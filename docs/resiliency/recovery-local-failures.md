---
title: 'Műszaki útmutató: Helyreállítás helyi hibák esetén az Azure-ban'
description: Annak az ismertetése, és rugalmas, magas rendelkezésre állású kialakítása, hibatűrő alkalmazások, valamint a vészhelyreállítási összpontosított helyi hibák utáni Azure-ban.
author: adamglick
ms.date: 08/18/2016
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.custom: resiliency
ms.openlocfilehash: a567b138580999c7b7a6ae8dedb244f4e37970e7
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54486046"
---
[!INCLUDE [header](../_includes/header.md)]

# <a name="azure-resiliency-technical-guidance-recovery-from-local-failures-in-azure"></a><span data-ttu-id="1f521-103">Technikai útmutató az Azure rugalmassága: Helyreállítás helyi hibák esetén az Azure-ban</span><span class="sxs-lookup"><span data-stu-id="1f521-103">Azure resiliency technical guidance: Recovery from local failures in Azure</span></span>

<span data-ttu-id="1f521-104">Nincsenek rendelkezésre állásának két elsődleges fenyegetések:</span><span class="sxs-lookup"><span data-stu-id="1f521-104">There are two primary threats to application availability:</span></span>

- <span data-ttu-id="1f521-105">A hiba az eszközök, például a meghajtók és kiszolgálók</span><span class="sxs-lookup"><span data-stu-id="1f521-105">The failure of devices, such as drives and servers</span></span>
- <span data-ttu-id="1f521-106">Kritikus erőforrások, például a maximális betöltési körülmények között számítási kimerülése</span><span class="sxs-lookup"><span data-stu-id="1f521-106">The exhaustion of critical resources, such as compute under peak load conditions</span></span>

<span data-ttu-id="1f521-107">Az Azure biztosít erőforrás-kezelést, rugalmasság, terheléselosztás és ilyen körülmények magas rendelkezésre állás engedélyezéséhez particionálás kombinációját.</span><span class="sxs-lookup"><span data-stu-id="1f521-107">Azure provides a combination of resource management, elasticity, load balancing, and partitioning to enable high availability under these circumstances.</span></span> <span data-ttu-id="1f521-108">Ezek a funkciók némelyike végrehajtása automatikusan történik az Azure-szolgáltatásokhoz.</span><span class="sxs-lookup"><span data-stu-id="1f521-108">Some of these features are performed automatically for all Azure services.</span></span> <span data-ttu-id="1f521-109">Bizonyos esetekben azonban az alkalmazás fejlesztőjének tegye számára, hogy azok néhány további munkát.</span><span class="sxs-lookup"><span data-stu-id="1f521-109">However, in some cases, the application developer must do some additional work to benefit from them.</span></span>

## <a name="cloud-services"></a><span data-ttu-id="1f521-110">Cloud Services</span><span class="sxs-lookup"><span data-stu-id="1f521-110">Cloud Services</span></span>

<span data-ttu-id="1f521-111">Az Azure Cloud Services áll egy vagy több webes vagy feldolgozói szerepkörök gyűjteménye.</span><span class="sxs-lookup"><span data-stu-id="1f521-111">Azure Cloud Services consists of collections of one or more web or worker roles.</span></span> <span data-ttu-id="1f521-112">Egy vagy több szerepkör példányai egyidejűleg is futtathatók.</span><span class="sxs-lookup"><span data-stu-id="1f521-112">One or more instances of a role can run concurrently.</span></span> <span data-ttu-id="1f521-113">A konfiguráció meghatározza, hogy a példányok számát.</span><span class="sxs-lookup"><span data-stu-id="1f521-113">The configuration determines the number of instances.</span></span> <span data-ttu-id="1f521-114">Szerepkörpéldányok monitorozott és felügyelt keresztül a hálóvezérlő összetevőt.</span><span class="sxs-lookup"><span data-stu-id="1f521-114">Role instances are monitored and managed through a component called the fabric controller.</span></span> <span data-ttu-id="1f521-115">A hálóvezérlő észleli, és automatikusan szoftver-és hardver válaszol.</span><span class="sxs-lookup"><span data-stu-id="1f521-115">The fabric controller detects and responds to both software and hardware failures automatically.</span></span>

<span data-ttu-id="1f521-116">Minden szerepkör-példány fut, a saját virtuális gépet (VM), és a hálóvezérlő egy vendégügynök keresztül kommunikál.</span><span class="sxs-lookup"><span data-stu-id="1f521-116">Every role instance runs in its own virtual machine (VM) and communicates with its fabric controller through a guest agent.</span></span> <span data-ttu-id="1f521-117">A vendégügynök erőforrás és a csomópont mérőszámokat, beleértve a virtuális gép használati, állapot, naplók, erőforrás-használat, kivételek és hibafeltételek gyűjti.</span><span class="sxs-lookup"><span data-stu-id="1f521-117">The guest agent collects resource and node metrics, including VM usage, status, logs, resource usage, exceptions, and failure conditions.</span></span> <span data-ttu-id="1f521-118">A hálóvezérlő konfigurálható időközönként a vendégügynök kérdezi le, és azt a virtuális gép újraindul, ha a vendégügynök nem válaszol.</span><span class="sxs-lookup"><span data-stu-id="1f521-118">The fabric controller queries the guest agent at configurable intervals, and it restarts the VM if the guest agent fails to respond.</span></span> <span data-ttu-id="1f521-119">Hardverhiba esetén a társított hálóvezérlő helyezi át az összes érintett szerepkörpéldány új hardver csomópontot, és újrakonfigurálja a hálózati forgalom irányítására van.</span><span class="sxs-lookup"><span data-stu-id="1f521-119">In the event of hardware failure, the associated fabric controller moves all affected role instances to a new hardware node and reconfigures the network to route traffic there.</span></span>

<span data-ttu-id="1f521-120">Számára, hogy ezeket a funkciókat, fejlesztők biztosítania kell, hogy az összes szolgáltatás szerepkör elkerülése érdekében a szerepkörpéldányok állapotát tárolja.</span><span class="sxs-lookup"><span data-stu-id="1f521-120">To benefit from these features, developers should ensure that all service roles avoid storing state on the role instances.</span></span> <span data-ttu-id="1f521-121">Ehelyett minden perzisztens kell elérhető tartós tárolási, például az Azure Storage vagy az Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="1f521-121">Instead, all persistent data should be accessed from durable storage, such as Azure Storage or Azure SQL Database.</span></span> <span data-ttu-id="1f521-122">Ez lehetővé teszi a kérések kezelésére szerepköröket.</span><span class="sxs-lookup"><span data-stu-id="1f521-122">This allows any roles to handle requests.</span></span> <span data-ttu-id="1f521-123">Azt is jelenti, hogy szerepkör példányai is leáll bármikor a szolgáltatás átmeneti vagy állandó állapotban inkonzisztenciát létrehozása nélkül.</span><span class="sxs-lookup"><span data-stu-id="1f521-123">It also means that role instances can go down at any time without creating inconsistencies in the transient or persistent state of the service.</span></span>

<span data-ttu-id="1f521-124">A követelmény a szerepköröket, a külsőleg-állapotának tárolására több hatással van.</span><span class="sxs-lookup"><span data-stu-id="1f521-124">The requirement to store state externally to the roles has several implications.</span></span> <span data-ttu-id="1f521-125">Ez azt jelenti, például, hogy egy Azure Storage-táblába az összes kapcsolódó változtatás kell módosítani egy entitáscsoportot tranzakcióban, ha lehetséges.</span><span class="sxs-lookup"><span data-stu-id="1f521-125">It implies, for example, that all related changes to an Azure Storage table should be changed in a single entity-group transaction, if possible.</span></span> <span data-ttu-id="1f521-126">Természetesen nem mindig lehetséges, hogy az összes módosítást egy tranzakción belül.</span><span class="sxs-lookup"><span data-stu-id="1f521-126">Of course, it isn't always possible to make all changes in a single transaction.</span></span> <span data-ttu-id="1f521-127">Győződjön meg arról, hogy szerepkör sikertelen példánytelepítések nem problémákat okozhat, ha azok, amelyek a szolgáltatás állandó állapota két vagy több frissítéseit hosszú ideig futó műveletek megszakítási különös gondot kell végeznie.</span><span class="sxs-lookup"><span data-stu-id="1f521-127">You must take special care to ensure that role instance failures do not cause problems when they interrupt long-running operations that span two or more updates to the persistent state of the service.</span></span> <span data-ttu-id="1f521-128">Ha egy másik szerepkör megpróbálja próbálkozzon újra a e művelet, azt kell ennek előrejelzését, és az eset, ahol a munkahelyi részben végrehajtva kezelését.</span><span class="sxs-lookup"><span data-stu-id="1f521-128">If another role attempts to retry such an operation, it should anticipate and handle the case where the work was partially completed.</span></span>

<span data-ttu-id="1f521-129">Vegyük példaként egy szolgáltatás, amely több üzletben particionálja az adatokat.</span><span class="sxs-lookup"><span data-stu-id="1f521-129">For example, consider a service that partitions data across multiple stores.</span></span> <span data-ttu-id="1f521-130">Ha egy feldolgozói szerepkör leáll, amíg, áthelyezés, szegmensek van, valószínűleg nem fejeződött be a szegmenshez való áthelyezését.</span><span class="sxs-lookup"><span data-stu-id="1f521-130">If a worker role goes down while it's relocating a shard, the relocation of the shard might not finish.</span></span> <span data-ttu-id="1f521-131">Vagy az adatáthelyezési előfordulhat, hogy ismétlődik a kezdetektől a különböző feldolgozói szerepkör, potenciálisan a árva adatokat vagy adatsérülés okozza.</span><span class="sxs-lookup"><span data-stu-id="1f521-131">Or the relocation might be repeated from its inception by a different worker role, potentially causing orphaned data or data corruption.</span></span> <span data-ttu-id="1f521-132">A problémák megelőzése érdekében hosszú ideig futó műveletek egyikét vagy mindkettőt a következőket kell lennie:</span><span class="sxs-lookup"><span data-stu-id="1f521-132">To prevent problems, long-running operations must be one or both of the following:</span></span>

- <span data-ttu-id="1f521-133">*Idempotens*: Megismételhető hatásai nélkül.</span><span class="sxs-lookup"><span data-stu-id="1f521-133">*Idempotent*: Repeatable without side effects.</span></span> <span data-ttu-id="1f521-134">Ahhoz, hogy idempotensek, egy hosszú ideig futó művelet ugyanezt a hatást, függetlenül attól, hogy hányszor hajtja azt végre, akkor is, ha a végrehajtás során megszakad, kell rendelkeznie.</span><span class="sxs-lookup"><span data-stu-id="1f521-134">To be idempotent, a long-running operation should have the same effect no matter how many times it's executed, even when it's interrupted during execution.</span></span>
- <span data-ttu-id="1f521-135">*Növekményes újraindítható*: A legutóbbi pont folytatása sikerült.</span><span class="sxs-lookup"><span data-stu-id="1f521-135">*Incrementally restartable*: Able to continue from the most recent point of failure.</span></span> <span data-ttu-id="1f521-136">Ahhoz, hogy növekményes újraindítható, egy hosszú ideig futó művelet atomi művelet kisebb sorozatát kell állnia.</span><span class="sxs-lookup"><span data-stu-id="1f521-136">To be incrementally restartable, a long-running operation should consist of a sequence of smaller atomic operations.</span></span> <span data-ttu-id="1f521-137">Tartós tárolási, is azt kell rögzíteni a folyamat előrehaladását, úgy, hogy minden ezt követő meghívási szerzi be ahol elődjének leállt.</span><span class="sxs-lookup"><span data-stu-id="1f521-137">It should also record its progress in durable storage, so that each subsequent invocation picks up where its predecessor stopped.</span></span>

<span data-ttu-id="1f521-138">Végül az összes hosszú ideig futó műveletek kell hívható ismételten amíg nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="1f521-138">Finally, all long-running operations should be invoked repeatedly until they succeed.</span></span> <span data-ttu-id="1f521-139">Például egy üzembe helyezési művelet előfordulhat, hogy helyezi el az Azure-üzenetsort, és ezután eltávolítja az üzenetsor feldolgozói szerepkör által csak akkor, ha ez sikeres.</span><span class="sxs-lookup"><span data-stu-id="1f521-139">For example, a provisioning operation might be placed in an Azure queue, and then removed from the queue by a worker role only when it succeeds.</span></span> <span data-ttu-id="1f521-140">A szemétgyűjtés karbantartási műveletek megszakad adatok létrehozásához szükség lehet.</span><span class="sxs-lookup"><span data-stu-id="1f521-140">Garbage collection might be necessary to clean up data that interrupted operations create.</span></span>

### <a name="elasticity"></a><span data-ttu-id="1f521-141">Rugalmasság</span><span class="sxs-lookup"><span data-stu-id="1f521-141">Elasticity</span></span>

<span data-ttu-id="1f521-142">Az egyes szerepkörökhöz futó példányok kezdeti száma az egyes szerepkör-konfigurációjának határozza meg.</span><span class="sxs-lookup"><span data-stu-id="1f521-142">The initial number of instances running for each role is determined in each role’s configuration.</span></span> <span data-ttu-id="1f521-143">A rendszergazdák először konfigurálnia kell a várható terhelés alapján két vagy több példányát futtatni kívánt szerepkörök.</span><span class="sxs-lookup"><span data-stu-id="1f521-143">Administrators should initially configure each role to run with two or more instances based on expected load.</span></span> <span data-ttu-id="1f521-144">De egyszerűen méretezhető szerepkörpéldányok vagy le, a használati minták módosítása.</span><span class="sxs-lookup"><span data-stu-id="1f521-144">But you can easily scale role instances up or down as usage patterns change.</span></span> <span data-ttu-id="1f521-145">Ezt megteheti manuálisan az Azure Portalon, vagy a folyamat automatizálható a Windows PowerShell, a Service Management API vagy a külső eszközök használatával.</span><span class="sxs-lookup"><span data-stu-id="1f521-145">You can do this manually in the Azure portal, or you can automate the process by using Windows PowerShell, the Service Management API, or third-party tools.</span></span> <span data-ttu-id="1f521-146">További információkért lásd: [az automatikus skálázáshoz alkalmazás](/azure/cloud-services/cloud-services-how-to-scale/).</span><span class="sxs-lookup"><span data-stu-id="1f521-146">For more information, see [How to autoscale an application](/azure/cloud-services/cloud-services-how-to-scale/).</span></span>

### <a name="partitioning"></a><span data-ttu-id="1f521-147">Particionálás</span><span class="sxs-lookup"><span data-stu-id="1f521-147">Partitioning</span></span>

<span data-ttu-id="1f521-148">Az Azure fabric controller két típusú partíciók használ:</span><span class="sxs-lookup"><span data-stu-id="1f521-148">The Azure fabric controller uses two types of partitions:</span></span>

- <span data-ttu-id="1f521-149">Egy *frissítési tartományt* -service-szerepkörpéldányok csoportok frissítésére szolgál.</span><span class="sxs-lookup"><span data-stu-id="1f521-149">An *update domain* is used to upgrade a service’s role instances in groups.</span></span> <span data-ttu-id="1f521-150">Azure szolgáltatáspéldányok több tartományban történő üzembe helyezi.</span><span class="sxs-lookup"><span data-stu-id="1f521-150">Azure deploys service instances into multiple update domains.</span></span> <span data-ttu-id="1f521-151">Helybeni frissítést a a hálóvezérlő összes példányát le egyetlen frissítési tartomány számos lehetőséget kínál, frissíti őket, és újraindítja az őket a következő frissítési tartomány áthelyezése előtt.</span><span class="sxs-lookup"><span data-stu-id="1f521-151">For an in-place update, the fabric controller brings down all the instances in one update domain, updates them, and then restarts them before moving to the next update domain.</span></span> <span data-ttu-id="1f521-152">Ez a módszer megakadályozza az egész szolgáltatás nem érhető el a frissítési folyamat alatt.</span><span class="sxs-lookup"><span data-stu-id="1f521-152">This approach prevents the entire service from being unavailable during the update process.</span></span>
- <span data-ttu-id="1f521-153">A *tartalék tartomány* hibalehetőség adódik hardver- vagy hálózati határozza meg.</span><span class="sxs-lookup"><span data-stu-id="1f521-153">A *fault domain* defines potential points of hardware or network failure.</span></span> <span data-ttu-id="1f521-154">Minden olyan szerepkörhöz, amelynek több példányt a hálóvezérlő biztosítja, hogy a példányok között oszlanak meg több tartalék tartomány megakadályozza, hogy elkülönített hardver-meghibásodásokkal szolgáltatás megszakítása.</span><span class="sxs-lookup"><span data-stu-id="1f521-154">For any role that has more than one instance, the fabric controller ensures that the instances are distributed across multiple fault domains, to prevent isolated hardware failures from disrupting service.</span></span> <span data-ttu-id="1f521-155">A tartalék tartomány szabályozza a kitettség a kiszolgáló és a hibákkal szemben.</span><span class="sxs-lookup"><span data-stu-id="1f521-155">Fault domains govern all exposure to server and cluster failures.</span></span>

<span data-ttu-id="1f521-156">A [Azure szolgáltatásiszint-szerződés (SLA)](https://azure.microsoft.com/support/legal/sla/) garantálja, hogy különböző tartalék és frissítési tartományokba, legalább két webes szerepkör példányai van telepítve, ha rendelkeznek külső kapcsolatokat az idő legalább 99,95 %-os.</span><span class="sxs-lookup"><span data-stu-id="1f521-156">The [Azure service-level agreement (SLA)](https://azure.microsoft.com/support/legal/sla/) guarantees that when two or more web role instances are deployed to different fault and upgrade domains, they'll have external connectivity at least 99.95 percent of the time.</span></span> <span data-ttu-id="1f521-157">Ellentétben a frissítési tartományok nincs lehetőség a tartalék tartományok száma.</span><span class="sxs-lookup"><span data-stu-id="1f521-157">Unlike update domains, there's no way to control the number of fault domains.</span></span> <span data-ttu-id="1f521-158">Az Azure automatikusan foglalja le a tartalék tartományok és azok között osztja el a szerepkör példányai.</span><span class="sxs-lookup"><span data-stu-id="1f521-158">Azure automatically allocates fault domains and distributes role instances across them.</span></span> <span data-ttu-id="1f521-159">At legalább az első két példánya minden kerüljenek a különböző hibatűrési és frissítési tartományokban tárolja, győződjön meg arról, hogy minden olyan szerepkörhöz legalább két példányt megfelelnek-e a szolgáltatói szerződés.</span><span class="sxs-lookup"><span data-stu-id="1f521-159">At least the first two instances of every role are placed in different fault and upgrade domains to ensure that any role with at least two instances will satisfy the SLA.</span></span> <span data-ttu-id="1f521-160">Ez a következő ábrán jelölt.</span><span class="sxs-lookup"><span data-stu-id="1f521-160">This is represented in the following diagram.</span></span>

![Tartalék tartomány elkülönítési egyszerűsített nézete](./images/technical-guidance-recovery-local-failures/partitioning-1.png)

### <a name="load-balancing"></a><span data-ttu-id="1f521-162">Terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="1f521-162">Load balancing</span></span>

<span data-ttu-id="1f521-163">Az összes bejövő forgalmat a webes szerepkör áthalad egy állapot nélküli terheléselosztó, amely ügyfélkéréseket a szerepkör példányai között osztja el.</span><span class="sxs-lookup"><span data-stu-id="1f521-163">All inbound traffic to a web role passes through a stateless load balancer, which distributes client requests among the role instances.</span></span> <span data-ttu-id="1f521-164">Egyéni szerepkör példányai nem rendelkezik a nyilvános IP-címeket, és azok nem közvetlenül címezhetővé válnak az internetről.</span><span class="sxs-lookup"><span data-stu-id="1f521-164">Individual role instances do not have public IP addresses, and they are not directly addressable from the Internet.</span></span> <span data-ttu-id="1f521-165">Webes szerepkörök nélküliek, így bármely ügyfél kérés átirányítható, bármilyen szerepkör-példány.</span><span class="sxs-lookup"><span data-stu-id="1f521-165">Web roles are stateless so that any client request can be routed to any role instance.</span></span> <span data-ttu-id="1f521-166">A [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck.aspx) esemény jelenik meg a 15 másodpercenként.</span><span class="sxs-lookup"><span data-stu-id="1f521-166">A [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck.aspx) event is raised every 15 seconds.</span></span> <span data-ttu-id="1f521-167">Ezzel jelezheti, hogy a szerepkör készen áll a forgalom fogadásához, vagy legyen az elfoglalt, és a load balancer rotációból kell venni.</span><span class="sxs-lookup"><span data-stu-id="1f521-167">You can use this to indicate whether the role is ready to receive traffic, or whether it's busy and should be taken out of the load-balancer rotation.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="1f521-168">Virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="1f521-168">Virtual Machines</span></span>

<span data-ttu-id="1f521-169">Az Azure Virtual Machines, a platformszolgáltatás (PaaS) szerepkörök több szempontból viszonyítva magas rendelkezésre állású számítási platform eltér.</span><span class="sxs-lookup"><span data-stu-id="1f521-169">Azure Virtual Machines differs from platform as a service (PaaS) compute roles in several respects in relation to high availability.</span></span> <span data-ttu-id="1f521-170">Bizonyos esetekben, tegye a magas rendelkezésre állás biztosítása érdekében további munkát.</span><span class="sxs-lookup"><span data-stu-id="1f521-170">In some instances, you must do additional work to ensure high availability.</span></span>

### <a name="disk-durability"></a><span data-ttu-id="1f521-171">Lemez tartóssága</span><span class="sxs-lookup"><span data-stu-id="1f521-171">Disk durability</span></span>

<span data-ttu-id="1f521-172">PaaS szerepkörpéldányok, ellentétben a virtuális gép meghajtókon tárolt adatokat az állandó akkor is, ha a virtuális gép van más helyre.</span><span class="sxs-lookup"><span data-stu-id="1f521-172">Unlike PaaS role instances, data stored on virtual machine drives is persistent even when the virtual machine is relocated.</span></span> <span data-ttu-id="1f521-173">Az Azure virtual machines létező Virtuálisgép-lemezek használjuk az Azure Storage-blobokat.</span><span class="sxs-lookup"><span data-stu-id="1f521-173">Azure virtual machines use VM disks that exist as blobs in Azure Storage.</span></span> <span data-ttu-id="1f521-174">Azure Storage rendelkezésre állási jellemzőinek miatt a virtuális gépek meghajtókon tárolt adatokat is magas rendelkezésre állású.</span><span class="sxs-lookup"><span data-stu-id="1f521-174">Because of the availability characteristics of Azure Storage, the data stored on a virtual machine’s drives is also highly available.</span></span>

<span data-ttu-id="1f521-175">Vegye figyelembe, hogy D meghajtó (a Windows VM-EK) az ezen szabály alól.</span><span class="sxs-lookup"><span data-stu-id="1f521-175">Note that drive D (in Windows VMs) is the exception to this rule.</span></span> <span data-ttu-id="1f521-176">D meghajtó a rack kiszolgálón, amelyen a virtuális gép tényleges fizikai tárhelyet, és az adatok elvesznek, ha a virtuális gép újraindul.</span><span class="sxs-lookup"><span data-stu-id="1f521-176">Drive D is actually physical storage on the rack server that hosts the VM, and its data will be lost if the VM is recycled.</span></span> <span data-ttu-id="1f521-177">D meghajtó csak ideiglenes tároló szól.</span><span class="sxs-lookup"><span data-stu-id="1f521-177">Drive D is intended for temporary storage only.</span></span> <span data-ttu-id="1f521-178">A Linux Azure "általában" (de nem mindig) tesz elérhetővé a helyi ideiglenes lemez /dev/sdb blokk eszközként.</span><span class="sxs-lookup"><span data-stu-id="1f521-178">In Linux, Azure “usually” (but not always) exposes the local temporary disk as /dev/sdb block device.</span></span> <span data-ttu-id="1f521-179">Gyakran csatlakoztatva van az Azure Linux-ügynök által /mnt/resource vagy /mnt csatlakoztatási pontokra (/etc/waagent.conf keresztül konfigurálható).</span><span class="sxs-lookup"><span data-stu-id="1f521-179">It is often mounted by the Azure Linux Agent as /mnt/resource or /mnt mount points (configurable via /etc/waagent.conf).</span></span>

<!-- markdownlint-disable MD024 -->

### <a name="partitioning"></a><span data-ttu-id="1f521-180">Particionálás</span><span class="sxs-lookup"><span data-stu-id="1f521-180">Partitioning</span></span>

<span data-ttu-id="1f521-181">Az Azure natív módon megért a rétegek egy PaaS-alkalmazásban (webes és feldolgozói szerepkörök), és így tudja megfelelően kioszthatja tartalék és frissítési tartományok között.</span><span class="sxs-lookup"><span data-stu-id="1f521-181">Azure natively understands the tiers in a PaaS application (web role and worker role) and thus can properly distribute them across fault and update domains.</span></span> <span data-ttu-id="1f521-182">Ezzel szemben a rétegek egy infrastruktúra-szolgáltatás (IaaS) alkalmazásként manuálisan definiálni kell keresztül a rendelkezésre állási csoportok.</span><span class="sxs-lookup"><span data-stu-id="1f521-182">In contrast, the tiers in an infrastructure as a service (IaaS) application must be manually defined through availability sets.</span></span> <span data-ttu-id="1f521-183">A rendelkezésre állási csoportok szükségesek alatt IaaS SLA-t.</span><span class="sxs-lookup"><span data-stu-id="1f521-183">Availability sets are required for an SLA under IaaS.</span></span>

![Rendelkezésre állási csoportok az Azure-beli virtuális gépek](./images/technical-guidance-recovery-local-failures/partitioning-2.png)

<span data-ttu-id="1f521-185">A fenti ábrán az Internet Information Services (IIS) szint (amely a web app réteget módon működik) és az SQL-szint (amely egy adatrétegbeli módon működik) hozzá van rendelve másik rendelkezésre állási csoportokat.</span><span class="sxs-lookup"><span data-stu-id="1f521-185">In the preceding diagram, the Internet Information Services (IIS) tier (which works as a web app tier) and the SQL tier (which works as a data tier) are assigned to different availability sets.</span></span> <span data-ttu-id="1f521-186">Ez biztosítja, hogy rendelkezik-e az egyes szintek összes példányát hardverredundancia osztja meg a virtuális gépek a tartalék tartományok között, és, hogy teljes szinten nem egy frissítés alatt álló alkotásait.</span><span class="sxs-lookup"><span data-stu-id="1f521-186">This ensures that all instances of each tier have hardware redundancy by distributing virtual machines across fault domains, and that entire tiers are not taken down during an update.</span></span>

### <a name="load-balancing"></a><span data-ttu-id="1f521-187">Terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="1f521-187">Load balancing</span></span>

<span data-ttu-id="1f521-188">A virtuális gépek elosztott azok között forgalmat kell rendelkeznie, ha egy alkalmazás és a terhelés elosztása a virtuális gépek között egy adott TCP vagy UDP-végpontnak kell csoportosítja.</span><span class="sxs-lookup"><span data-stu-id="1f521-188">If the VMs should have traffic distributed across them, you must group the VMs in an application and load balance across a specific TCP or UDP endpoint.</span></span> <span data-ttu-id="1f521-189">További információkért lásd: [terheléselosztási virtuális gépek](/azure/virtual-machines/virtual-machines-linux-load-balance/?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="1f521-189">For more information, see [Load balancing virtual machines](/azure/virtual-machines/virtual-machines-linux-load-balance/?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span> <span data-ttu-id="1f521-190">Ha a virtuális gépek bemeneti más forrásból (például egy üzenetsor-kezelési mechanizmust) kap, a load balancer, nem szükséges.</span><span class="sxs-lookup"><span data-stu-id="1f521-190">If the VMs receive input from another source (for example, a queuing mechanism), a load balancer is not required.</span></span> <span data-ttu-id="1f521-191">A load balancer alapszintű állapot-ellenőrzése alapján határozza meg, hogy kell-e forgalmat küldeni a csomópontra.</span><span class="sxs-lookup"><span data-stu-id="1f521-191">The load balancer uses a basic health check to determine whether traffic should be sent to the node.</span></span> <span data-ttu-id="1f521-192">Az is lehet létrehozni a saját mintavételek megvalósításához és alkalmazásspecifikus mérőszámok, amelyek meghatározzák, hogy a virtuális gép jár-e a forgalmat.</span><span class="sxs-lookup"><span data-stu-id="1f521-192">It's also possible to create your own probes to implement application-specific health metrics that determine whether the VM should receive traffic.</span></span>

## <a name="storage"></a><span data-ttu-id="1f521-193">Tárhely</span><span class="sxs-lookup"><span data-stu-id="1f521-193">Storage</span></span>

<span data-ttu-id="1f521-194">Az Azure Storage szolgáltatása a referenciakonfiguráció hosszú élettartamú adatok az Azure-hoz.</span><span class="sxs-lookup"><span data-stu-id="1f521-194">Azure Storage is the baseline durable data service for Azure.</span></span> <span data-ttu-id="1f521-195">Blob, table, queue és virtuális gép lemezes tárolás biztosít.</span><span class="sxs-lookup"><span data-stu-id="1f521-195">It provides blob, table, queue, and VM disk storage.</span></span> <span data-ttu-id="1f521-196">Replikáció és az erőforrás-kezelés együttes használatával magas rendelkezésre állás egyetlen adatközponton belül.</span><span class="sxs-lookup"><span data-stu-id="1f521-196">It uses a combination of replication and resource management to provide high availability within a single datacenter.</span></span> <span data-ttu-id="1f521-197">Az Azure Storage rendelkezésre állási SLA biztosítja azt, hogy legalább 99,9 %-ában:</span><span class="sxs-lookup"><span data-stu-id="1f521-197">The Azure Storage availability SLA guarantees that at least 99.9 percent of the time:</span></span>

- <span data-ttu-id="1f521-198">Helyesen formázott kérelmeket szeretne hozzáadni, update, olvassa el és az adatok törlésével fogja sikeres és helyesen feldolgozni.</span><span class="sxs-lookup"><span data-stu-id="1f521-198">Correctly formatted requests to add, update, read, and delete data will be successfully and correctly processed.</span></span>
- <span data-ttu-id="1f521-199">Storage-fiókok elérhetőséget, az internetes átjárónkhoz.</span><span class="sxs-lookup"><span data-stu-id="1f521-199">Storage accounts will have connectivity to the Internet gateway.</span></span>

### <a name="replication"></a><span data-ttu-id="1f521-200">Replikáció</span><span class="sxs-lookup"><span data-stu-id="1f521-200">Replication</span></span>

<span data-ttu-id="1f521-201">Az Azure Storage segíti az adatok tartós megőrzését között teljesen független fizikai tárhelyek alrendszerei a régión belül több példányának különböző meghajtókon található összes adat megőrzése.</span><span class="sxs-lookup"><span data-stu-id="1f521-201">Azure Storage facilitates data durability by maintaining multiple copies of all data on different drives across fully independent physical storage subsystems within the region.</span></span> <span data-ttu-id="1f521-202">Szinkron módon rendszer replikálja az adatokat, és mindegyik példányt véglegesítése előtt a rendszer arra vonatkozik, az írási.</span><span class="sxs-lookup"><span data-stu-id="1f521-202">Data is replicated synchronously, and all copies are committed before the write is acknowledged.</span></span> <span data-ttu-id="1f521-203">Az Azure Storage szolgáltatás erősen konzisztens, ami azt jelenti, hogy olvasási garantáltan a legújabb írást tükrözik.</span><span class="sxs-lookup"><span data-stu-id="1f521-203">Azure Storage is strongly consistent, meaning that reads are guaranteed to reflect the most recent writes.</span></span> <span data-ttu-id="1f521-204">Adatok másolatainak emellett folyamatosan vizsgált észlelése és javítása bit rothadás, egy gyakran tényezőkből fenyegetés tárolt adatok sértetlenségét.</span><span class="sxs-lookup"><span data-stu-id="1f521-204">In addition, copies of data are continually scanned to detect and repair bit rot, an often overlooked threat to the integrity of stored data.</span></span>

<span data-ttu-id="1f521-205">Szolgáltatások csak az Azure Storage használatával előnyeit a replikációból.</span><span class="sxs-lookup"><span data-stu-id="1f521-205">Services benefit from replication just by using Azure Storage.</span></span> <span data-ttu-id="1f521-206">A szolgáltatás fejlesztői nem kell helyi hiba helyreállítása további munkát.</span><span class="sxs-lookup"><span data-stu-id="1f521-206">The service developer doesn't need to do additional work to recover from a local failure.</span></span>

### <a name="resource-management"></a><span data-ttu-id="1f521-207">Erőforrás-kezelés</span><span class="sxs-lookup"><span data-stu-id="1f521-207">Resource management</span></span>

<span data-ttu-id="1f521-208">2014. május, után létrehozott Storage-fiókok legfeljebb 500 TB-ig (a korábbi maximális volt 200 TB) növelhető.</span><span class="sxs-lookup"><span data-stu-id="1f521-208">Storage accounts created after May 2014, can grow to up to 500 TB (the previous maximum was 200 TB).</span></span> <span data-ttu-id="1f521-209">Ha további tárterületre szükség, alkalmazásokat kell kialakítani, hogy több tárfiók használata.</span><span class="sxs-lookup"><span data-stu-id="1f521-209">If additional space is required, applications must be designed to use multiple storage accounts.</span></span>

### <a name="virtual-machine-disks"></a><span data-ttu-id="1f521-210">Virtuálisgép-lemezek</span><span class="sxs-lookup"><span data-stu-id="1f521-210">Virtual machine disks</span></span>

<span data-ttu-id="1f521-211">Az Azure Storage adná ugyanazokat tartósság és a méretezhetőség tulajdonság a Blob storage, lapblob egy virtuálisgép-lemez van tárolva.</span><span class="sxs-lookup"><span data-stu-id="1f521-211">A virtual machine’s disk is stored as a page blob in Azure Storage, giving it all the same durability and scalability properties as Blob storage.</span></span> <span data-ttu-id="1f521-212">Ez a kialakítás teszi az adatok egy virtuálisgép-lemez állandó, még akkor is, ha a virtuális Gépet futtató kiszolgáló meghibásodik, és újra kell indítani a virtuális gép egy másik kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="1f521-212">This design makes the data on a virtual machine’s disk persistent, even if the server running the VM fails and the VM must be restarted on another server.</span></span>

## <a name="database"></a><span data-ttu-id="1f521-213">Adatbázis</span><span class="sxs-lookup"><span data-stu-id="1f521-213">Database</span></span>

### <a name="sql-database"></a><span data-ttu-id="1f521-214">SQL-adatbázis</span><span class="sxs-lookup"><span data-stu-id="1f521-214">SQL Database</span></span>

<span data-ttu-id="1f521-215">Az Azure SQL Database-adatbázist kínál szolgáltatásként.</span><span class="sxs-lookup"><span data-stu-id="1f521-215">Azure SQL Database provides database as a service.</span></span> <span data-ttu-id="1f521-216">Lehetővé teszi alkalmazások gyors üzembe helyezése, helyezze be az adatokat, és a relációs adatbázisok lekérdezése.</span><span class="sxs-lookup"><span data-stu-id="1f521-216">It allows applications to quickly provision, insert data into, and query relational databases.</span></span> <span data-ttu-id="1f521-217">Az ismerős SQL-kiszolgálói szolgáltatásairól és funkcióiról, számos hardver, konfigurációs, javítási és rugalmasság terhe paltformfüggetlen közben biztosít.</span><span class="sxs-lookup"><span data-stu-id="1f521-217">It provides many of the familiar SQL Server features and functionality, while abstracting the burden of hardware, configuration, patching, and resiliency.</span></span>

> [!NOTE]
> <span data-ttu-id="1f521-218">Az Azure SQL Database nem biztosít az SQL Server-az-egyhez funkcióparitás.</span><span class="sxs-lookup"><span data-stu-id="1f521-218">Azure SQL Database does not provide one-to-one feature parity with SQL Server.</span></span> <span data-ttu-id="1f521-219">Az követelmények –, amely rendelkezik egyedi alkalmas a felhőalapú alkalmazások (rugalmasan méretezhető, adatbázis-szolgáltatás karbantartási költségek csökkentéséhez és így tovább) külön készletét teljesítéséhez rendelkezik szolgál.</span><span class="sxs-lookup"><span data-stu-id="1f521-219">It's intended to fulfill a different set of requirements--one that's uniquely suited to cloud applications (elastic scale, database as a service to reduce maintenance costs, and so on).</span></span> <span data-ttu-id="1f521-220">További információkért lásd: [felhőalapú SQL Server option: Az Azure SQL (PaaS) adatbázis vagy SQL Server Azure virtuális gépeken (IaaS)](/azure/sql-database/sql-database-paas-vs-sql-server-iaas/).</span><span class="sxs-lookup"><span data-stu-id="1f521-220">For more information, see [Choose a cloud SQL Server option: Azure SQL (PaaS) Database or SQL Server on Azure VMs (IaaS)](/azure/sql-database/sql-database-paas-vs-sql-server-iaas/).</span></span>

#### <a name="replication"></a><span data-ttu-id="1f521-221">Replikáció</span><span class="sxs-lookup"><span data-stu-id="1f521-221">Replication</span></span>

<span data-ttu-id="1f521-222">Az Azure SQL Database csomópont-szintű hiba beépített rugalmasságot biztosít.</span><span class="sxs-lookup"><span data-stu-id="1f521-222">Azure SQL Database provides built-in resiliency to node-level failure.</span></span> <span data-ttu-id="1f521-223">Az összes írási művelet az adatbázisba hátterének legalább két csomóponttal keresztül egy kvórum véglegesítési technika automatikusan replikálva van.</span><span class="sxs-lookup"><span data-stu-id="1f521-223">All writes into a database are automatically replicated to two or more background nodes through a quorum commit technique.</span></span> <span data-ttu-id="1f521-224">(Az elsődleges és másodlagos legalább egy meg kell erősítenie, hogy a tevékenység írt a tranzakciónapló, mielőtt a tranzakció sikeres minősül, és adja vissza.) Csomóponthiba esetén az adatbázis automatikusan átadja a feladatokat a másodlagos replikára.</span><span class="sxs-lookup"><span data-stu-id="1f521-224">(The primary and at least one secondary must confirm that the activity is written to the transaction log before the transaction is deemed successful and returns.) In the case of node failure, the database automatically fails over to one of the secondary replicas.</span></span> <span data-ttu-id="1f521-225">Ez azt eredményezi, hogy egy átmeneti kapcsolat megszakadása, az ügyfélalkalmazások számára.</span><span class="sxs-lookup"><span data-stu-id="1f521-225">This causes a transient connection interruption for client applications.</span></span> <span data-ttu-id="1f521-226">Ebből kifolyólag minden Azure SQL Database-ügyfelek musí implementovat valamilyen átmeneti kapcsolati kezelését.</span><span class="sxs-lookup"><span data-stu-id="1f521-226">For this reason, all Azure SQL Database clients must implement some form of transient connection handling.</span></span> <span data-ttu-id="1f521-227">További információkért lásd: [az újrapróbálkozási mechanizmushoz adott](/azure/best-practices-retry-service-specific/).</span><span class="sxs-lookup"><span data-stu-id="1f521-227">For more information, see [Retry service specific guidance](/azure/best-practices-retry-service-specific/).</span></span>

#### <a name="resource-management"></a><span data-ttu-id="1f521-228">Erőforrás-kezelés</span><span class="sxs-lookup"><span data-stu-id="1f521-228">Resource management</span></span>

<span data-ttu-id="1f521-229">Minden adatbázis létrehozása után úgy van konfigurálva, és a egy méretének felső korlátja.</span><span class="sxs-lookup"><span data-stu-id="1f521-229">Each database, when created, is configured with an upper size limit.</span></span> <span data-ttu-id="1f521-230">A jelenleg rendelkezésre álló maximális mérete 1 TB-os (korlátok eltérő méretű lásd a szolgáltatási réteg alapján [szolgáltatás és az Azure SQL Database-adatbázisok teljesítményszintek](/azure/sql-database/sql-database-resource-limits/#service-tiers-and-performance-levels).</span><span class="sxs-lookup"><span data-stu-id="1f521-230">The currently available maximum size is 1 TB (size limits vary based on your service tier, see [service tiers and performance levels of Azure SQL Databases](/azure/sql-database/sql-database-resource-limits/#service-tiers-and-performance-levels).</span></span> <span data-ttu-id="1f521-231">Egy adatbázis találatok száma a felső méretkorlátot, elutasítja a további INSERT nebo UPDATE parancsok.</span><span class="sxs-lookup"><span data-stu-id="1f521-231">When a database hits its upper size limit, it rejects additional INSERT or UPDATE commands.</span></span> <span data-ttu-id="1f521-232">(Lekérdezés, és az adatok törlése az továbbra is lehetséges.)</span><span class="sxs-lookup"><span data-stu-id="1f521-232">(Querying and deleting data is still possible.)</span></span>

<span data-ttu-id="1f521-233">Egy adatbázison belül az Azure SQL Database használ a háló-erőforrások kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="1f521-233">Within a database, Azure SQL Database uses a fabric to manage resources.</span></span> <span data-ttu-id="1f521-234">Azonban a hálóvezérlő helyett használja egy körgyűrűs topológia a hibák észlelése érdekében.</span><span class="sxs-lookup"><span data-stu-id="1f521-234">However, instead of a fabric controller, it uses a ring topology to detect failures.</span></span> <span data-ttu-id="1f521-235">Minden replika egy fürtben két szomszédok rendelkezik, és azt észlelte, amikor azok felelős.</span><span class="sxs-lookup"><span data-stu-id="1f521-235">Every replica in a cluster has two neighbors and is responsible for detecting when they go down.</span></span> <span data-ttu-id="1f521-236">Ha egy replika leáll, szomszédjainak aktiválása egy újrakonfigurálási ügynök újra létre egy másik gépen.</span><span class="sxs-lookup"><span data-stu-id="1f521-236">When a replica goes down, its neighbors trigger a reconfiguration agent to re-create it on another machine.</span></span> <span data-ttu-id="1f521-237">Annak biztosítása érdekében, hogy egy logikai kiszolgálót nem túl sok erőforrást használja a gépén vagy haladhatja meg a gép fizikai korlátok motor szabályozás biztosítja.</span><span class="sxs-lookup"><span data-stu-id="1f521-237">Engine throttling is provided to ensure that a logical server doesn't use too many resources on a machine or exceed the machine’s physical limits.</span></span>

### <a name="elasticity"></a><span data-ttu-id="1f521-238">Rugalmasság</span><span class="sxs-lookup"><span data-stu-id="1f521-238">Elasticity</span></span>

<span data-ttu-id="1f521-239">Ha az alkalmazás több, mint az 1 TB-os adatbázis korlátozása, azt meg kell valósítania egy kibővített megközelítés.</span><span class="sxs-lookup"><span data-stu-id="1f521-239">If the application requires more than the 1 TB database limit, it must implement a scale-out approach.</span></span> <span data-ttu-id="1f521-240">Horizontális felskálázása az Azure SQL Database particionálásával manuálisan, más néven horizontális skálázás, adatokat több SQL-adatbázisban.</span><span class="sxs-lookup"><span data-stu-id="1f521-240">You scale out with Azure SQL Database by manually partitioning, also known as sharding, data across multiple SQL databases.</span></span> <span data-ttu-id="1f521-241">A horizontális felskálázás megközelítés méretek mellett közel lineáris költség növekedés elérése lehetőséget biztosít.</span><span class="sxs-lookup"><span data-stu-id="1f521-241">This scale-out approach provides the opportunity to achieve nearly linear cost growth with scale.</span></span> <span data-ttu-id="1f521-242">Rugalmas növekedést vagy igény szerinti kapacitás növekményes költségekkel igény szerint növelhető, mert az adatbázis átlagos tényleges mérete alapján használja egy nap, nem a maximális mérete alapján számolunk fel.</span><span class="sxs-lookup"><span data-stu-id="1f521-242">Elastic growth or capacity on demand can grow with incremental costs as needed because databases are billed based on the average actual size used per day, not based on maximum possible size.</span></span>

## <a name="sql-server-on-virtual-machines"></a><span data-ttu-id="1f521-243">SQL Server on Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="1f521-243">SQL Server on Virtual Machines</span></span>

<span data-ttu-id="1f521-244">Telepíti az SQL Server (2014 vagy újabb verzió) az Azure Virtual machines szolgáltatásban, használhatja az SQL Server hagyományos rendelkezésre állási funkcióit is igénybe vehet.</span><span class="sxs-lookup"><span data-stu-id="1f521-244">By installing SQL Server (version 2014 or later) on Azure Virtual Machines, you can take advantage of the traditional availability features of SQL Server.</span></span> <span data-ttu-id="1f521-245">Ezek a funkciók közé tartozik az AlwaysOn rendelkezésre állási csoportok és az adatbázis-tükrözés.</span><span class="sxs-lookup"><span data-stu-id="1f521-245">These features include AlwaysOn Availability Groups and database mirroring.</span></span> <span data-ttu-id="1f521-246">Vegye figyelembe, hogy az Azure virtuális gépek, tárolási és hálózatkezelési egy helyszíni informatikai infrastruktúrával nem virtualizált eltérő működési jellemzői.</span><span class="sxs-lookup"><span data-stu-id="1f521-246">Note that Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="1f521-247">Egy magas rendelkezésre állás/vészhelyreállítás az Azure-ban (HA/DR) az SQL Server-megoldás sikeres megvalósítását megköveteli, hogy ezek a különbségek megértéséhez, és a megoldás kialakításakor megtervezése.</span><span class="sxs-lookup"><span data-stu-id="1f521-247">A successful implementation of a high availability/disaster recovery (HA/DR) SQL Server solution in Azure requires that you understand these differences and design your solution to accommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="1f521-248">Magas rendelkezésre állású csomópontok egy rendelkezésre állási csoportban</span><span class="sxs-lookup"><span data-stu-id="1f521-248">High-availability nodes in an availability set</span></span>

<span data-ttu-id="1f521-249">Egy magas rendelkezésre állású megoldások megvalósításának az Azure-ban, a rendelkezésre állási csoportot az Azure segítségével a magas rendelkezésre állású csomópontok helyezze külön tartalék tartományokban és frissítési tartományokban tárolja.</span><span class="sxs-lookup"><span data-stu-id="1f521-249">When you implement a high-availability solution in Azure, you can use the availability set in Azure to place the high-availability nodes into separate fault domains and upgrade domains.</span></span> <span data-ttu-id="1f521-250">A rendelkezésre állási csoport tisztázzuk egy Azure fogalom.</span><span class="sxs-lookup"><span data-stu-id="1f521-250">To be clear, the availability set is an Azure concept.</span></span> <span data-ttu-id="1f521-251">Fontos, hogy ellenőrizze, hogy az adatbázisok valóban magas rendelkezésre állású, legyen szó az AlwaysOn rendelkezésre állási csoportok, adatbázis-tükrözés vagy valami mást a követendő ajánlott.</span><span class="sxs-lookup"><span data-stu-id="1f521-251">It's a best practice that you should follow to make sure that your databases are indeed highly available, whether you're using AlwaysOn Availability Groups, database mirroring, or something else.</span></span> <span data-ttu-id="1f521-252">Ha nem követi az ajánlott eljárás, valószínűleg hamis feltételezve, hogy a rendszer magas rendelkezésre állású.</span><span class="sxs-lookup"><span data-stu-id="1f521-252">If you don't follow this best practice, you might be under the false assumption that your system is highly available.</span></span> <span data-ttu-id="1f521-253">De a valóságban a végzett, a csomópontok összes sikertelen lehet egyidejűleg mert mobilak ugyanabban a tartalék tartományban található, az Azure-régióban kell elhelyezni.</span><span class="sxs-lookup"><span data-stu-id="1f521-253">But in reality, your nodes can all fail simultaneously because they happen to be placed in the same fault domain in the Azure region.</span></span>

<span data-ttu-id="1f521-254">Ez a javaslat nem is alkalmazható a naplóküldésben.</span><span class="sxs-lookup"><span data-stu-id="1f521-254">This recommendation is not as applicable with log shipping.</span></span> <span data-ttu-id="1f521-255">Egy vész-helyreállítási funkció, győződjön meg, hogy a kiszolgáló fut-e külön Azure-régióban.</span><span class="sxs-lookup"><span data-stu-id="1f521-255">As a disaster recovery feature, you should ensure that the servers are running in separate Azure regions.</span></span> <span data-ttu-id="1f521-256">Definíció szerint ezekben a régiókban a külön tartalék tartományokban.</span><span class="sxs-lookup"><span data-stu-id="1f521-256">By definition, these regions are separate fault domains.</span></span>

<span data-ttu-id="1f521-257">Az Azure Cloud Services üzembe helyezett virtuális gépek a klasszikus portálon keresztül kell ugyanabban a rendelkezésre állási csoportban telepítenie kell őket az ugyanazon felhőszolgáltatásban.</span><span class="sxs-lookup"><span data-stu-id="1f521-257">For Azure Cloud Services VMs deployed through the classic portal to be in the same availability set, you must deploy them in the same Cloud Service.</span></span> <span data-ttu-id="1f521-258">Az Azure Resource Manager (aktuális portálon) üzembe helyezett virtuális gépek nem kell ezt a korlátozást.</span><span class="sxs-lookup"><span data-stu-id="1f521-258">VMs deployed through Azure Resource Manager (the current portal) do not have this limitation.</span></span> <span data-ttu-id="1f521-259">A klasszikus portálon üzembe helyezett virtuális gépek az Azure Cloud Service, ugyanazon a Felhőszolgáltatáson csomópontok csak az azonos rendelkezésre állási csoport vehet részt.</span><span class="sxs-lookup"><span data-stu-id="1f521-259">For classic portal deployed VMs in Azure Cloud Service, only nodes in the same Cloud Service can participate in the same availability set.</span></span> <span data-ttu-id="1f521-260">Emellett a Cloud Services virtuális gépeket annak érdekében, hogy az IP-címek megőriznek felültelepítés után is ugyanabban a virtuális hálózatban kell lennie.</span><span class="sxs-lookup"><span data-stu-id="1f521-260">In addition, the Cloud Services VMs should be in the same virtual network to ensure that they maintain their IPs even after service healing.</span></span> <span data-ttu-id="1f521-261">Ezzel elkerülhető a DNS frissítési megszakadását.</span><span class="sxs-lookup"><span data-stu-id="1f521-261">This avoids DNS update disruptions.</span></span>

### <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="1f521-262">Azure-only: Magas rendelkezésre állású megoldások</span><span class="sxs-lookup"><span data-stu-id="1f521-262">Azure-only: High-availability solutions</span></span>

<span data-ttu-id="1f521-263">AlwaysOn rendelkezésre állási csoportok vagy az adatbázis-tükrözés rendelkezhet egy magas rendelkezésre állású megoldás az SQL Server-adatbázisait az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="1f521-263">You can have a high-availability solution for your SQL Server databases in Azure by using AlwaysOn Availability Groups or database mirroring.</span></span>

<span data-ttu-id="1f521-264">A következő ábra azt mutatja be, az architektúra az Azure virtuális gépeken futó AlwaysOn rendelkezésre állási csoportok.</span><span class="sxs-lookup"><span data-stu-id="1f521-264">The following diagram demonstrates the architecture of AlwaysOn Availability Groups running on Azure Virtual Machines.</span></span> <span data-ttu-id="1f521-265">Ez az ábra a témával kapcsolatos, a részletes cikkben hibaállapota [az Azure virtuális gépeken futó SQL Server magas rendelkezésre állás és vészhelyreállítás helyreállítási](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="1f521-265">This diagram was taken from the in-depth article on this subject, [High availability and disaster recovery for SQL Server on Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

![AlwaysOn rendelkezésre állási csoportok a Microsoft Azure](./images/technical-guidance-recovery-local-failures/high_availability_solutions-1.png)

<span data-ttu-id="1f521-267">Az Azure Portalon az AlwaysOn-sablon használatával automatikusan is telepíthet egy AlwaysOn rendelkezésre állási csoportok üzembe helyezés – teljes körű Azure virtuális gépeken.</span><span class="sxs-lookup"><span data-stu-id="1f521-267">You can also automatically provision an AlwaysOn Availability Groups deployment end-to-end on Azure VMs by using the AlwaysOn template in the Azure portal.</span></span> <span data-ttu-id="1f521-268">További információkért lásd: [SQL Server AlwaysOn ajánlatot a Microsoft Azure Portal Gallery](https://blogs.technet.microsoft.com/dataplatforminsider/2014/08/25/sql-server-alwayson-offering-in-microsoft-azure-portal-gallery/).</span><span class="sxs-lookup"><span data-stu-id="1f521-268">For more information, see [SQL Server AlwaysOn Offering in Microsoft Azure Portal Gallery](https://blogs.technet.microsoft.com/dataplatforminsider/2014/08/25/sql-server-alwayson-offering-in-microsoft-azure-portal-gallery/).</span></span>

<span data-ttu-id="1f521-269">Az alábbi diagram bemutatja, hogy az adatbázis-tükrözés az Azure Virtual machines szolgáltatásban.</span><span class="sxs-lookup"><span data-stu-id="1f521-269">The following diagram demonstrates the use of database mirroring on Azure Virtual Machines.</span></span> <span data-ttu-id="1f521-270">A részletes témakörből is hibaállapota [az Azure virtuális gépeken futó SQL Server magas rendelkezésre állás és vészhelyreállítás helyreállítási](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="1f521-270">It was also taken from the in-depth topic [High availability and disaster recovery for SQL Server on Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

![Adatbázis-tükrözés a Microsoft Azure](./images/technical-guidance-recovery-local-failures/high_availability_solutions-2.png)

> [!NOTE]
> <span data-ttu-id="1f521-272">Mindkét architektúrát tartományvezérlőt igényelnek.</span><span class="sxs-lookup"><span data-stu-id="1f521-272">Both architectures require a domain controller.</span></span> <span data-ttu-id="1f521-273">Azonban az adatbázis-tükrözés, lehetősége tartományvezérlő szükségtelenné teszi a kiszolgálói tanúsítványok használatával.</span><span class="sxs-lookup"><span data-stu-id="1f521-273">However, with database mirroring, it's possible to use server certificates to eliminate the need for a domain controller.</span></span>

## <a name="other-azure-platform-services"></a><span data-ttu-id="1f521-274">Más Azure platformszolgáltatások</span><span class="sxs-lookup"><span data-stu-id="1f521-274">Other Azure platform services</span></span>

<span data-ttu-id="1f521-275">Az Azure-ban készített alkalmazások számára előnyös platform képességei a helyi hibák utáni helyreállításhoz.</span><span class="sxs-lookup"><span data-stu-id="1f521-275">Applications that are built on Azure benefit from platform capabilities to recover from local failures.</span></span> <span data-ttu-id="1f521-276">Bizonyos esetekben az adott forgatókönyv a rendelkezésre állás növelése érdekében bizonyos műveleteket hajthatja végre.</span><span class="sxs-lookup"><span data-stu-id="1f521-276">In some cases, you can take specific actions to increase availability for your specific scenario.</span></span>

### <a name="service-bus"></a><span data-ttu-id="1f521-277">Service Bus</span><span class="sxs-lookup"><span data-stu-id="1f521-277">Service Bus</span></span>

<span data-ttu-id="1f521-278">Az Azure Service Bus egy átmeneti szolgáltatáskimaradás veszélye, fontolja meg egy ügyféloldali tartós üzenetsor létrehozása.</span><span class="sxs-lookup"><span data-stu-id="1f521-278">To mitigate against a temporary outage of Azure Service Bus, consider creating a durable client-side queue.</span></span> <span data-ttu-id="1f521-279">Ez ideiglenesen használja egy másik, a helyi tárolási mechanizmus, amely nem adható hozzá a Service Bus-üzenetsorba üzenetek tárolásához.</span><span class="sxs-lookup"><span data-stu-id="1f521-279">This temporarily uses an alternate, local storage mechanism to store messages that cannot be added to the Service Bus queue.</span></span> <span data-ttu-id="1f521-280">Az alkalmazás eldöntheti, hogyan legyen kezelve az ideiglenesen tárolt üzenetek, a szolgáltatás visszaállítása után.</span><span class="sxs-lookup"><span data-stu-id="1f521-280">The application can decide how to handle the temporarily stored messages after the service is restored.</span></span> <span data-ttu-id="1f521-281">További információkért lásd: [ajánlott eljárások a teljesítmény használatával a Service Bus közvetítőalapú üzenettovábbítás](/azure/service-bus-messaging/service-bus-performance-improvements/) és [a Service Bus (katasztrófa utáni helyreállítás)](recovery-loss-azure-region.md#other-azure-platform-services).</span><span class="sxs-lookup"><span data-stu-id="1f521-281">For more information, see [Best practices for performance improvements using Service Bus brokered messaging](/azure/service-bus-messaging/service-bus-performance-improvements/) and [Service Bus (disaster recovery)](recovery-loss-azure-region.md#other-azure-platform-services).</span></span>

### <a name="hdinsight"></a><span data-ttu-id="1f521-282">HDInsight</span><span class="sxs-lookup"><span data-stu-id="1f521-282">HDInsight</span></span>

<span data-ttu-id="1f521-283">Az Azure Blob storage-ban alapértelmezés szerint az Azure HDInsight társított adatokat tárolja.</span><span class="sxs-lookup"><span data-stu-id="1f521-283">The data that's associated with Azure HDInsight is stored by default in Azure Blob storage.</span></span> <span data-ttu-id="1f521-284">Az Azure Storage a Blob storage magas rendelkezésre állást és tartósságot tulajdonságát meghatározza.</span><span class="sxs-lookup"><span data-stu-id="1f521-284">Azure Storage specifies high-availability and durability properties for Blob storage.</span></span> <span data-ttu-id="1f521-285">A több csomópontos feldolgozás Hadoop MapReduce-feladatok társított akkor fordul elő, az egy átmeneti Hadoop elosztott fájlrendszer (HDFS), amely ki van építve, amikor HDInsight kell azt.</span><span class="sxs-lookup"><span data-stu-id="1f521-285">The multiple-node processing that's associated with Hadoop MapReduce jobs occurs on a transient Hadoop Distributed File System (HDFS) that is provisioned when HDInsight needs it.</span></span> <span data-ttu-id="1f521-286">Egy MapReduce-feladatot az eredmények is tárolása az Azure Blob storage, alapértelmezés szerint, hogy a feldolgozott adatok tartósságát és magas rendelkezésre állású marad, a Hadoop-fürt az eltávolítása után.</span><span class="sxs-lookup"><span data-stu-id="1f521-286">Results from a MapReduce job are also stored by default in Azure Blob storage, so that the processed data is durable and remains highly available after the Hadoop cluster is deprovisioned.</span></span> <span data-ttu-id="1f521-287">További információkért lásd: [HDInsight (katasztrófa utáni helyreállítás)](recovery-loss-azure-region.md#other-azure-platform-services).</span><span class="sxs-lookup"><span data-stu-id="1f521-287">For more information, see [HDInsight (disaster recovery)](recovery-loss-azure-region.md#other-azure-platform-services).</span></span>

## <a name="checklists-for-local-failures"></a><span data-ttu-id="1f521-288">Helyi hibák Ellenőrzőlisták</span><span class="sxs-lookup"><span data-stu-id="1f521-288">Checklists for local failures</span></span>

### <a name="cloud-services-checklist"></a><span data-ttu-id="1f521-289">Cloud Services ellenőrzőlista</span><span class="sxs-lookup"><span data-stu-id="1f521-289">Cloud Services checklist</span></span>

1. <span data-ttu-id="1f521-290">Tekintse át a Cloud Services szakasz ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-290">Review the Cloud Services section of this document.</span></span>
2. <span data-ttu-id="1f521-291">Állítsa be legalább két példányt az egyes szerepkörökhöz.</span><span class="sxs-lookup"><span data-stu-id="1f521-291">Configure at least two instances for each role.</span></span>
3. <span data-ttu-id="1f521-292">Továbbra is fennáll a tartós tárolási, nem a szerepkörpéldányok állapotát.</span><span class="sxs-lookup"><span data-stu-id="1f521-292">Persist state in durable storage, not on role instances.</span></span>
4. <span data-ttu-id="1f521-293">Helyesen kezeli a StatusCheck eseményét.</span><span class="sxs-lookup"><span data-stu-id="1f521-293">Correctly handle the StatusCheck event.</span></span>
5. <span data-ttu-id="1f521-294">Összefüggő változások zabalit do tranzakciók, amikor csak lehetséges.</span><span class="sxs-lookup"><span data-stu-id="1f521-294">Wrap related changes in transactions when possible.</span></span>
6. <span data-ttu-id="1f521-295">Győződjön meg arról, hogy a feldolgozói szerepkör feladatok idempotensek és újraindítható.</span><span class="sxs-lookup"><span data-stu-id="1f521-295">Verify that worker role tasks are idempotent and restartable.</span></span>
7. <span data-ttu-id="1f521-296">Továbbra is, hogy műveleteket hívjon meg, amíg nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="1f521-296">Continue to invoke operations until they succeed.</span></span>
8. <span data-ttu-id="1f521-297">Fontolja meg az automatikus skálázási stratégiákra.</span><span class="sxs-lookup"><span data-stu-id="1f521-297">Consider autoscaling strategies.</span></span>

### <a name="virtual-machines-checklist"></a><span data-ttu-id="1f521-298">Virtuális gépek ellenőrzőlista</span><span class="sxs-lookup"><span data-stu-id="1f521-298">Virtual Machines checklist</span></span>

1. <span data-ttu-id="1f521-299">Tekintse át a virtuális gépekre vonatkozó szakaszban ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-299">Review the Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="1f521-300">Ne használja a D meghajtó hosszú távú adattárolásra.</span><span class="sxs-lookup"><span data-stu-id="1f521-300">Do not use drive D for persistent storage.</span></span>
3. <span data-ttu-id="1f521-301">A gépeket egy rendelkezésre állási csoportba egy szolgáltatási rétegben található.</span><span class="sxs-lookup"><span data-stu-id="1f521-301">Group machines in a service tier into an availability set.</span></span>
4. <span data-ttu-id="1f521-302">Terheléselosztás és a választható mintavétel konfigurálása.</span><span class="sxs-lookup"><span data-stu-id="1f521-302">Configure load balancing and optional probes.</span></span>

### <a name="storage-checklist"></a><span data-ttu-id="1f521-303">Tárolási ellenőrzőlista</span><span class="sxs-lookup"><span data-stu-id="1f521-303">Storage checklist</span></span>

1. <span data-ttu-id="1f521-304">Tekintse át a Storage szakasz ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-304">Review the Storage section of this document.</span></span>
2. <span data-ttu-id="1f521-305">Több tárfiók használata, ha adatokat vagy a sávszélesség túllépi kvótákat.</span><span class="sxs-lookup"><span data-stu-id="1f521-305">Use multiple storage accounts when data or bandwidth exceeds quotas.</span></span>

### <a name="sql-database-checklist"></a><span data-ttu-id="1f521-306">Az SQL Database ellenőrzőlista</span><span class="sxs-lookup"><span data-stu-id="1f521-306">SQL Database checklist</span></span>

1. <span data-ttu-id="1f521-307">Tekintse át az SQL Database szakasz ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-307">Review the SQL Database section of this document.</span></span>
2. <span data-ttu-id="1f521-308">Átmeneti hibák kezeléséhez újrapróbálkozási szabályzat megvalósítása.</span><span class="sxs-lookup"><span data-stu-id="1f521-308">Implement a retry policy to handle transient errors.</span></span>
3. <span data-ttu-id="1f521-309">Particionálási és horizontális particionálás egy horizontális felskálázási stratégiát használja.</span><span class="sxs-lookup"><span data-stu-id="1f521-309">Use partitioning/sharding as a scale-out strategy.</span></span>

### <a name="sql-server-on-virtual-machines-checklist"></a><span data-ttu-id="1f521-310">Az SQL Server virtuális gépek ellenőrzőlista használata</span><span class="sxs-lookup"><span data-stu-id="1f521-310">SQL Server on Virtual Machines checklist</span></span>

1. <span data-ttu-id="1f521-311">Tekintse át az SQL Server, a virtuális gépekre vonatkozó szakaszban ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-311">Review the SQL Server on Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="1f521-312">Kövesse a fenti javaslatok a virtuális gépekhez.</span><span class="sxs-lookup"><span data-stu-id="1f521-312">Follow the previous recommendations for Virtual Machines.</span></span>
3. <span data-ttu-id="1f521-313">Az SQL Server magas rendelkezésre állású szolgáltatások, például AlwaysOn használata.</span><span class="sxs-lookup"><span data-stu-id="1f521-313">Use SQL Server high availability features, such as AlwaysOn.</span></span>

### <a name="service-bus-checklist"></a><span data-ttu-id="1f521-314">A Service Bus ellenőrzőlista</span><span class="sxs-lookup"><span data-stu-id="1f521-314">Service Bus checklist</span></span>

1. <span data-ttu-id="1f521-315">Tekintse át a Service Bus szakasz ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-315">Review the Service Bus section of this document.</span></span>
2. <span data-ttu-id="1f521-316">Érdemes létrehozni egy ügyféloldali üzenetsorban biztonsági mentéséhez.</span><span class="sxs-lookup"><span data-stu-id="1f521-316">Consider creating a durable client-side queue as a backup.</span></span>

### <a name="hdinsight-checklist"></a><span data-ttu-id="1f521-317">HDInsight-feladatlista</span><span class="sxs-lookup"><span data-stu-id="1f521-317">HDInsight checklist</span></span>

1. <span data-ttu-id="1f521-318">Tekintse át a HDInsight szakasz ebben a dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="1f521-318">Review the HDInsight section of this document.</span></span>
2. <span data-ttu-id="1f521-319">További rendelkezésre állási lépés nem szükségesek helyi hibák esetén.</span><span class="sxs-lookup"><span data-stu-id="1f521-319">No additional availability steps are required for local failures.</span></span>

<!-- markdownlint-enable MD024 -->
