---
title: A hibaállapot elemzése
description: Útmutató az Azure-alapú megoldások mód elemzés végrehajtásához.
author: MikeWasson
ms.date: 03/24/2017
ms.custom: resiliency
pnp.series.title: Design for Resiliency
ms.openlocfilehash: 8786c411249267e502003a90d5f2ff5e4c786803
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/06/2018
---
# <a name="failure-mode-analysis"></a><span data-ttu-id="f20f6-103">A hibaállapot elemzése</span><span class="sxs-lookup"><span data-stu-id="f20f6-103">Failure mode analysis</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="f20f6-104">Hibaelemzés mód (FMA) az a folyamat rugalmassági készítéséhez rendszerben, a rendszer lehetséges hiba pontok azonosításával.</span><span class="sxs-lookup"><span data-stu-id="f20f6-104">Failure mode analysis (FMA) is a process for building resiliency into a system, by identifying possible failure points in the system.</span></span> <span data-ttu-id="f20f6-105">A FMA felépítéséről és kialakításáról fázisok részének kell lennie, úgy, hogy a rendszer az elejéről történő hibaelhárítás hozhat létre.</span><span class="sxs-lookup"><span data-stu-id="f20f6-105">The FMA should be part of the architecture and design phases, so that you can build failure recovery into the system from the beginning.</span></span>

<span data-ttu-id="f20f6-106">Íme egy FMA elvégzésére általános folyamata:</span><span class="sxs-lookup"><span data-stu-id="f20f6-106">Here is the general process to conduct an FMA:</span></span>

1. <span data-ttu-id="f20f6-107">Azonosítsa az összes összetevőt a rendszerben.</span><span class="sxs-lookup"><span data-stu-id="f20f6-107">Identify all of the components in the system.</span></span> <span data-ttu-id="f20f6-108">Foglaljon magába függ külső tényezőktől, például az identitás-szolgáltatóktól, harmadik féltől származó szolgáltatással, stb.</span><span class="sxs-lookup"><span data-stu-id="f20f6-108">Include external dependencies, such as as identity providers, third-party services, and so on.</span></span>   
2. <span data-ttu-id="f20f6-109">Az egyes összetevők esetleg előforduló lehetséges hibák azonosítására.</span><span class="sxs-lookup"><span data-stu-id="f20f6-109">For each component, identify potential failures that could occur.</span></span> <span data-ttu-id="f20f6-110">Előfordulhat, hogy az adott összetevőt egynél több hibaállapotba.</span><span class="sxs-lookup"><span data-stu-id="f20f6-110">A single component may have more than one failure mode.</span></span> <span data-ttu-id="f20f6-111">Például kell figyelembe venni az olvasási hibák, és hibák külön-külön kiírni, mert a hatás és a lehetséges megoldást eltérőek lesznek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-111">For example, you should consider read failures and write failures separately, because the impact and possible mitigations will be different.</span></span>
3. <span data-ttu-id="f20f6-112">Az általános kockázati megfelelően minden hibaállapotba aránya.</span><span class="sxs-lookup"><span data-stu-id="f20f6-112">Rate each failure mode according to its overall risk.</span></span> <span data-ttu-id="f20f6-113">Vegye figyelembe a következőket:</span><span class="sxs-lookup"><span data-stu-id="f20f6-113">Consider these factors:</span></span>  

   * <span data-ttu-id="f20f6-114">Mi az a hibák valószínűségét.</span><span class="sxs-lookup"><span data-stu-id="f20f6-114">What is the likelihood of the failure.</span></span> <span data-ttu-id="f20f6-115">Az viszonylag közös?</span><span class="sxs-lookup"><span data-stu-id="f20f6-115">Is it relatively common?</span></span> <span data-ttu-id="f20f6-116">Ritka Extrememly?</span><span class="sxs-lookup"><span data-stu-id="f20f6-116">Extrememly rare?</span></span> <span data-ttu-id="f20f6-117">Nem kell pontos számok; a célja a prioritás rangsorolja segítségével.</span><span class="sxs-lookup"><span data-stu-id="f20f6-117">You don't need exact numbers; the purpose is to help rank the priority.</span></span>
   * <span data-ttu-id="f20f6-118">Mi az az alkalmazás rendelkezésre állásának, adatvesztés, a költség és üzleti megszűnésének gyakorolt hatás?</span><span class="sxs-lookup"><span data-stu-id="f20f6-118">What is the impact on the application, in terms of availability, data loss, monetary cost, and business disruption?</span></span>
4. <span data-ttu-id="f20f6-119">Minden egyes hibaállapotba határozza meg a hogyan az alkalmazás válaszol, és helyreállítani.</span><span class="sxs-lookup"><span data-stu-id="f20f6-119">For each failure mode, determine how the application will respond and recover.</span></span> <span data-ttu-id="f20f6-120">Figyelembe kell venni mellékhatásokkal költség- és alkalmazás összetettségét.</span><span class="sxs-lookup"><span data-stu-id="f20f6-120">Consider tradeoffs in cost and application complexity.</span></span>   

<span data-ttu-id="f20f6-121">A FMA folyamat kezdőpontját Ez a cikk lehetséges függően katalógust és az azok mérséklési tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-121">As a starting point for your FMA process, this article contains a catalog of potential failure modes and their mitigations.</span></span> <span data-ttu-id="f20f6-122">A katalógus technológia vagy Azure-szolgáltatás, valamint egy általános alkalmazás szintű tervezési kategória szerint van rendezve.</span><span class="sxs-lookup"><span data-stu-id="f20f6-122">The catalog is organized by technology or Azure service, plus a general category for application-level design.</span></span> <span data-ttu-id="f20f6-123">A katalógus nem teljes, de hozzá van rendelve az alapszintű Azure számos szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="f20f6-123">The catalog is not exhaustive, but covers many of the core Azure services.</span></span>

## <a name="app-service"></a><span data-ttu-id="f20f6-124">App Service</span><span class="sxs-lookup"><span data-stu-id="f20f6-124">App Service</span></span>
### <a name="app-service-app-shuts-down"></a><span data-ttu-id="f20f6-125">App Service alkalmazás leáll.</span><span class="sxs-lookup"><span data-stu-id="f20f6-125">App Service app shuts down.</span></span>
<span data-ttu-id="f20f6-126">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-126">**Detection**.</span></span> <span data-ttu-id="f20f6-127">Lehetséges okok:</span><span class="sxs-lookup"><span data-stu-id="f20f6-127">Possible causes:</span></span>

* <span data-ttu-id="f20f6-128">Várt leállás</span><span class="sxs-lookup"><span data-stu-id="f20f6-128">Expected shutdown</span></span>

  * <span data-ttu-id="f20f6-129">Az alkalmazás leállása operátor például az Azure portál használatával.</span><span class="sxs-lookup"><span data-stu-id="f20f6-129">An operator shuts down the application; for example, using the Azure portal.</span></span>
  * <span data-ttu-id="f20f6-130">Az alkalmazás lett távolítva a memóriából, mert üresjáratban van.</span><span class="sxs-lookup"><span data-stu-id="f20f6-130">The app was unloaded because it was idle.</span></span> <span data-ttu-id="f20f6-131">(Csak akkor, ha a `Always On` beállítás le van tiltva.)</span><span class="sxs-lookup"><span data-stu-id="f20f6-131">(Only if the `Always On` setting is disabled.)</span></span>
* <span data-ttu-id="f20f6-132">Nem tervezett leállás</span><span class="sxs-lookup"><span data-stu-id="f20f6-132">Unexpected shutdown</span></span>

  * <span data-ttu-id="f20f6-133">Az alkalmazás összeomlik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-133">The app crashes.</span></span>
  * <span data-ttu-id="f20f6-134">Az App Service Virtuálisgép-példány nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="f20f6-134">An App Service VM instance becomes unavailable.</span></span>

<span data-ttu-id="f20f6-135">Application_End naplózási fog dolgozza fel az alkalmazás tartomány leállítási (soft folyamat összeomlási), és csak úgy dolgozza fel az alkalmazás tartomány kiváltott leállítás elkerüléséhez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-135">Application_End logging will catch the app domain shutdown (soft process crash) and is the only way to catch the application domain shutdowns.</span></span>

<span data-ttu-id="f20f6-136">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-136">**Recovery**</span></span>

* <span data-ttu-id="f20f6-137">Ha a leállítási várta, használja az alkalmazás leállítás esemény leállítása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-137">If the shutdown was expected, use the application's shutdown event to shut down gracefully.</span></span> <span data-ttu-id="f20f6-138">Például az ASP.NET, használja a `Application_End` metódust.</span><span class="sxs-lookup"><span data-stu-id="f20f6-138">For example, in ASP.NET, use the `Application_End` method.</span></span>
* <span data-ttu-id="f20f6-139">Ha az alkalmazás memóriából közben üresjárati, automatikusan újraindul a következő kérelemnél.</span><span class="sxs-lookup"><span data-stu-id="f20f6-139">If the application was unloaded while idle, it is automatically restarted on the next request.</span></span> <span data-ttu-id="f20f6-140">Azonban a "hidegindítás" költség gyakorisága.</span><span class="sxs-lookup"><span data-stu-id="f20f6-140">However, you will incur the "cold start" cost.</span></span>
* <span data-ttu-id="f20f6-141">Az alkalmazás közben üresjárati eltávolítása folyamatban érdekében engedélyezze a `Always On` a webalkalmazás-ban történő beállítását.</span><span class="sxs-lookup"><span data-stu-id="f20f6-141">To prevent the application from being unloaded while idle, enable the `Always On` setting in the web app.</span></span> <span data-ttu-id="f20f6-142">Lásd: [webes alkalmazások konfigurálása az Azure App Service][app-service-configure].</span><span class="sxs-lookup"><span data-stu-id="f20f6-142">See [Configure web apps in Azure App Service][app-service-configure].</span></span>
* <span data-ttu-id="f20f6-143">Az alkalmazás leállítása érdekében operátor beállítása egy erőforrás zárolást a következő `ReadOnly` szintjét.</span><span class="sxs-lookup"><span data-stu-id="f20f6-143">To prevent an operator from shutting down the app, set a resource lock with `ReadOnly` level.</span></span> <span data-ttu-id="f20f6-144">Lásd: [erőforrások az Azure Resource Manager zárolása][rm-locks].</span><span class="sxs-lookup"><span data-stu-id="f20f6-144">See [Lock resources with Azure Resource Manager][rm-locks].</span></span>
* <span data-ttu-id="f20f6-145">Ha az alkalmazás összeomlik vagy az App Service virtuális gép nem érhető el, az App Service automatikusan újraindul az alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="f20f6-145">If the app crashes or an App Service VM becomes unavailable, App Service automatically restarts the app.</span></span>

<span data-ttu-id="f20f6-146">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-146">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-147">Alkalmazás naplók és a webkiszolgáló naplóinak.</span><span class="sxs-lookup"><span data-stu-id="f20f6-147">Application logs and web server logs.</span></span> <span data-ttu-id="f20f6-148">Lásd: [az Azure App Service web Apps diagnosztikai naplózás engedélyezése][app-service-logging].</span><span class="sxs-lookup"><span data-stu-id="f20f6-148">See [Enable diagnostics logging for web apps in Azure App Service][app-service-logging].</span></span>

### <a name="a-particular-user-repeatedly-makes-bad-requests-or-overloads-the-system"></a><span data-ttu-id="f20f6-149">Egy adott felhasználó ismételten hibás kérésekből indít telefonhívásokat, és a rendszer túlterhelések.</span><span class="sxs-lookup"><span data-stu-id="f20f6-149">A particular user repeatedly makes bad requests or overloads the system.</span></span>
<span data-ttu-id="f20f6-150">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-150">**Detection**.</span></span> <span data-ttu-id="f20f6-151">Hitelesíti a felhasználókat, és tartalmazza a felhasználói Azonosítót alkalmazásnaplók.</span><span class="sxs-lookup"><span data-stu-id="f20f6-151">Authenticate users and include user ID in application logs.</span></span>

<span data-ttu-id="f20f6-152">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-152">**Recovery**</span></span>

* <span data-ttu-id="f20f6-153">Használjon [Azure API Management] [ api-management] adatátviteli kérésekre a felhasználótól.</span><span class="sxs-lookup"><span data-stu-id="f20f6-153">Use [Azure API Management][api-management] to throttle requests from the user.</span></span> <span data-ttu-id="f20f6-154">Lásd: [speciális kérelmet az Azure API Management-szabályozás][api-management-throttling]</span><span class="sxs-lookup"><span data-stu-id="f20f6-154">See [Advanced request throttling with Azure API Management][api-management-throttling]</span></span>
* <span data-ttu-id="f20f6-155">A felhasználó letiltásához.</span><span class="sxs-lookup"><span data-stu-id="f20f6-155">Block the user.</span></span>

<span data-ttu-id="f20f6-156">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-156">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-157">A naplófájl minden hitelesítési kérelemre.</span><span class="sxs-lookup"><span data-stu-id="f20f6-157">Log all authentication requests.</span></span>

### <a name="a-bad-update-was-deployed"></a><span data-ttu-id="f20f6-158">A hibás frissítés telepítése megtörtént.</span><span class="sxs-lookup"><span data-stu-id="f20f6-158">A bad update was deployed.</span></span>
<span data-ttu-id="f20f6-159">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-159">**Detection**.</span></span> <span data-ttu-id="f20f6-160">Figyelheti az alkalmazás állapotát az Azure portálon keresztül (lásd: [figyelő Azure web app teljesítmény][app-insights-web-apps]) vagy valósítja meg a [mintát figyelési állapotfigyelő végpont] [health-endpoint-monitoring-pattern].</span><span class="sxs-lookup"><span data-stu-id="f20f6-160">Monitor the application health through the Azure Portal (see [Monitor Azure web app performance][app-insights-web-apps]) or implement the [health endpoint monitoring pattern][health-endpoint-monitoring-pattern].</span></span>

<span data-ttu-id="f20f6-161">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-161">**Recovery**.</span></span> <span data-ttu-id="f20f6-162">Használjon több [üzembe helyezési] [ app-service-slots] és állítsa vissza a legutóbbi helyes központi telepítéshez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-162">Use multiple [deployment slots][app-service-slots] and roll back to the last-known-good deployment.</span></span> <span data-ttu-id="f20f6-163">További információkért lásd: [alapvető webalkalmazás][ra-web-apps-basic].</span><span class="sxs-lookup"><span data-stu-id="f20f6-163">For more information, see [Basic web application][ra-web-apps-basic].</span></span>

## <a name="azure-active-directory"></a><span data-ttu-id="f20f6-164">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="f20f6-164">Azure Active Directory</span></span>
### <a name="openid-connect-oidc-authentication-fails"></a><span data-ttu-id="f20f6-165">OpenID Connect (OIDC) hitelesítés nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="f20f6-165">OpenID Connect (OIDC) authentication fails.</span></span>
<span data-ttu-id="f20f6-166">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-166">**Detection**.</span></span> <span data-ttu-id="f20f6-167">Lehetséges probléma módok a következők:</span><span class="sxs-lookup"><span data-stu-id="f20f6-167">Possible failure modes include:</span></span>

1. <span data-ttu-id="f20f6-168">Az Azure AD nem érhető el, vagy a hálózati hiba miatt nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="f20f6-168">Azure AD is not available, or cannot be reached due to a network problem.</span></span> <span data-ttu-id="f20f6-169">A hitelesítési végpont a következő URL nem sikerül, és a OIDC köztes kivételt.</span><span class="sxs-lookup"><span data-stu-id="f20f6-169">Redirection to the authentication endpoint fails, and the OIDC middleware throws an exception.</span></span>
2. <span data-ttu-id="f20f6-170">Az Azure AD-bérlő nem létezik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-170">Azure AD tenant does not exist.</span></span> <span data-ttu-id="f20f6-171">A hitelesítési végpont a következő URL HTTP-hibakódot ad vissza, és a OIDC köztes kivételt jelez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-171">Redirection to the authentication endpoint returns an HTTP error code, and the OIDC middleware throws an exception.</span></span>
3. <span data-ttu-id="f20f6-172">Felhasználói nem tudják hitelesíteni magukat.</span><span class="sxs-lookup"><span data-stu-id="f20f6-172">User cannot authenticate.</span></span> <span data-ttu-id="f20f6-173">Nincs észlelő stratégia szükség; Az Azure AD bejelentkezési hibák kezeli.</span><span class="sxs-lookup"><span data-stu-id="f20f6-173">No detection strategy is necessary; Azure AD handles login failures.</span></span>

<span data-ttu-id="f20f6-174">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-174">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-175">A köztes a nem kezelt kivételeket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-175">Catch unhandled exceptions from the middleware.</span></span>
2. <span data-ttu-id="f20f6-176">Kezelni `AuthenticationFailed` események.</span><span class="sxs-lookup"><span data-stu-id="f20f6-176">Handle `AuthenticationFailed` events.</span></span>
3. <span data-ttu-id="f20f6-177">Egy hibalap átirányítja a felhasználót.</span><span class="sxs-lookup"><span data-stu-id="f20f6-177">Redirect the user to an error page.</span></span>
4. <span data-ttu-id="f20f6-178">Felhasználói újrapróbálkozások.</span><span class="sxs-lookup"><span data-stu-id="f20f6-178">User retries.</span></span>

## <a name="azure-search"></a><span data-ttu-id="f20f6-179">Azure Search</span><span class="sxs-lookup"><span data-stu-id="f20f6-179">Azure Search</span></span>
### <a name="writing-data-to-azure-search-fails"></a><span data-ttu-id="f20f6-180">Írás az Azure Search nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="f20f6-180">Writing data to Azure Search fails.</span></span>
<span data-ttu-id="f20f6-181">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-181">**Detection**.</span></span> <span data-ttu-id="f20f6-182">A tényleges `Microsoft.Rest.Azure.CloudException` hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-182">Catch `Microsoft.Rest.Azure.CloudException` errors.</span></span>

<span data-ttu-id="f20f6-183">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-183">**Recovery**</span></span>

<span data-ttu-id="f20f6-184">A [Search .NET SDK] [ search-sdk] átmeneti hiba után automatikusan újrapróbálkozik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-184">The [Search .NET SDK][search-sdk] automatically retries after transient failures.</span></span> <span data-ttu-id="f20f6-185">Az ügyfél SDK által okozott kivételek nem átmeneti hibák kell kezelni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-185">Any exceptions thrown by the client SDK should be treated as non-transient errors.</span></span>

<span data-ttu-id="f20f6-186">Az alapértelmezett újrapróbálkozási házirendet használja exponenciális vissza ki.</span><span class="sxs-lookup"><span data-stu-id="f20f6-186">The default retry policy uses exponential back-off.</span></span> <span data-ttu-id="f20f6-187">Használjon másik újrapróbálkozási házirendje, hívja meg a `SetRetryPolicy` a a `SearchIndexClient` vagy `SearchServiceClient` osztály.</span><span class="sxs-lookup"><span data-stu-id="f20f6-187">To use a different retry policy, call `SetRetryPolicy` on the `SearchIndexClient` or `SearchServiceClient` class.</span></span> <span data-ttu-id="f20f6-188">További információkért lásd: [automatikus újrapróbálkozások][auto-rest-client-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-188">For more information, see [Automatic Retries][auto-rest-client-retry].</span></span>

<span data-ttu-id="f20f6-189">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-189">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-190">Használjon [keresési forgalom Analytics][search-analytics].</span><span class="sxs-lookup"><span data-stu-id="f20f6-190">Use [Search Traffic Analytics][search-analytics].</span></span>

### <a name="reading-data-from-azure-search-fails"></a><span data-ttu-id="f20f6-191">Azure Search adatok beolvasása sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-191">Reading data from Azure Search fails.</span></span>
<span data-ttu-id="f20f6-192">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-192">**Detection**.</span></span> <span data-ttu-id="f20f6-193">A tényleges `Microsoft.Rest.Azure.CloudException` hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-193">Catch `Microsoft.Rest.Azure.CloudException` errors.</span></span>

<span data-ttu-id="f20f6-194">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-194">**Recovery**</span></span>

<span data-ttu-id="f20f6-195">A [Search .NET SDK] [ search-sdk] átmeneti hiba után automatikusan újrapróbálkozik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-195">The [Search .NET SDK][search-sdk]  automatically retries after transient failures.</span></span> <span data-ttu-id="f20f6-196">Az ügyfél SDK által okozott kivételek nem átmeneti hibák kell kezelni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-196">Any exceptions thrown by the client SDK should be treated as non-transient errors.</span></span>

<span data-ttu-id="f20f6-197">Az alapértelmezett újrapróbálkozási házirendet használja exponenciális vissza ki.</span><span class="sxs-lookup"><span data-stu-id="f20f6-197">The default retry policy uses exponential back-off.</span></span> <span data-ttu-id="f20f6-198">Használjon másik újrapróbálkozási házirendje, hívja meg a `SetRetryPolicy` a a `SearchIndexClient` vagy `SearchServiceClient` osztály.</span><span class="sxs-lookup"><span data-stu-id="f20f6-198">To use a different retry policy, call `SetRetryPolicy` on the `SearchIndexClient` or `SearchServiceClient` class.</span></span> <span data-ttu-id="f20f6-199">További információkért lásd: [automatikus újrapróbálkozások][auto-rest-client-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-199">For more information, see [Automatic Retries][auto-rest-client-retry].</span></span>

<span data-ttu-id="f20f6-200">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-200">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-201">Használjon [keresési forgalom Analytics][search-analytics].</span><span class="sxs-lookup"><span data-stu-id="f20f6-201">Use [Search Traffic Analytics][search-analytics].</span></span>

## <a name="cassandra"></a><span data-ttu-id="f20f6-202">Cassandra</span><span class="sxs-lookup"><span data-stu-id="f20f6-202">Cassandra</span></span>
### <a name="reading-or-writing-to-a-node-fails"></a><span data-ttu-id="f20f6-203">A csomópont írása vagy olvasása sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-203">Reading or writing to a node fails.</span></span>
<span data-ttu-id="f20f6-204">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-204">**Detection**.</span></span> <span data-ttu-id="f20f6-205">A findlogin.</span><span class="sxs-lookup"><span data-stu-id="f20f6-205">Catch the exception.</span></span> <span data-ttu-id="f20f6-206">A .NET-ügyfelek esetében ez lesz `System.Web.HttpException`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-206">For .NET clients, this will typically be `System.Web.HttpException`.</span></span> <span data-ttu-id="f20f6-207">Előfordulhat, hogy más ügyfél más kivétel típusa.</span><span class="sxs-lookup"><span data-stu-id="f20f6-207">Other client may have other exception types.</span></span>  <span data-ttu-id="f20f6-208">További információkért lásd: [megfelelők legyenek Cassandra hibakezelés](http://www.datastax.com/dev/blog/cassandra-error-handling-done-right).</span><span class="sxs-lookup"><span data-stu-id="f20f6-208">For more information, see [Cassandra error handling done right](http://www.datastax.com/dev/blog/cassandra-error-handling-done-right).</span></span>

<span data-ttu-id="f20f6-209">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-209">**Recovery**</span></span>

* <span data-ttu-id="f20f6-210">Minden egyes [Cassandra ügyfél](https://wiki.apache.org/cassandra/ClientOptions) saját újrapróbálkozási házirendek és képességeit.</span><span class="sxs-lookup"><span data-stu-id="f20f6-210">Each [Cassandra client](https://wiki.apache.org/cassandra/ClientOptions) has its own retry policies and capabilities.</span></span> <span data-ttu-id="f20f6-211">További információkért lásd: [megfelelők legyenek Cassandra hibakezelés][cassandra-error-handling].</span><span class="sxs-lookup"><span data-stu-id="f20f6-211">For more information, see [Cassandra error handling done right][cassandra-error-handling].</span></span>
* <span data-ttu-id="f20f6-212">Állvány-kompatibilis központi telepítés, a tartalék tartományok pontjain adatok csomópontokkal használata.</span><span class="sxs-lookup"><span data-stu-id="f20f6-212">Use a rack-aware deployment, with data nodes distributed across the fault domains.</span></span>
* <span data-ttu-id="f20f6-213">Telepíthet több régióba helyi kvórum konzisztencia.</span><span class="sxs-lookup"><span data-stu-id="f20f6-213">Deploy to multiple regions with local quorum consistency.</span></span> <span data-ttu-id="f20f6-214">Nem átmeneti hiba lép fel, ha átadja egy másik régióban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-214">If a non-transient failure occurs, fail over to another region.</span></span>

<span data-ttu-id="f20f6-215">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-215">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-216">Alkalmazásnaplók</span><span class="sxs-lookup"><span data-stu-id="f20f6-216">Application logs</span></span>

## <a name="cloud-service"></a><span data-ttu-id="f20f6-217">Felhőszolgáltatás</span><span class="sxs-lookup"><span data-stu-id="f20f6-217">Cloud Service</span></span>
### <a name="web-or-worker-roles-are-unexpectedlybeing-shut-down"></a><span data-ttu-id="f20f6-218">Webes vagy feldolgozói szerepköröket vannak váratlanul leáll.</span><span class="sxs-lookup"><span data-stu-id="f20f6-218">Web or worker roles are unexpectedly being shut down.</span></span>
<span data-ttu-id="f20f6-219">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-219">**Detection**.</span></span> <span data-ttu-id="f20f6-220">A [RoleEnvironment.Stopping] [ RoleEnvironment.Stopping] az esemény.</span><span class="sxs-lookup"><span data-stu-id="f20f6-220">The [RoleEnvironment.Stopping][RoleEnvironment.Stopping] event is fired.</span></span>

<span data-ttu-id="f20f6-221"><strong>Helyreállítási</strong>.</span><span class="sxs-lookup"><span data-stu-id="f20f6-221"><strong>Recovery</strong>.</span></span> <span data-ttu-id="f20f6-222">Bírálja felül a [RoleEntryPoint.OnStop] [ RoleEntryPoint.OnStop] szabályosan karbantartása metódust.</span><span class="sxs-lookup"><span data-stu-id="f20f6-222">Override the [RoleEntryPoint.OnStop][RoleEntryPoint.OnStop] method to gracefully clean up.</span></span> <span data-ttu-id="f20f6-223">További információkért lásd: [Azure OnStop események kezelésére úgy a jobb oldali] [ onstop-events] (blogbejegyzés).</span><span class="sxs-lookup"><span data-stu-id="f20f6-223">For more information, see [The Right Way to Handle Azure OnStop Events][onstop-events] (blog).</span></span>

## <a name="cosmos-db"></a><span data-ttu-id="f20f6-224">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="f20f6-224">Cosmos DB</span></span> 
### <a name="reading-data-fails"></a><span data-ttu-id="f20f6-225">Adatok beolvasása sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-225">Reading data fails.</span></span>
<span data-ttu-id="f20f6-226">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-226">**Detection**.</span></span> <span data-ttu-id="f20f6-227">A tényleges `System.Net.Http.HttpRequestException` vagy `Microsoft.Azure.Documents.DocumentClientException`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-227">Catch `System.Net.Http.HttpRequestException` or `Microsoft.Azure.Documents.DocumentClientException`.</span></span>

<span data-ttu-id="f20f6-228">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-228">**Recovery**</span></span>

* <span data-ttu-id="f20f6-229">Az SDK automatikusan újrapróbálkozik a sikertelen kísérletek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-229">The SDK automatically retries failed attempts.</span></span> <span data-ttu-id="f20f6-230">Az újrapróbálkozások száma és a maximális várakozási idő beállításához konfigurálása `ConnectionPolicy.RetryOptions`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-230">To set the number of retries and the maximum wait time, configure `ConnectionPolicy.RetryOptions`.</span></span> <span data-ttu-id="f20f6-231">Az ügyfél által okozott kivételek vagy túlmutatnak az újrapróbálkozási szabályzaton, vagy nem átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-231">Exceptions that the client raises are either beyond the retry policy or are not transient errors.</span></span>
* <span data-ttu-id="f20f6-232">Ha a Cosmos DB korlátozza az ügyfél kísérleteit, a 429-es HTTP-hibaüzenetet adja vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-232">If Cosmos DB throttles the client, it returns an HTTP 429 error.</span></span> <span data-ttu-id="f20f6-233">Ellenőrizze a `DocumentClientException` állapotkódját.</span><span class="sxs-lookup"><span data-stu-id="f20f6-233">Check the status code in the `DocumentClientException`.</span></span> <span data-ttu-id="f20f6-234">Ha a hiba 429 következetesen, fontolja meg a gyűjtemény átviteli sebesség értékének növelésével.</span><span class="sxs-lookup"><span data-stu-id="f20f6-234">If you are getting error 429 consistently, consider increasing the throughput value of the collection.</span></span>
    * <span data-ttu-id="f20f6-235">A MongoDB API-t használ, ha a szolgáltatás a esetén a sávszélesség-szabályozás hibakód 16500 ad vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-235">If you are using the MongoDB API, the service returns error code 16500 when throttling.</span></span>
* <span data-ttu-id="f20f6-236">A Cosmos DB adatbázis két vagy több régió replikálásához.</span><span class="sxs-lookup"><span data-stu-id="f20f6-236">Replicate the Cosmos DB database across two or more regions.</span></span> <span data-ttu-id="f20f6-237">Összes replikát is olvasható.</span><span class="sxs-lookup"><span data-stu-id="f20f6-237">All replicas are readable.</span></span> <span data-ttu-id="f20f6-238">Az ügyfél SDK-k használata, adja meg a `PreferredLocations` paraméter.</span><span class="sxs-lookup"><span data-stu-id="f20f6-238">Using the client SDKs, specify the `PreferredLocations` parameter.</span></span> <span data-ttu-id="f20f6-239">Ez az Azure-régiók rendezett listáját.</span><span class="sxs-lookup"><span data-stu-id="f20f6-239">This is an ordered list of Azure regions.</span></span> <span data-ttu-id="f20f6-240">Az összes olvasási kapnak a lista első rendelkezésre álló terület.</span><span class="sxs-lookup"><span data-stu-id="f20f6-240">All reads will be sent to the first available region in the list.</span></span> <span data-ttu-id="f20f6-241">A kérés nem teljesíthető, ha az ügyfél megpróbál a más régiókból, a listában, sorrendben.</span><span class="sxs-lookup"><span data-stu-id="f20f6-241">If the request fails, the client will try the other regions in the list, in order.</span></span> <span data-ttu-id="f20f6-242">További információkért lásd: [telepítője az SQL API-val Azure Cosmos DB globális terjesztési hogyan][cosmosdb-multi-region].</span><span class="sxs-lookup"><span data-stu-id="f20f6-242">For more information, see [How to setup Azure Cosmos DB global distribution using the SQL API][cosmosdb-multi-region].</span></span>

<span data-ttu-id="f20f6-243">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-243">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-244">Ügyféloldali összes hibák naplózására.</span><span class="sxs-lookup"><span data-stu-id="f20f6-244">Log all errors on the client side.</span></span>

### <a name="writing-data-fails"></a><span data-ttu-id="f20f6-245">Sikertelen az adatok írásakor.</span><span class="sxs-lookup"><span data-stu-id="f20f6-245">Writing data fails.</span></span>
<span data-ttu-id="f20f6-246">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-246">**Detection**.</span></span> <span data-ttu-id="f20f6-247">A tényleges `System.Net.Http.HttpRequestException` vagy `Microsoft.Azure.Documents.DocumentClientException`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-247">Catch `System.Net.Http.HttpRequestException` or `Microsoft.Azure.Documents.DocumentClientException`.</span></span>

<span data-ttu-id="f20f6-248">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-248">**Recovery**</span></span>

* <span data-ttu-id="f20f6-249">Az SDK automatikusan újrapróbálkozik a sikertelen kísérletek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-249">The SDK automatically retries failed attempts.</span></span> <span data-ttu-id="f20f6-250">Az újrapróbálkozások száma és a maximális várakozási idő beállításához konfigurálása `ConnectionPolicy.RetryOptions`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-250">To set the number of retries and the maximum wait time, configure `ConnectionPolicy.RetryOptions`.</span></span> <span data-ttu-id="f20f6-251">Az ügyfél által okozott kivételek vagy túlmutatnak az újrapróbálkozási szabályzaton, vagy nem átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-251">Exceptions that the client raises are either beyond the retry policy or are not transient errors.</span></span>
* <span data-ttu-id="f20f6-252">Ha a Cosmos DB korlátozza az ügyfél kísérleteit, a 429-es HTTP-hibaüzenetet adja vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-252">If Cosmos DB throttles the client, it returns an HTTP 429 error.</span></span> <span data-ttu-id="f20f6-253">Ellenőrizze a `DocumentClientException` állapotkódját.</span><span class="sxs-lookup"><span data-stu-id="f20f6-253">Check the status code in the `DocumentClientException`.</span></span> <span data-ttu-id="f20f6-254">Ha a hiba 429 következetesen, fontolja meg a gyűjtemény átviteli sebesség értékének növelésével.</span><span class="sxs-lookup"><span data-stu-id="f20f6-254">If you are getting error 429 consistently, consider increasing the throughput value of the collection.</span></span>
* <span data-ttu-id="f20f6-255">A Cosmos DB adatbázis két vagy több régió replikálásához.</span><span class="sxs-lookup"><span data-stu-id="f20f6-255">Replicate the Cosmos DB database across two or more regions.</span></span> <span data-ttu-id="f20f6-256">Ha az elsődleges régióban meghibásodik, egy másik régióban lesz előléptetve írni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-256">If the primary region fails, another region will be promoted to write.</span></span> <span data-ttu-id="f20f6-257">A feladatátvétel manuálisan is elindítható.</span><span class="sxs-lookup"><span data-stu-id="f20f6-257">You can also trigger a failover manually.</span></span> <span data-ttu-id="f20f6-258">Az SDK automatikus felderítést és az útválasztást, végzi, az alkalmazás kódjában folytatja a működést egy feladatátvétel után.</span><span class="sxs-lookup"><span data-stu-id="f20f6-258">The SDK does automatic discovery and routing, so application code continues to work after a failover.</span></span> <span data-ttu-id="f20f6-259">Időszakban a feladatátvétel (általában percben) az írási műveletek, az SDK megkeresi az új írási terület lesz nagyobb késleltetéssel járhat.</span><span class="sxs-lookup"><span data-stu-id="f20f6-259">During the failover period (typically minutes), write operations will have higher latency, as the SDK finds the new write region.</span></span>
  <span data-ttu-id="f20f6-260">További információkért lásd: [telepítője az SQL API-val Azure Cosmos DB globális terjesztési hogyan][cosmosdb-multi-region].</span><span class="sxs-lookup"><span data-stu-id="f20f6-260">For more information, see [How to setup Azure Cosmos DB global distribution using the SQL API][cosmosdb-multi-region].</span></span>
* <span data-ttu-id="f20f6-261">Tartalékként továbbra is fennáll a dokumentum a biztonsági mentési üzenetsorba, és a várólista később feldolgozni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-261">As a fallback, persist the document to a backup queue, and process the queue later.</span></span>

<span data-ttu-id="f20f6-262">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-262">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-263">Ügyféloldali összes hibák naplózására.</span><span class="sxs-lookup"><span data-stu-id="f20f6-263">Log all errors on the client side.</span></span>

## <a name="elasticsearch"></a><span data-ttu-id="f20f6-264">Elasticsearch</span><span class="sxs-lookup"><span data-stu-id="f20f6-264">Elasticsearch</span></span>
### <a name="reading-data-from-elasticsearch-fails"></a><span data-ttu-id="f20f6-265">Adatok beolvasása Elasticsearch sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-265">Reading data from Elasticsearch fails.</span></span>
<span data-ttu-id="f20f6-266">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-266">**Detection**.</span></span> <span data-ttu-id="f20f6-267">Az adott megfelelő findlogin [Elasticsearch ügyfél] [ elasticsearch-client] használja.</span><span class="sxs-lookup"><span data-stu-id="f20f6-267">Catch the appropriate exception for the particular [Elasticsearch client][elasticsearch-client] being used.</span></span>

<span data-ttu-id="f20f6-268">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-268">**Recovery**</span></span>

* <span data-ttu-id="f20f6-269">Egy újrapróbálkozási mechanizmus használata.</span><span class="sxs-lookup"><span data-stu-id="f20f6-269">Use a retry mechanism.</span></span> <span data-ttu-id="f20f6-270">Minden ügyfél-nak a saját újrapróbálkozási házirendje.</span><span class="sxs-lookup"><span data-stu-id="f20f6-270">Each client has its own retry policies.</span></span>
* <span data-ttu-id="f20f6-271">Telepítse több Elasticsearch csomópontokat, és a magas rendelkezésre állású replikációs használja.</span><span class="sxs-lookup"><span data-stu-id="f20f6-271">Deploy multiple Elasticsearch nodes and use replication for high availability.</span></span>

<span data-ttu-id="f20f6-272">További információkért lásd: [az Azure-on futó Elasticsearch][elasticsearch-azure].</span><span class="sxs-lookup"><span data-stu-id="f20f6-272">For more information, see [Running Elasticsearch on Azure][elasticsearch-azure].</span></span>

<span data-ttu-id="f20f6-273">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-273">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-274">Figyelési eszközök segítségével Elasticsearch, vagy jelentkezzen az ügyféloldalon összes hiba a tartalom.</span><span class="sxs-lookup"><span data-stu-id="f20f6-274">You can use monitoring tools for Elasticsearch, or log all errors on the client side with the payload.</span></span> <span data-ttu-id="f20f6-275">A "Figyelés" című [az Azure-on futó Elasticsearch][elasticsearch-azure].</span><span class="sxs-lookup"><span data-stu-id="f20f6-275">See the 'Monitoring' section in [Running Elasticsearch on Azure][elasticsearch-azure].</span></span>

### <a name="writing-data-to-elasticsearch-fails"></a><span data-ttu-id="f20f6-276">Írás a Elasticsearch meghiúsul.</span><span class="sxs-lookup"><span data-stu-id="f20f6-276">Writing data to Elasticsearch fails.</span></span>
<span data-ttu-id="f20f6-277">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-277">**Detection**.</span></span> <span data-ttu-id="f20f6-278">Az adott megfelelő findlogin [Elasticsearch ügyfél] [ elasticsearch-client] használja.</span><span class="sxs-lookup"><span data-stu-id="f20f6-278">Catch the appropriate exception for the particular [Elasticsearch client][elasticsearch-client] being used.</span></span>  

<span data-ttu-id="f20f6-279">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-279">**Recovery**</span></span>

* <span data-ttu-id="f20f6-280">Egy újrapróbálkozási mechanizmus használata.</span><span class="sxs-lookup"><span data-stu-id="f20f6-280">Use a retry mechanism.</span></span> <span data-ttu-id="f20f6-281">Minden ügyfél-nak a saját újrapróbálkozási házirendje.</span><span class="sxs-lookup"><span data-stu-id="f20f6-281">Each client has its own retry policies.</span></span>
* <span data-ttu-id="f20f6-282">Ha az alkalmazás működését csökkentett konzisztenciaszint, fontolja meg az írás `write_consistency` beállítása `quorum`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-282">If the application can tolerate a reduced consistency level, consider writing with `write_consistency` setting of `quorum`.</span></span>

<span data-ttu-id="f20f6-283">További információkért lásd: [az Azure-on futó Elasticsearch][elasticsearch-azure].</span><span class="sxs-lookup"><span data-stu-id="f20f6-283">For more information, see [Running Elasticsearch on Azure][elasticsearch-azure].</span></span>

<span data-ttu-id="f20f6-284">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-284">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-285">Figyelési eszközök segítségével Elasticsearch, vagy jelentkezzen az ügyféloldalon összes hiba a tartalom.</span><span class="sxs-lookup"><span data-stu-id="f20f6-285">You can use monitoring tools for Elasticsearch, or log all errors on the client side with the payload.</span></span> <span data-ttu-id="f20f6-286">A "Figyelés" című [az Azure-on futó Elasticsearch][elasticsearch-azure].</span><span class="sxs-lookup"><span data-stu-id="f20f6-286">See the 'Monitoring' section in [Running Elasticsearch on Azure][elasticsearch-azure].</span></span>

## <a name="queue-storage"></a><span data-ttu-id="f20f6-287">Queue Storage</span><span class="sxs-lookup"><span data-stu-id="f20f6-287">Queue storage</span></span>
### <a name="writing-a-message-to-azure-queue-storage-fails-consistently"></a><span data-ttu-id="f20f6-288">Egy üzenet következetesen Azure Queue storage sikertelen írásakor.</span><span class="sxs-lookup"><span data-stu-id="f20f6-288">Writing a message to Azure Queue storage fails consistently.</span></span>
<span data-ttu-id="f20f6-289">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-289">**Detection**.</span></span> <span data-ttu-id="f20f6-290">Miután *N* újrapróbálkozási kísérletek, továbbra is sikertelen lesz, az írási művelet.</span><span class="sxs-lookup"><span data-stu-id="f20f6-290">After *N* retry attempts, the write operation still fails.</span></span>

<span data-ttu-id="f20f6-291">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-291">**Recovery**</span></span>

* <span data-ttu-id="f20f6-292">Az adatok tárolása a helyi gyorsítótárba, és továbbítja a írási műveleteket ad ki tárolási később, amikor a szolgáltatás elérhetővé válik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-292">Store the data in a local cache, and forward the writes to storage later, when the service becomes available.</span></span>
* <span data-ttu-id="f20f6-293">Hozzon létre egy másodlagos várólistát, és írni erre a várólistára, ha az elsődleges queue nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="f20f6-293">Create a secondary queue, and write to that queue if the primary queue is unavailable.</span></span>

<span data-ttu-id="f20f6-294">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-294">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-295">Használjon [storage mérőszámainak][storage-metrics].</span><span class="sxs-lookup"><span data-stu-id="f20f6-295">Use [storage metrics][storage-metrics].</span></span>

### <a name="the-application-cannot-process-a-particular-message-from-the-queue"></a><span data-ttu-id="f20f6-296">Az alkalmazás nem tudja feldolgozni az egy adott üzenetet az üzenetsorból.</span><span class="sxs-lookup"><span data-stu-id="f20f6-296">The application cannot process a particular message from the queue.</span></span>
<span data-ttu-id="f20f6-297">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-297">**Detection**.</span></span> <span data-ttu-id="f20f6-298">Adott alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="f20f6-298">Application specific.</span></span> <span data-ttu-id="f20f6-299">Például az üzenet érvénytelen adatokat tartalmaz, vagy az üzleti logika valamilyen okból nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="f20f6-299">For example, the message contains invalid data, or the business logic fails for some reason.</span></span>

<span data-ttu-id="f20f6-300">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-300">**Recovery**</span></span>

<span data-ttu-id="f20f6-301">Az üzenet áthelyezése egy külön várólista.</span><span class="sxs-lookup"><span data-stu-id="f20f6-301">Move the message to a separate queue.</span></span> <span data-ttu-id="f20f6-302">Egy adott várólistán lévő üzenetek vizsgálata külön folyamatban fut.</span><span class="sxs-lookup"><span data-stu-id="f20f6-302">Run a separate process to examine the messages in that queue.</span></span>

<span data-ttu-id="f20f6-303">Érdemes lehet Azure Service Bus üzenetkezelés várólisták, amely biztosítja a [kézbesítetlen levelek várólistájára] [ sb-dead-letter-queue] funkció erre a célra.</span><span class="sxs-lookup"><span data-stu-id="f20f6-303">Consider using Azure Service Bus Messaging queues, which provides a [dead-letter queue][sb-dead-letter-queue] functionality for this purpose.</span></span>

> [!NOTE]
> <span data-ttu-id="f20f6-304">A webjobs-feladatok tárüzenetsort használ, a WebJobs SDK beépített elhalt üzenetek kezelésének biztosít.</span><span class="sxs-lookup"><span data-stu-id="f20f6-304">If you are using Storage queues with WebJobs, the WebJobs SDK provides built-in poison message handling.</span></span> <span data-ttu-id="f20f6-305">Lásd: [Azure a queue storage használata a WebJobs SDK][sb-poison-message].</span><span class="sxs-lookup"><span data-stu-id="f20f6-305">See [How to use Azure queue storage with the WebJobs SDK][sb-poison-message].</span></span>

<span data-ttu-id="f20f6-306">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-306">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-307">Alkalmazásnaplózás használja.</span><span class="sxs-lookup"><span data-stu-id="f20f6-307">Use application logging.</span></span>

## <a name="redis-cache"></a><span data-ttu-id="f20f6-308">Redis Cache</span><span class="sxs-lookup"><span data-stu-id="f20f6-308">Redis Cache</span></span>
### <a name="reading-from-the-cache-fails"></a><span data-ttu-id="f20f6-309">A gyorsítótár olvasása sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-309">Reading from the cache fails.</span></span>
<span data-ttu-id="f20f6-310">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-310">**Detection**.</span></span> <span data-ttu-id="f20f6-311">A tényleges `StackExchange.Redis.RedisConnectionException`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-311">Catch `StackExchange.Redis.RedisConnectionException`.</span></span>

<span data-ttu-id="f20f6-312">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-312">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-313">Ismételje meg az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-313">Retry on transient failures.</span></span> <span data-ttu-id="f20f6-314">Az Azure Redis cache automatikusan újrapróbálkozik, lásd: keresztül támogatja [Redis Cache újrapróbálkozási irányelvek][redis-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-314">Azure Redis cache supports built-in retry through See [Redis Cache retry guidelines][redis-retry].</span></span>
2. <span data-ttu-id="f20f6-315">A gyorsítótár-tévesztései nem átmeneti hibák tekinti, és térhet vissza az eredeti adatforrás.</span><span class="sxs-lookup"><span data-stu-id="f20f6-315">Treat non-transient failures as a cache miss, and fall back to the original data source.</span></span>

<span data-ttu-id="f20f6-316">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-316">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-317">Használjon [Redis Cache diagnosztika][redis-monitor].</span><span class="sxs-lookup"><span data-stu-id="f20f6-317">Use [Redis Cache diagnostics][redis-monitor].</span></span>

### <a name="writing-to-the-cache-fails"></a><span data-ttu-id="f20f6-318">A gyorsítótárba írása sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-318">Writing to the cache fails.</span></span>
<span data-ttu-id="f20f6-319">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-319">**Detection**.</span></span> <span data-ttu-id="f20f6-320">A tényleges `StackExchange.Redis.RedisConnectionException`.</span><span class="sxs-lookup"><span data-stu-id="f20f6-320">Catch `StackExchange.Redis.RedisConnectionException`.</span></span>

<span data-ttu-id="f20f6-321">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-321">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-322">Ismételje meg az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-322">Retry on transient failures.</span></span> <span data-ttu-id="f20f6-323">Az Azure Redis cache automatikusan újrapróbálkozik, lásd: keresztül támogatja [Redis Cache újrapróbálkozási irányelvek][redis-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-323">Azure Redis cache supports built-in retry through See [Redis Cache retry guidelines][redis-retry].</span></span>
2. <span data-ttu-id="f20f6-324">Ha a hiba nem átmeneti, figyelmen kívül hagyhatja, és hogy más tranzakciók később a gyorsítótárba írni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-324">If the error is non-transient, ignore it and let other transactions write to the cache later.</span></span>

<span data-ttu-id="f20f6-325">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-325">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-326">Használjon [Redis Cache diagnosztika][redis-monitor].</span><span class="sxs-lookup"><span data-stu-id="f20f6-326">Use [Redis Cache diagnostics][redis-monitor].</span></span>

## <a name="sql-database"></a><span data-ttu-id="f20f6-327">SQL Database</span><span class="sxs-lookup"><span data-stu-id="f20f6-327">SQL Database</span></span>
### <a name="cannot-connect-to-the-database-in-the-primary-region"></a><span data-ttu-id="f20f6-328">Nem lehet kapcsolódni az adatbázishoz az elsődleges régióban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-328">Cannot connect to the database in the primary region.</span></span>
<span data-ttu-id="f20f6-329">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-329">**Detection**.</span></span> <span data-ttu-id="f20f6-330">Csatlakozás sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-330">Connection fails.</span></span>

<span data-ttu-id="f20f6-331">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-331">**Recovery**</span></span>

<span data-ttu-id="f20f6-332">Előfeltétel: Az adatbázis aktív georeplikációt a kell konfigurálni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-332">Prerequisite: The database must be configured for active geo-replication.</span></span> <span data-ttu-id="f20f6-333">Lásd: [SQL adatbázis aktív Georeplikáció][sql-db-replication].</span><span class="sxs-lookup"><span data-stu-id="f20f6-333">See [SQL Database Active Geo-Replication][sql-db-replication].</span></span>

* <span data-ttu-id="f20f6-334">A lekérdezések egy másodlagos másodpéldány olvasni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-334">For queries, read from a secondary replica.</span></span>
* <span data-ttu-id="f20f6-335">Beszúrások és a frissítések manuális feladatátvétellel egy másodlagos replikára.</span><span class="sxs-lookup"><span data-stu-id="f20f6-335">For inserts and updates, manually fail over to a secondary replica.</span></span> <span data-ttu-id="f20f6-336">Lásd: [kezdeményezzen tervezett vagy nem tervezett feladatátvételt az Azure SQL Database][sql-db-failover].</span><span class="sxs-lookup"><span data-stu-id="f20f6-336">See [Initiate a planned or unplanned failover for Azure SQL Database][sql-db-failover].</span></span>

<span data-ttu-id="f20f6-337">A replika használ egy másik kapcsolati karakterláncot, ezért szüksége lesz a kapcsolati karakterlánc az alkalmazás frissítésére.</span><span class="sxs-lookup"><span data-stu-id="f20f6-337">The replica uses a different connection string, so you will need to update the connection string in your application.</span></span>

### <a name="client-runs-out-of-connections-in-the-connection-pool"></a><span data-ttu-id="f20f6-338">Ügyfél elfogy a kapcsolatkészletben található kapcsolatok.</span><span class="sxs-lookup"><span data-stu-id="f20f6-338">Client runs out of connections in the connection pool.</span></span>
<span data-ttu-id="f20f6-339">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-339">**Detection**.</span></span> <span data-ttu-id="f20f6-340">A tényleges `System.InvalidOperationException` hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-340">Catch `System.InvalidOperationException` errors.</span></span>

<span data-ttu-id="f20f6-341">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-341">**Recovery**</span></span>

* <span data-ttu-id="f20f6-342">Próbálja megismételni a műveletet.</span><span class="sxs-lookup"><span data-stu-id="f20f6-342">Retry the operation.</span></span>
* <span data-ttu-id="f20f6-343">A kezelési terv, különítse el a kapcsolatkészletek minden használati eset az, hogy egy használati eset nem dominálja az összes kapcsolat.</span><span class="sxs-lookup"><span data-stu-id="f20f6-343">As a mitigation plan, isolate the connection pools for each use case, so that one use case can't dominate all the connections.</span></span>
* <span data-ttu-id="f20f6-344">Növelje meg a maximális kapcsolatkészletek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-344">Increase the maximum connection pools.</span></span>

<span data-ttu-id="f20f6-345">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-345">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-346">Alkalmazás naplókat.</span><span class="sxs-lookup"><span data-stu-id="f20f6-346">Application logs.</span></span>

### <a name="database-connection-limit-is-reached"></a><span data-ttu-id="f20f6-347">Adatbázis-kapcsolathoz megadott korlátot elérte.</span><span class="sxs-lookup"><span data-stu-id="f20f6-347">Database connection limit is reached.</span></span>
<span data-ttu-id="f20f6-348">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-348">**Detection**.</span></span> <span data-ttu-id="f20f6-349">Az Azure SQL Database egyidejű dolgozók, a bejelentkezési adatok, valamint a munkamenetek számának korlátozása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-349">Azure SQL Database limits the number of concurrent workers, logins, and sessions.</span></span> <span data-ttu-id="f20f6-350">A korlátozások attól függnek, hogy a szolgáltatási rétegben.</span><span class="sxs-lookup"><span data-stu-id="f20f6-350">The limits depend on the service tier.</span></span> <span data-ttu-id="f20f6-351">További információkért lásd: [erőforrás-korlátozások az Azure SQL Database][sql-db-limits].</span><span class="sxs-lookup"><span data-stu-id="f20f6-351">For more information, see [Azure SQL Database resource limits][sql-db-limits].</span></span>

<span data-ttu-id="f20f6-352">Ezek a hibák észlelésére, catch `System.Data.SqlClient.SqlException` , és ellenőrizze a értékének `SqlException.Number` az SQL-hibakódhoz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-352">To detect these errors, catch `System.Data.SqlClient.SqlException` and check the value of `SqlException.Number` for the SQL error code.</span></span> <span data-ttu-id="f20f6-353">Kapcsolódó hibakódok listáját lásd: [az SQL Database-ügyfélalkalmazások SQL hibakódjai: adatbázis-kapcsolati hiba és más olyan problémák][sql-db-errors].</span><span class="sxs-lookup"><span data-stu-id="f20f6-353">For a list of relevant error codes, see [SQL error codes for SQL Database client applications: Database connection error and other issues][sql-db-errors].</span></span>

<span data-ttu-id="f20f6-354">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-354">**Recovery**.</span></span> <span data-ttu-id="f20f6-355">Ezek a hibák átmeneti, minősülnek, így újrapróbálkozás megoldhatja a problémát.</span><span class="sxs-lookup"><span data-stu-id="f20f6-355">These errors are considered transient, so retrying may resolve the issue.</span></span> <span data-ttu-id="f20f6-356">Hogy következetesen érte ezeket a hibákat, fontolja meg az adatbázis méretezése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-356">If you consistently hit these errors, consider scaling the database.</span></span>

<span data-ttu-id="f20f6-357">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-357">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-358">-A [sys.event_log] [ sys.event_log] lekérdezés sikeres adatbázis-kapcsolatok, a csatlakozási hibák és a holtpontok adja vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-358">- The [sys.event_log][sys.event_log] query returns successful database connections, connection failures, and deadlocks.</span></span>

* <span data-ttu-id="f20f6-359">Hozzon létre egy [riasztási szabály] [ azure-alerts] nem sikerült a következő kapcsolatok.</span><span class="sxs-lookup"><span data-stu-id="f20f6-359">Create an [alert rule][azure-alerts] for failed connections.</span></span>
* <span data-ttu-id="f20f6-360">Engedélyezése [SQL Database auditing] [ sql-db-audit] és sikertelen bejelentkezések ellenőrzése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-360">Enable [SQL Database auditing][sql-db-audit] and check for failed logins.</span></span>

## <a name="service-bus-messaging"></a><span data-ttu-id="f20f6-361">Service Bus-üzenetkezelés</span><span class="sxs-lookup"><span data-stu-id="f20f6-361">Service Bus Messaging</span></span>
### <a name="reading-a-message-from-a-service-bus-queue-fails"></a><span data-ttu-id="f20f6-362">A Service Bus-üzenetsorba üzenet olvasása sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-362">Reading a message from a Service Bus queue fails.</span></span>
<span data-ttu-id="f20f6-363">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-363">**Detection**.</span></span> <span data-ttu-id="f20f6-364">Az ügyfél SDK kivételeket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-364">Catch exceptions from the client SDK.</span></span> <span data-ttu-id="f20f6-365">A Service Bus kivételek alaposztálya [MessagingException][sb-messagingexception-class].</span><span class="sxs-lookup"><span data-stu-id="f20f6-365">The base class for Service Bus exceptions is [MessagingException][sb-messagingexception-class].</span></span> <span data-ttu-id="f20f6-366">Ha a hiba átmeneti, a `IsTransient` tulajdonság értéke igaz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-366">If the error is transient, the `IsTransient` property is true.</span></span>

<span data-ttu-id="f20f6-367">További információkért lásd: [Service Bus üzenetküldési kivételek][sb-messaging-exceptions].</span><span class="sxs-lookup"><span data-stu-id="f20f6-367">For more information, see [Service Bus messaging exceptions][sb-messaging-exceptions].</span></span>

<span data-ttu-id="f20f6-368">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-368">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-369">Ismételje meg az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-369">Retry on transient failures.</span></span> <span data-ttu-id="f20f6-370">Lásd: [Service Bus újrapróbálkozási irányelvek][sb-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-370">See [Service Bus retry guidelines][sb-retry].</span></span>
2. <span data-ttu-id="f20f6-371">Üzeneteket egyetlen fogadó nem kézbesíthetők helyezi a *kézbesítetlen levelek várólistájára*.</span><span class="sxs-lookup"><span data-stu-id="f20f6-371">Messages that cannot be delivered to any receiver are placed in a *dead-letter queue*.</span></span> <span data-ttu-id="f20f6-372">A várólista segítségével tekintse meg az üzenetet nem lehet fogadni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-372">Use this queue to see which messages could not be received.</span></span> <span data-ttu-id="f20f6-373">Nincs nincs automatikus karbantartása a kézbesítetlen levelek várólistájára.</span><span class="sxs-lookup"><span data-stu-id="f20f6-373">There is no automatic cleanup of the dead-letter queue.</span></span> <span data-ttu-id="f20f6-374">Üzenetek nem maradnak, amíg explicit módon kérheti le azokat.</span><span class="sxs-lookup"><span data-stu-id="f20f6-374">Messages remain there until you explicitly retrieve them.</span></span> <span data-ttu-id="f20f6-375">Lásd: [áttekintése a Service Bus kézbesítetlen levelek várólistájának][sb-dead-letter-queue].</span><span class="sxs-lookup"><span data-stu-id="f20f6-375">See [Overview of Service Bus dead-letter queues][sb-dead-letter-queue].</span></span>

### <a name="writing-a-message-to-a-service-bus-queue-fails"></a><span data-ttu-id="f20f6-376">Egy üzenet írása egy Service Bus várólista sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-376">Writing a message to a Service Bus queue fails.</span></span>
<span data-ttu-id="f20f6-377">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-377">**Detection**.</span></span> <span data-ttu-id="f20f6-378">Az ügyfél SDK kivételeket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-378">Catch exceptions from the client SDK.</span></span> <span data-ttu-id="f20f6-379">A Service Bus kivételek alaposztálya [MessagingException][sb-messagingexception-class].</span><span class="sxs-lookup"><span data-stu-id="f20f6-379">The base class for Service Bus exceptions is [MessagingException][sb-messagingexception-class].</span></span> <span data-ttu-id="f20f6-380">Ha a hiba átmeneti, a `IsTransient` tulajdonság értéke igaz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-380">If the error is transient, the `IsTransient` property is true.</span></span>

<span data-ttu-id="f20f6-381">További információkért lásd: [Service Bus üzenetküldési kivételek][sb-messaging-exceptions].</span><span class="sxs-lookup"><span data-stu-id="f20f6-381">For more information, see [Service Bus messaging exceptions][sb-messaging-exceptions].</span></span>

<span data-ttu-id="f20f6-382">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-382">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-383">A Service Bus-ügyfél automatikusan újrapróbálkozik átmeneti hibák után.</span><span class="sxs-lookup"><span data-stu-id="f20f6-383">The Service Bus client automatically retries after transient errors.</span></span> <span data-ttu-id="f20f6-384">Alapértelmezés szerint azt használja az exponenciális vissza ki.</span><span class="sxs-lookup"><span data-stu-id="f20f6-384">By default, it uses exponential back-off.</span></span> <span data-ttu-id="f20f6-385">Az újrapróbálkozások maximális számát vagy a maximális engedélyezett idő után az ügyfél kivételt jelez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-385">After the maximum retry count or maximum timeout period, the client throws an exception.</span></span> <span data-ttu-id="f20f6-386">További információkért lásd: [Service Bus újrapróbálkozási irányelvek][sb-retry].</span><span class="sxs-lookup"><span data-stu-id="f20f6-386">For more information, see [Service Bus retry guidelines][sb-retry].</span></span>
2. <span data-ttu-id="f20f6-387">A várólista kvóta túllépése, az ügyfél jelez [QuotaExceededException][QuotaExceededException].</span><span class="sxs-lookup"><span data-stu-id="f20f6-387">If the queue quota is exceeded, the client throws [QuotaExceededException][QuotaExceededException].</span></span> <span data-ttu-id="f20f6-388">A kivétel üzenetének további részleteket nyújt.</span><span class="sxs-lookup"><span data-stu-id="f20f6-388">The exception message gives more details.</span></span> <span data-ttu-id="f20f6-389">A várólistában lévő egyes üzenetek kiürítésére újrapróbálkozás előtt, és vegye figyelembe, folyamatos újrapróbálkozások elkerülése érdekében, miközben a rendszer túllépte az áramköri megszakító minta használatával.</span><span class="sxs-lookup"><span data-stu-id="f20f6-389">Drain some messages from the queue before retrying, and consider using the Circuit Breaker pattern to avoid continued retries while the quota is exceeded.</span></span> <span data-ttu-id="f20f6-390">Győződjön meg arról is, a [BrokeredMessage.TimeToLive] tulajdonság értéke túl magas.</span><span class="sxs-lookup"><span data-stu-id="f20f6-390">Also, make sure the [BrokeredMessage.TimeToLive] property is not set too high.</span></span>
3. <span data-ttu-id="f20f6-391">A régión belül használatával növelhető a rugalmasság [üzenetsorok és témakörök particionálva][sb-partition].</span><span class="sxs-lookup"><span data-stu-id="f20f6-391">Within a region, resiliency can be improved by using [partitioned queues or topics][sb-partition].</span></span> <span data-ttu-id="f20f6-392">Nem particionált üzenetsor vagy témakör egyetlen üzenetküldési tárolóra van hozzárendelve.</span><span class="sxs-lookup"><span data-stu-id="f20f6-392">A non-partitioned queue or topic is assigned to one messaging store.</span></span> <span data-ttu-id="f20f6-393">Az üzenetküldési tárolóban nem érhető el, ha az adott üzenetsor vagy témakör összes művelet sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-393">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="f20f6-394">A particionált üzenetsor vagy témakör particionálása több üzenetküldési tároló között.</span><span class="sxs-lookup"><span data-stu-id="f20f6-394">A partitioned queue or topic is partitioned across multiple messaging stores.</span></span>
4. <span data-ttu-id="f20f6-395">A további rugalmasságot különböző régiókban két Service Bus-névtér létrehozása, és az üzenet replikálása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-395">For additional resiliency, create two Service Bus namespaces in different regions, and replicate the messages.</span></span> <span data-ttu-id="f20f6-396">A replikálás aktív vagy passzív replikációs is használhatja.</span><span class="sxs-lookup"><span data-stu-id="f20f6-396">You can use either active replication or passive replication.</span></span>

   * <span data-ttu-id="f20f6-397">Aktív replikáció: az ügyfél minden üzenetet küld mindkét várólisták.</span><span class="sxs-lookup"><span data-stu-id="f20f6-397">Active replication: The client sends every message to both queues.</span></span> <span data-ttu-id="f20f6-398">A fogadó mindkét várólisták figyel.</span><span class="sxs-lookup"><span data-stu-id="f20f6-398">The receiver listens on both queues.</span></span> <span data-ttu-id="f20f6-399">Egy egyedi azonosítóval rendelkező üzenetek címkét, így az ügyfél elvetheti a duplikált üzenetek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-399">Tag messages with a unique identifier, so the client can discard duplicate messages.</span></span>
   * <span data-ttu-id="f20f6-400">Passzív replikáció: az ügyfél az üzenet elküldése egy olyan sort.</span><span class="sxs-lookup"><span data-stu-id="f20f6-400">Passive replication: The client sends the message to one queue.</span></span> <span data-ttu-id="f20f6-401">Ha nem sikerül, az ügyfél visszavált a várakozási sorba.</span><span class="sxs-lookup"><span data-stu-id="f20f6-401">If there is an error, the client falls back to the other queue.</span></span> <span data-ttu-id="f20f6-402">A fogadó mindkét várólisták figyel.</span><span class="sxs-lookup"><span data-stu-id="f20f6-402">The receiver listens on both queues.</span></span> <span data-ttu-id="f20f6-403">Ezt a módszert csökkenthető az ismétlődő küldött üzenetek száma.</span><span class="sxs-lookup"><span data-stu-id="f20f6-403">This approach reduces the number of duplicate messages that are sent.</span></span> <span data-ttu-id="f20f6-404">Azonban a fogadó kell továbbra is duplikált üzenetek kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-404">However, the receiver must still handle duplicate messages.</span></span>

     <span data-ttu-id="f20f6-405">További információkért lásd: [georeplication beállítását minta] [ sb-georeplication-sample] és [ajánlott eljárások az alkalmazások a Service Bus kimaradások és vészhelyzetek szigetelő](/azure/service-bus-messaging/service-bus-outages-disasters/).</span><span class="sxs-lookup"><span data-stu-id="f20f6-405">For more information, see [GeoReplication sample][sb-georeplication-sample] and [Best practices for insulating applications against Service Bus outages and disasters](/azure/service-bus-messaging/service-bus-outages-disasters/).</span></span>

### <a name="duplicate-message"></a><span data-ttu-id="f20f6-406">Ismétlődő üzenet.</span><span class="sxs-lookup"><span data-stu-id="f20f6-406">Duplicate message.</span></span>
<span data-ttu-id="f20f6-407">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-407">**Detection**.</span></span> <span data-ttu-id="f20f6-408">Vizsgálja meg a `MessageId` és `DeliveryCount` az üzenet tulajdonságai.</span><span class="sxs-lookup"><span data-stu-id="f20f6-408">Examine the `MessageId` and `DeliveryCount` properties of the message.</span></span>

<span data-ttu-id="f20f6-409">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-409">**Recovery**</span></span>

* <span data-ttu-id="f20f6-410">Ha lehetséges tervezze meg az üzenetet, feldolgozási műveletek idempotent kell.</span><span class="sxs-lookup"><span data-stu-id="f20f6-410">If possible, design your message processing operations to be idempotent.</span></span> <span data-ttu-id="f20f6-411">Ellenkező esetben tárolására üzenet azonosítói üzeneteket már dolgoznak fel, és ellenőrizze az azonosító egy üzenet feldolgozása előtt.</span><span class="sxs-lookup"><span data-stu-id="f20f6-411">Otherwise, store message IDs of messages that are already processed, and check the ID before processing a message.</span></span>
* <span data-ttu-id="f20f6-412">Kettős észlelés, engedélyezze a várólista létrehozása `RequiresDuplicateDetection` igaz értékre állítva.</span><span class="sxs-lookup"><span data-stu-id="f20f6-412">Enable duplicate detection, by creating the queue with `RequiresDuplicateDetection` set to true.</span></span> <span data-ttu-id="f20f6-413">Ezzel a beállítással a Service Bus automatikusan törli a ugyanazzal a küldött üzenet `MessageId` előző üzenetben.</span><span class="sxs-lookup"><span data-stu-id="f20f6-413">With this setting, Service Bus automatically deletes any message that is sent with the same `MessageId` as a previous message.</span></span>  <span data-ttu-id="f20f6-414">Vegye figyelembe a következőket:</span><span class="sxs-lookup"><span data-stu-id="f20f6-414">Note the following:</span></span>

  * <span data-ttu-id="f20f6-415">Ez a beállítás megakadályozza, hogy a duplikált üzenetek a várólista üzembe.</span><span class="sxs-lookup"><span data-stu-id="f20f6-415">This setting prevents duplicate messages from being put into the queue.</span></span> <span data-ttu-id="f20f6-416">Ez nem akadályozza a fogadó ugyanaz az üzenet feldolgozása egynél többször.</span><span class="sxs-lookup"><span data-stu-id="f20f6-416">It doesn't prevent a receiver from processing the same message more than once.</span></span>
  * <span data-ttu-id="f20f6-417">Kettős észlelés rendelkezik egy olyan időkeretet.</span><span class="sxs-lookup"><span data-stu-id="f20f6-417">Duplicate detection has a time window.</span></span> <span data-ttu-id="f20f6-418">Duplikált küldött meghaladja ezt az ablakot, ha nem észlelhető.</span><span class="sxs-lookup"><span data-stu-id="f20f6-418">If a duplicate is sent beyond this window, it won't be detected.</span></span>

<span data-ttu-id="f20f6-419">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-419">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-420">Duplikált üzenetek naplózása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-420">Log duplicated messages.</span></span>

### <a name="the-application-cannot-process-a-particular-message-from-the-queue"></a><span data-ttu-id="f20f6-421">Az alkalmazás nem tudja feldolgozni az egy adott üzenetet az üzenetsorból.</span><span class="sxs-lookup"><span data-stu-id="f20f6-421">The application cannot process a particular message from the queue.</span></span>
<span data-ttu-id="f20f6-422">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-422">**Detection**.</span></span> <span data-ttu-id="f20f6-423">Adott alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="f20f6-423">Application specific.</span></span> <span data-ttu-id="f20f6-424">Például az üzenet érvénytelen adatokat tartalmaz, vagy az üzleti logika valamilyen okból nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="f20f6-424">For example, the message contains invalid data, or the business logic fails for some reason.</span></span>

<span data-ttu-id="f20f6-425">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-425">**Recovery**</span></span>

<span data-ttu-id="f20f6-426">Nincsenek két hiba módot kell figyelembe venni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-426">There are two failure modes to consider.</span></span>

* <span data-ttu-id="f20f6-427">A fogadó észleli a hibát.</span><span class="sxs-lookup"><span data-stu-id="f20f6-427">The receiver detects the failure.</span></span> <span data-ttu-id="f20f6-428">Ebben az esetben az üzenet áthelyezése a kézbesítetlen levelek várólistájára.</span><span class="sxs-lookup"><span data-stu-id="f20f6-428">In this case, move the message to the dead-letter queue.</span></span> <span data-ttu-id="f20f6-429">Később futtassa a kézbesítetlen levelek várólistában lévő üzenetek vizsgálata külön folyamatban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-429">Later, run a separate process to examine the messages in the dead-letter queue.</span></span>
* <span data-ttu-id="f20f6-430">A fogadó nem sikerül, az üzenet feldolgozása közepén &mdash; például egy nem kezelt kivétel miatt.</span><span class="sxs-lookup"><span data-stu-id="f20f6-430">The receiver fails in the middle of processing the message &mdash; for example, due to an unhandled exception.</span></span> <span data-ttu-id="f20f6-431">Ebben az esetben kezelésére, használja a `PeekLock` mód.</span><span class="sxs-lookup"><span data-stu-id="f20f6-431">To handle this case, use `PeekLock` mode.</span></span> <span data-ttu-id="f20f6-432">Ebben a módban Ha a lejár a zárolást, az üzenet elérhetővé válik többi fogadó számára.</span><span class="sxs-lookup"><span data-stu-id="f20f6-432">In this mode, if the lock expires, the message becomes available to other receivers.</span></span> <span data-ttu-id="f20f6-433">Ha az üzenet túllépi a maximális szám vagy az idő élettartamát, az üzenet automatikusan átkerül a kézbesítetlen levelek várólistájára.</span><span class="sxs-lookup"><span data-stu-id="f20f6-433">If the message exceeds the maximum delivery count or the time-to-live, the message is automatically moved to the dead-letter queue.</span></span>

<span data-ttu-id="f20f6-434">További információkért lásd: [áttekintése a Service Bus kézbesítetlen levelek várólistájának][sb-dead-letter-queue].</span><span class="sxs-lookup"><span data-stu-id="f20f6-434">For more information, see [Overview of Service Bus dead-letter queues][sb-dead-letter-queue].</span></span>

<span data-ttu-id="f20f6-435">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-435">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-436">Amikor az alkalmazás egy üzenetet a kézbesítetlen levelek várólistájára helyezi, írni egy eseményt az alkalmazás naplóiban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-436">Whenever the application moves a message to the dead-letter queue, write an event to the application logs.</span></span>

## <a name="service-fabric"></a><span data-ttu-id="f20f6-437">Service Fabric</span><span class="sxs-lookup"><span data-stu-id="f20f6-437">Service Fabric</span></span>
### <a name="a-request-to-a-service-fails"></a><span data-ttu-id="f20f6-438">A szolgáltatásnak küldött kérelemben sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-438">A request to a service fails.</span></span>
<span data-ttu-id="f20f6-439">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-439">**Detection**.</span></span> <span data-ttu-id="f20f6-440">A szolgáltatás hibát ad vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-440">The service returns an error.</span></span>

<span data-ttu-id="f20f6-441">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-441">**Recovery**</span></span>

* <span data-ttu-id="f20f6-442">Keresse meg a proxy újra (`ServiceProxy` vagy `ActorProxy`) és a szolgáltatás-vagy aktormetódus hívja meg ismét.</span><span class="sxs-lookup"><span data-stu-id="f20f6-442">Locate a proxy again (`ServiceProxy` or `ActorProxy`) and call the service/actor method again.</span></span>
* <span data-ttu-id="f20f6-443">**Az állapotalapú szolgáltatás**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-443">**Stateful service**.</span></span> <span data-ttu-id="f20f6-444">A megbízható gyűjtemények műveletek burkolása szerepel egy tranzakcióban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-444">Wrap operations on reliable collections in a transaction.</span></span> <span data-ttu-id="f20f6-445">Ha nem sikerül, a tranzakció vissza lesz állítva.</span><span class="sxs-lookup"><span data-stu-id="f20f6-445">If there is an error, the transaction will be rolled back.</span></span> <span data-ttu-id="f20f6-446">A kérést, ha a várólista lekért dolgoz fel újra.</span><span class="sxs-lookup"><span data-stu-id="f20f6-446">The request, if pulled from a queue, will be processed again.</span></span>
* <span data-ttu-id="f20f6-447">**Állapotmentes szolgáltatások**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-447">**Stateless service**.</span></span> <span data-ttu-id="f20f6-448">Ha a szolgáltatás továbbra is fennáll, külső áruházban adatokat, minden műveletet kell lennie az idempotent.</span><span class="sxs-lookup"><span data-stu-id="f20f6-448">If the service persists data to an external store, all operations need to be idempotent.</span></span>

<span data-ttu-id="f20f6-449">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-449">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-450">Napló</span><span class="sxs-lookup"><span data-stu-id="f20f6-450">Application log</span></span>

### <a name="service-fabric-node-is-shut-down"></a><span data-ttu-id="f20f6-451">Service Fabric-csomópont le van állítva.</span><span class="sxs-lookup"><span data-stu-id="f20f6-451">Service Fabric node is shut down.</span></span>
<span data-ttu-id="f20f6-452">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-452">**Detection**.</span></span> <span data-ttu-id="f20f6-453">Megszakítási jogkivonat továbbítódik a szolgáltatás `RunAsync` metódust.</span><span class="sxs-lookup"><span data-stu-id="f20f6-453">A cancellation token is passed to the service's `RunAsync` method.</span></span> <span data-ttu-id="f20f6-454">A Service Fabric a feladat törli a csomópont leállítása előtt.</span><span class="sxs-lookup"><span data-stu-id="f20f6-454">Service Fabric cancels the task before shutting down the node.</span></span>

<span data-ttu-id="f20f6-455">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-455">**Recovery**.</span></span> <span data-ttu-id="f20f6-456">A megszakítási token leállítási észleléséhez használni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-456">Use the cancellation token to detect shutdown.</span></span> <span data-ttu-id="f20f6-457">Ha a Service Fabric törlését kéri, Befejezés munka, és zárja be `RunAsync` lehető leggyorsabban tegye.</span><span class="sxs-lookup"><span data-stu-id="f20f6-457">When Service Fabric requests cancellation, finish any work and exit `RunAsync` as quickly as possible.</span></span>

<span data-ttu-id="f20f6-458">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-458">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-459">Alkalmazásnaplók</span><span class="sxs-lookup"><span data-stu-id="f20f6-459">Application logs</span></span>

## <a name="storage"></a><span data-ttu-id="f20f6-460">Tárolás</span><span class="sxs-lookup"><span data-stu-id="f20f6-460">Storage</span></span>
### <a name="writing-data-to-azure-storage-fails"></a><span data-ttu-id="f20f6-461">Sikertelen az adatok Azure Storage való írásakor</span><span class="sxs-lookup"><span data-stu-id="f20f6-461">Writing data to Azure Storage fails</span></span>
<span data-ttu-id="f20f6-462">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-462">**Detection**.</span></span> <span data-ttu-id="f20f6-463">Az ügyfél megkapja a hibák írása közben.</span><span class="sxs-lookup"><span data-stu-id="f20f6-463">The client receives errors when writing.</span></span>

<span data-ttu-id="f20f6-464">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-464">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-465">Próbálja megismételni a műveletet, helyreállítása az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-465">Retry the operation, to recover from transient failures.</span></span> <span data-ttu-id="f20f6-466">A [újrapróbálkozási házirendet] [ Storage.RetryPolicies] az ügyfél SDK kezeli ezt automatikusan.</span><span class="sxs-lookup"><span data-stu-id="f20f6-466">The [retry policy][Storage.RetryPolicies] in the client SDK handles this automatically.</span></span>
2. <span data-ttu-id="f20f6-467">Az áramköri megszakító mintát mellőzése túlságosan megvalósításához.</span><span class="sxs-lookup"><span data-stu-id="f20f6-467">Implement the Circuit Breaker pattern to avoid overwhelming storage.</span></span>
3. <span data-ttu-id="f20f6-468">Ha N újrapróbálkozási kísérletek sikertelenek, hajtsa végre a szabályos fallback.</span><span class="sxs-lookup"><span data-stu-id="f20f6-468">If N retry attempts fail, perform a graceful fallback.</span></span> <span data-ttu-id="f20f6-469">Példa:</span><span class="sxs-lookup"><span data-stu-id="f20f6-469">For example:</span></span>

   * <span data-ttu-id="f20f6-470">Az adatok tárolása a helyi gyorsítótárba, és továbbítja a írási műveleteket ad ki tárolási később, amikor a szolgáltatás elérhetővé válik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-470">Store the data in a local cache, and forward the writes to storage later, when the service becomes available.</span></span>
   * <span data-ttu-id="f20f6-471">Ha az írási művelet volt, a tranzakciós hatókörű, kártalanítja a tranzakciót.</span><span class="sxs-lookup"><span data-stu-id="f20f6-471">If the write action was in a transactional scope, compensate the transaction.</span></span>

<span data-ttu-id="f20f6-472">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-472">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-473">Használjon [storage mérőszámainak][storage-metrics].</span><span class="sxs-lookup"><span data-stu-id="f20f6-473">Use [storage metrics][storage-metrics].</span></span>

### <a name="reading-data-from-azure-storage-fails"></a><span data-ttu-id="f20f6-474">Azure Storage adatok beolvasása sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-474">Reading data from Azure Storage fails.</span></span>
<span data-ttu-id="f20f6-475">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-475">**Detection**.</span></span> <span data-ttu-id="f20f6-476">Az ügyfél megkapja a hibák olvasásakor.</span><span class="sxs-lookup"><span data-stu-id="f20f6-476">The client receives errors when reading.</span></span>

<span data-ttu-id="f20f6-477">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-477">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-478">Próbálja megismételni a műveletet, helyreállítása az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-478">Retry the operation, to recover from transient failures.</span></span> <span data-ttu-id="f20f6-479">A [újrapróbálkozási házirendet] [ Storage.RetryPolicies] az ügyfél SDK kezeli ezt automatikusan.</span><span class="sxs-lookup"><span data-stu-id="f20f6-479">The [retry policy][Storage.RetryPolicies] in the client SDK handles this automatically.</span></span>
2. <span data-ttu-id="f20f6-480">RA-GRS tárolási Ha az elsődleges végpont olvasása sikertelen, próbálja meg a másodlagos végponti olvasásakor.</span><span class="sxs-lookup"><span data-stu-id="f20f6-480">For RA-GRS storage, if reading from the primary endpoint fails, try reading from the secondary endpoint.</span></span> <span data-ttu-id="f20f6-481">Az ügyfél SDK oldhatja meg automatikusan.</span><span class="sxs-lookup"><span data-stu-id="f20f6-481">The client SDK can handle this automatically.</span></span> <span data-ttu-id="f20f6-482">Lásd: [Azure Storage replikációs][storage-replication].</span><span class="sxs-lookup"><span data-stu-id="f20f6-482">See [Azure Storage replication][storage-replication].</span></span>
3. <span data-ttu-id="f20f6-483">Ha *N* újrapróbálkozási sikertelen kísérlet után, a tartalék tenni szabályosan kezd.</span><span class="sxs-lookup"><span data-stu-id="f20f6-483">If *N* retry attempts fail, take a fallback action to degrade gracefully.</span></span> <span data-ttu-id="f20f6-484">Ha nem lehet beolvasni a termék lemezkép tárolási, például egy általános helyőrző kép megjelenítése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-484">For example, if a product image can't be retrieved from storage, show a generic placeholder image.</span></span>

<span data-ttu-id="f20f6-485">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-485">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-486">Használjon [storage mérőszámainak][storage-metrics].</span><span class="sxs-lookup"><span data-stu-id="f20f6-486">Use [storage metrics][storage-metrics].</span></span>

## <a name="virtual-machine"></a><span data-ttu-id="f20f6-487">Virtuális gép</span><span class="sxs-lookup"><span data-stu-id="f20f6-487">Virtual Machine</span></span>
### <a name="connection-to-a-backend-vm-fails"></a><span data-ttu-id="f20f6-488">A háttér virtuális gép nem sikerül kapcsolódni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-488">Connection to a backend VM fails.</span></span>
<span data-ttu-id="f20f6-489">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-489">**Detection**.</span></span> <span data-ttu-id="f20f6-490">A hálózati csatlakozási hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-490">Network connection errors.</span></span>

<span data-ttu-id="f20f6-491">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-491">**Recovery**</span></span>

* <span data-ttu-id="f20f6-492">Telepítse legalább két háttér virtuális gépek rendelkezésre állási csoportba, a terheléselosztó mögött.</span><span class="sxs-lookup"><span data-stu-id="f20f6-492">Deploy at least two backend VMs in an availability set, behind a load balancer.</span></span>
* <span data-ttu-id="f20f6-493">Ha a kapcsolat hiba átmeneti, néha TCP sikeresen újra fog az üzenet elküldése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-493">If the connection error is transient, sometimes TCP will successfully retry sending the message.</span></span>
* <span data-ttu-id="f20f6-494">Újrapróbálkozási házirendje megvalósítása az alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-494">Implement a retry policy in the application.</span></span>
* <span data-ttu-id="f20f6-495">Állandó vagy nem átmeneti hiba, megvalósítani a [áramköri megszakító] [ circuit-breaker] mintát.</span><span class="sxs-lookup"><span data-stu-id="f20f6-495">For persistent or non-transient errors, implement the [Circuit Breaker][circuit-breaker] pattern.</span></span>
* <span data-ttu-id="f20f6-496">Ha a hívó VM túllépi ezt a hálózati kilépő, a kimenő várólista betelik.</span><span class="sxs-lookup"><span data-stu-id="f20f6-496">If the calling VM exceeds its network egress limit, the outbound queue will fill up.</span></span> <span data-ttu-id="f20f6-497">Ha a kimenő várólista következetesen teljes, fontolja meg a kiterjesztése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-497">If the outbound queue is consistently full, consider scaling out.</span></span>

<span data-ttu-id="f20f6-498">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-498">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-499">Naplózza a szolgáltatáshatárokon történő eseményeket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-499">Log events at service boundaries.</span></span>

### <a name="vm-instance-becomes-unavailable-or-unhealthy"></a><span data-ttu-id="f20f6-500">Virtuálisgép-példány nem érhető el vagy nem megfelelő állapotú lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-500">VM instance becomes unavailable or unhealthy.</span></span>
<span data-ttu-id="f20f6-501">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-501">**Detection**.</span></span> <span data-ttu-id="f20f6-502">Egy terheléskiegyenlítő [állapotmintáihoz] [ lb-probe] , amely jelzi, hogy a Virtuálisgép-példány állapota kifogástalan.</span><span class="sxs-lookup"><span data-stu-id="f20f6-502">Configure a Load Balancer [health probe][lb-probe] that signals whether the VM instance is healthy.</span></span> <span data-ttu-id="f20f6-503">A mintavétel ellenőriznie kell, hogy a kritikus fontosságú funkciók helytelenül válaszol-e.</span><span class="sxs-lookup"><span data-stu-id="f20f6-503">The probe should check whether critical functions are responding correctly.</span></span>

<span data-ttu-id="f20f6-504">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-504">**Recovery**.</span></span> <span data-ttu-id="f20f6-505">Minden alkalmazás szinten több Virtuálisgép-példány üzembe az azonos rendelkezésre állási csoport, és helyezze el a virtuális gépek előtt terheléselosztó.</span><span class="sxs-lookup"><span data-stu-id="f20f6-505">For each application tier, put multiple VM instances into the same availability set, and place a load balancer in front of the VMs.</span></span> <span data-ttu-id="f20f6-506">Ha a állapotmintáihoz sikertelen, a terheléselosztó leállítja az új kapcsolatok küld a nem megfelelő állapotú példány.</span><span class="sxs-lookup"><span data-stu-id="f20f6-506">If the health probe fails, the Load Balancer stops sending new connections to the unhealthy instance.</span></span>

<span data-ttu-id="f20f6-507">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-507">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-508">-Használni kívánt terheléselosztó [analytics jelentkezzen][lb-monitor].</span><span class="sxs-lookup"><span data-stu-id="f20f6-508">- Use Load Balancer [log analytics][lb-monitor].</span></span>

* <span data-ttu-id="f20f6-509">A felügyeleti rendszer figyelheti az összes a állapotfigyelési végpontok konfigurálása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-509">Configure your monitoring system to monitor all of the health monitoring endpoints.</span></span>

### <a name="operator-accidentally-shuts-down-a-vm"></a><span data-ttu-id="f20f6-510">Operátor véletlenül egy virtuális gép leáll.</span><span class="sxs-lookup"><span data-stu-id="f20f6-510">Operator accidentally shuts down a VM.</span></span>
<span data-ttu-id="f20f6-511">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-511">**Detection**.</span></span> <span data-ttu-id="f20f6-512">–</span><span class="sxs-lookup"><span data-stu-id="f20f6-512">N/A</span></span>

<span data-ttu-id="f20f6-513">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-513">**Recovery**.</span></span> <span data-ttu-id="f20f6-514">Állítsa be az erőforrás-zárolást a következő `ReadOnly` szintjét.</span><span class="sxs-lookup"><span data-stu-id="f20f6-514">Set a resource lock with `ReadOnly` level.</span></span> <span data-ttu-id="f20f6-515">Lásd: [erőforrások az Azure Resource Manager zárolása][rm-locks].</span><span class="sxs-lookup"><span data-stu-id="f20f6-515">See [Lock resources with Azure Resource Manager][rm-locks].</span></span>

<span data-ttu-id="f20f6-516">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-516">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-517">Használjon [Azure tevékenységi naplóit][azure-activity-logs].</span><span class="sxs-lookup"><span data-stu-id="f20f6-517">Use [Azure Activity Logs][azure-activity-logs].</span></span>

## <a name="webjobs"></a><span data-ttu-id="f20f6-518">WebJobs</span><span class="sxs-lookup"><span data-stu-id="f20f6-518">WebJobs</span></span>
### <a name="continuous-job-stops-running-when-the-scm-host-is-idle"></a><span data-ttu-id="f20f6-519">Folyamatos feladatot leállítja, ha az SCM állomás üresjáratban.</span><span class="sxs-lookup"><span data-stu-id="f20f6-519">Continuous job stops running when the SCM host is idle.</span></span>
<span data-ttu-id="f20f6-520">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-520">**Detection**.</span></span> <span data-ttu-id="f20f6-521">A webjobs-feladat függvény cancellation tokent átadni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-521">Pass a cancellation token to the WebJob function.</span></span> <span data-ttu-id="f20f6-522">További információkért lásd: [szabályos leállítást][web-jobs-shutdown].</span><span class="sxs-lookup"><span data-stu-id="f20f6-522">For more information, see [Graceful shutdown][web-jobs-shutdown].</span></span>

<span data-ttu-id="f20f6-523">**Helyreállítási**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-523">**Recovery**.</span></span> <span data-ttu-id="f20f6-524">Engedélyezze a `Always On` a webalkalmazás-ban történő beállítását.</span><span class="sxs-lookup"><span data-stu-id="f20f6-524">Enable the `Always On` setting in the web app.</span></span> <span data-ttu-id="f20f6-525">További információkért lásd: [háttérfeladatok futtatása a webjobs-feladatok][web-jobs].</span><span class="sxs-lookup"><span data-stu-id="f20f6-525">For more information, see [Run Background tasks with WebJobs][web-jobs].</span></span>

## <a name="application-design"></a><span data-ttu-id="f20f6-526">Alkalmazás tervezése</span><span class="sxs-lookup"><span data-stu-id="f20f6-526">Application design</span></span>
### <a name="application-cant-handle-a-spike-in-incoming-requests"></a><span data-ttu-id="f20f6-527">Alkalmazás nem tudja kezelni a csúcs az igények bejövő kérelmeket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-527">Application can't handle a spike in incoming requests.</span></span>
<span data-ttu-id="f20f6-528">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-528">**Detection**.</span></span> <span data-ttu-id="f20f6-529">Az alkalmazás függ.</span><span class="sxs-lookup"><span data-stu-id="f20f6-529">Depends on the application.</span></span> <span data-ttu-id="f20f6-530">Tipikus jelenségek:</span><span class="sxs-lookup"><span data-stu-id="f20f6-530">Typical symptoms:</span></span>

* <span data-ttu-id="f20f6-531">A webhely elindul, HTTP 5xx hibakódok ad vissza.</span><span class="sxs-lookup"><span data-stu-id="f20f6-531">The website starts returning HTTP 5xx error codes.</span></span>
* <span data-ttu-id="f20f6-532">Függő szolgáltatások, például az adatbázis vagy a tárolási, adatátviteli kérések megkezdése.</span><span class="sxs-lookup"><span data-stu-id="f20f6-532">Dependent services, such as database or storage, start to throttle requests.</span></span> <span data-ttu-id="f20f6-533">Keresse meg a HTTP-hibák HTTP 429 (túl sok kérelem), például attól függően, hogy a szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="f20f6-533">Look for HTTP errors such as HTTP 429 (Too Many Requests), depending on the service.</span></span>
* <span data-ttu-id="f20f6-534">HTTP-várólista hossza nő.</span><span class="sxs-lookup"><span data-stu-id="f20f6-534">HTTP queue length grows.</span></span>

<span data-ttu-id="f20f6-535">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-535">**Recovery**</span></span>

* <span data-ttu-id="f20f6-536">Terjessze ki a megnövekedett terhelés kezelése érdekében.</span><span class="sxs-lookup"><span data-stu-id="f20f6-536">Scale out to handle increased load.</span></span>
* <span data-ttu-id="f20f6-537">Kerülje az egymásra épülő hibák megzavarhatják a teljes alkalmazás sikertelen mérsékelni.</span><span class="sxs-lookup"><span data-stu-id="f20f6-537">Mitigate failures to avoid having cascading failures disrupt the entire application.</span></span> <span data-ttu-id="f20f6-538">Megoldás stratégiák a következők:</span><span class="sxs-lookup"><span data-stu-id="f20f6-538">Mitigation strategies include:</span></span>

  * <span data-ttu-id="f20f6-539">Alkalmazzon a [sávszélesség-szabályozás mintát] [ throttling-pattern] túlságosan háttérrendszerek elkerülése érdekében.</span><span class="sxs-lookup"><span data-stu-id="f20f6-539">Implement the [Throttling Pattern][throttling-pattern] to avoid overwhelming backend systems.</span></span>
  * <span data-ttu-id="f20f6-540">Használja [várólista alapú terhelés simítás] [ queue-based-load-leveling] puffer kérelmek és egy megfelelő ütemben dolgozza fel őket.</span><span class="sxs-lookup"><span data-stu-id="f20f6-540">Use [queue-based load leveling][queue-based-load-leveling] to buffer requests and process them at an appropriate pace.</span></span>
  * <span data-ttu-id="f20f6-541">Egyes ügyfelek sorrendet.</span><span class="sxs-lookup"><span data-stu-id="f20f6-541">Prioritize certain clients.</span></span> <span data-ttu-id="f20f6-542">Például ha az alkalmazás ingyenes és fizetős rétegek, sávszélesség-szabályozási ügyfelek a ingyenes szint, de nem fizetős ügyfelek.</span><span class="sxs-lookup"><span data-stu-id="f20f6-542">For example, if the application has free and paid tiers, throttle customers on the free tier, but not paid customers.</span></span> <span data-ttu-id="f20f6-543">Lásd: [prioritású várólista mintát][priority-queue-pattern].</span><span class="sxs-lookup"><span data-stu-id="f20f6-543">See [Priority queue pattern][priority-queue-pattern].</span></span>

<span data-ttu-id="f20f6-544">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-544">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-545">Használjon [App Service diagnosztikai naplózás][app-service-logging].</span><span class="sxs-lookup"><span data-stu-id="f20f6-545">Use [App Service diagnostic logging][app-service-logging].</span></span> <span data-ttu-id="f20f6-546">Használjon például egy szolgáltatás [Azure Naplóelemzés][azure-log-analytics], [Application Insights][app-insights], vagy [New Relic] [ new-relic] a diagnosztikai naplók megismeréséhez.</span><span class="sxs-lookup"><span data-stu-id="f20f6-546">Use a service such as [Azure Log Analytics][azure-log-analytics], [Application Insights][app-insights], or [New Relic][new-relic] to help understand the diagnostic logs.</span></span>

### <a name="one-of-the-operations-in-a-workflow-or-distributed-transaction-fails"></a><span data-ttu-id="f20f6-547">A műveletek a munkafolyamat vagy az elosztott tranzakciók nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="f20f6-547">One of the operations in a workflow or distributed transaction fails.</span></span>
<span data-ttu-id="f20f6-548">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-548">**Detection**.</span></span> <span data-ttu-id="f20f6-549">Miután *N* újrapróbálkozási kísérletek, továbbra is sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-549">After *N* retry attempts, it still fails.</span></span>

<span data-ttu-id="f20f6-550">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-550">**Recovery**</span></span>

* <span data-ttu-id="f20f6-551">A kezelési terv hajtja végre a [Feladatütemező ügynök felügyelő] [ scheduler-agent-supervisor] kezelése a teljes munkafolyamat mintát.</span><span class="sxs-lookup"><span data-stu-id="f20f6-551">As a mitigation plan, implement the [Scheduler Agent Supervisor][scheduler-agent-supervisor] pattern to manage the entire workflow.</span></span>
* <span data-ttu-id="f20f6-552">Az időtúllépések nem próbálja újra.</span><span class="sxs-lookup"><span data-stu-id="f20f6-552">Don't retry on timeouts.</span></span> <span data-ttu-id="f20f6-553">Ezt a hibát egy alacsony sikerességi arányát van.</span><span class="sxs-lookup"><span data-stu-id="f20f6-553">There is a low success rate for this error.</span></span>
* <span data-ttu-id="f20f6-554">Besorolni a munkaelemet, ahhoz, hogy később próbálja meg újra.</span><span class="sxs-lookup"><span data-stu-id="f20f6-554">Queue work, in order to retry later.</span></span>

<span data-ttu-id="f20f6-555">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-555">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-556">Minden művelet (sikeres és sikertelen), beleértve a compensating műveletek naplózása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-556">Log all operations (successful and failed), including compensating actions.</span></span> <span data-ttu-id="f20f6-557">Korrelációs azonosítót használja, így ugyanazon a tranzakción belül minden műveletet nyomon követheti.</span><span class="sxs-lookup"><span data-stu-id="f20f6-557">Use correlation IDs, so that you can track all operations within the same transaction.</span></span>

### <a name="a-call-to-a-remote-service-fails"></a><span data-ttu-id="f20f6-558">A távoli szolgáltatás hívása sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="f20f6-558">A call to a remote service fails.</span></span>
<span data-ttu-id="f20f6-559">**Észlelési**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-559">**Detection**.</span></span> <span data-ttu-id="f20f6-560">HTTP-hibakódot.</span><span class="sxs-lookup"><span data-stu-id="f20f6-560">HTTP error code.</span></span>

<span data-ttu-id="f20f6-561">**Helyreállítás**</span><span class="sxs-lookup"><span data-stu-id="f20f6-561">**Recovery**</span></span>

1. <span data-ttu-id="f20f6-562">Ismételje meg az átmeneti hibák.</span><span class="sxs-lookup"><span data-stu-id="f20f6-562">Retry on transient failures.</span></span>
2. <span data-ttu-id="f20f6-563">Ha a hívás sikertelen után *N* kísérleteket, egy tartalék művelet végrehajtása.</span><span class="sxs-lookup"><span data-stu-id="f20f6-563">If the call fails after *N* attempts, take a fallback action.</span></span> <span data-ttu-id="f20f6-564">(Alkalmazás adott.)</span><span class="sxs-lookup"><span data-stu-id="f20f6-564">(Application specific.)</span></span>
3. <span data-ttu-id="f20f6-565">Alkalmazzon a [áramköri megszakító mintát] [ circuit-breaker] kaszkádolt hibák elkerülése érdekében.</span><span class="sxs-lookup"><span data-stu-id="f20f6-565">Implement the [Circuit Breaker pattern][circuit-breaker] to avoid cascading failures.</span></span>

<span data-ttu-id="f20f6-566">**Diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="f20f6-566">**Diagnostics**.</span></span> <span data-ttu-id="f20f6-567">A naplófájl minden távoli hívás sikertelen.</span><span class="sxs-lookup"><span data-stu-id="f20f6-567">Log all remote call failures.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f20f6-568">További lépések</span><span class="sxs-lookup"><span data-stu-id="f20f6-568">Next steps</span></span>
<span data-ttu-id="f20f6-569">A FMA folyamattal kapcsolatos további információkért lásd: [rugalmas kialakítás a felhőszolgáltatások] [ resilience-by-design-pdf] (PDF-fájl letöltése).</span><span class="sxs-lookup"><span data-stu-id="f20f6-569">For more information about the FMA process, see [Resilience by design for cloud services][resilience-by-design-pdf] (PDF download).</span></span>

<!-- links -->

[api-management]: https://azure.microsoft.com/documentation/services/api-management/
[api-management-throttling]: /azure/api-management/api-management-sample-flexible-throttling/
[app-insights]: /azure/application-insights/app-insights-overview/
[app-insights-web-apps]: /azure/application-insights/app-insights-azure-web-apps/
[app-service-configure]: /azure/app-service-web/web-sites-configure/
[app-service-logging]: /azure/app-service-web/web-sites-enable-diagnostic-log/
[app-service-slots]: /azure/app-service-web/web-sites-staged-publishing/
[auto-rest-client-retry]: https://github.com/Azure/autorest/tree/master/docs
[azure-activity-logs]: /azure/monitoring-and-diagnostics/monitoring-overview-activity-logs/
[azure-alerts]: /azure/monitoring-and-diagnostics/insights-alerts-portal/
[azure-log-analytics]: /azure/log-analytics/log-analytics-overview/
[BrokeredMessage.TimeToLive]: https://msdn.microsoft.com/library/microsoft.servicebus.messaging.brokeredmessage.timetolive.aspx
[cassandra-error-handling]: http://www.datastax.com/dev/blog/cassandra-error-handling-done-right
[circuit-breaker]: https://msdn.microsoft.com/library/dn589784.aspx
[cosmosdb-multi-region]: /azure/cosmos-db/tutorial-global-distribution-sql-api
[elasticsearch-azure]: ../elasticsearch/index.md
[elasticsearch-client]: https://www.elastic.co/guide/en/elasticsearch/client/index.html
[health-endpoint-monitoring-pattern]: https://msdn.microsoft.com/library/dn589789.aspx
[onstop-events]: https://azure.microsoft.com/blog/the-right-way-to-handle-azure-onstop-events/
[lb-monitor]: /azure/load-balancer/load-balancer-monitor-log/
[lb-probe]: /azure/load-balancer/load-balancer-custom-probe-overview/#learn-about-the-types-of-probes
[new-relic]: https://newrelic.com/
[priority-queue-pattern]: https://msdn.microsoft.com/library/dn589794.aspx
[queue-based-load-leveling]: https://msdn.microsoft.com/library/dn589783.aspx
[QuotaExceededException]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.quotaexceededexception.aspx
[ra-web-apps-basic]: ../reference-architectures/app-service-web-app/basic-web-app.md
[redis-monitor]: /azure/redis-cache/cache-how-to-monitor/
[redis-retry]: ../best-practices/retry-service-specific.md#azure-redis-cache-retry-guidelines
[resilience-by-design-pdf]: http://download.microsoft.com/download/D/8/C/D8C599A4-4E8A-49BF-80EE-FE35F49B914D/Resilience_by_Design_for_Cloud_Services_White_Paper.pdf
[RoleEntryPoint.OnStop]: https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx
[RoleEnvironment.Stopping]: https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx
[rm-locks]: /azure/azure-resource-manager/resource-group-lock-resources/
[sb-dead-letter-queue]: /azure/service-bus-messaging/service-bus-dead-letter-queues/
[sb-georeplication-sample]: https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/GeoReplication
[sb-messagingexception-class]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingexception.aspx
[sb-messaging-exceptions]: /azure/service-bus-messaging/service-bus-messaging-exceptions/
[sb-outages]: /azure/service-bus-messaging/service-bus-outages-disasters/#protecting-queues-and-topics-against-datacenter-outages-or-disasters
[sb-partition]: /azure/service-bus-messaging/service-bus-partitioning/
[sb-poison-message]: /azure/app-service-web/websites-dotnet-webjobs-sdk-storage-queues-how-to/#poison
[sb-retry]: ../best-practices/retry-service-specific.md#service-bus-retry-guidelines
[search-sdk]: https://msdn.microsoft.com/library/dn951165.aspx
[scheduler-agent-supervisor]: https://msdn.microsoft.com/library/dn589780.aspx
[search-analytics]: /azure/search/search-traffic-analytics/
[sql-db-audit]: /azure/sql-database/sql-database-auditing-get-started/
[sql-db-errors]: /azure/sql-database/sql-database-develop-error-messages/#resource-governance-errors
[sql-db-failover]: /azure/sql-database/sql-database-geo-replication-failover-portal/
[sql-db-limits]: /azure/sql-database/sql-database-resource-limits/
[sql-db-replication]: /azure/sql-database/sql-database-geo-replication-overview/
[storage-metrics]: https://msdn.microsoft.com/library/dn782843.aspx
[storage-replication]: /azure/storage/storage-redundancy/
[Storage.RetryPolicies]: https://msdn.microsoft.com/library/microsoft.windowsazure.storage.retrypolicies.aspx
[sys.event_log]: https://msdn.microsoft.com/library/dn270018.aspx
[throttling-pattern]: https://msdn.microsoft.com/library/dn589798.aspx
[web-jobs]: /azure/app-service-web/web-sites-create-web-jobs/
[web-jobs-shutdown]: /azure/app-service-web/websites-dotnet-webjobs-sdk-storage-queues-how-to/#graceful
