---
title: Rugalmas alkalmazások tervezése az Azure-hoz
description: Rugalmas alkalmazások felépítése az Azure-ban magas rendelkezésre álláshoz és vészhelyreállításhoz.
author: MikeWasson
ms.date: 12/18/2018
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.custom: resiliency
ms.openlocfilehash: ba3637ce90b793425b1238ee0d99d36a936da6ca
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: hu-HU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54488596"
---
# <a name="designing-resilient-applications-for-azure"></a><span data-ttu-id="a8e64-103">Rugalmas alkalmazások tervezése az Azure-hoz</span><span class="sxs-lookup"><span data-stu-id="a8e64-103">Designing resilient applications for Azure</span></span>

<span data-ttu-id="a8e64-104">Az elosztott rendszerekben időnként fellépnek hibák.</span><span class="sxs-lookup"><span data-stu-id="a8e64-104">In a distributed system, failures will happen.</span></span> <span data-ttu-id="a8e64-105">Meghibásodhatnak a hardverek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-105">Hardware can fail.</span></span> <span data-ttu-id="a8e64-106">Átmeneti hibák lehetnek a hálózaton.</span><span class="sxs-lookup"><span data-stu-id="a8e64-106">The network can have transient failures.</span></span> <span data-ttu-id="a8e64-107">Ritkán a teljes szolgáltatásban vagy régióban üzemszünet állhat elő, de ezekre is fel kell készülni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-107">Rarely, an entire service or region may experience a disruption, but even those must be planned for.</span></span>

<span data-ttu-id="a8e64-108">A megbízható alkalmazások felhőben való felépítése különbözik a vállalati környezetben való felépítésüktől.</span><span class="sxs-lookup"><span data-stu-id="a8e64-108">Building a reliable application in the cloud is different than building a reliable application in an enterprise setting.</span></span> <span data-ttu-id="a8e64-109">Míg régebben megoldást jelenthetett, ha jobb minőségű hardvert vett a vertikális felskálázás érdekében, a felhőalapú környezetekben ehelyett horizontálisan kell felskáláznia.</span><span class="sxs-lookup"><span data-stu-id="a8e64-109">While historically you may have purchased higher-end hardware to scale up, in a cloud environment you must scale out instead of scaling up.</span></span> <span data-ttu-id="a8e64-110">A felhőalapú környezetek költségei a közös hardverek használata révén alacsonyan tartható.</span><span class="sxs-lookup"><span data-stu-id="a8e64-110">Costs for cloud environments are kept low through the use of commodity hardware.</span></span> <span data-ttu-id="a8e64-111">Az összes hiba megakadályozása helyett a cél a hibák hatásának minimálisra csökkentése a rendszerben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-111">Instead of trying to prevent failures altogether, the goal is to minimize the effects of a failure within the system.</span></span>

<span data-ttu-id="a8e64-112">Ez a cikk a rugalmas alkalmazások a Microsoft Azure-ban történő felépítését ismerteti.</span><span class="sxs-lookup"><span data-stu-id="a8e64-112">This article provides an overview of how to build resilient applications in Microsoft Azure.</span></span> <span data-ttu-id="a8e64-113">A cikk a *rugalmasság* és a kapcsolódó fogalmak ismertetésével kezdődik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-113">It starts with a definition of the term *resiliency* and related concepts.</span></span> <span data-ttu-id="a8e64-114">Ezután ismerteti a rugalmasság elérésének egy, a tervezéstől és implementálástól a központi telepítésig és üzemeltetésig terjedő folyamatát, amely az alkalmazások élettartama során strukturált megközelítést használ.</span><span class="sxs-lookup"><span data-stu-id="a8e64-114">Then it describes a process for achieving resiliency, using a structured approach over the lifetime of an application, from design and implementation to deployment and operations.</span></span>

<!-- markdownlint-disable MD026 -->

## <a name="what-is-resiliency"></a><span data-ttu-id="a8e64-115">Mi a rugalmasság?</span><span class="sxs-lookup"><span data-stu-id="a8e64-115">What is resiliency?</span></span>

<!-- markdownlint-enable MD026 -->

<span data-ttu-id="a8e64-116">A **rugalmasság** a rendszer azon képessége, hogy helyreálljon a hibák után, és folytassa a működést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-116">**Resiliency** is the ability of a system to recover from failures and continue to function.</span></span> <span data-ttu-id="a8e64-117">Nem a hibák *elkerüléséről* szól, hanem a hibákra adott olyan *válaszokról*, amelyek kiküszöbölik az állásidőt és az adatveszteséget.</span><span class="sxs-lookup"><span data-stu-id="a8e64-117">It's not about *avoiding* failures, but *responding* to failures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="a8e64-118">A rugalmasság célja, hogy az alkalmazás egy hibát követően teljesen működőképes állapotba térjen vissza.</span><span class="sxs-lookup"><span data-stu-id="a8e64-118">The goal of resiliency is to return the application to a fully functioning state following a failure.</span></span>

<span data-ttu-id="a8e64-119">A rugalmasság két fontos szempontja a magas rendelkezésre állás és a vészhelyreállítás.</span><span class="sxs-lookup"><span data-stu-id="a8e64-119">Two important aspects of resiliency are high availability and disaster recovery.</span></span>

- <span data-ttu-id="a8e64-120">A **magas rendelkezésre állás** az alkalmazás azon képessége, amellyel kifogástalan állapotban tudja folytatni a működést, jelentős állásidő nélkül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-120">**High availability** (HA) is the ability of the application to continue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="a8e64-121">A „kifogástalan állapot” alatt azt értjük, hogy az alkalmazás válaszol, és a felhasználók csatlakozni tudnak az alkalmazáshoz, valamint használni tudják azt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-121">By "healthy state," we mean the application is responsive, and users can connect to the application and interact with it.</span></span>  
- <span data-ttu-id="a8e64-122">A **vészhelyreállítás** a ritka, de nagyobb incidensekből való helyreállítás képessége: ezek nem átmeneti, széleskörű hibák, például a szolgáltatás megszakadása, ami hatással van egy teljes régióra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-122">**Disaster recovery** (DR) is the ability to recover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="a8e64-123">A vészhelyreállításba tartozik az adatok biztonsági mentése és archiválása, és manuális beavatkozást foglalhat magába, például az adatbázis biztonsági mentésből való helyreállítását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-123">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="a8e64-124">A magas rendelkezésre állás és a vészhelyreállítás úgy képzelhető el a legegyszerűbben, hogy a vészhelyreállítás akkor kezdődik, amikor a hiba hatása nagyobb annál, mint amit a magas rendelkezésre állás kezelni képes.</span><span class="sxs-lookup"><span data-stu-id="a8e64-124">One way to think about HA versus DR is that DR starts when the impact of a fault exceeds the ability of the HA design to handle it.</span></span>  

<span data-ttu-id="a8e64-125">Amikor rugalmasságra törekszik a tervezéskor, ismernie kell a rendelkezésre állási követelményeket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-125">When you design resiliency, you must understand your availability requirements.</span></span> <span data-ttu-id="a8e64-126">Mennyi állásidő fogadható el?</span><span class="sxs-lookup"><span data-stu-id="a8e64-126">How much downtime is acceptable?</span></span> <span data-ttu-id="a8e64-127">Ez részben a költség függvénye.</span><span class="sxs-lookup"><span data-stu-id="a8e64-127">This is partly a function of cost.</span></span> <span data-ttu-id="a8e64-128">Mennyibe kerül a lehetséges állásidő az üzletének?</span><span class="sxs-lookup"><span data-stu-id="a8e64-128">How much will potential downtime cost your business?</span></span> <span data-ttu-id="a8e64-129">Mennyit kell befektetnie az alkalmazás magas rendelkezésre állásúvá tételéhez?</span><span class="sxs-lookup"><span data-stu-id="a8e64-129">How much should you invest in making the application highly available?</span></span> <span data-ttu-id="a8e64-130">Azt is meg kell határoznia, hogy mit jelent az alkalmazás rendelkezésre állása.</span><span class="sxs-lookup"><span data-stu-id="a8e64-130">You also have to define what it means for the application to be available.</span></span> <span data-ttu-id="a8e64-131">Az alkalmazás „üzemen kívül” van-e, ha egy ügyfél el tud küldeni egy rendelést, de a rendszer nem tudja feldolgozni azt a normál időkereten belül?</span><span class="sxs-lookup"><span data-stu-id="a8e64-131">For example, is the application "down" if a customer can submit an order but the system cannot process it within the normal timeframe?</span></span> <span data-ttu-id="a8e64-132">Egy bizonyos típusú üzemszünet előfordulásának esélyét is vegye figyelembe, valamint hogy a kockázatcsökkentési stratégia költséghatékony-e.</span><span class="sxs-lookup"><span data-stu-id="a8e64-132">Also consider the probability of a particular type of outage occurring, and whether a mitigation strategy is cost-effective.</span></span>

<span data-ttu-id="a8e64-133">Egy másik gyakori kifejezés az **üzletmenet folytonossága**, amely kedvezőtlen feltételek, például természeti katasztrófa vagy egy szolgáltatás kiesése alatt és után az alapvető üzleti funkciók elvégzésének képességét jelenti.</span><span class="sxs-lookup"><span data-stu-id="a8e64-133">Another common term is **business continuity** (BC), which is the ability to perform essential business functions during and after adverse conditions, such as a natural disaster or a downed service.</span></span> <span data-ttu-id="a8e64-134">Az üzletmenet folytonosságába beletartozik az üzlet teljes működése, beleértve a fizikai létesítményeket, a személyeket, a kommunikációt, a szállítást és az informatikát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-134">BC covers the entire operation of the business, including physical facilities, people, communications, transportation, and IT.</span></span> <span data-ttu-id="a8e64-135">Ez a cikk a felhőalapú alkalmazásokra összpontosít, de a rugalmasság tervezését az általános üzletmenet-folytonossági követelményeket figyelembe véve kell elvégezni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-135">This article focuses on cloud applications, but resilience planning must be done in the context of overall BC requirements.</span></span>

<span data-ttu-id="a8e64-136">Az **adatok biztonsági mentése** a DR kritikus része.</span><span class="sxs-lookup"><span data-stu-id="a8e64-136">**Data backup** is a critical part of DR.</span></span> <span data-ttu-id="a8e64-137">Ha egy alkalmazás állapot nélküli összetevői meghibásodnak, mindig újból üzembe helyezheti őket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-137">If the stateless components of an application fail, you can always redeploy them.</span></span> <span data-ttu-id="a8e64-138">Adatvesztés esetén azonban a rendszer nem tud visszatérni stabil állapotba.</span><span class="sxs-lookup"><span data-stu-id="a8e64-138">But if data is lost, the system can't return to a stable state.</span></span> <span data-ttu-id="a8e64-139">Az adatokról biztonsági mentést kell készíteni, ideális esetben egy másik régióban, egy egész régióra kiterjedő katasztrófa esetére.</span><span class="sxs-lookup"><span data-stu-id="a8e64-139">Data must be backed up, ideally in a different region in case of a region-wide disaster.</span></span>

<span data-ttu-id="a8e64-140">A biztonsági mentés nem azonos az *adatreplikációval*.</span><span class="sxs-lookup"><span data-stu-id="a8e64-140">Backup is distinct from *data replication*.</span></span> <span data-ttu-id="a8e64-141">Adatreplikáció esetén az adatok másolása szinte valós időben történik, hogy a rendszer gyorsan átadhassa a műveleteket egy replikának.</span><span class="sxs-lookup"><span data-stu-id="a8e64-141">Data replication involves copying data in near-real-time, so that the system can fail over quickly to a replica.</span></span> <span data-ttu-id="a8e64-142">Számos adatbázisrendszer támogatja a replikálást, például az SQL Server támogatja az SQL Server Always On rendelkezésre állási csoportokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-142">Many databases systems support replication; for example, SQL Server supports SQL Server Always On Availability Groups.</span></span> <span data-ttu-id="a8e64-143">Az adatreplikáció csökkentheti a kimaradás utáni helyreálláshoz szükséges időt, mivel biztosítja, hogy az adatok replikája mindig készenlétben legyen.</span><span class="sxs-lookup"><span data-stu-id="a8e64-143">Data replication can reduce how long it takes to recover from an outage, by ensuring that a replica of the data is always standing by.</span></span> <span data-ttu-id="a8e64-144">Az adatreplikáció azonban nem véd az emberi hibák ellen.</span><span class="sxs-lookup"><span data-stu-id="a8e64-144">However, data replication won't protect against human error.</span></span> <span data-ttu-id="a8e64-145">Ha az adatok emberi hiba miatt sérülnek, ezek a sérült adatok egyszerűen átmásolódnak a replikákba.</span><span class="sxs-lookup"><span data-stu-id="a8e64-145">If data gets corrupted because of human error, the corrupted data just gets copied to the replicas.</span></span> <span data-ttu-id="a8e64-146">Ezért a DR-stratégiájának tartalmaznia kell a hosszú távú biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-146">Therefore, you still need to include long-term backup in your DR strategy.</span></span>

## <a name="process-to-achieve-resiliency"></a><span data-ttu-id="a8e64-147">A rugalmasság elérésének folyamata</span><span class="sxs-lookup"><span data-stu-id="a8e64-147">Process to achieve resiliency</span></span>

<span data-ttu-id="a8e64-148">A rugalmasság nem kezelhető bővítményként.</span><span class="sxs-lookup"><span data-stu-id="a8e64-148">Resiliency is not an add-on.</span></span> <span data-ttu-id="a8e64-149">A rendszer integrált részeként kell megtervezni, és a gyakorlat részévé kell tenni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-149">It must be designed into the system and put into operational practice.</span></span> <span data-ttu-id="a8e64-150">Itt láthat egy általános modellt, amelyet követhet:</span><span class="sxs-lookup"><span data-stu-id="a8e64-150">Here is a general model to follow:</span></span>

1. <span data-ttu-id="a8e64-151">Az üzleti igények alapján **határozza meg** a rendelkezésreállási követelményeit.</span><span class="sxs-lookup"><span data-stu-id="a8e64-151">**Define** your availability requirements, based on business needs.</span></span>
2. <span data-ttu-id="a8e64-152">**Tervezze meg** az alkalmazást a rugalmassághoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-152">**Design** the application for resiliency.</span></span> <span data-ttu-id="a8e64-153">Olyan architektúrával kezdjen, amely bevált gyakorlatokat követ, majd azonosítsa az architektúrában a lehetséges hibapontokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-153">Start with an architecture that follows proven practices, and then identify the possible failure points in that architecture.</span></span>
3. <span data-ttu-id="a8e64-154">**Implementáljon** stratégiákat a hibák észleléséhez és az azokból való helyreálláshoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-154">**Implement** strategies to detect and recover from failures.</span></span>
4. <span data-ttu-id="a8e64-155">**Tesztelje** az implementálást a hibák szimulálásával és kényszerített feladatátvételek aktiválásával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-155">**Test** the implementation by simulating faults and triggering forced failovers.</span></span>
5. <span data-ttu-id="a8e64-156">**Helyezze üzembe** az alkalmazást egy megbízható, megismételhető folyamattal.</span><span class="sxs-lookup"><span data-stu-id="a8e64-156">**Deploy** the application into production using a reliable, repeatable process.</span></span>
6. <span data-ttu-id="a8e64-157">**Monitorozza** az alkalmazást a hibák észlelése érdekében.</span><span class="sxs-lookup"><span data-stu-id="a8e64-157">**Monitor** the application to detect failures.</span></span> <span data-ttu-id="a8e64-158">A rendszer monitorozásával felmérheti az alkalmazás állapotát, és szükség esetén válaszolhat az incidensekre.</span><span class="sxs-lookup"><span data-stu-id="a8e64-158">By monitoring the system, you can gauge the health of the application and respond to incidents if necessary.</span></span>
7. <span data-ttu-id="a8e64-159">**Tegyen intézkedéseket**, ha manuális beavatkozást igénylő hibák fordulnak elő.</span><span class="sxs-lookup"><span data-stu-id="a8e64-159">**Respond** if there are failure that require manual interventions.</span></span>

<span data-ttu-id="a8e64-160">A cikk további részében részletesebben tárgyaljuk az egyes lépéseket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-160">In the remainder of this article, we discuss each of these steps in more detail.</span></span>

## <a name="define-your-availability-requirements"></a><span data-ttu-id="a8e64-161">A rendelkezésreállási követelmények meghatározása</span><span class="sxs-lookup"><span data-stu-id="a8e64-161">Define your availability requirements</span></span>

<span data-ttu-id="a8e64-162">A rugalmasság tervezése az üzleti követelményekkel kezdődik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-162">Resiliency planning starts with business requirements.</span></span> <span data-ttu-id="a8e64-163">Az alábbiakban néhány olyan módszert találhat, amelyek bemutatják, miként veheti figyelembe a rugalmasságot ezeket a szempontokat szem előtt tartva.</span><span class="sxs-lookup"><span data-stu-id="a8e64-163">Here are some approaches for thinking about resiliency in those terms.</span></span>

### <a name="decompose-by-workload"></a><span data-ttu-id="a8e64-164">Felbontás számítási feladat alapján</span><span class="sxs-lookup"><span data-stu-id="a8e64-164">Decompose by workload</span></span>

<span data-ttu-id="a8e64-165">Sok felhőalapú megoldás több számítási feladatból áll.</span><span class="sxs-lookup"><span data-stu-id="a8e64-165">Many cloud solutions consist of multiple application workloads.</span></span> <span data-ttu-id="a8e64-166">Ebben a környezetben a „számítási feladat” kifejezés olyan különálló képességet vagy számítási feladatot jelent, amely logikusan elválasztható más feladatoktól az üzleti logika és az adattárolási követelmények szerint.</span><span class="sxs-lookup"><span data-stu-id="a8e64-166">The term "workload" in this context means a discrete capability or computing task, which can be logically separated from other tasks, in terms of business logic and data storage requirements.</span></span> <span data-ttu-id="a8e64-167">Egy e-kereskedelmi alkalmazás például a következő számítási feladatokat tartalmazhatja:</span><span class="sxs-lookup"><span data-stu-id="a8e64-167">For example, an e-commerce app might include the following workloads:</span></span>

- <span data-ttu-id="a8e64-168">Termékkatalógus tallózása és keresés.</span><span class="sxs-lookup"><span data-stu-id="a8e64-168">Browse and search a product catalog.</span></span>
- <span data-ttu-id="a8e64-169">Rendelések létrehozása és nyomon követése.</span><span class="sxs-lookup"><span data-stu-id="a8e64-169">Create and track orders.</span></span>
- <span data-ttu-id="a8e64-170">Javaslatok megtekintése.</span><span class="sxs-lookup"><span data-stu-id="a8e64-170">View recommendations.</span></span>

<span data-ttu-id="a8e64-171">E számítási feladatok különböző követelményekkel rendelkezhetnek a rendelkezésre állás, a skálázhatóság, az adatkonzisztencia és a vészhelyreállítás alapján.</span><span class="sxs-lookup"><span data-stu-id="a8e64-171">These workloads might have different requirements for availability, scalability, data consistency, and disaster recovery.</span></span> <span data-ttu-id="a8e64-172">Olyan üzleti döntéseket szükséges meghozni, amelyek a költségek és a kockázatok kiegyenlítésére vonatkoznak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-172">There are business decisions to be made in terms of balancing cost versus risk.</span></span>

<span data-ttu-id="a8e64-173">A használati mintákat is érdemes figyelembe venni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-173">Also consider usage patterns.</span></span> <span data-ttu-id="a8e64-174">Vannak bizonyos kritikus időszakok, amikor a rendszernek elérhetőnek kell lennie?</span><span class="sxs-lookup"><span data-stu-id="a8e64-174">Are there certain critical periods when the system must be available?</span></span> <span data-ttu-id="a8e64-175">Egy adóbevallást készítő szolgáltatás például nem állhat le közvetlenül a bevallás elküldésének határideje előtt, egy videóstreamelő szolgáltatásnak pedig működnie kell egy nagy sportesemény alatt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-175">For example, a tax-filing service can't go down right before the filing deadline, a video streaming service must stay up during a big sports event, and so on.</span></span> <span data-ttu-id="a8e64-176">A kritikus időszakok alatt létesíthet redundáns üzemelő példányokat több régióban, így az alkalmazás feladatátvétele akkor is biztosított, ha az egyik régió meghibásodik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-176">During the critical periods, you might have redundant deployments across several regions, so the application could fail over if one region failed.</span></span> <span data-ttu-id="a8e64-177">Ám mivel a több régióból álló üzemelő példányok fenntartása költségesebb lehet, ezért a kevésbé kritikus időkben egyetlen régióban futtathatja az alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="a8e64-177">However, a multi-region deployment is potentially more expensive, so during less critical times, you might run the application in a single region.</span></span> <span data-ttu-id="a8e64-178">Bizonyos esetekben a további költségek csökkenthetők olyan modern, kiszolgáló nélküli technológiákkal, amelyek használatalapú számlázást alkalmaznak, így a kihasználatlan számítási erőforrásokért nem kell fizetnie.</span><span class="sxs-lookup"><span data-stu-id="a8e64-178">In some cases, the additional expense can be mitigated by using modern serverless techniques, which use consumption-based billing, so you are not charged for under-utilitzed compute resources.</span></span>

### <a name="rto-and-rpo"></a><span data-ttu-id="a8e64-179">RTO és RPO</span><span class="sxs-lookup"><span data-stu-id="a8e64-179">RTO and RPO</span></span>

<span data-ttu-id="a8e64-180">Két fontos mérőszámot érdemes figyelembe vennie: a helyreállítási időre vonatkozó célkitűzést és a helyreállítási időkorlátot, mivel ezek a vészhelyreállításhoz tartoznak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-180">Two important metrics to consider are the recovery time objective and recovery point objective, as they pertain to disaster recovery.</span></span>

- <span data-ttu-id="a8e64-181">A **helyreállítási időre vonatkozó célkitűzés** (RTO) az a maximális elfogadható idő, ameddig egy alkalmazás elérhetetlen maradhat egy incidens után.</span><span class="sxs-lookup"><span data-stu-id="a8e64-181">**Recovery time objective** (RTO) is the maximum acceptable time that an application can be unavailable after an incident.</span></span> <span data-ttu-id="a8e64-182">Ha az RTO 90 perc, akkor a katasztrófa kezdetétől számított 90 percen belül helyre kell tudnia állítani az alkalmazás futó állapotát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-182">If your RTO is 90 minutes, you must be able to restore the application to a running state within 90 minutes from the start of a disaster.</span></span> <span data-ttu-id="a8e64-183">Ha nagyon alacsony RTO-val kell számolnia, készenléti módban tarthat egy aktív/passzív konfigurációt futtató második regionális üzemelő példányt, amely védelmet nyújt a regionális leállásokkal szemben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-183">If you have a very low RTO, you might keep a second regional deployment continually running an active/passive configuration on standby, to protect against a regional outage.</span></span> <span data-ttu-id="a8e64-184">Bizonyos esetekben előfordulhat, hogy üzembe kell helyeznie egy aktív/passzív konfigurációt a még alacsonyabb RTO eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="a8e64-184">In some cases you might deploy an active/active configuration to achieve even lower RTO.</span></span>

- <span data-ttu-id="a8e64-185">A **helyreállítási időkorlát** (RPO) a katasztrófa során elfogadható adatveszteség maximális ideje.</span><span class="sxs-lookup"><span data-stu-id="a8e64-185">**Recovery point objective** (RPO) is the maximum duration of data loss that is acceptable during a disaster.</span></span> <span data-ttu-id="a8e64-186">Ha például egyetlen adatbázisban tárol adatokat, és nem készít replikát egy másik adatbázisba, és óránként végez biztonsági mentéseket, akkor legfeljebb egy órányi adatot veszíthet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-186">For example, if you store data in a single database, with no replication to other databases, and perform hourly backups, you could lose up to an hour of data.</span></span>

<span data-ttu-id="a8e64-187">Az RTO és az RPO egy rendszer nem funkcionális követelményei, amelyeket az üzleti követelményeknek kell meghatározniuk.</span><span class="sxs-lookup"><span data-stu-id="a8e64-187">RTO and RPO are non-functional requirements of a system, and should be dictated by business requirements.</span></span> <span data-ttu-id="a8e64-188">Az értékek kiszámításához érdemes lehet kockázatfelmérést végezni, és átfogóan megismerni az állásidő és az adatvesztés járulékos költségeit.</span><span class="sxs-lookup"><span data-stu-id="a8e64-188">To derive these values, it's a good idea to conduct a risk assessment, and clearly understanding the cost of downtime or data loss.</span></span>

### <a name="mttr-and-mtbf"></a><span data-ttu-id="a8e64-189">MTTR és MTBF</span><span class="sxs-lookup"><span data-stu-id="a8e64-189">MTTR and MTBF</span></span>

<span data-ttu-id="a8e64-190">A rendelkezésre állás másik két gyakori mérőszáma a helyreállítás átlagos ideje (MTTR) és a hibák közötti átlagos idő (MTBF).</span><span class="sxs-lookup"><span data-stu-id="a8e64-190">Two other common measures of availability are mean time to recover (MTTR) and mean time between failures (MTBF).</span></span> <span data-ttu-id="a8e64-191">Ezeket a mérőszámokat általában a szolgáltatók használják annak megállapítására, hogy hol szükséges redundanciát hozzáadni a felhőszolgáltatásokhoz és hogy melyik SLA-t biztosítsák az ügyfelek számára.</span><span class="sxs-lookup"><span data-stu-id="a8e64-191">These measures are usually used internally by service providers to determine where to add redundancy to cloud services, and which SLAs to provide to customers.</span></span>

<span data-ttu-id="a8e64-192">A **helyreállítás átlagos ideje** (MTTR) az az átlagos idő, amely az összetevő egy hiba utáni helyreállításához szükséges.</span><span class="sxs-lookup"><span data-stu-id="a8e64-192">**Mean time to recover** (MTTR) is the average time that it takes to restore a component after a failure.</span></span> <span data-ttu-id="a8e64-193">Az MTTR az összetevő empirikus jellemzője.</span><span class="sxs-lookup"><span data-stu-id="a8e64-193">MTTR is an empirical fact about a component.</span></span> <span data-ttu-id="a8e64-194">Az egyes összetevők MTTR-mérőszáma alapján megbecsülheti egy teljes alkalmazás MTTR-mérőszámát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-194">Based on the MTTR of each component, you can estimate the MTTR of an entire application.</span></span> <span data-ttu-id="a8e64-195">Az alkalmazás alacsony MTTR-értékű összetevőkből történő létrehozása azt eredményezi, hogy az alkalmazás alacsony átlagos MTTR-értékkel rendelkezik – így gyorsan helyreállítható a hibák után.</span><span class="sxs-lookup"><span data-stu-id="a8e64-195">Building applications from multiple components with low MTTR values results in an application with a low overall MTTR &mdash; one that recovers quickly from failures.</span></span>

<span data-ttu-id="a8e64-196">A **hibák közötti átlagos idő** (MTBF) az a futásidő, amelyre az összetevő számíthat a szolgáltatáskimaradások között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-196">**Mean time between failures** (MTBF) is the runtime that a component can reasonably expect to last between outages.</span></span> <span data-ttu-id="a8e64-197">Ez a mérőszám segíthet kiszámítani, milyen gyakran válik elérhetetlenné egy szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="a8e64-197">This metric can help you to calculate how frequently a service will become unavailable.</span></span> <span data-ttu-id="a8e64-198">Egy nem megbízható összetevő MTBF-értéke alacsony, ezért az összetevő SLA-száma is alacsony lesz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-198">An unreliable component has a low MTBF, resulting in a low SLA number for that component.</span></span> <span data-ttu-id="a8e64-199">Ugyanakkor az alacsony MTBF-érték korrigálható az összetevő több példányának üzembe helyezésével és a példányok közötti feladatátvétel beállításával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-199">However, a low MTBF can be mitigated by deploying multiple instances of the component and implementing failover between them.</span></span>

> [!NOTE]
> <span data-ttu-id="a8e64-200">Ha az összetevők BÁRMELY MTTR-értéke egy magas rendelkezésreállási környezetben meghaladja a rendszer RTO-értékét, a rendszer hibája az üzletmenet elfogadhatatlan mértékű szüneteltetését okozza.</span><span class="sxs-lookup"><span data-stu-id="a8e64-200">If ANY of the MTTR values of components in a high-availability setup exceed the RTO of the system, then a failure in the system will cause an unacceptable business disruption.</span></span> <span data-ttu-id="a8e64-201">A rendszert nem lehet majd visszaállítani a megadott RTO-n belül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-201">It won't be possible to restore the system within the defined RTO.</span></span>

### <a name="slas"></a><span data-ttu-id="a8e64-202">SLA-k</span><span class="sxs-lookup"><span data-stu-id="a8e64-202">SLAs</span></span>

<span data-ttu-id="a8e64-203">Az Azure-ban a [szolgáltatási szerződés][sla] (SLA) ismerteti a Microsoft az üzemidővel és hálózati elérhetőséggel kapcsolatos vállalásait.</span><span class="sxs-lookup"><span data-stu-id="a8e64-203">In Azure, the [Service Level Agreement][sla] (SLA) describes Microsoft’s commitments for uptime and connectivity.</span></span> <span data-ttu-id="a8e64-204">Ha egy adott szolgáltatás SLA-ja 99,9%-os, az azt jelenti, hogy a szolgáltatás várhatóan az idő 99,9%-ában elérhető.</span><span class="sxs-lookup"><span data-stu-id="a8e64-204">If the SLA for a particular service is 99.9%, it means you should expect the service to be available 99.9% of the time.</span></span>

> [!NOTE]
> <span data-ttu-id="a8e64-205">Az Azure SLA jóváírást is biztosít, ha az SLA nem valósul meg, valamint az egyes szolgáltatások „rendelkezésre állásának” adott definícióit is megadja.</span><span class="sxs-lookup"><span data-stu-id="a8e64-205">The Azure SLA also includes provisions for obtaining a service credit if the SLA is not met, along with specific definitions of "availability" for each service.</span></span> <span data-ttu-id="a8e64-206">Az SLA ezen eleme kényszerítési házirendként működik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-206">That aspect of the SLA acts as an enforcement policy.</span></span>

<span data-ttu-id="a8e64-207">Saját cél SLA-kat kell meghatároznia a megoldás összes számítási feladatához.</span><span class="sxs-lookup"><span data-stu-id="a8e64-207">You should define your own target SLAs for each workload in your solution.</span></span> <span data-ttu-id="a8e64-208">Az SLA lehetővé teszi annak kiértékelését, hogy az architektúra megfelel-e az üzleti követelményeknek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-208">An SLA makes it possible to evaluate whether the architecture meets the business requirements.</span></span> <span data-ttu-id="a8e64-209">Ha például egy számítási feladat 99,99%-os üzemidőt igényel, de egy 99,9%-os SLA-val rendelkező szolgáltatásra támaszkodik, akkor a szolgáltatás nem lehet rendszerkritikus meghibásodási pont.</span><span class="sxs-lookup"><span data-stu-id="a8e64-209">For example, if a workload requires 99.99% uptime, but depends on a service with a 99.9% SLA, that service cannot be a single-point of failure in the system.</span></span> <span data-ttu-id="a8e64-210">Az egyik megoldás az, ha a szolgáltatás meghibásodása esetére rendelkezik egy tartalék elérési úttal, vagy ha más intézkedéseket tesz a szolgáltatás hibájából való helyreállításhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-210">One remedy is to have a fallback path in case the service fails, or take other measures to recover from a failure in that service.</span></span>

<span data-ttu-id="a8e64-211">Az alábbi táblázat a különböző SLA-szintek lehetséges halmozott állásidejét mutatja be.</span><span class="sxs-lookup"><span data-stu-id="a8e64-211">The following table shows the potential cumulative downtime for various SLA levels.</span></span>

| <span data-ttu-id="a8e64-212">SLA</span><span class="sxs-lookup"><span data-stu-id="a8e64-212">SLA</span></span> | <span data-ttu-id="a8e64-213">Állásidő hetente</span><span class="sxs-lookup"><span data-stu-id="a8e64-213">Downtime per week</span></span> | <span data-ttu-id="a8e64-214">Állásidő havonta</span><span class="sxs-lookup"><span data-stu-id="a8e64-214">Downtime per month</span></span> | <span data-ttu-id="a8e64-215">Állásidő évente</span><span class="sxs-lookup"><span data-stu-id="a8e64-215">Downtime per year</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="a8e64-216">99%</span><span class="sxs-lookup"><span data-stu-id="a8e64-216">99%</span></span> |<span data-ttu-id="a8e64-217">1,68 óra</span><span class="sxs-lookup"><span data-stu-id="a8e64-217">1.68 hours</span></span> |<span data-ttu-id="a8e64-218">7,2 óra</span><span class="sxs-lookup"><span data-stu-id="a8e64-218">7.2 hours</span></span> |<span data-ttu-id="a8e64-219">3,65 nap</span><span class="sxs-lookup"><span data-stu-id="a8e64-219">3.65 days</span></span> |
| <span data-ttu-id="a8e64-220">99.9%</span><span class="sxs-lookup"><span data-stu-id="a8e64-220">99.9%</span></span> |<span data-ttu-id="a8e64-221">10,1 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-221">10.1 minutes</span></span> |<span data-ttu-id="a8e64-222">43,2 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-222">43.2 minutes</span></span> |<span data-ttu-id="a8e64-223">8,76 óra</span><span class="sxs-lookup"><span data-stu-id="a8e64-223">8.76 hours</span></span> |
| <span data-ttu-id="a8e64-224">99.95%</span><span class="sxs-lookup"><span data-stu-id="a8e64-224">99.95%</span></span> |<span data-ttu-id="a8e64-225">5 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-225">5 minutes</span></span> |<span data-ttu-id="a8e64-226">21,6 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-226">21.6 minutes</span></span> |<span data-ttu-id="a8e64-227">4,38 óra</span><span class="sxs-lookup"><span data-stu-id="a8e64-227">4.38 hours</span></span> |
| <span data-ttu-id="a8e64-228">99.99%</span><span class="sxs-lookup"><span data-stu-id="a8e64-228">99.99%</span></span> |<span data-ttu-id="a8e64-229">1,01 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-229">1.01 minutes</span></span> |<span data-ttu-id="a8e64-230">4,32 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-230">4.32 minutes</span></span> |<span data-ttu-id="a8e64-231">52,56 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-231">52.56 minutes</span></span> |
| <span data-ttu-id="a8e64-232">99.999%</span><span class="sxs-lookup"><span data-stu-id="a8e64-232">99.999%</span></span> |<span data-ttu-id="a8e64-233">6 másodperc</span><span class="sxs-lookup"><span data-stu-id="a8e64-233">6 seconds</span></span> |<span data-ttu-id="a8e64-234">25,9 másodperc</span><span class="sxs-lookup"><span data-stu-id="a8e64-234">25.9 seconds</span></span> |<span data-ttu-id="a8e64-235">5,26 perc</span><span class="sxs-lookup"><span data-stu-id="a8e64-235">5.26 minutes</span></span> |

<span data-ttu-id="a8e64-236">Természetesen a nagyobb rendelkezésre állás a jobb, ha minden más tényezőt figyelmen kívül hagyhatunk.</span><span class="sxs-lookup"><span data-stu-id="a8e64-236">Of course, higher availability is better, everything else being equal.</span></span> <span data-ttu-id="a8e64-237">De minél több „9-est” szeretne elérni, annál jobban nő a rendelkezésreállási szint elérésének költsége és összetettsége.</span><span class="sxs-lookup"><span data-stu-id="a8e64-237">But as you strive for more 9s, the cost and complexity to achieve that level of availability grows.</span></span> <span data-ttu-id="a8e64-238">A 99,99%-os üzemidő havonta összesen körülbelül 5 perc állásidőt jelent.</span><span class="sxs-lookup"><span data-stu-id="a8e64-238">An uptime of 99.99% translates to about 5 minutes of total downtime per month.</span></span> <span data-ttu-id="a8e64-239">Megéri a további összetettséget és költségeket az öt „9-es” elérése?</span><span class="sxs-lookup"><span data-stu-id="a8e64-239">Is it worth the additional complexity and cost to reach five 9s?</span></span> <span data-ttu-id="a8e64-240">A válasz az üzleti követelményektől függ.</span><span class="sxs-lookup"><span data-stu-id="a8e64-240">The answer depends on the business requirements.</span></span>

<span data-ttu-id="a8e64-241">Az alábbiakban néhány további szempontot találhat az SLA meghatározásához:</span><span class="sxs-lookup"><span data-stu-id="a8e64-241">Here are some other considerations when defining an SLA:</span></span>

- <span data-ttu-id="a8e64-242">Négy „9-es” (99,99%) eléréséhez valószínűleg nem támaszkodhat manuális beavatkozásra a hibákból való helyreállításhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-242">To achieve four 9's (99.99%), you probably can't rely on manual intervention to recover from failures.</span></span> <span data-ttu-id="a8e64-243">Az alkalmazásnak képesnek kell lennie az öndiagnózisra és az önjavításra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-243">The application must be self-diagnosing and self-healing.</span></span>
- <span data-ttu-id="a8e64-244">A négy „9-esen” túl már kihívást jelent az állásidő elég gyors észlelése az SLA feltételeinek kielégítéséhez.</span><span class="sxs-lookup"><span data-stu-id="a8e64-244">Beyond four 9's, it is challenging to detect outages quickly enough to meet the SLA.</span></span>
- <span data-ttu-id="a8e64-245">Gondoljon az SLA-ban megszabott, a mérés alapját képező időtartományra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-245">Think about the time window that your SLA is measured against.</span></span> <span data-ttu-id="a8e64-246">Minél kisebb a tartomány, annál szigorúbbak a feltételek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-246">The smaller the window, the tighter the tolerances.</span></span> <span data-ttu-id="a8e64-247">Valószínűleg nem éri meg óránkénti vagy napi üzemidőben meghatározni az SLA-t.</span><span class="sxs-lookup"><span data-stu-id="a8e64-247">It probably doesn't make sense to define your SLA in terms of hourly or daily uptime.</span></span>
- <span data-ttu-id="a8e64-248">Fontolja meg az MTBF- és az MTTR-mérőszám használatát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-248">Consider the MTBF and MTTR measurements.</span></span> <span data-ttu-id="a8e64-249">Minél alacsonyabb az SLA, annál ritkábban állhat le a szolgáltatás, és annál gyorsabban is kell helyreállnia.</span><span class="sxs-lookup"><span data-stu-id="a8e64-249">The lower your SLA, the less frequently the service can go down, and the quicker the service must recover.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="a8e64-250">Összetett SLA-k</span><span class="sxs-lookup"><span data-stu-id="a8e64-250">Composite SLAs</span></span>

<span data-ttu-id="a8e64-251">Vegyünk egy olyan App Service-webalkalmazást, amely az Azure SQL Database adatbázisába ír.</span><span class="sxs-lookup"><span data-stu-id="a8e64-251">Consider an App Service web app that writes to Azure SQL Database.</span></span> <span data-ttu-id="a8e64-252">Az oktatóanyag összeállításakor ezek az Azure-szolgáltatások a következő SLA-kkal rendelkeztek:</span><span class="sxs-lookup"><span data-stu-id="a8e64-252">At the time of this writing, these Azure services have the following SLAs:</span></span>

- <span data-ttu-id="a8e64-253">App Service Web Apps = 99,95%</span><span class="sxs-lookup"><span data-stu-id="a8e64-253">App Service Web Apps = 99.95%</span></span>
- <span data-ttu-id="a8e64-254">SQL Database = 99,99%</span><span class="sxs-lookup"><span data-stu-id="a8e64-254">SQL Database = 99.99%</span></span>

![Összetett SLA](./images/sla1.png)

<span data-ttu-id="a8e64-256">Mi az alkalmazás esetében elvárt maximális állásidő?</span><span class="sxs-lookup"><span data-stu-id="a8e64-256">What is the maximum downtime you would expect for this application?</span></span> <span data-ttu-id="a8e64-257">Ha valamelyik szolgáltatás meghibásodik, akkor a teljes alkalmazás meghibásodik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-257">If either service fails, the whole application fails.</span></span> <span data-ttu-id="a8e64-258">Általánosságban az egyes szolgáltatások meghibásodásának valószínűsége független egymástól, ezért a jelen alkalmazás összetett SLA-ja 99,95% &times; 99,99% = 99,94%.</span><span class="sxs-lookup"><span data-stu-id="a8e64-258">In general, the probability of each service failing is independent, so the composite SLA for this application is 99.95% &times; 99.99% = 99.94%.</span></span> <span data-ttu-id="a8e64-259">Ez alacsonyabb az egyes SLA-knál, ami nem meglepő, mert a több szolgáltatásra támaszkodó alkalmazások több lehetséges hibaponttal rendelkeznek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-259">That's lower than the individual SLAs, which isn't surprising, because an application that relies on multiple services has more potential failure points.</span></span>

<span data-ttu-id="a8e64-260">Az összetett SLA viszont javítható független tartalék útvonalak létrehozásával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-260">On the other hand, you can improve the composite SLA by creating independent fallback paths.</span></span> <span data-ttu-id="a8e64-261">Ha például az SQL Database nem érhető el, állítsa üzenetsorba a tranzakciókat későbbi feldolgozás céljából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-261">For example, if SQL Database is unavailable, put transactions into a queue, to be processed later.</span></span>

![Összetett SLA](./images/sla2.png)

<span data-ttu-id="a8e64-263">E kialakítás révén az alkalmazás akkor is elérhető, ha épp nem tud csatlakozni az adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-263">With this design, the application is still available even if it can't connect to the database.</span></span> <span data-ttu-id="a8e64-264">Az alkalmazás azonban leáll, ha az adatbázis és az üzenetsor egyidejűleg hibásodik meg.</span><span class="sxs-lookup"><span data-stu-id="a8e64-264">However, it fails if the database and the queue both fail at the same time.</span></span> <span data-ttu-id="a8e64-265">Az egyidejű hiba várt időhányada 0,0001 &times; 0,001, ezért az ehhez a kombinált útvonalhoz tartozó összetett SLA:</span><span class="sxs-lookup"><span data-stu-id="a8e64-265">The expected percentage of time for a simultaneous failure is 0.0001 &times; 0.001, so the composite SLA for this combined path is:</span></span>  

- <span data-ttu-id="a8e64-266">Adatbázis VAGY üzenetsor = 1,0 &minus; (0,0001 &times; 0,001) = 99,99999%</span><span class="sxs-lookup"><span data-stu-id="a8e64-266">Database OR queue = 1.0 &minus; (0.0001 &times; 0.001) = 99.99999%</span></span>

<span data-ttu-id="a8e64-267">A teljes összetett SLA:</span><span class="sxs-lookup"><span data-stu-id="a8e64-267">The total composite SLA is:</span></span>

- <span data-ttu-id="a8e64-268">Webalkalmazás ÉS (adatbázis VAGY üzenetsor) = 99,95% &times; 99,99999% = ~99,95%</span><span class="sxs-lookup"><span data-stu-id="a8e64-268">Web app AND (database OR queue) = 99.95% &times; 99.99999% = ~99.95%</span></span>

<span data-ttu-id="a8e64-269">De ennek a módszernek hátrányai is vannak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-269">But there are tradeoffs to this approach.</span></span> <span data-ttu-id="a8e64-270">Az alkalmazáslogika összetettebb, az üzenetsorért fizetni kell, és adatkonzisztenciával kapcsolatos problémák is felmerülhetnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-270">The application logic is more complex, you are paying for the queue, and there may be data consistency issues to consider.</span></span>

<span data-ttu-id="a8e64-271">**SLA többrégiós üzemelő példányokhoz**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-271">**SLA for multi-region deployments**.</span></span> <span data-ttu-id="a8e64-272">Egy másik magas rendelkezésre állású megoldás az alkalmazás több régióban történő üzembe helyezése: ha az alkalmazás meghibásodik egy régióban, az Azure Traffic Manager révén feladatátvétel hajtható végre.</span><span class="sxs-lookup"><span data-stu-id="a8e64-272">Another HA technique is to deploy the application in more than one region, and use Azure Traffic Manager to fail over if the application fails in one region.</span></span> <span data-ttu-id="a8e64-273">Többrégiós üzemelő példány esetében az összetett SLA képlete a következő.</span><span class="sxs-lookup"><span data-stu-id="a8e64-273">For a multi-region deployment, the composite SLA is calculated as follows.</span></span>

<span data-ttu-id="a8e64-274">Legyen *N* az egy régióban üzembe helyezett alkalmazás összetett SLA-ja, *R* pedig azon régiók száma, amelyekben az alkalmazás üzembe van helyezve.</span><span class="sxs-lookup"><span data-stu-id="a8e64-274">Let *N* be the composite SLA for the application deployed in one region, and *R* be the number of regions where the application is deployed.</span></span> <span data-ttu-id="a8e64-275">Annak a várt esélye, hogy az alkalmazás egyidejűleg hibásodik meg minden régióban, ((1 &minus; N) ^ R).</span><span class="sxs-lookup"><span data-stu-id="a8e64-275">The expected chance that the application will fail in all regions at the same time is ((1 &minus; N) ^ R).</span></span>

<span data-ttu-id="a8e64-276">Ha például egyetlen régió SLA-ja 99,95%-os, akkor</span><span class="sxs-lookup"><span data-stu-id="a8e64-276">For example, if the single-region SLA is 99.95%,</span></span>

- <span data-ttu-id="a8e64-277">Két régió összetett SLA-ja = (1 &minus; (0,9995 ^ 2)) = 99,999975%</span><span class="sxs-lookup"><span data-stu-id="a8e64-277">The combined SLA for two regions = (1 &minus; (0.9995 ^ 2)) = 99.999975%</span></span>
- <span data-ttu-id="a8e64-278">Négy régió összetett SLA-ja = (1 &minus; (0,9995 ^ 4)) = 99,999999%</span><span class="sxs-lookup"><span data-stu-id="a8e64-278">The combined SLA for four regions = (1 &minus; (0.9995 ^ 4)) = 99.999999%</span></span>

<span data-ttu-id="a8e64-279">Figyelembe kell vennie a [Traffic Manager SLA-ját][tm-sla] is.</span><span class="sxs-lookup"><span data-stu-id="a8e64-279">You must also factor in the [SLA for Traffic Manager][tm-sla].</span></span> <span data-ttu-id="a8e64-280">Az oktatóanyag összeállításakor a Traffic Manager SLA SLA-ja 99,99%.</span><span class="sxs-lookup"><span data-stu-id="a8e64-280">At the time of this writing, the SLA for Traffic Manager SLA is 99.99%.</span></span>

<span data-ttu-id="a8e64-281">A feladatátvétel továbbá nem azonnali lefutású az aktív-passzív konfigurációkban, így a feladatátvétel során szolgáltatáskiesés fordulhat elő.</span><span class="sxs-lookup"><span data-stu-id="a8e64-281">Also, failing over is not instantaneous in active-passive configurations, which can result in some downtime during a failover.</span></span> <span data-ttu-id="a8e64-282">Lásd: [Traffic Manager-végpont monitorozása és feladatátvétele][tm-failover].</span><span class="sxs-lookup"><span data-stu-id="a8e64-282">See [Traffic Manager endpoint monitoring and failover][tm-failover].</span></span>

<span data-ttu-id="a8e64-283">A kiszámított SLA-szám hasznos kiindulási alap, de nem mutat teljes képet a rendelkezésre állásról.</span><span class="sxs-lookup"><span data-stu-id="a8e64-283">The calculated SLA number is a useful baseline, but it doesn't tell the whole story about availability.</span></span> <span data-ttu-id="a8e64-284">Gyakran előfordul, hogy egy alkalmazás teljesítménye leállás nélkül csökken, ha nem kritikus útvonal hibásodik meg.</span><span class="sxs-lookup"><span data-stu-id="a8e64-284">Often, an application can degrade gracefully when a non-critical path fails.</span></span> <span data-ttu-id="a8e64-285">Vegyünk például egy könyvkatalógust megjelenítő alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="a8e64-285">Consider an application that shows a catalog of books.</span></span> <span data-ttu-id="a8e64-286">Ha az alkalmazás nem tudja lekérni a borítók miniatűrjét, helyőrző képet jeleníthet meg helyette.</span><span class="sxs-lookup"><span data-stu-id="a8e64-286">If the application can't retrieve the thumbnail image for the cover, it might show a placeholder image.</span></span> <span data-ttu-id="a8e64-287">Ebben az esetben a kép lekérésének sikertelensége nem csökkenti az alkalmazás üzemidejét, de hatással van a felhasználói élményre.</span><span class="sxs-lookup"><span data-stu-id="a8e64-287">In that case, failing to get the image does not reduce the application's uptime, although it affects the user experience.</span></span>  

## <a name="design-for-resiliency"></a><span data-ttu-id="a8e64-288">Rugalmasságot szem előtt tartó tervezés</span><span class="sxs-lookup"><span data-stu-id="a8e64-288">Design for resiliency</span></span>

<span data-ttu-id="a8e64-289">A tervezési fázis során javasolt hibaállapot-elemzést (FMA) végezni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-289">During the design phase, you should perform a failure mode analysis (FMA).</span></span> <span data-ttu-id="a8e64-290">Az FMA célja a lehetséges meghibásodási pontok megtalálása, és annak definiálása, hogyan reagáljon az alkalmazás ezekre a hibákra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-290">The goal of an FMA is to identify possible points of failure, and define how the application will respond to those failures.</span></span>

- <span data-ttu-id="a8e64-291">Hogyan észleli az alkalmazás az adott hibatípust?</span><span class="sxs-lookup"><span data-stu-id="a8e64-291">How will the application detect this type of failure?</span></span>
- <span data-ttu-id="a8e64-292">Hogyan reagál az alkalmazás az adott hibatípusra?</span><span class="sxs-lookup"><span data-stu-id="a8e64-292">How will the application respond to this type of failure?</span></span>
- <span data-ttu-id="a8e64-293">Hogyan naplózza és monitorozza az adott hibatípust?</span><span class="sxs-lookup"><span data-stu-id="a8e64-293">How will you log and monitor this type of failure?</span></span>

<span data-ttu-id="a8e64-294">Az FMA eljárásra vonatkozó további információkért – a kifejezetten az Azure-ra vonatkozó ajánlásokkal együtt – lásd [az Azure rugalmasságáról szóló műszaki útmutató hibaállapot-elemzéssel][fma] foglalkozó részét.</span><span class="sxs-lookup"><span data-stu-id="a8e64-294">For more information about the FMA process, with specific recommendations for Azure, see [Azure resiliency guidance: Failure mode analysis][fma].</span></span>

### <a name="example-of-identifying-failure-modes-and-detection-strategy"></a><span data-ttu-id="a8e64-295">Példa a hibaállapotok azonosítására és az észlelési stratégiára</span><span class="sxs-lookup"><span data-stu-id="a8e64-295">Example of identifying failure modes and detection strategy</span></span>

<span data-ttu-id="a8e64-296">**Meghibásodási pont:** Külső webszolgáltatás/API meghívása.</span><span class="sxs-lookup"><span data-stu-id="a8e64-296">**Failure point:** Call to an external web service / API.</span></span>

| <span data-ttu-id="a8e64-297">Hibaállapot</span><span class="sxs-lookup"><span data-stu-id="a8e64-297">Failure mode</span></span> | <span data-ttu-id="a8e64-298">Észlelési stratégia</span><span class="sxs-lookup"><span data-stu-id="a8e64-298">Detection strategy</span></span> |
| --- | --- |
| <span data-ttu-id="a8e64-299">A szolgáltatás nem érhető el</span><span class="sxs-lookup"><span data-stu-id="a8e64-299">Service is unavailable</span></span> |<span data-ttu-id="a8e64-300">HTTP 5xx</span><span class="sxs-lookup"><span data-stu-id="a8e64-300">HTTP 5xx</span></span> |
| <span data-ttu-id="a8e64-301">Throttling</span><span class="sxs-lookup"><span data-stu-id="a8e64-301">Throttling</span></span> |<span data-ttu-id="a8e64-302">HTTP 429 (Túl sok kérelem)</span><span class="sxs-lookup"><span data-stu-id="a8e64-302">HTTP 429 (Too Many Requests)</span></span> |
| <span data-ttu-id="a8e64-303">Hitelesítés</span><span class="sxs-lookup"><span data-stu-id="a8e64-303">Authentication</span></span> |<span data-ttu-id="a8e64-304">HTTP 401 (Jogosulatlan)</span><span class="sxs-lookup"><span data-stu-id="a8e64-304">HTTP 401 (Unauthorized)</span></span> |
| <span data-ttu-id="a8e64-305">Lassú válasz</span><span class="sxs-lookup"><span data-stu-id="a8e64-305">Slow response</span></span> |<span data-ttu-id="a8e64-306">A kérés túllépi az időkorlátot</span><span class="sxs-lookup"><span data-stu-id="a8e64-306">Request times out</span></span> |

### <a name="redundancy-and-designing-for-failure"></a><span data-ttu-id="a8e64-307">Redundancia és meghibásodásra felkészült tervezés</span><span class="sxs-lookup"><span data-stu-id="a8e64-307">Redundancy and designing for failure</span></span>

<span data-ttu-id="a8e64-308">A hibák a hatásukat illetően eltérőek lehetnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-308">Failures can vary in the scope of their impact.</span></span> <span data-ttu-id="a8e64-309">Bizonyos hardveres hibák – például egy meghibásodott lemez – csak egyetlen gazdagépet érintenek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-309">Some hardware failures, such as a failed disk, may affect a single host machine.</span></span> <span data-ttu-id="a8e64-310">Egy meghibásodott hálózati kapcsoló egy teljes kiszolgálószekrényt érinthet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-310">A failed network switch could affect a whole server rack.</span></span> <span data-ttu-id="a8e64-311">Kevésbé gyakori meghibásodások teljes adatközpontok működését zavarhatják meg, például egy áramkimaradás esetén az adatközpontban.</span><span class="sxs-lookup"><span data-stu-id="a8e64-311">Less common are failures that disrupt a whole data center, such as loss of power in a data center.</span></span> <span data-ttu-id="a8e64-312">Ritkán egy teljes régió válhat elérhetetlenné.</span><span class="sxs-lookup"><span data-stu-id="a8e64-312">Rarely, an entire region could become unavailable.</span></span>

<span data-ttu-id="a8e64-313">Az alkalmazások rugalmasságának egyik legfőbb eleme a redundancia.</span><span class="sxs-lookup"><span data-stu-id="a8e64-313">One of the main ways to make an application resilient is through redundancy.</span></span> <span data-ttu-id="a8e64-314">Ezt a redundanciát azonban meg kell terveznie az alkalmazás fejlesztésekor.</span><span class="sxs-lookup"><span data-stu-id="a8e64-314">But you need to plan for this redundancy when you design the application.</span></span> <span data-ttu-id="a8e64-315">A szükséges redundancia szintje az üzleti követelményeitől függ. Nem szükséges minden alkalmazáshoz régiók közötti redundancia, hogy védelmet nyújtson a regionális kimaradással szemben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-315">Also, the level of redundancy that you need depends on your business requirements &mdash; not every application needs redundancy across regions to guard against a regional outage.</span></span> <span data-ttu-id="a8e64-316">Általában a nagyobb redundancia és megbízhatóság magasabb költséget és összetettséget von magával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-316">In general, there is a tradeoff between greater redundancy and reliability versus higher cost and complexity.</span></span>  

<span data-ttu-id="a8e64-317">Az Azure számos funkciót kínál, amellyel az alkalmazások számára biztosítja a redundanciát a meghibásodások minden szintjén, egyetlen virtuális géptől kezdve egészen a teljes régiókig.</span><span class="sxs-lookup"><span data-stu-id="a8e64-317">Azure has a number of features to make an application redundant at every level of failure, from an individual VM to an entire region.</span></span>

![Az Azure rugalmassági funkciói](./images/redundancy.svg)

<span data-ttu-id="a8e64-319">**Egyetlen virtuális gép**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-319">**Single VM**.</span></span> <span data-ttu-id="a8e64-320">Az Azure [üzemidőre vonatkozó SLA-t](https://azure.microsoft.com/support/legal/sla/virtual-machines) biztosít a virtuális gépekhez.</span><span class="sxs-lookup"><span data-stu-id="a8e64-320">Azure provides an [uptime SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines) for single VMs.</span></span> <span data-ttu-id="a8e64-321">(A virtuális gépnek prémium szintű tárolást kell használnia minden operációsrendszer-lemez és adatlemez esetében.) Bár magasabb SLA-t kaphat két vagy több virtuális gép futtatása esetén, egyetlen virtuális gép is elég megbízható lehet bizonyos számítási feladatokhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-321">(The VM must use premium storage for all Operating System Disks and Data Disks.) Although you can get a higher SLA by running two or more VMs, a single VM may be reliable enough for some workloads.</span></span> <span data-ttu-id="a8e64-322">Az éles számítási feladatokhoz azonban két vagy több virtuális gép használatát javasoljuk a redundancia biztosítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="a8e64-322">For production workloads, however, we recommend using two or more VMs for redundancy.</span></span>

<span data-ttu-id="a8e64-323">**Rendelkezésre állási csoportok**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-323">**Availability sets**.</span></span> <span data-ttu-id="a8e64-324">A helyi hardverhibák, például lemezek vagy hálózati kapcsolók meghibásodása elleni védelem érdekében helyezzen üzembe két vagy több virtuális gépet egy rendelkezésre állási csoportban.</span><span class="sxs-lookup"><span data-stu-id="a8e64-324">To protect against localized hardware failures, such as a disk or network switch failing, deploy two or more VMs in an availability set.</span></span> <span data-ttu-id="a8e64-325">Egy rendelkezésre állási csoport két vagy több *tartalék tartományból* áll, amelyek közös áramforrással és hálózati kapcsolóval rendelkeznek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-325">An availability set consists of two or more *fault domains* that share a common power source and network switch.</span></span> <span data-ttu-id="a8e64-326">A rendelkezésre állási csoportban található virtuális gépek el vannak osztva a tartalék tartományok között, ezért ha hardverhiba merül fel az egyik tartalék tartományban, a hálózati forgalom átirányítható a többi tartalék tartományban található virtuális gépekre.</span><span class="sxs-lookup"><span data-stu-id="a8e64-326">VMs in an availability set are distributed across the fault domains, so if a hardware failure affects one fault domain, network traffic can still be routed the VMs in the other fault domains.</span></span> <span data-ttu-id="a8e64-327">További információt a rendelkezésre állási csoportokról [a Windows rendszerű virtuális gépek rendelkezésre állásának az Azure-ban történő kezelését](/azure/virtual-machines/windows/manage-availability) ismertető cikkben talál.</span><span class="sxs-lookup"><span data-stu-id="a8e64-327">For more information about Availability Sets, see [Manage the availability of Windows virtual machines in Azure](/azure/virtual-machines/windows/manage-availability).</span></span>

<span data-ttu-id="a8e64-328">**Rendelkezésre állási zónák**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-328">**Availability zones**.</span></span>  <span data-ttu-id="a8e64-329">A rendelkezésre állási zónák egy Azure-régió fizikailag elkülönített zónáit jelentik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-329">An Availability Zone is a physically separate zone within an Azure region.</span></span> <span data-ttu-id="a8e64-330">Mindegyik rendelkezésre állási zóna különálló áramforrással, hálózattal és hűtéssel rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-330">Each Availability Zone has a distinct power source, network, and cooling.</span></span> <span data-ttu-id="a8e64-331">Ha a virtuális gépeket több rendelkezésre állási zónában helyezi üzembe, azzal segít megvédeni az alkalmazásokat a teljes adatközpontra kiterjedő meghibásodásokkal szemben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-331">Deploying VMs across availability zones helps to protect an application against datacenter-wide failures.</span></span> <span data-ttu-id="a8e64-332">Nem mindegyik régió támogatja a rendelkezésreállási zónákat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-332">Not all regions support Availability Zones.</span></span> <span data-ttu-id="a8e64-333">A támogatott régiók és szolgáltatások listáját lásd [az Azure rendelkezésreállási zónáit](/azure/availability-zones/az-overview) ismertető részben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-333">For a list of supported regions and services, see [What are Availability Zones in Azure?](/azure/availability-zones/az-overview).</span></span>

<span data-ttu-id="a8e64-334">Ha rendelkezésreállási zónák használatát tervezi az üzemelő példányban, először ellenőrizze, hogy az alkalmazás architektúrája és kódbázisa támogatja-e ezt a konfigurációt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-334">If you are planning to use Availability Zones in your deployment, first validate that your application architecture and code base can support this configuration.</span></span> <span data-ttu-id="a8e64-335">Ha kereskedelmi forgalomban kapható, használatra kész szoftvert helyez üzembe, forduljon a szoftver gyártójához, és tesztelje alaposan a szoftvert az éles üzembe helyezés előtt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-335">If you are deploying commercial off-the-shelf software, consult with the software vendor and test adequately before deploying into production.</span></span> <span data-ttu-id="a8e64-336">Egy alkalmazásnak fenn kell tartania az állapotot, és meg kell akadályoznia az adatvesztést a konfigurált zónában tapasztalható szolgáltatáskimaradás során.</span><span class="sxs-lookup"><span data-stu-id="a8e64-336">An application must be able to maintain state and prevent loss of data during an outage within the configured zone.</span></span> <span data-ttu-id="a8e64-337">Az alkalmazásnak alkalmasnak kell lennie egy rugalmas és elosztott infrastruktúrában való futtatásra anélkül, hogy a kódbázisban nem módosítható infrastruktúra-összetevők lennének megadva.</span><span class="sxs-lookup"><span data-stu-id="a8e64-337">The application must support running in an elastic and distributed infrastructure with no hard-coded infrastructure components specified in the code base.</span></span>

<span data-ttu-id="a8e64-338">**Azure Site Recovery**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-338">**Azure Site Recovery**.</span></span>  <span data-ttu-id="a8e64-339">Replikálhatja az Azure-beli virtuális gépeket egy másik Azure-régióba az üzletmenet-folytonosság és a vészhelyreállítás érdekében.</span><span class="sxs-lookup"><span data-stu-id="a8e64-339">Replicate Azure virtual machines to another Azure region for business continuity and disaster recovery needs.</span></span> <span data-ttu-id="a8e64-340">Időszakos vészhelyreállítási tesztekkel biztosíthatja a követelményeknek való megfelelést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-340">You can conduct periodic DR drills to ensure you meet the compliance needs.</span></span> <span data-ttu-id="a8e64-341">A rendszer a megadott beállításokkal replikálja a virtuális gépet a kiválasztott régióba, így Ön visszaállíthatja alkalmazásait, ha a forrásrégióban leállás történne.</span><span class="sxs-lookup"><span data-stu-id="a8e64-341">The VM will be replicated with the specified settings to the selected region so that you can recover your applications in the event of outages in the source region.</span></span> <span data-ttu-id="a8e64-342">További információt az [Azure-beli virtuális gépek ASR használatával történő replikálását ismertető részben][site-recovery] talál.</span><span class="sxs-lookup"><span data-stu-id="a8e64-342">For more information, see [Replicate Azure VMs using ASR][site-recovery].</span></span> <span data-ttu-id="a8e64-343">Vegye figyelembe a szolgáltatás itt található RTO- és RPO-számát, és a teszteléskor győződjön meg arról, hogy a helyreállítási idő és a helyreállítási pont megfelel az igényeinek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-343">Consider the RTO and RPO numbers for your solution here and ensure that when testing, the recovery time and recovery point is appropriate for your needs.</span></span>

<span data-ttu-id="a8e64-344">**Párosított régiók**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-344">**Paired regions**.</span></span> <span data-ttu-id="a8e64-345">Annak érdekében, hogy védelmet nyújtson egy alkalmazás számára regionális kimaradás esetén, helyezze üzembe az alkalmazást egyszerre több régióban, és az Azure Traffic Manager használatával ossza el az internetes forgalmat a különböző régiók között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-345">To protect an application against a regional outage, you can deploy the application across multiple regions, using Azure Traffic Manager to distribute internet traffic to the different regions.</span></span> <span data-ttu-id="a8e64-346">Minden egyes Azure-régió párban áll egy másikkal.</span><span class="sxs-lookup"><span data-stu-id="a8e64-346">Each Azure region is paired with another region.</span></span> <span data-ttu-id="a8e64-347">Ezek együtt egy [régiópárt](/azure/best-practices-availability-paired-regions) alkotnak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-347">Together, these form a [regional pair](/azure/best-practices-availability-paired-regions).</span></span> <span data-ttu-id="a8e64-348">Dél-Brazília kivételével a régiópárok azonos földrajzi helyen találhatók, hogy adóügyi és törvényi szempontból megfeleljenek az adatok tárolási helyére vonatkozó előírásoknak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-348">With the exception of Brazil South, regional pairs are located within the same geography in order to meet data residency requirements for tax and law enforcement jurisdiction purposes.</span></span>

<span data-ttu-id="a8e64-349">Amikor többrégiós alkalmazásokat tervez, vegye figyelembe, hogy a régiók közötti hálózati késés magasabb, mint egy régión belül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-349">When you design a multi-region application, take into account that network latency across regions is higher than within a region.</span></span> <span data-ttu-id="a8e64-350">Például, ha egy adatbázist replikál a feladatátvétel támogatása érdekében, használjon szinkron adatreplikációt a régión belül, míg aszinkron adatreplikációt a régiók között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-350">For example, if you are replicating a database to enable failover, use synchronous data replication within a region, but asynchronous data replication across regions.</span></span>

| &nbsp; | <span data-ttu-id="a8e64-351">Rendelkezésre állási csoport</span><span class="sxs-lookup"><span data-stu-id="a8e64-351">Availability Set</span></span> | <span data-ttu-id="a8e64-352">Rendelkezésre állási zóna</span><span class="sxs-lookup"><span data-stu-id="a8e64-352">Availability Zone</span></span> | <span data-ttu-id="a8e64-353">Azure Site Recovery/párosított régió</span><span class="sxs-lookup"><span data-stu-id="a8e64-353">Azure Site Recovery/Paired region</span></span> |
|--------|------------------|-------------------|---------------|
| <span data-ttu-id="a8e64-354">Hiba hatóköre</span><span class="sxs-lookup"><span data-stu-id="a8e64-354">Scope of failure</span></span> | <span data-ttu-id="a8e64-355">Kiszolgálószekrény</span><span class="sxs-lookup"><span data-stu-id="a8e64-355">Rack</span></span> | <span data-ttu-id="a8e64-356">Adatközpont</span><span class="sxs-lookup"><span data-stu-id="a8e64-356">Datacenter</span></span> | <span data-ttu-id="a8e64-357">Régió</span><span class="sxs-lookup"><span data-stu-id="a8e64-357">Region</span></span> |
| <span data-ttu-id="a8e64-358">Kérések útválasztása</span><span class="sxs-lookup"><span data-stu-id="a8e64-358">Request routing</span></span> | <span data-ttu-id="a8e64-359">Load Balancer</span><span class="sxs-lookup"><span data-stu-id="a8e64-359">Load Balancer</span></span> | <span data-ttu-id="a8e64-360">Zónák közötti terheléselosztó</span><span class="sxs-lookup"><span data-stu-id="a8e64-360">Cross-zone Load Balancer</span></span> | <span data-ttu-id="a8e64-361">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="a8e64-361">Traffic Manager</span></span> |
| <span data-ttu-id="a8e64-362">Hálózati késleltetés</span><span class="sxs-lookup"><span data-stu-id="a8e64-362">Network latency</span></span> | <span data-ttu-id="a8e64-363">Nagyon alacsony</span><span class="sxs-lookup"><span data-stu-id="a8e64-363">Very low</span></span> | <span data-ttu-id="a8e64-364">Alacsony</span><span class="sxs-lookup"><span data-stu-id="a8e64-364">Low</span></span> | <span data-ttu-id="a8e64-365">Közepes vagy magas</span><span class="sxs-lookup"><span data-stu-id="a8e64-365">Mid to high</span></span> |
| <span data-ttu-id="a8e64-366">Virtuális hálózat</span><span class="sxs-lookup"><span data-stu-id="a8e64-366">Virtual network</span></span>  | <span data-ttu-id="a8e64-367">VNet</span><span class="sxs-lookup"><span data-stu-id="a8e64-367">VNet</span></span> | <span data-ttu-id="a8e64-368">VNet</span><span class="sxs-lookup"><span data-stu-id="a8e64-368">VNet</span></span> | <span data-ttu-id="a8e64-369">Régiók közötti virtuális hálózatok közötti társviszony</span><span class="sxs-lookup"><span data-stu-id="a8e64-369">Cross-region VNet peering</span></span> |

## <a name="implement-resiliency-strategies"></a><span data-ttu-id="a8e64-370">Rugalmassági stratégiák megvalósítása</span><span class="sxs-lookup"><span data-stu-id="a8e64-370">Implement resiliency strategies</span></span>

<span data-ttu-id="a8e64-371">Ebben a szakaszban áttekintünk néhány gyakori rugalmassági stratégiát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-371">This section provides a survey of some common resiliency strategies.</span></span> <span data-ttu-id="a8e64-372">Ezek legtöbbje az alkalmazott technológiától függetlenül működik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-372">Most of these are not limited to a particular technology.</span></span> <span data-ttu-id="a8e64-373">Az ebben a szakaszban található leírások az egyes technikák általános működési elvét foglalják össze, további információkra mutató hivatkozásokkal.</span><span class="sxs-lookup"><span data-stu-id="a8e64-373">The descriptions in this section summarize the general idea behind each technique, with links to further reading.</span></span>

<span data-ttu-id="a8e64-374">**Újrapróbálkozás átmeneti meghibásodások esetén**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-374">**Retry transient failures**.</span></span> <span data-ttu-id="a8e64-375">Az átmeneti meghibásodások oka lehet a hálózati kapcsolat pillanatnyi megszakadása, az adatbázis-kapcsolat megszakadása, vagy foglalt szolgáltatás miatti időtúllépés.</span><span class="sxs-lookup"><span data-stu-id="a8e64-375">Transient failures can be caused by momentary loss of network connectivity, a dropped database connection, or a timeout when a service is busy.</span></span> <span data-ttu-id="a8e64-376">Az átmeneti meghibásodások gyakran megoldódnak a kérelem újbóli elküldésével.</span><span class="sxs-lookup"><span data-stu-id="a8e64-376">Often, a transient failure can be resolved simply by retrying the request.</span></span> <span data-ttu-id="a8e64-377">Sok Azure-szolgáltatás esetében az ügyfél SDK automatikus újrapróbálkozásokat valósít meg, a hívó számára átlátható módon; lásd [Szolgáltatásspecifikus újrapróbálkozásokkal kapcsolatos útmutatás][retry-service-specific guidance].</span><span class="sxs-lookup"><span data-stu-id="a8e64-377">For many Azure services, the client SDK implements automatic retries, in a way that is transparent to the caller; see [Retry service specific guidance][retry-service-specific guidance].</span></span>

<span data-ttu-id="a8e64-378">Mindegyik újrapróbálkozás növeli a teljes késést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-378">Each retry attempt adds to the total latency.</span></span> <span data-ttu-id="a8e64-379">Túl sok sikertelen kérelem továbbá szűk keresztmetszetet eredményezhet, mivel a függőben lévő kérelmek halmozódnak az üzenetsorban.</span><span class="sxs-lookup"><span data-stu-id="a8e64-379">Also, too many failed requests can cause a bottleneck, as pending requests accumulate in the queue.</span></span> <span data-ttu-id="a8e64-380">Ezek a blokkolt kérelmek olyan kritikus rendszererőforrásokat akadályozhatnak, mint a memória, szálak, adatbázis-kapcsolatok stb., ezáltal pedig kaszkádolt meghibásodásokhoz vezethetnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-380">These blocked requests might hold critical system resources such as memory, threads, database connections, and so on, which can cause cascading failures.</span></span> <span data-ttu-id="a8e64-381">Ennek elkerülése végett növelni kell az egyes újrapróbálkozások közötti időt, és korlátozni a sikertelen kérelmek lehetséges számát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-381">To avoid this, increase the delay between each retry attempt, and limit the total number of failed requests.</span></span>

![Újrapróbálkozási kísérletek ábrája](./images/retry.png)

<span data-ttu-id="a8e64-383">**Terheléselosztás példányok között**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-383">**Load balance across instances**.</span></span> <span data-ttu-id="a8e64-384">A skálázhatóság érdekében a felhőalkalmazásoknak képesnek kell lenniük a további példányok hozzáadása révén történő horizontális felskálázásra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-384">For scalability, a cloud application should be able to scale out by adding more instances.</span></span> <span data-ttu-id="a8e64-385">Ez a módszer is növeli a rugalmasságot, mert a nem megfelelő állapotú példányokat ki lehet iktatni a rotációból.</span><span class="sxs-lookup"><span data-stu-id="a8e64-385">This approach also improves resiliency, because unhealthy instances can be removed from rotation.</span></span> <span data-ttu-id="a8e64-386">Például:</span><span class="sxs-lookup"><span data-stu-id="a8e64-386">For example:</span></span>

- <span data-ttu-id="a8e64-387">Helyezzen két vagy több virtuális gépet terheléselosztó mögé.</span><span class="sxs-lookup"><span data-stu-id="a8e64-387">Put two or more VMs behind a load balancer.</span></span> <span data-ttu-id="a8e64-388">A terheléselosztó az összes virtuális gép között osztja el a forgalmat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-388">The load balancer distributes traffic to all the VMs.</span></span> <span data-ttu-id="a8e64-389">Lásd az [elosztott terhelésű virtuális gépek üzemeltetése a skálázhatóság és a rendelkezésre állás érdekében][ra-multi-vm] témakörrel foglalkozó részt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-389">See [Run load-balanced VMs for scalability and availability][ra-multi-vm].</span></span>
- <span data-ttu-id="a8e64-390">Skálázzon fel horizontálisan egy Azure App Service alkalmazást több példányra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-390">Scale out an Azure App Service app to multiple instances.</span></span> <span data-ttu-id="a8e64-391">Az App Service automatikusan elosztja a terhelést a példányok között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-391">App Service automatically balances load across instances.</span></span> <span data-ttu-id="a8e64-392">Lásd: [Alapszintű webalkalmazás][ra-basic-web].</span><span class="sxs-lookup"><span data-stu-id="a8e64-392">See [Basic web application][ra-basic-web].</span></span>
- <span data-ttu-id="a8e64-393">Az [Azure Traffic Managerrel][tm] ossza el a forgalmat végpontok között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-393">Use [Azure Traffic Manager][tm] to distribute traffic across a set of endpoints.</span></span>

<span data-ttu-id="a8e64-394">**Adatok replikálása**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-394">**Replicate data**.</span></span> <span data-ttu-id="a8e64-395">Az adatok replikálása egy általános stratégia, amellyel az adattárak nem átmeneti meghibásodásai kezelhetők.</span><span class="sxs-lookup"><span data-stu-id="a8e64-395">Replicating data is a general strategy for handling non-transient failures in a data store.</span></span> <span data-ttu-id="a8e64-396">Számos tárolótechnológia – mint például az Azure Storage, az Azure SQL Database, a Cosmos DB és az Apache Cassandra – beépített replikálással rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-396">Many storage technologies provide built-in replication, including Azure Storage, Azure SQL Database, Cosmos DB, and Apache Cassandra.</span></span> <span data-ttu-id="a8e64-397">Az olvasási és írási útvonalakra egyaránt gondolni kell.</span><span class="sxs-lookup"><span data-stu-id="a8e64-397">It's important to consider both the read and write paths.</span></span> <span data-ttu-id="a8e64-398">A tárolótechnológiától függően rendelkezhet több írható replikával, vagy egy írható és több írásvédett replikával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-398">Depending on the storage technology, you might have multiple writable replicas, or a single writable replica and multiple read-only replicas.</span></span>

<span data-ttu-id="a8e64-399">A rendelkezésre állás maximalizálása érdekében a replikákat több régióban is el lehet helyezni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-399">To maximize availability, replicas can be placed in multiple regions.</span></span> <span data-ttu-id="a8e64-400">Ez azonban növeli az adatok replikálásával járó késést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-400">However, this increases the latency when replicating the data.</span></span> <span data-ttu-id="a8e64-401">A régiók közötti replikálás általában aszinkron módon történik, ami végleges konzisztenciájú modellt jelent, valamint azt, hogy egy replika meghibásodása adatveszteséggel járhat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-401">Typically, replicating across regions is done asynchronously, which implies an eventual consistency model and potential data loss if a replica fails.</span></span>

<span data-ttu-id="a8e64-402">Az [Azure Site Recoveryvel][site-recovery] Azure-beli virtuális gépeket replikálhat egy régióból egy másikba.</span><span class="sxs-lookup"><span data-stu-id="a8e64-402">You can use [Azure Site Recovery][site-recovery] to replicate Azure virtual machines from one region to another region.</span></span> <span data-ttu-id="a8e64-403">A Site Recovery folyamatosan végzi az adatok replikálását a célrégióba.</span><span class="sxs-lookup"><span data-stu-id="a8e64-403">Site Recovery replicates data continuously to the target region.</span></span> <span data-ttu-id="a8e64-404">Ha az elsődleges helyen kimaradás történik, a rendszer átadja a feladatokat a másodlagos helynek</span><span class="sxs-lookup"><span data-stu-id="a8e64-404">When an outage occurs at your primary site, you fail over to secondary location</span></span>

<span data-ttu-id="a8e64-405">**Leállás nélküli teljesítménycsökkenés**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-405">**Degrade gracefully**.</span></span> <span data-ttu-id="a8e64-406">Ha egy szolgáltatás meghibásodik, és nincs feladatátvételi útvonal, az alkalmazás képes lehet leállás nélküli teljesítménycsökkenéssel tovább futni, továbbra is elfogadható felhasználói élményt nyújtva.</span><span class="sxs-lookup"><span data-stu-id="a8e64-406">If a service fails and there is no failover path, the application may be able to degrade gracefully while still providing an acceptable user experience.</span></span> <span data-ttu-id="a8e64-407">Például:</span><span class="sxs-lookup"><span data-stu-id="a8e64-407">For example:</span></span>

- <span data-ttu-id="a8e64-408">Helyezzen egy munkaelemet üzenetsorba későbbi kezelés céljából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-408">Put a work item on a queue, to be handled later.</span></span>
- <span data-ttu-id="a8e64-409">Adjon vissza becsült értéket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-409">Return an estimated value.</span></span>
- <span data-ttu-id="a8e64-410">Használjon helyi gyorsítótárban tárolt adatokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-410">Use locally cached data.</span></span>
- <span data-ttu-id="a8e64-411">Jelenítsen meg hibaüzenetet a felhasználó számára.</span><span class="sxs-lookup"><span data-stu-id="a8e64-411">Show the user an error message.</span></span> <span data-ttu-id="a8e64-412">(Ez jobb lehetőség, mint ha az alkalmazás nem válaszol a további kérelmekre.)</span><span class="sxs-lookup"><span data-stu-id="a8e64-412">(This option is better than having the application stop responding to requests.)</span></span>

<span data-ttu-id="a8e64-413">**Nagy forgalmú felhasználók szabályozása**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-413">**Throttle high-volume users**.</span></span> <span data-ttu-id="a8e64-414">Előfordulhat, hogy néhány felhasználó túlzott terhelést okoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-414">Sometimes a small number of users create excessive load.</span></span> <span data-ttu-id="a8e64-415">Ez más felhasználókra is hatással lehet, csökkentve az alkalmazás teljes rendelkezésre állását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-415">That can have an impact on other users, reducing the overall availability of your application.</span></span>

<span data-ttu-id="a8e64-416">Ha egyetlen ügyfél túlzott mennyiségű kérelmet küld, az alkalmazás bizonyos ideig szabályozhatja a felhasználó forgalmát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-416">When a single client makes an excessive number of requests, the application might throttle the client for a certain period of time.</span></span> <span data-ttu-id="a8e64-417">A szabályozási időszak alatt az alkalmazás visszautasítja az adott ügyféltől érkező néhány vagy összes kérelmet (a konkrét szabályozási stratégiától függően).</span><span class="sxs-lookup"><span data-stu-id="a8e64-417">During the throttling period, the application refuses some or all of the requests from that client (depending on the exact throttling strategy).</span></span> <span data-ttu-id="a8e64-418">A szabályozási küszöbérték függhet az ügyfél szolgáltatásszintjétől.</span><span class="sxs-lookup"><span data-stu-id="a8e64-418">The threshold for throttling might depend on the customer's service tier.</span></span>

<span data-ttu-id="a8e64-419">A szabályozás nem feltétlenül jelent kártételi szándékot az ügyfél részéről – csupán azt jelenti, hogy túllépte a szolgáltatási kvótáját.</span><span class="sxs-lookup"><span data-stu-id="a8e64-419">Throttling does not imply the client was necessarily acting maliciously, only that it exceeded its service quota.</span></span> <span data-ttu-id="a8e64-420">Egyes esetekben a fogyasztók rendszeresen túlléphetik a kvótájukat, vagy egyéb helytelen magatartást tanúsíthatnak.</span><span class="sxs-lookup"><span data-stu-id="a8e64-420">In some cases, a consumer might consistently exceed their quota or otherwise behave badly.</span></span> <span data-ttu-id="a8e64-421">Ilyen esetben további lépésként lehetséges a felhasználó blokkolása.</span><span class="sxs-lookup"><span data-stu-id="a8e64-421">In that case, you might go further and block the user.</span></span> <span data-ttu-id="a8e64-422">Ez általában API-kulcs vagy IP-címtartomány blokkolása révén történik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-422">Typically, this is done by blocking an API key or an IP address range.</span></span> <span data-ttu-id="a8e64-423">További információkért lásd: [Szabályozási minta][throttling-pattern].</span><span class="sxs-lookup"><span data-stu-id="a8e64-423">For more information, see [Throttling Pattern][throttling-pattern].</span></span>

<span data-ttu-id="a8e64-424">**Áramköri megszakító használata**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-424">**Use a circuit breaker**.</span></span> <span data-ttu-id="a8e64-425">Az [áramköri megszakítási][circuit-breaker-pattern] minta meggátolhatja, hogy egy alkalmazás olyan műveletet próbáljon többször végrehajtani, amely nagy eséllyel lesz sikertelen.</span><span class="sxs-lookup"><span data-stu-id="a8e64-425">The [Circuit Breaker][circuit-breaker-pattern] pattern can prevent an application from repeatedly trying an operation that is likely to fail.</span></span> <span data-ttu-id="a8e64-426">Az áramköri megszakító egy szolgáltatás meghívásait burkolja, és nyomon követi a nemrégiben történt hibákat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-426">The circuit breaker wraps calls to a service and tracks the number of recent failures.</span></span> <span data-ttu-id="a8e64-427">Ha a hibaszám túllépi a küszöbértéket, az áramköri megszakító egy hibakódot ad vissza a szolgáltatás hívása nélkül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-427">If the failure count exceeds a threshold, the circuit breaker starts returning an error code without calling the service.</span></span> <span data-ttu-id="a8e64-428">Ez időt biztosít a szolgáltatásnak, hogy helyreálljon.</span><span class="sxs-lookup"><span data-stu-id="a8e64-428">This gives the service time to recover.</span></span>

<span data-ttu-id="a8e64-429">**Adatforgalmi kiugrások csökkentése terheléskiegyenlítéssel**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-429">**Use load leveling to smooth out spikes in traffic**.</span></span>
<span data-ttu-id="a8e64-430">Az alkalmazások adatforgalmának esetleges hirtelen kiugrásai túlterhelhetik a háttérkiszolgálón futó szolgáltatásokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-430">Applications may experience sudden spikes in traffic, which can overwhelm services on the backend.</span></span> <span data-ttu-id="a8e64-431">Ha egy háttérszolgáltatás nem képes elég gyorsan válaszolni a kérelmekre, az sorban állásra kényszerítheti a kérelmeket, vagy az alkalmazás szolgáltatás általi szabályozását válthatja ki.</span><span class="sxs-lookup"><span data-stu-id="a8e64-431">If a backend service cannot respond to requests quickly enough, it may cause requests to queue (back up), or cause the service to throttle the application.</span></span> <span data-ttu-id="a8e64-432">Ennek elkerülése végett az üzenetsor pufferként használható.</span><span class="sxs-lookup"><span data-stu-id="a8e64-432">To avoid this, you can use a queue as a buffer.</span></span> <span data-ttu-id="a8e64-433">Új munkaelem megjelenésekor a háttérszolgáltatás azonnali meghívása helyett az alkalmazás aszinkron futáshoz állít sorba egy munkaelemet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-433">When there is a new work item, instead of calling the backend service immediately, the application queues a work item to run asynchronously.</span></span> <span data-ttu-id="a8e64-434">Az üzenetsor pufferként működik, amely csökkenti a terhelési kiugrásokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-434">The queue acts as a buffer that smooths out peaks in the load.</span></span> <span data-ttu-id="a8e64-435">További információkért lásd az [üzenetsor-alapú terheléskiegyenlítési mintával][load-leveling-pattern] foglalkozó részt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-435">For more information, see [Queue-Based Load Leveling Pattern][load-leveling-pattern].</span></span>

<span data-ttu-id="a8e64-436">**Kritikus erőforrások elkülönítése**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-436">**Isolate critical resources**.</span></span> <span data-ttu-id="a8e64-437">Egy alrendszerben bekövetkező meghibásodás időnként kaszkádolás révén elterjedhet, az alkalmazás más részein is meghibásodásokat okozva.</span><span class="sxs-lookup"><span data-stu-id="a8e64-437">Failures in one subsystem can sometimes cascade, causing failures in other parts of the application.</span></span> <span data-ttu-id="a8e64-438">Ilyen akkor történhet, ha egy hiba miatt bizonyos erőforrások, mint például szálak vagy szoftvercsatornák, nem szabadulnak fel időben, ami erőforrásfogyáshoz vezet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-438">This can happen if a failure causes some resources, such as threads or sockets, not to get freed in a timely manner, leading to resource exhaustion.</span></span>

<span data-ttu-id="a8e64-439">Ennek elkerülése végett a rendszer elkülönített csoportokra particionálható, aminek eredményeképpen az egy partícióban bekövetkező hiba nem vezet a teljes rendszer leállásához.</span><span class="sxs-lookup"><span data-stu-id="a8e64-439">To avoid this, you can partition a system into isolated groups, so that a failure in one partition does not bring down the entire system.</span></span> <span data-ttu-id="a8e64-440">Ezt a módszert Válaszfal mintának is szokás nevezni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-440">This technique is sometimes called the Bulkhead pattern.</span></span>

<span data-ttu-id="a8e64-441">Példák:</span><span class="sxs-lookup"><span data-stu-id="a8e64-441">Examples:</span></span>

- <span data-ttu-id="a8e64-442">Particionáljon egy adatbázist (például bérlőnként), és mindegyik partícióhoz rendelje webkiszolgáló-példányok külön készletét.</span><span class="sxs-lookup"><span data-stu-id="a8e64-442">Partition a database (for example, by tenant) and assign a separate pool of web server instances for each partition.</span></span>  
- <span data-ttu-id="a8e64-443">Használjon külön szálkészleteket a különböző szolgáltatások meghívásainak elkülönítésére.</span><span class="sxs-lookup"><span data-stu-id="a8e64-443">Use separate thread pools to isolate calls to different services.</span></span> <span data-ttu-id="a8e64-444">Ez segít meggátolni a kaszkádolás révén terjedő hibákat, ha az egyik szolgáltatás meghibásodik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-444">This helps to prevent cascading failures if one of the services fails.</span></span> <span data-ttu-id="a8e64-445">Példaként tekintse meg a Netflix [Hystrix könyvtárát][hystrix].</span><span class="sxs-lookup"><span data-stu-id="a8e64-445">For an example, see the Netflix [Hystrix library][hystrix].</span></span>
- <span data-ttu-id="a8e64-446">[Tárolók][containers] felhasználásával korlátozza az egyes alrendszerek által elérhető erőforrások mennyiségét.</span><span class="sxs-lookup"><span data-stu-id="a8e64-446">Use [containers][containers] to limit the resources available to a particular subsystem.</span></span>

![A Válaszfal minta ábrája](./images/bulkhead.png)

<span data-ttu-id="a8e64-448">**Kompenzáló tranzakciók alkalmazása**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-448">**Apply compensating transactions**.</span></span> <span data-ttu-id="a8e64-449">A [kompenzáló tranzakciók][compensating-transaction-pattern] más, befejezett tranzakciók hatásait szüntetik meg.</span><span class="sxs-lookup"><span data-stu-id="a8e64-449">A [compensating transaction][compensating-transaction-pattern] is a transaction that undoes the effects of another completed transaction.</span></span> <span data-ttu-id="a8e64-450">Az elosztott rendszerekben rendkívül nehéz lehet az erős tranzakció-konzisztencia megvalósítása.</span><span class="sxs-lookup"><span data-stu-id="a8e64-450">In a distributed system, it can be very difficult to achieve strong transactional consistency.</span></span> <span data-ttu-id="a8e64-451">A kompenzáló tranzakciók révén megvalósítható a konzisztencia azáltal, hogy kisebb, különálló tranzakciókat használunk, amelyek mindegyike visszavonható.</span><span class="sxs-lookup"><span data-stu-id="a8e64-451">Compensating transactions are a way to achieve consistency by using a series of smaller, individual transactions that can be undone at each step.</span></span>

<span data-ttu-id="a8e64-452">Például utazásfoglalás esetében az ügyfél foglalhat autót, hotelszobát és repülőjegyet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-452">For example, to book a trip, a customer might reserve a car, a hotel room, and a flight.</span></span> <span data-ttu-id="a8e64-453">Ha e lépések bármelyike meghiúsul, az egész művelet meghiúsul.</span><span class="sxs-lookup"><span data-stu-id="a8e64-453">If any of these steps fails, the entire operation fails.</span></span> <span data-ttu-id="a8e64-454">Az egész művelet egyetlen elosztott tranzakcióval történő megvalósítása helyett definiálható kompenzáló tranzakció mindegyik lépéshez.</span><span class="sxs-lookup"><span data-stu-id="a8e64-454">Instead of trying to use a single distributed transaction for the entire operation, you can define a compensating transaction for each step.</span></span> <span data-ttu-id="a8e64-455">Az autófoglalás visszavonásához például törölheti a foglalást.</span><span class="sxs-lookup"><span data-stu-id="a8e64-455">For example, to undo a car reservation, you cancel the reservation.</span></span> <span data-ttu-id="a8e64-456">A teljes művelet befejezése érdekében koordinátor hajtja végre az összes lépést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-456">In order to complete the whole operation, a coordinator executes each step.</span></span> <span data-ttu-id="a8e64-457">Ha valamelyik lépés meghiúsul, a koordinátor kompenzáló tranzakciókkal vonja vissza a már befejezett lépéseket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-457">If any step fails, the coordinator applies compensating transactions to undo any steps that were completed.</span></span>

## <a name="test-for-resiliency"></a><span data-ttu-id="a8e64-458">Rugalmasság tesztelése</span><span class="sxs-lookup"><span data-stu-id="a8e64-458">Test for resiliency</span></span>

<span data-ttu-id="a8e64-459">A rugalmasságot általában véve nem lehet ugyanúgy tesztelni, mint az alkalmazások működőképességét (egységtesztek futtatásával stb).</span><span class="sxs-lookup"><span data-stu-id="a8e64-459">Generally, you can't test resiliency in the same way that you test application functionality (by running unit tests and so on).</span></span> <span data-ttu-id="a8e64-460">Ehelyett azt kell megvizsgálni, hogyan teljesít a végpontok közötti munkaterhelés csak időnként jelentkező hibafeltételek mellett.</span><span class="sxs-lookup"><span data-stu-id="a8e64-460">Instead, you must test how the end-to-end workload performs under failure conditions which only occur intermittently.</span></span>

<span data-ttu-id="a8e64-461">A tesztelés iteratív folyamat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-461">Testing is an iterative process.</span></span> <span data-ttu-id="a8e64-462">Tesztelje az alkalmazást, mérje meg az eredményt, elemezze és kezelje az esetleges kapott hibákat, majd ismételje meg a folyamatot.</span><span class="sxs-lookup"><span data-stu-id="a8e64-462">Test the application, measure the outcome, analyze and address any failures that result, and repeat the process.</span></span>

<span data-ttu-id="a8e64-463">**Tesztelés hibabeszúrással**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-463">**Fault injection testing**.</span></span> <span data-ttu-id="a8e64-464">Tesztelje a rendszer meghibásodásokkal szembeni rugalmasságát valódi hibák kiváltása vagy azok szimulálása révén.</span><span class="sxs-lookup"><span data-stu-id="a8e64-464">Test the resiliency of the system during failures, either by triggering actual failures or by simulating them.</span></span> <span data-ttu-id="a8e64-465">Alább található néhány gyakori meghibásodási helyzet:</span><span class="sxs-lookup"><span data-stu-id="a8e64-465">Here are some common failure scenarios to test:</span></span>

- <span data-ttu-id="a8e64-466">Állítson le virtuálisgép-példányokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-466">Shut down VM instances.</span></span>
- <span data-ttu-id="a8e64-467">Váltsa ki egyes folyamatok összeomlását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-467">Crash processes.</span></span>
- <span data-ttu-id="a8e64-468">Alkalmazzon lejárt tanúsítványokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-468">Expire certificates.</span></span>
- <span data-ttu-id="a8e64-469">Módosítson hozzáférési kulcsokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-469">Change access keys.</span></span>
- <span data-ttu-id="a8e64-470">Állítsa le a DNS-szolgáltatást a tartományvezérlőkön.</span><span class="sxs-lookup"><span data-stu-id="a8e64-470">Shut down the DNS service on domain controllers.</span></span>
- <span data-ttu-id="a8e64-471">Korlátozza az elérhető rendszererőforrásokat, mint például a RAM-ot vagy a szálak számát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-471">Limit available system resources, such as RAM or number of threads.</span></span>
- <span data-ttu-id="a8e64-472">Válasszon le lemezeket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-472">Unmount disks.</span></span>
- <span data-ttu-id="a8e64-473">Helyezzen ismételten üzembe egy virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-473">Redeploy a VM.</span></span>

<span data-ttu-id="a8e64-474">Mérje meg a helyreállítási időtartamokat, és győződjön meg róla, hogy azok megfelelnek az üzleti követelményeinek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-474">Measure the recovery times and verify that your business requirements are met.</span></span> <span data-ttu-id="a8e64-475">Több hibaállapot kombinációját is tesztelje.</span><span class="sxs-lookup"><span data-stu-id="a8e64-475">Test combinations of failure modes as well.</span></span> <span data-ttu-id="a8e64-476">Ügyeljen a hibák elkülönített kezelésére, és a kaszkádolásos terjedésük kiküszöbölésére.</span><span class="sxs-lookup"><span data-stu-id="a8e64-476">Make sure that failures don't cascade, and are handled in an isolated way.</span></span>

<span data-ttu-id="a8e64-477">Ez is egy érv a lehetséges hibapontok tervezési fázis során történő elemzése mellett.</span><span class="sxs-lookup"><span data-stu-id="a8e64-477">This is another reason why it's important to analyze possible failure points during the design phase.</span></span> <span data-ttu-id="a8e64-478">Az elemzés eredményei szolgálhatnak a tesztelési terve bemeneteiként.</span><span class="sxs-lookup"><span data-stu-id="a8e64-478">The results of that analysis should be inputs into your test plan.</span></span>

<span data-ttu-id="a8e64-479">**Terheléses tesztelés**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-479">**Load testing**.</span></span> <span data-ttu-id="a8e64-480">A terheléses tesztelés kulcsfontosságú a csak terhelés alatt bekövetkező hibák, mint például a háttéradatbázis túlterhelése vagy a szolgáltatásszabályozás azonosítása szempontjából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-480">Load testing is crucial for identifying failures that only happen under load, such as the backend database being overwhelmed or service throttling.</span></span> <span data-ttu-id="a8e64-481">A csúcsterhelést tesztelje, termelési adatok vagy a termelési adatokhoz lehető legközelebb álló szintetikus adatok használatával.</span><span class="sxs-lookup"><span data-stu-id="a8e64-481">Test for peak load, using production data or synthetic data that is as close to production data as possible.</span></span> <span data-ttu-id="a8e64-482">A cél annak megállapítása, hogyan viselkedik az alkalmazás valós körülmények között.</span><span class="sxs-lookup"><span data-stu-id="a8e64-482">The goal is to see how the application behaves under real-world conditions.</span></span>

<span data-ttu-id="a8e64-483">**Vészhelyreállítási próbák**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-483">**Disaster recovery drills**.</span></span> <span data-ttu-id="a8e64-484">A jó vészhelyreállítás terv önmagában nem elegendő.</span><span class="sxs-lookup"><span data-stu-id="a8e64-484">It is not enough if you have a good disaster recovery plan in place.</span></span> <span data-ttu-id="a8e64-485">Rendszeres tesztelés is szükséges, hogy a helyreállítási terv biztosan jól működjön, amikor szükség van rá.</span><span class="sxs-lookup"><span data-stu-id="a8e64-485">You need to test it periodically to ensure your recovery plan works fine when it matters.</span></span> <span data-ttu-id="a8e64-486">Az [Azure Site Recoveryvel][site-recovery] replikálhatja az Azure-beli virtuális gépeket, és [vészhelyreállítási próbákat][site-recovery-test-failover] hajthat végre az üzemi alkalmazások vagy a folyamatban lévő replikáció zavarása nélkül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-486">For Azure virtual machines, you can use [Azure Site Recovery][site-recovery] to replicate and [perform DR drills][site-recovery-test-failover] without impacting production applications or ongoing replication.</span></span>

## <a name="deploy-using-reliable-processes"></a><span data-ttu-id="a8e64-487">Üzembe helyezés megbízható folyamatokkal</span><span class="sxs-lookup"><span data-stu-id="a8e64-487">Deploy using reliable processes</span></span>

<span data-ttu-id="a8e64-488">Miután egy alkalmazás éles telepítése megtörtént, a frissítések hibaforrások lehetnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-488">Once an application is deployed to production, updates are a possible source of errors.</span></span> <span data-ttu-id="a8e64-489">A legrosszabb esetben egy rossz frissítés szolgáltatáskiesést okozhat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-489">In the worst case, a bad update can cause downtime.</span></span> <span data-ttu-id="a8e64-490">Ennek elkerülése végett az üzembehelyezési folyamatnak kiszámíthatónak és ismételhetőnek kell lennie.</span><span class="sxs-lookup"><span data-stu-id="a8e64-490">To avoid this, the deployment process must be predictable and repeatable.</span></span> <span data-ttu-id="a8e64-491">A telepítés magában foglalja az Azure-erőforrások kiépítését, az alkalmazáskód telepítését és a konfigurációs beállítások alkalmazását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-491">Deployment includes provisioning Azure resources, deploying application code, and applying configuration settings.</span></span> <span data-ttu-id="a8e64-492">A frissítések ezek némelyikére vagy mindegyikére terjedhetnek ki.</span><span class="sxs-lookup"><span data-stu-id="a8e64-492">An update may involve all three, or a subset.</span></span>

<span data-ttu-id="a8e64-493">A lényeg, hogy a manuális telepítés során gyakran fordul elő hiba –</span><span class="sxs-lookup"><span data-stu-id="a8e64-493">The crucial point is that manual deployments are prone to error.</span></span> <span data-ttu-id="a8e64-494">emiatt ajánlott automatizált, idempotens folyamat alkalmazása, amely igény szerint futtatható, meghibásodás esetén pedig újból futtatható.</span><span class="sxs-lookup"><span data-stu-id="a8e64-494">Therefore, it's recommended to have an automated, idempotent process that you can run on demand, and re-run if something fails.</span></span>

- <span data-ttu-id="a8e64-495">Automatizálja az Azure-erőforrások kiépítését Azure Resource Manager-sablonokkal.</span><span class="sxs-lookup"><span data-stu-id="a8e64-495">Use Azure Resource Manager templates to automate provisioning of Azure resources.</span></span>
- <span data-ttu-id="a8e64-496">Használja az [Azure Automation célállapot-konfigurációt][dsc] (DSC) a virtuális gépek konfigurálásához.</span><span class="sxs-lookup"><span data-stu-id="a8e64-496">Use [Azure Automation Desired State Configuration][dsc] (DSC) to configure VMs.</span></span>
- <span data-ttu-id="a8e64-497">Használjon automatizált üzembehelyezési folyamatot az alkalmazáskódhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-497">Use an automated deployment process for application code.</span></span>

<span data-ttu-id="a8e64-498">Az *infrastruktúra mint kód* és a *megváltoztathatatlan infrastruktúra* két, rugalmas üzembe helyezéshez kapcsolódó fogalom.</span><span class="sxs-lookup"><span data-stu-id="a8e64-498">Two concepts related to resilient deployment are *infrastructure as code* and *immutable infrastructure*.</span></span>

- <span data-ttu-id="a8e64-499">Az **infrastruktúra mint kód** az infrastruktúra kód használatával történő kiépítését és konfigurálását jelenti.</span><span class="sxs-lookup"><span data-stu-id="a8e64-499">**Infrastructure as code** is the practice of using code to provision and configure infrastructure.</span></span> <span data-ttu-id="a8e64-500">Az infrastruktúra mint kód megvalósítható deklaratív vagy imperatív módszerrel (vagy a kettő kombinációjával).</span><span class="sxs-lookup"><span data-stu-id="a8e64-500">Infrastructure as code may use a declarative approach or an imperative approach (or a combination of both).</span></span> <span data-ttu-id="a8e64-501">A Resource Manager-sablonok használata a deklaratív módszer egy példája.</span><span class="sxs-lookup"><span data-stu-id="a8e64-501">Resource Manager templates are an example of a declarative approach.</span></span> <span data-ttu-id="a8e64-502">A PowerShell-parancsprogramok használata az imperatív módszer egy példája.</span><span class="sxs-lookup"><span data-stu-id="a8e64-502">PowerShell scripts are an example of an imperative approach.</span></span>
- <span data-ttu-id="a8e64-503">A **megváltoztathatatlan infrastruktúra** elve szerint az éles üzembe helyezés után nem szabad módosítani az infrastruktúrát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-503">**Immutable infrastructure** is the principle that you shouldn’t modify infrastructure after it’s deployed to production.</span></span> <span data-ttu-id="a8e64-504">Ellenkező esetben előállhat olyan helyzet, amelyben alkalmi változtatások alkalmazása megnehezíti annak megállapítását, hogy pontosan mi változott, valamint a rendszerre vonatkozó döntések meghozatalát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-504">Otherwise, you can get into a state where ad hoc changes have been applied, so it's hard to know exactly what changed, and hard to reason about the system.</span></span>

<span data-ttu-id="a8e64-505">Kérdéses lehet még az alkalmazásfrissítések bevezetésének mikéntje.</span><span class="sxs-lookup"><span data-stu-id="a8e64-505">Another question is how to roll out an application update.</span></span> <span data-ttu-id="a8e64-506">Ajánlott a kék-zöld üzembe helyezés vagy a tesztcsoportos kiadások használata; mindkét módszer a frissítések szigorúan ellenőrzött bevezetését alkalmazza az esetleges rossz üzembe helyezés hatásainak minimalizálása céljából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-506">We recommend techniques such as blue-green deployment or canary releases, which push updates in highly controlled way to minimize possible impacts from a bad deployment.</span></span>

- <span data-ttu-id="a8e64-507">[A kék-zöld üzembe helyezés][blue-green] módszere esetében a rendszer az élő alkalmazástól elkülönített éles környezetben helyezi üzembe a frissítést.</span><span class="sxs-lookup"><span data-stu-id="a8e64-507">[Blue-green deployment][blue-green] is a technique where an update is deployed into a production environment separate from the live application.</span></span> <span data-ttu-id="a8e64-508">Az üzemelő példány ellenőrzése után irányítsa át a forgalmat a frissített verzióhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-508">After you validate the deployment, switch the traffic routing to the updated version.</span></span> <span data-ttu-id="a8e64-509">Ez például az Azure App Service Web Appsban előkészítési pontok használatával lehetséges.</span><span class="sxs-lookup"><span data-stu-id="a8e64-509">For example, Azure App Service Web Apps enables this with staging slots.</span></span>
- <span data-ttu-id="a8e64-510">[A tesztcsoportos kiadások][canary-release] a kék-zöld üzembe helyezéshez hasonlóan működnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-510">[Canary releases][canary-release] are similar to blue-green deployments.</span></span> <span data-ttu-id="a8e64-511">A teljes forgalom frissített verzióhoz való átirányítása helyett csak a felhasználók egy kis csoportja számára kell bevezetni a frissítést, a forgalom egy részét irányítva át az új üzemelő példányhoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-511">Instead of switching all traffic to the updated version, you roll out the update to a small percentage of users, by routing a portion of the traffic to the new deployment.</span></span> <span data-ttu-id="a8e64-512">Ha probléma merül fel, váltson vissza a régi üzemelő példányra.</span><span class="sxs-lookup"><span data-stu-id="a8e64-512">If there is a problem, back off and revert to the old deployment.</span></span> <span data-ttu-id="a8e64-513">Ellenkező esetben fokozatosan irányítsa át a forgalom többi részét az új verzióhoz, amíg az adatforgalom 100%-a át nem kerül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-513">Otherwise, route more of the traffic to the new version, until it gets 100% of the traffic.</span></span>

<span data-ttu-id="a8e64-514">Bármelyik módszert is választja, biztosítsa a legutóbbi biztosan jól működő üzemelő példányhoz való visszatérés lehetőségét arra az esetre, ha az új verzió nem működne.</span><span class="sxs-lookup"><span data-stu-id="a8e64-514">Whatever approach you take, make sure that you can roll back to the last-known-good deployment, in case the new version is not functioning.</span></span> <span data-ttu-id="a8e64-515">Továbbá ha hiba lép fel, az alkalmazásnaplóknak jelezniük kell, melyik verzió okozta a hibát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-515">Also, if errors occur, the application logs must indicate which version caused the error.</span></span>

## <a name="monitor-to-detect-failures"></a><span data-ttu-id="a8e64-516">Monitorozás a hibák észlelése érdekében</span><span class="sxs-lookup"><span data-stu-id="a8e64-516">Monitor to detect failures</span></span>

<span data-ttu-id="a8e64-517">A megfigyelés és a diagnosztika létfontosságú a rugalmasság szempontjából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-517">Monitoring and diagnostics are crucial for resiliency.</span></span> <span data-ttu-id="a8e64-518">Ha hiba lép fel, tudnia kell róla, hogy hiba történt, és a hiba kiváltó okairól szóló információkra is szüksége van.</span><span class="sxs-lookup"><span data-stu-id="a8e64-518">If something fails, you need to know that it failed, and you need insights into the cause of the failure.</span></span>

<span data-ttu-id="a8e64-519">A kiterjedt, elosztott rendszerek megfigyelése meglehetősen nehéz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-519">Monitoring a large-scale distributed system poses a significant challenge.</span></span> <span data-ttu-id="a8e64-520">Vegyünk például egy néhány tucat virtuális gépen futó alkalmazást – nem célszerű minden egyes virtuális gépre bejelentkezni, és egyenként végignézni a naplófájlokat a hiba elhárítása céljából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-520">Think about an application that runs on a few dozen VMs &mdash; it's not practical to log into each VM, one at a time, and look through log files, trying to troubleshoot a problem.</span></span> <span data-ttu-id="a8e64-521">Valószínű, hogy a virtuális gépek példányszáma sem statikus.</span><span class="sxs-lookup"><span data-stu-id="a8e64-521">Moreover, the number of VM instances is probably not static.</span></span> <span data-ttu-id="a8e64-522">A virtuális gépek száma nőhet vagy csökkenhet az alkalmazás skálázása során, időnként pedig meghibásodhat egy-egy példány, és az újbóli kiépítésére lehet szükség.</span><span class="sxs-lookup"><span data-stu-id="a8e64-522">VMs get added and removed as the application scales in and out, and occasionally an instance may fail and need to be reprovisioned.</span></span> <span data-ttu-id="a8e64-523">Ezen felül a felhőalkalmazások általában több adattárral (Azure Storage, SQL Database, Cosmos DB, Redis Cache) dolgoznak, és egyetlen felhasználói művelet több alrendszerre is kiterjedhet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-523">In addition, a typical cloud application might use multiple data stores (Azure storage, SQL Database, Cosmos DB, Redis cache), and a single user action may span multiple subsystems.</span></span>

<span data-ttu-id="a8e64-524">A megfigyelés és diagnosztika folyamata több különálló szakaszból áll:</span><span class="sxs-lookup"><span data-stu-id="a8e64-524">You can think of the monitoring and diagnostics process as a pipeline with several distinct stages:</span></span>

![Összetett SLA](./images/monitoring.png)

- <span data-ttu-id="a8e64-526">**Rendszerállapot**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-526">**Instrumentation**.</span></span> <span data-ttu-id="a8e64-527">A megfigyeléshez és diagnosztikához szükséges nyers adatok különböző forrásokból származhatnak, beleértve az alkalmazásnaplókat, webkiszolgáló-naplókat, az operációs rendszer teljesítményszámlálóit, adatbázisnaplókat és az Azure-platformba beépített diagnosztikákat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-527">The raw data for monitoring and diagnostics comes from a variety of sources, including application logs, web server logs, OS performance counters, database logs, and diagnostics built into the Azure platform.</span></span> <span data-ttu-id="a8e64-528">A legtöbb Azure-szolgáltatás rendelkezik diagnosztikai funkcióval, amely a problémák okainak feltárására használható.</span><span class="sxs-lookup"><span data-stu-id="a8e64-528">Most Azure services have a diagnostics feature that you can use to determine the cause of problems.</span></span>
- <span data-ttu-id="a8e64-529">**Gyűjtés és tárolás**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-529">**Collection and storage**.</span></span> <span data-ttu-id="a8e64-530">A nyers rendszerállapot-megfigyelési adatokat különböző helyeken és formátumokban tárolhatja a rendszer (pl.: alkalmazáskövetési naplók, IIS-naplók, teljesítményszámlálók).</span><span class="sxs-lookup"><span data-stu-id="a8e64-530">Raw instrumentation data can be held in various locations and with various formats (e.g., application trace logs, IIS logs, performance counters).</span></span> <span data-ttu-id="a8e64-531">E különálló forrásokat össze kell gyűjteni, összesíteni kell, és megbízható tárolóban kell elhelyezni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-531">These disparate sources are collected, consolidated, and put into reliable storage.</span></span>
- <span data-ttu-id="a8e64-532">**Elemzés és diagnosztika**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-532">**Analysis and diagnosis**.</span></span> <span data-ttu-id="a8e64-533">Az adatok összesítése után, az elemzésük révén végezhető el a hibaelhárítás és tekinthető át az alkalmazás állapota.</span><span class="sxs-lookup"><span data-stu-id="a8e64-533">After the data is consolidated, it can be analyzed to troubleshoot issues and provide an overall view of application health.</span></span>
- <span data-ttu-id="a8e64-534">**Megjelenítés és riasztások**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-534">**Visualization and alerts**.</span></span> <span data-ttu-id="a8e64-535">Ebben a szakaszban a telemetriaadatok olyan formában jelennek meg, amelyben a kezelő gyorsan észre tudja venni a problémákat vagy tendenciákat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-535">In this stage, telemetry data is presented in such a way that an operator can quickly notice problems or trends.</span></span> <span data-ttu-id="a8e64-536">Ilyenek például az irányítópultok vagy az email-riasztások.</span><span class="sxs-lookup"><span data-stu-id="a8e64-536">Example include dashboards or email alerts.</span></span>  

<span data-ttu-id="a8e64-537">A megfigyelés nem ugyanaz, mint a hibaészlelés.</span><span class="sxs-lookup"><span data-stu-id="a8e64-537">Monitoring is not the same as failure detection.</span></span> <span data-ttu-id="a8e64-538">Egy alkalmazás például észlelhet átmeneti hibát, és újból próbálkozhat, szolgáltatáskiesés nélkül.</span><span class="sxs-lookup"><span data-stu-id="a8e64-538">For example, your application might detect a transient error and retry, resulting in no downtime.</span></span> <span data-ttu-id="a8e64-539">Viszont naplóznia is kell az újrapróbálkozás műveletét, ami által megfigyelhető a hiba gyakorisága, és általános képet kaphat az alkalmazás állapotáról.</span><span class="sxs-lookup"><span data-stu-id="a8e64-539">But it should also log the retry operation, so that you can monitor the error rate, in order to get an overall picture of application health.</span></span>

<span data-ttu-id="a8e64-540">Az alkalmazásnaplók a diagnosztikai adatok fontos forrását képezik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-540">Application logs are an important source of diagnostics data.</span></span> <span data-ttu-id="a8e64-541">Ajánlott eljárások az alkalmazásnaplózáshoz:</span><span class="sxs-lookup"><span data-stu-id="a8e64-541">Best practices for application logging include:</span></span>

- <span data-ttu-id="a8e64-542">Naplózzon éles környezetben.</span><span class="sxs-lookup"><span data-stu-id="a8e64-542">Log in production.</span></span> <span data-ttu-id="a8e64-543">E nélkül a leginkább szükséges információkról maradhat le.</span><span class="sxs-lookup"><span data-stu-id="a8e64-543">Otherwise, you lose insight where you need it most.</span></span>
- <span data-ttu-id="a8e64-544">Naplózza a szolgáltatáshatárokon történő eseményeket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-544">Log events at service boundaries.</span></span> <span data-ttu-id="a8e64-545">Használjon korrelációs azonosítót, amely átnyúlik a szolgáltatáshatárokon.</span><span class="sxs-lookup"><span data-stu-id="a8e64-545">Include a correlation ID that flows across service boundaries.</span></span> <span data-ttu-id="a8e64-546">Ha egy tranzakció több szolgáltatáson nyúlik keresztül, és az egyikük meghibásodik, a korrelációs azonosító segít megtalálni a tranzakció meghiúsulásának okát.</span><span class="sxs-lookup"><span data-stu-id="a8e64-546">If a transaction flows through multiple services and one of them fails, the correlation ID will help you pinpoint why the transaction failed.</span></span>
- <span data-ttu-id="a8e64-547">Használjon szemantikus naplózást, más néven strukturált naplózást.</span><span class="sxs-lookup"><span data-stu-id="a8e64-547">Use semantic logging, also known as structured logging.</span></span> <span data-ttu-id="a8e64-548">A strukturálatlan naplók megnehezítik a naplóadatok használatának és elemzésének automatizálását, amelyre felhőszinten szükség van.</span><span class="sxs-lookup"><span data-stu-id="a8e64-548">Unstructured logs make it hard to automate the consumption and analysis of the log data, which is needed at cloud scale.</span></span>
- <span data-ttu-id="a8e64-549">Használjon aszinkron naplózást.</span><span class="sxs-lookup"><span data-stu-id="a8e64-549">Use asynchronous logging.</span></span> <span data-ttu-id="a8e64-550">Egyéb esetben maga a naplózórendszer is okozhatja az alkalmazás meghibásodását azáltal, hogy a kérelmek felgyülemlését okozza, mivel a naplózási esemény írására való várakozás blokkolja a többi kérelmet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-550">Otherwise, the logging system itself can cause the application to fail by causing requests to back up, as they block while waiting to write a logging event.</span></span>
- <span data-ttu-id="a8e64-551">Az alkalmazásnaplózás nem ugyanaz, mint a naplózás (auditing).</span><span class="sxs-lookup"><span data-stu-id="a8e64-551">Application logging is not the same as auditing.</span></span> <span data-ttu-id="a8e64-552">A naplózás megfelelőségi vagy jogszabályi megfeleléssel kapcsolatos célból történik.</span><span class="sxs-lookup"><span data-stu-id="a8e64-552">Auditing may be done for compliance or regulatory reasons.</span></span> <span data-ttu-id="a8e64-553">Emiatt a naplózási rekordoknak teljesnek kell lenniük, és nem fogadható el az elvetésük a tranzakciók feldolgozása során.</span><span class="sxs-lookup"><span data-stu-id="a8e64-553">As such, audit records must be complete, and it's not acceptable to drop any while processing transactions.</span></span> <span data-ttu-id="a8e64-554">Ha egy alkalmazás működését naplózni kell, a naplózást el kell választani a diagnosztikai naplózástól.</span><span class="sxs-lookup"><span data-stu-id="a8e64-554">If an application requires auditing, this should be kept separate from diagnostics logging.</span></span>

<span data-ttu-id="a8e64-555">A megfigyeléssel és diagnosztikával kapcsolatos további információkért lásd a [megfigyelési és diagnosztikai útmutatót][monitoring-guidance] tartalmazó szakaszt.</span><span class="sxs-lookup"><span data-stu-id="a8e64-555">For more information about monitoring and diagnostics, see [Monitoring and diagnostics guidance][monitoring-guidance].</span></span>

## <a name="respond-to-failures"></a><span data-ttu-id="a8e64-556">Válasz a hibákra</span><span class="sxs-lookup"><span data-stu-id="a8e64-556">Respond to failures</span></span>

<span data-ttu-id="a8e64-557">A korábbi szakaszok az automatizált helyreállítási stratégiákról szóltak, amelyek létfontosságúak a magas rendelkezésre állás szempontjából.</span><span class="sxs-lookup"><span data-stu-id="a8e64-557">Previous sections have focused on automated recovery strategies, which are critical for high availability.</span></span> <span data-ttu-id="a8e64-558">Időnként azonban kézi beavatkozás szükséges.</span><span class="sxs-lookup"><span data-stu-id="a8e64-558">However, sometimes manual intervention is needed.</span></span>

- <span data-ttu-id="a8e64-559">**Riasztások**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-559">**Alerts**.</span></span> <span data-ttu-id="a8e64-560">Kísérje figyelemmel az alkalmazása olyan figyelmeztető jeleit, amelyek proaktív beavatkozást igényelhetnek.</span><span class="sxs-lookup"><span data-stu-id="a8e64-560">Monitor your application for warning signs that may require proactive intervention.</span></span> <span data-ttu-id="a8e64-561">Ha például az SQL Database vagy a Cosmos DB rendszeresen szabályozza az alkalmazását, lehetséges, hogy növelnie kell az adatbázis-kapacitását, vagy optimalizálnia kell a lekérdezéseit.</span><span class="sxs-lookup"><span data-stu-id="a8e64-561">For example, if you see that SQL Database or Cosmos DB consistently throttles your application, you might need to increase your database capacity or optimize your queries.</span></span> <span data-ttu-id="a8e64-562">Ebben a példában, bár az alkalmazás képes átláthatóan kezelni a szabályozási hibákat, a telemetria riasztást küld, hogy nyomon követhesse az eseményeket.</span><span class="sxs-lookup"><span data-stu-id="a8e64-562">In this example, even though the application might handle the throttling errors transparently, your telemetry should still raise an alert so that you can follow up.</span></span>  
- <span data-ttu-id="a8e64-563">**Manuális feladatátvétel**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-563">**Manual failover**.</span></span> <span data-ttu-id="a8e64-564">Egyes rendszerek nem tudják automatikusan átadni a feladataikat. Az ilyen esetekben manuális feladatátvételre van szükség.</span><span class="sxs-lookup"><span data-stu-id="a8e64-564">Some systems cannot fail over automatically and require a manual failover.</span></span> <span data-ttu-id="a8e64-565">Az [Azure Site Recoveryvel][site-recovery] konfigurált Azure-beli virtuális gépeken [feladatátvételt hajthat végre][site-recovery-failover], és percek alatt helyreállíthatja a virtuális gépeit egy másik régióban.</span><span class="sxs-lookup"><span data-stu-id="a8e64-565">For Azure virtual machines configured with [Azure Site Recovery][site-recovery], you can [perform failover][site-recovery-failover] and recover your virtual machines in another region within minutes.</span></span>
- <span data-ttu-id="a8e64-566">**Működési készenlét tesztelése**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-566">**Operational readiness testing**.</span></span> <span data-ttu-id="a8e64-567">Ha az alkalmazás egy másodlagos régióba adja át a feladatait, akkor tesztelje a működési készenlétet, mielőtt visszaadja a feladatokat az elsődleges régióba.</span><span class="sxs-lookup"><span data-stu-id="a8e64-567">If your application fails over to a secondary region, you should perform an operational readiness test before you fail back to the primary region.</span></span> <span data-ttu-id="a8e64-568">A teszt ellenőrzi, hogy az elsődleges régió állapota megfelelő-e, és készen áll-e a forgalom újbóli fogadására.</span><span class="sxs-lookup"><span data-stu-id="a8e64-568">The test should verify that the primary region is healthy and ready to receive traffic again.</span></span>
- <span data-ttu-id="a8e64-569">**Adatkonzisztencia-ellenőrzés**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-569">**Data consistency check**.</span></span> <span data-ttu-id="a8e64-570">Ha egy adattár meghibásodik, adatinkonzisztencia jelentkezhet, amikor a tároló ismét elérhetővé válik. Ez főleg akkor jellemző, ha a rendszer replikálta az adatokat.</span><span class="sxs-lookup"><span data-stu-id="a8e64-570">If a failure happens in a data store, there may be data inconsistencies when the store becomes available again, especially if the data was replicated.</span></span>
- <span data-ttu-id="a8e64-571">**Visszaállítás biztonsági másolatból**.</span><span class="sxs-lookup"><span data-stu-id="a8e64-571">**Restoring from backup**.</span></span> <span data-ttu-id="a8e64-572">Ha például az SQL Database-ben regionális leállás történik, a georedundáns visszaállítással helyre tudja állítani az adatbázist a legutóbbi biztonsági másolatból.</span><span class="sxs-lookup"><span data-stu-id="a8e64-572">For example, if SQL Database experiences a regional outage, you can geo-restore the database from the latest backup.</span></span>

<span data-ttu-id="a8e64-573">Dokumentálja és tesztelje a vészhelyreállítási tervet.</span><span class="sxs-lookup"><span data-stu-id="a8e64-573">Document and test your disaster recovery plan.</span></span> <span data-ttu-id="a8e64-574">Értékelje az alkalmazáshibák üzletmenetre gyakorolt hatását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-574">Evaluate the business impact of application failures.</span></span> <span data-ttu-id="a8e64-575">A lehető legnagyobb mértékben automatizálja a folyamatot, és dokumentálja az összes manuális lépést, például a manuális feladatátvételt vagy az adatok biztonsági másolatból történő visszaállítását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-575">Automate the process as much as possible, and document any manual steps, such as manual failover or data restoration from backups.</span></span> <span data-ttu-id="a8e64-576">A terv ellenőrzéséhez és továbbfejlesztéséhez rendszeresen tesztelje a vészhelyreállítási folyamatot.</span><span class="sxs-lookup"><span data-stu-id="a8e64-576">Regularly test your disaster recovery process to validate and improve the plan.</span></span>

## <a name="summary"></a><span data-ttu-id="a8e64-577">Összegzés</span><span class="sxs-lookup"><span data-stu-id="a8e64-577">Summary</span></span>

<span data-ttu-id="a8e64-578">A cikk holisztikus szempontból tárgyalta a rugalmasságot, és kiemelte a felhőalapú környezet néhány egyedi kihívását.</span><span class="sxs-lookup"><span data-stu-id="a8e64-578">This article discussed resiliency from a holistic perspective, emphasizing some of the unique challenges of the cloud.</span></span> <span data-ttu-id="a8e64-579">Ezek közé tartozik a felhőalapú számítógép-használat elosztott jellege, a hagyományos hardverek használata és az átmeneti hálózati hibák jelenléte.</span><span class="sxs-lookup"><span data-stu-id="a8e64-579">These include the distributed nature of cloud computing, the use of commodity hardware, and the presence of transient network faults.</span></span>

<span data-ttu-id="a8e64-580">A cikk lényeges pontjai a következők:</span><span class="sxs-lookup"><span data-stu-id="a8e64-580">Here are the major points to take away from this article:</span></span>

- <span data-ttu-id="a8e64-581">A rugalmasságnak köszönhetően magasabb lesz a rendelkezésre állás, és átlagosan kevesebb idő szükséges a hibák utáni helyreálláshoz.</span><span class="sxs-lookup"><span data-stu-id="a8e64-581">Resiliency leads to higher availability, and lower mean time to recover from failures.</span></span>
- <span data-ttu-id="a8e64-582">A rugalmasság elérése a felhőben más technikákat igényel, mint a hagyományos helyszíni megoldások esetében.</span><span class="sxs-lookup"><span data-stu-id="a8e64-582">Achieving resiliency in the cloud requires a different set of techniques from traditional on-premises solutions.</span></span>
- <span data-ttu-id="a8e64-583">A rugalmasság nem jön létre magától.</span><span class="sxs-lookup"><span data-stu-id="a8e64-583">Resiliency does not happen by accident.</span></span> <span data-ttu-id="a8e64-584">Meg kell tervezni, és már a kezdetektől be kell építeni.</span><span class="sxs-lookup"><span data-stu-id="a8e64-584">It must be designed and built in from the start.</span></span>
- <span data-ttu-id="a8e64-585">A rugalmasság az alkalmazás életciklusának minden részére kihat, a tervezéstől a kódoláson át egészen a műveletekig.</span><span class="sxs-lookup"><span data-stu-id="a8e64-585">Resiliency touches every part of the application lifecycle, from planning and coding to operations.</span></span>
- <span data-ttu-id="a8e64-586">Teszteljen és monitorozzon!</span><span class="sxs-lookup"><span data-stu-id="a8e64-586">Test and monitor!</span></span>

<!-- links -->

[blue-green]: https://martinfowler.com/bliki/BlueGreenDeployment.html
[canary-release]: https://martinfowler.com/bliki/CanaryRelease.html
[circuit-breaker-pattern]: https://msdn.microsoft.com/library/dn589784.aspx
[compensating-transaction-pattern]: https://msdn.microsoft.com/library/dn589804.aspx
[containers]: https://en.wikipedia.org/wiki/Operating-system-level_virtualization
[dsc]: /azure/automation/automation-dsc-overview
[contingency-planning-guide]: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
[fma]: failure-mode-analysis.md
[hystrix]: https://medium.com/netflix-techblog/introducing-hystrix-for-resilience-engineering-13531c1ab362
[jmeter]: https://jmeter.apache.org/
[load-leveling-pattern]: ../patterns/queue-based-load-leveling.md
[monitoring-guidance]: ../best-practices/monitoring.md
[ra-basic-web]: ../reference-architectures/app-service-web-app/basic-web-app.md
[ra-multi-vm]: ../reference-architectures/virtual-machines-windows/multi-vm.md
[checklist]: ../checklist/resiliency.md
[retry-pattern]: ../patterns/retry.md
[retry-service-specific guidance]: ../best-practices/retry-service-specific.md
[sla]: https://azure.microsoft.com/support/legal/sla/
[throttling-pattern]: ../patterns/throttling.md
[tm]: https://azure.microsoft.com/services/traffic-manager/
[tm-failover]: /azure/traffic-manager/traffic-manager-monitoring
[tm-sla]: https://azure.microsoft.com/support/legal/sla/traffic-manager
[site-recovery]:/azure/site-recovery/azure-to-azure-quickstart/
[site-recovery-test-failover]:/azure/site-recovery/azure-to-azure-tutorial-dr-drill/
[site-recovery-failover]:/azure/site-recovery/azure-to-azure-tutorial-failover-failback/
