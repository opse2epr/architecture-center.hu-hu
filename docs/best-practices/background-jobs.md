---
title: Útmutató a háttérfeladatokhoz
description: Útmutatás a felhasználói felülettől függetlenül futó háttérfeladatokhoz.
author: dragon119
ms.date: 05/24/2017
pnp.series.title: Best Practices
ms.openlocfilehash: 57fd7a6cc400b53e51e08fb5a1377dce4ae61327
ms.sourcegitcommit: e9eb2b895037da0633ef3ccebdea2fcce047620f
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/30/2018
ms.locfileid: "50251923"
---
# <a name="background-jobs"></a><span data-ttu-id="e2d86-103">Háttérfeladatok</span><span class="sxs-lookup"><span data-stu-id="e2d86-103">Background jobs</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="e2d86-104">Számos különböző típusú alkalmazásban van szükség olyan háttérfeladatokra, amelyek a felhasználói felülettől függetlenül futnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-104">Many types of applications require background tasks that run independently of the user interface (UI).</span></span> <span data-ttu-id="e2d86-105">Ilyenek lehetnek a kötegelt feladatok, az intenzív feldolgozási feladatok és a hosszú futású folyamatok, például a munkafolyamatok.</span><span class="sxs-lookup"><span data-stu-id="e2d86-105">Examples include batch jobs, intensive processing tasks, and long-running processes such as workflows.</span></span> <span data-ttu-id="e2d86-106">A háttérfeladatok felhasználói beavatkozás nélkül hajthatók végre – az alkalmazás a feladat elindítását követően folytathatja a felhasználók interaktív kéréseinek feldolgozását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-106">Background jobs can be executed without requiring user interaction--the application can start the job and then continue to process interactive requests from users.</span></span> <span data-ttu-id="e2d86-107">Ez segít csökkenteni az alkalmazás felhasználói felületének terhelését, ami javíthatja a rendelkezésre állást és csökkentheti az interaktív válaszidőket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-107">This can help to minimize the load on the application UI, which can improve availability and reduce interactive response times.</span></span>

<span data-ttu-id="e2d86-108">Például ha egy alkalmazás bélyegképeket hoz létre a felhasználók által feltöltött képekhez, azt megteheti háttérfeladatként is, a bélyegképeket azok elkészültekor a tárolóba mentve – anélkül, hogy a felhasználónak meg kellene várnia a folyamat befejeztét.</span><span class="sxs-lookup"><span data-stu-id="e2d86-108">For example, if an application is required to generate thumbnails of images that are uploaded by users, it can do this as a background job and save the thumbnail to storage when it is complete--without the user needing to wait for the process to be completed.</span></span> <span data-ttu-id="e2d86-109">Például egy megrendelés feladása esetén a felhasználó ugyanígy inicializálja a megrendelést feldolgozó háttér-munkafolyamatot, majd a felhasználói felületen folytathatja a webes alkalmazás böngészését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-109">In the same way, a user placing an order can initiate a background workflow that processes the order, while the UI allows the user to continue browsing the web app.</span></span> <span data-ttu-id="e2d86-110">Ha a háttérben futó feladat befejeződött, az frissítheti a tárolt rendelési adatokat, és e-mailben visszaigazolhatja a megrendelést a felhasználónak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-110">When the background job is complete, it can update the stored orders data and send an email to the user that confirms the order.</span></span>

<span data-ttu-id="e2d86-111">Amikor azt mérlegeli, hogy egy adott feladat háttérfeladatként legyen-e végrehajtva, a fő szempont, hogy a feladat képes-e felhasználói beavatkozás nélkül futni, illetve anélkül, hogy a felhasználói felület megvárná a feladat befejezését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-111">When you consider whether to implement a task as a background job, the main criteria is whether the task can run without user interaction and without the UI needing to wait for the job to be completed.</span></span> <span data-ttu-id="e2d86-112">Az olyan feladatok, amelyekhez szükséges, hogy a felhasználó vagy a felület várakozzon, nem alkalmasak háttérben való futtatásra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-112">Tasks that require the user or the UI to wait while they are completed might not be appropriate as background jobs.</span></span>

## <a name="types-of-background-jobs"></a><span data-ttu-id="e2d86-113">Háttérfeladatok típusai</span><span class="sxs-lookup"><span data-stu-id="e2d86-113">Types of background jobs</span></span>
<span data-ttu-id="e2d86-114">A háttérfeladatok rendszerint a következő típusú feladatok közül egyet vagy többet tartalmaznak:</span><span class="sxs-lookup"><span data-stu-id="e2d86-114">Background jobs typically include one or more of the following types of jobs:</span></span>

* <span data-ttu-id="e2d86-115">Számításigényes feladatok, például matematikai számítások vagy szerkezeti modellek elemzése.</span><span class="sxs-lookup"><span data-stu-id="e2d86-115">CPU-intensive jobs, such as mathematical calculations or structural model analysis.</span></span>
* <span data-ttu-id="e2d86-116">Adatátvitel-igényes feladatok, például tárolási tranzakciók sorozatának végrehajtása vagy fájlok indexelése.</span><span class="sxs-lookup"><span data-stu-id="e2d86-116">I/O-intensive jobs, such as executing a series of storage transactions or indexing files.</span></span>
* <span data-ttu-id="e2d86-117">Kötegelt feladatok, például éjszakai adatfrissítések vagy ütemezett feldolgozás.</span><span class="sxs-lookup"><span data-stu-id="e2d86-117">Batch jobs, such as nightly data updates or scheduled processing.</span></span>
* <span data-ttu-id="e2d86-118">Hosszan futó munkafolyamatok, például megrendelések teljesítése vagy szolgáltatások és rendszerek üzembe helyezése.</span><span class="sxs-lookup"><span data-stu-id="e2d86-118">Long-running workflows, such as order fulfillment, or provisioning services and systems.</span></span>
* <span data-ttu-id="e2d86-119">Bizalmas adatok feldolgozása, ahol a feladat egy biztonságosabb helyre lesz továbbítva feldolgozásra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-119">Sensitive-data processing where the task is handed off to a more secure location for processing.</span></span> <span data-ttu-id="e2d86-120">Például előfordulhat, hogy a bizalmas adatokat nem szeretné egy adott webalkalmazáson belül feldolgozni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-120">For example, you might not want to process sensitive data within a web app.</span></span> <span data-ttu-id="e2d86-121">Ehelyett például a [Gatekeeper-minta](https://msdn.microsoft.com/library/dn589793.aspx) használatával az adatokat átadja egy elkülönített háttérfolyamatnak, amely hozzáféréssel rendelkezik egy védett tárolóhoz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-121">Instead, you might use a pattern such as [Gatekeeper](https://msdn.microsoft.com/library/dn589793.aspx) to transfer the data to an isolated background process that has access to protected storage.</span></span>

## <a name="triggers"></a><span data-ttu-id="e2d86-122">Eseményindítók</span><span class="sxs-lookup"><span data-stu-id="e2d86-122">Triggers</span></span>
<span data-ttu-id="e2d86-123">A háttérben futó feladatok számos különböző módon indíthatók el.</span><span class="sxs-lookup"><span data-stu-id="e2d86-123">Background jobs can be initiated in several different ways.</span></span> <span data-ttu-id="e2d86-124">Az alábbi kategóriák valamelyikébe tartoznak:</span><span class="sxs-lookup"><span data-stu-id="e2d86-124">They fall into one of the following categories:</span></span>

* <span data-ttu-id="e2d86-125">[**Eseményvezérelt eseményindítók**](#event-driven-triggers).</span><span class="sxs-lookup"><span data-stu-id="e2d86-125">[**Event-driven triggers**](#event-driven-triggers).</span></span> <span data-ttu-id="e2d86-126">A feladat egy eseményre, általában a felhasználó által végrehajtott műveletre vagy a munkafolyamat egy lépésére válaszképpen indul.</span><span class="sxs-lookup"><span data-stu-id="e2d86-126">The task is started in response to an event, typically an action taken by a user or a step in a workflow.</span></span>
* <span data-ttu-id="e2d86-127">[**Ütemezésvezérelt eseményindítók**](#schedule-driven-triggers).</span><span class="sxs-lookup"><span data-stu-id="e2d86-127">[**Schedule-driven triggers**](#schedule-driven-triggers).</span></span> <span data-ttu-id="e2d86-128">A feladatot egy időzítésen alapuló ütemezés indítja el.</span><span class="sxs-lookup"><span data-stu-id="e2d86-128">The task is invoked on a schedule based on a timer.</span></span> <span data-ttu-id="e2d86-129">Ez lehet egy ismétlődő ütemezés szerint vagy egy egyszeri hívás, amely egy későbbi időpontra lett megadva.</span><span class="sxs-lookup"><span data-stu-id="e2d86-129">This might be a recurring schedule or a one-off invocation that is specified for a later time.</span></span>

### <a name="event-driven-triggers"></a><span data-ttu-id="e2d86-130">Eseményvezérelt eseményindítók</span><span class="sxs-lookup"><span data-stu-id="e2d86-130">Event-driven triggers</span></span>
<span data-ttu-id="e2d86-131">Az eseményvezérelt hívás egy eseményindító segítségével indítja el a háttérfeladatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-131">Event-driven invocation uses a trigger to start the background task.</span></span> <span data-ttu-id="e2d86-132">Példa az eseményvezérelt eseményindítókra:</span><span class="sxs-lookup"><span data-stu-id="e2d86-132">Examples of using event-driven triggers include:</span></span>

* <span data-ttu-id="e2d86-133">A felhasználói felület vagy egy másik feladat egy üzenetet küld az üzenetsorba.</span><span class="sxs-lookup"><span data-stu-id="e2d86-133">The UI or another job places a message in a queue.</span></span> <span data-ttu-id="e2d86-134">Az üzenet egy lezajlott művelettel kapcsolatos adatokat tartalmaz, például egy felhasználó rendelését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-134">The message contains data about an action that has taken place, such as the user placing an order.</span></span> <span data-ttu-id="e2d86-135">A háttérfeladat figyeli ezt az üzenetsort, és észleli az új üzenet megérkezését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-135">The background task listens on this queue and detects the arrival of a new message.</span></span> <span data-ttu-id="e2d86-136">Kiolvassa az üzenetet, és az adatait használja a háttérfeladat bemeneti adataiként.</span><span class="sxs-lookup"><span data-stu-id="e2d86-136">It reads the message and uses the data in it as the input to the background job.</span></span>
* <span data-ttu-id="e2d86-137">A felhasználói felület vagy egy másik feladat ment vagy frissít egy értéket a tárolóban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-137">The UI or another job saves or updates a value in storage.</span></span> <span data-ttu-id="e2d86-138">A háttérfeladat figyeli a tárolót, és észleli a változásokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-138">The background task monitors the storage and detects changes.</span></span> <span data-ttu-id="e2d86-139">Kiolvassa az adatokat, és azokat használja a háttérfeladat bemeneti adataiként.</span><span class="sxs-lookup"><span data-stu-id="e2d86-139">It reads the data and uses it as the input to the background job.</span></span>
* <span data-ttu-id="e2d86-140">A felhasználói felület vagy egy másik feladat egy kérést küld egy végpontra, például egy HTTPS URI azonosítóra vagy egy webszolgáltatásként megnyitott API-ra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-140">The UI or another job makes a request to an endpoint, such as an HTTPS URI, or an API that is exposed as a web service.</span></span> <span data-ttu-id="e2d86-141">A háttérfeladat végrehajtásához szükséges adatokat a kérés részeként továbbítja.</span><span class="sxs-lookup"><span data-stu-id="e2d86-141">It passes the data that is required to complete the background task as part of the request.</span></span> <span data-ttu-id="e2d86-142">A végpont vagy a webszolgáltatás meghívja a háttérfeladatot, amely az adatokat használja bemenetként.</span><span class="sxs-lookup"><span data-stu-id="e2d86-142">The endpoint or web service invokes the background task, which uses the data as its input.</span></span>

<span data-ttu-id="e2d86-143">Tipikus példák az eseményvezérelten meghívható feladatokra a képfeldolgozás, a munkafolyamatok, az adatok távoli szolgáltatásoknak való küldése, az e-mailek küldése, valamint az új felhasználók létrehozása több-bérlős alkalmazásokban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-143">Typical examples of tasks that are suited to event-driven invocation include image processing, workflows, sending information to remote services, sending email messages, and provisioning new users in multitenant applications.</span></span>

### <a name="schedule-driven-triggers"></a><span data-ttu-id="e2d86-144">Ütemezésvezérelt eseményindítók</span><span class="sxs-lookup"><span data-stu-id="e2d86-144">Schedule-driven triggers</span></span>
<span data-ttu-id="e2d86-145">Az ütemezésvezérelt hívás egy időzítő segítségével indítja el a háttérfeladatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-145">Schedule-driven invocation uses a timer to start the background task.</span></span> <span data-ttu-id="e2d86-146">Példa az ütemezésvezérelt eseményindítókra:</span><span class="sxs-lookup"><span data-stu-id="e2d86-146">Examples of using schedule-driven triggers include:</span></span>

* <span data-ttu-id="e2d86-147">Egy, az alkalmazásban helyileg vagy az alkalmazás operációs rendszerének részeként futó időzítő rendszeres időközönként meghív egy adott háttérfeladatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-147">A timer that is running locally within the application or as part of the application’s operating system invokes a background task on a regular basis.</span></span>
* <span data-ttu-id="e2d86-148">Egy másik alkalmazásban futó időzítő vagy egy időzítőszolgáltatás, például az Azure Scheduler rendszeres időközönként kérést küld egy API-nak vagy egy webszolgáltatásnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-148">A timer that is running in a different application, or a timer service such as Azure Scheduler, sends a request to an API or web service on a regular basis.</span></span> <span data-ttu-id="e2d86-149">Az API vagy a webszolgáltatás meghívja a háttérfeladatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-149">The API or web service invokes the background task.</span></span>
* <span data-ttu-id="e2d86-150">Egy külön folyamat vagy alkalmazás elindít egy időzítőt, amely egy adott időtartam elteltével vagy egy adott időpontban kezdeményezi a háttérfeladat meghívását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-150">A separate process or application starts a timer that causes the background task to be invoked once after a specified time delay, or at a specific time.</span></span>

<span data-ttu-id="e2d86-151">Az ütemezésvezérelten meghívható feladatokra tipikus példák a kötegelt feldolgozási rutinok (például a kapcsolódó termékek listájának frissítése a felhasználók legutóbbi tevékenységei alapján), a rutinszerű adatfeldolgozási feladatok (például az indexek frissítése vagy a halmozott eredmények létrehozása), az adatok elemzése a napi jelentésekhez, a megőrzött adatok törlése, valamint az adatkonzisztencia ellenőrzése.</span><span class="sxs-lookup"><span data-stu-id="e2d86-151">Typical examples of tasks that are suited to schedule-driven invocation include batch-processing routines (such as updating related-products lists for users based on their recent behavior), routine data processing tasks (such as updating indexes or generating accumulated results), data analysis for daily reports, data retention cleanup, and data consistency checks.</span></span>

<span data-ttu-id="e2d86-152">Ha egy olyan ütemezésvezérelt feladatot használ, amelynek egyetlen példányként kell futnia, figyeljen a következőkre:</span><span class="sxs-lookup"><span data-stu-id="e2d86-152">If you use a schedule-driven task that must run as a single instance, be aware of the following:</span></span>

* <span data-ttu-id="e2d86-153">Ha átméretezi a feladatütemezőt futtató számítási példányt (például a Windows ütemezett feladatait használó virtuális gépet), a feladatütemező több példányban fog futni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-153">If the compute instance that is running the scheduler (such as a virtual machine using Windows scheduled tasks) is scaled, you will have multiple instances of the scheduler running.</span></span> <span data-ttu-id="e2d86-154">Ezek a feladatnak egyszerre több példányát is elindíthatják.</span><span class="sxs-lookup"><span data-stu-id="e2d86-154">These could start multiple instances of the task.</span></span>
* <span data-ttu-id="e2d86-155">Ha a feladatok hosszabb ideig futnak, mint az ütemezett események között eltelt időtartam, a feladatütemező elindíthatja a feladat egy újabb példányát, miközben az előző még mindig fut.</span><span class="sxs-lookup"><span data-stu-id="e2d86-155">If tasks run for longer than the period between scheduler events, the scheduler may start another instance of the task while the previous one is still running.</span></span>

## <a name="returning-results"></a><span data-ttu-id="e2d86-156">Eredmények visszaadása</span><span class="sxs-lookup"><span data-stu-id="e2d86-156">Returning results</span></span>
<span data-ttu-id="e2d86-157">A háttérfeladatok aszinkron módon futnak a felhasználói felülethez vagy a háttérfeladatot meghívó folyamathoz képest – egy külön folyamatban, sőt akár külön helyen is.</span><span class="sxs-lookup"><span data-stu-id="e2d86-157">Background jobs execute asynchronously in a separate process, or even in a separate location, from the UI or the process that invoked the background task.</span></span> <span data-ttu-id="e2d86-158">Ideális esetben a háttérfeladatokat a meghívásuk után nem kell nyomon követni, és a végrehajtásuk folyamata nincs kihatással a felhasználói felületre vagy az azokat meghívó folyamatra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-158">Ideally, background tasks are “fire and forget” operations, and their execution progress has no impact on the UI or the calling process.</span></span> <span data-ttu-id="e2d86-159">Ez azt jelenti, hogy a meghívó folyamat nem vár a feladatok befejezésére.</span><span class="sxs-lookup"><span data-stu-id="e2d86-159">This means that the calling process does not wait for completion of the tasks.</span></span> <span data-ttu-id="e2d86-160">Emiatt nem is képes automatikusan észlelni, ha a feladat befejeződik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-160">Therefore, it cannot automatically detect when the task ends.</span></span>

<span data-ttu-id="e2d86-161">Amennyiben szükséges, hogy a háttérfeladat kommunikálja a meghívó feladatnak a végrehajtás folyamatát vagy befejeztét, erre ki kell alakítani valamilyen mechanizmust.</span><span class="sxs-lookup"><span data-stu-id="e2d86-161">If you require a background task to communicate with the calling task to indicate progress or completion, you must implement a mechanism for this.</span></span> <span data-ttu-id="e2d86-162">Néhány példa:</span><span class="sxs-lookup"><span data-stu-id="e2d86-162">Some examples are:</span></span>

* <span data-ttu-id="e2d86-163">Állapotjelző érték beírása egy, a felhasználói felület vagy a meghívó feladat által elérhető tárolóba, így az szükség esetén figyelheti és ellenőrizheti ezt az értéket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-163">Write a status indicator value to storage that is accessible to the UI or caller task, which can monitor or check this value when required.</span></span> <span data-ttu-id="e2d86-164">A háttérfaladat által a meghívónak visszaadandó egyéb adatok is elhelyezhetők ugyanebben a tárhelyben.</span><span class="sxs-lookup"><span data-stu-id="e2d86-164">Other data that the background task must return to the caller can be placed into the same storage.</span></span>
* <span data-ttu-id="e2d86-165">Egy, a felhasználói felület vagy a meghívó által figyelt válaszüzenetsor létrehozása.</span><span class="sxs-lookup"><span data-stu-id="e2d86-165">Establish a reply queue that the UI or caller listens on.</span></span> <span data-ttu-id="e2d86-166">A háttérfeladat az állapotot vagy a befejezést jelző üzeneteket küldhet az üzenetsorra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-166">The background task can send messages to the queue that indicate status and completion.</span></span> <span data-ttu-id="e2d86-167">A háttérfaladat által a meghívónak visszaadandó adatok is elhelyezhetők ezekben az üzenetekben.</span><span class="sxs-lookup"><span data-stu-id="e2d86-167">Data that the background task must return to the caller can be placed into the messages.</span></span> <span data-ttu-id="e2d86-168">Az Azure Service Bus alkalmazása esetén használhatja a **ReplyTo** és a **CorrelationId** tulajdonságot ennek a képességnek az implementálásához.</span><span class="sxs-lookup"><span data-stu-id="e2d86-168">If you are using Azure Service Bus, you can use the **ReplyTo** and **CorrelationId** properties to implement this capability.</span></span>
* <span data-ttu-id="e2d86-169">Elérhetővé tehet egy API-t vagy végpontot a háttérfeladatból, amelyet a felhasználói felület vagy a meghívó el tud érni az állapotadatok beszerzéséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-169">Expose an API or endpoint from the background task that the UI or caller can access to obtain status information.</span></span> <span data-ttu-id="e2d86-170">A háttérfaladat által a meghívónak visszaadandó adatok is részét képezhetik ennek a válasznak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-170">Data that the background task must return to the caller can be included in the response.</span></span>
* <span data-ttu-id="e2d86-171">A háttérfeladat visszahívást kezdeményezhet a felhasználói felület vagy a hívó felé egy API-n keresztül, és előre meghatározott pontokon vagy a befejezéskor jelezheti az állapotát.</span><span class="sxs-lookup"><span data-stu-id="e2d86-171">Have the background task call back to the UI or caller through an API to indicate status at predefined points or on completion.</span></span> <span data-ttu-id="e2d86-172">Ez történhet helyben létrehozott eseményeken vagy egy közzétételi-előfizetési mechanizmuson keresztül.</span><span class="sxs-lookup"><span data-stu-id="e2d86-172">This might be through events raised locally or through a publish-and-subscribe mechanism.</span></span> <span data-ttu-id="e2d86-173">A háttérfaladat által a meghívónak visszaadandó adatok is részét képezhetik ennek a kérésnek vagy az esemény hasznos adatainak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-173">Data that the background task must return to the caller can be included in the request or event payload.</span></span>

## <a name="hosting-environment"></a><span data-ttu-id="e2d86-174">Üzemeltetési környezet</span><span class="sxs-lookup"><span data-stu-id="e2d86-174">Hosting environment</span></span>
<span data-ttu-id="e2d86-175">A háttérfeladatokat futtathatja számos különböző Azure platformszolgáltatás használatával:</span><span class="sxs-lookup"><span data-stu-id="e2d86-175">You can host background tasks by using a range of different Azure platform services:</span></span>

* <span data-ttu-id="e2d86-176">[**Azure Web Apps és WebJobs**](#azure-web-apps-and-webjobs).</span><span class="sxs-lookup"><span data-stu-id="e2d86-176">[**Azure Web Apps and WebJobs**](#azure-web-apps-and-webjobs).</span></span> <span data-ttu-id="e2d86-177">A WebJobs használatával egy webalkalmazás kontextusában egyéni feladatokat hajthat végre számos különböző típusú szkript vagy végrehajtható program alapján.</span><span class="sxs-lookup"><span data-stu-id="e2d86-177">You can use WebJobs to execute custom jobs based on a range of different types of scripts or executable programs within the context of a web app.</span></span>
* <span data-ttu-id="e2d86-178">[**Azure Virtual Machines**](#azure-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="e2d86-178">[**Azure Virtual Machines**](#azure-virtual-machines).</span></span> <span data-ttu-id="e2d86-179">Ha Windows-szolgáltatással rendelkezik, vagy a Windows Feladatütemezőt szeretné használni, általános érdemes a háttérfeladatokat egy dedikált virtuális gépen futtatnia.</span><span class="sxs-lookup"><span data-stu-id="e2d86-179">If you have a Windows service or want to use the Windows Task Scheduler, it is common to host your background tasks within a dedicated virtual machine.</span></span>
* <span data-ttu-id="e2d86-180">[**Azure Batch**](#azure-batch).</span><span class="sxs-lookup"><span data-stu-id="e2d86-180">[**Azure Batch**](#azure-batch).</span></span> <span data-ttu-id="e2d86-181">A Batch platformszolgáltatás számításigényes munkák futtatását ütemezi virtuális gépek felügyelt gyűjteményében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-181">Batch is a platform service that schedules compute-intensive work to run on a managed collection of virtual machines.</span></span> <span data-ttu-id="e2d86-182">Automatikusan képes méretezni a számítási erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-182">It can automatically scale compute resources.</span></span>
* <span data-ttu-id="e2d86-183">[**Azure Container Service**](#azure-container-service).</span><span class="sxs-lookup"><span data-stu-id="e2d86-183">[**Azure Container Service**](#azure-container-service).</span></span> <span data-ttu-id="e2d86-184">Az Azure Container Service egy tárolóüzemeltetési környezetet biztosít az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-184">Azure Container Service provides a container hosting environment on Azure.</span></span> 
* <span data-ttu-id="e2d86-185">[**Azure Cloud Services**](#azure-cloud-services).</span><span class="sxs-lookup"><span data-stu-id="e2d86-185">[**Azure Cloud Services**](#azure-cloud-services).</span></span> <span data-ttu-id="e2d86-186">Ezzel a szolgáltatással háttérfeladatként futó szerepkörökben is írhat kódot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-186">You can write code within a role that executes as a background task.</span></span>

<span data-ttu-id="e2d86-187">Az alábbi szakaszok részletesebben ismertetik ezeket a lehetőségeket, és olyan szempontokat is tartalmaznak, amelyek alapján kiválaszthatja az Önnek megfelelő lehetőséget.</span><span class="sxs-lookup"><span data-stu-id="e2d86-187">The following sections describe each of these options in more detail, and include considerations to help you choose the appropriate option.</span></span>

### <a name="azure-web-apps-and-webjobs"></a><span data-ttu-id="e2d86-188">Azure Web Apps és WebJobs</span><span class="sxs-lookup"><span data-stu-id="e2d86-188">Azure Web Apps and WebJobs</span></span>

<span data-ttu-id="e2d86-189">Az Azure WebJobs használatával egyéni feladatokat hajthat végre háttérfeladatként egy Azure Web App-webalkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-189">You can use Azure WebJobs to execute custom jobs as background tasks within an Azure Web App.</span></span> <span data-ttu-id="e2d86-190">A WebJobs-feladatok a webalkalmazás kontextusában futnak, folyamatosan működő folyamatokként.</span><span class="sxs-lookup"><span data-stu-id="e2d86-190">WebJobs run within the context of your web app as a continuous process.</span></span> <span data-ttu-id="e2d86-191">A WebJobs-feladatok továbbá az Azure Scheduler eseményindító eseménye vagy külső tényezők bekövetkezése esetén is futtathatók, például a blobtárolók és az üzenetsorok változásakor.</span><span class="sxs-lookup"><span data-stu-id="e2d86-191">WebJobs also run in response to a trigger event from Azure Scheduler or external factors, such as changes to storage blobs and message queues.</span></span> <span data-ttu-id="e2d86-192">A feladatok igény szerint indíthatók és állíthatók le, és szabályosan állnak le.</span><span class="sxs-lookup"><span data-stu-id="e2d86-192">Jobs can be started and stopped on demand, and shut down gracefully.</span></span> <span data-ttu-id="e2d86-193">Ha egy folyamatosan futó WebJobs-feladat leáll, automatikusan újraindul.</span><span class="sxs-lookup"><span data-stu-id="e2d86-193">If a continuously running WebJob fails, it is automatically restarted.</span></span> <span data-ttu-id="e2d86-194">Az újrapróbálkozási és hibaműveletek konfigurálhatók.</span><span class="sxs-lookup"><span data-stu-id="e2d86-194">Retry and error actions are configurable.</span></span>

<span data-ttu-id="e2d86-195">WebJobs-feladatok konfigurálásakor:</span><span class="sxs-lookup"><span data-stu-id="e2d86-195">When you configure a WebJob:</span></span>

* <span data-ttu-id="e2d86-196">Ha azt szeretné, hogy a feladat egy eseményvezérelt eseményindítóra válaszoljon, a **Folyamatos futtatás** beállítással kell konfigurálnia.</span><span class="sxs-lookup"><span data-stu-id="e2d86-196">If you want the job to respond to an event-driven trigger, you should configure it as **Run continuously**.</span></span> <span data-ttu-id="e2d86-197">A szkript vagy a program a site/wwwroot/app_data/jobs/continuous mappában lesz tárolva.</span><span class="sxs-lookup"><span data-stu-id="e2d86-197">The script or program is stored in the folder named site/wwwroot/app_data/jobs/continuous.</span></span>
* <span data-ttu-id="e2d86-198">Ha azt szeretné, hogy a feladat egy ütemezésvezérelt eseményindítóra válaszoljon, az **Ütemezett futtatás** beállítással kell konfigurálnia.</span><span class="sxs-lookup"><span data-stu-id="e2d86-198">If you want the job to respond to a schedule-driven trigger, you should configure it as **Run on a schedule**.</span></span> <span data-ttu-id="e2d86-199">A szkript vagy a program a site/wwwroot/app_data/jobs/triggered mappában lesz tárolva.</span><span class="sxs-lookup"><span data-stu-id="e2d86-199">The script or program is stored in the folder named site/wwwroot/app_data/jobs/triggered.</span></span>
* <span data-ttu-id="e2d86-200">Ha valamely feladat konfigurálásakor az **Igény szerinti futtatás** beállítást választja, az az indításakor ugyanazt a kódot fogja végrehajtani, mint az **Ütemezett futtatás** beállítás.</span><span class="sxs-lookup"><span data-stu-id="e2d86-200">If you choose the **Run on demand** option when you configure a job, it will execute the same code as the **Run on a schedule** option when you start it.</span></span>

<span data-ttu-id="e2d86-201">Az Azure WebJobs-feladatok egy webalkalmazás elkülönített környezetében futnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-201">Azure WebJobs run within the sandbox of the web app.</span></span> <span data-ttu-id="e2d86-202">Ez azt jelenti, hogy hozzáféréssel rendelkeznek a környezeti változókhoz, és megoszthatják az információkat, például a kapcsolati sztringeket a webalkalmazással.</span><span class="sxs-lookup"><span data-stu-id="e2d86-202">This means that they can access environment variables and share information, such as connection strings, with the web app.</span></span> <span data-ttu-id="e2d86-203">A feladat eléri az azt futtató gép egyedi azonosítóját.</span><span class="sxs-lookup"><span data-stu-id="e2d86-203">The job has access to the unique identifier of the machine that is running the job.</span></span> <span data-ttu-id="e2d86-204">Az **AzureWebJobsStorage** kapcsolati sztring az alkalmazásadatok Azure Storage-üzenetsoraihoz, -blobjaihoz és -tábláihoz biztosít hozzáférést, valamint a Service Bushoz az üzenetkezelés és a kommunikáció megvalósítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-204">The connection string named **AzureWebJobsStorage** provides access to Azure storage queues, blobs, and tables for application data, and access to Service Bus for messaging and communication.</span></span> <span data-ttu-id="e2d86-205">Az **AzureWebJobsDashboard** kapcsolati sztring a feladat műveleti naplófájljaihoz biztosít hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="e2d86-205">The connection string named **AzureWebJobsDashboard** provides access to the job action log files.</span></span>

<span data-ttu-id="e2d86-206">Az Azure WebJobs-feladatok a következő jellemzőkkel rendelkeznek:</span><span class="sxs-lookup"><span data-stu-id="e2d86-206">Azure WebJobs have the following characteristics:</span></span>

* <span data-ttu-id="e2d86-207">**Biztonság**: A WebJobs-feladatokat a webalkalmazás üzembehelyezési hitelesítő adatai védik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-207">**Security**: WebJobs are protected by the deployment credentials of the web app.</span></span>
* <span data-ttu-id="e2d86-208">**Támogatott fájltípusok**: A WebJobs-feladatokat parancssori szkriptek (.cmd), parancsfájlok (.bat), PowerShell-szkriptek (.ps1), Bash-héjparancsfájlok (.sh), PHP-szkriptek (.php), Python-szkriptek (.py), JavaScript-kódok (.js), valamint végrehajtható programok (.exe, .jar stb.) használatával definiálhatja.</span><span class="sxs-lookup"><span data-stu-id="e2d86-208">**Supported file types**: You can define WebJobs by using command scripts (.cmd), batch files (.bat), PowerShell scripts (.ps1), bash shell scripts (.sh), PHP scripts (.php), Python scripts (.py), JavaScript code (.js), and executable programs (.exe, .jar, and more).</span></span>
* <span data-ttu-id="e2d86-209">**Üzembe helyezés**: A szkripteket és a végrehajtható fájlokat az [Azure Portal](/azure/app-service-web/web-sites-create-web-jobs), a [Visual Studio](/azure/app-service-web/websites-dotnet-deploy-webjobs) és az [Azure WebJobs SDK](/azure/app-service/webjobs-sdk-get-started) használatával, vagy közvetlenül a következő helyekre másolva helyezheti üzembe:</span><span class="sxs-lookup"><span data-stu-id="e2d86-209">**Deployment**: You can deploy scripts and executables by using the [Azure portal](/azure/app-service-web/web-sites-create-web-jobs), by using [Visual Studio](/azure/app-service-web/websites-dotnet-deploy-webjobs), by using the [Azure WebJobs SDK](/azure/app-service/webjobs-sdk-get-started), or by copying them directly to the following locations:</span></span>
  * <span data-ttu-id="e2d86-210">Eseményindító által indított végrehajtás esetén: site/wwwroot/app_data/jobs/triggered/{feladat neve}</span><span class="sxs-lookup"><span data-stu-id="e2d86-210">For triggered execution: site/wwwroot/app_data/jobs/triggered/{job name}</span></span>
  * <span data-ttu-id="e2d86-211">Folyamatos végrehajtás esetén: site/wwwroot/app_data/jobs/continuous/{feladat neve}</span><span class="sxs-lookup"><span data-stu-id="e2d86-211">For continuous execution: site/wwwroot/app_data/jobs/continuous/{job name}</span></span>
* <span data-ttu-id="e2d86-212">**Naplózás**: A Console.Out INFO-ként van kezelve (megjelölve).</span><span class="sxs-lookup"><span data-stu-id="e2d86-212">**Logging**: Console.Out is treated (marked) as INFO.</span></span> <span data-ttu-id="e2d86-213">A Console.Error HIBA-ként van kezelve.</span><span class="sxs-lookup"><span data-stu-id="e2d86-213">Console.Error is treated as ERROR.</span></span> <span data-ttu-id="e2d86-214">A monitorozási és diagnosztikai adatok az Azure Portalon keresztül érhetők el.</span><span class="sxs-lookup"><span data-stu-id="e2d86-214">You can access monitoring and diagnostics information by using the Azure portal.</span></span> <span data-ttu-id="e2d86-215">A naplófájlok közvetlenül is letölthetők a webhelyről.</span><span class="sxs-lookup"><span data-stu-id="e2d86-215">You can download log files directly from the site.</span></span> <span data-ttu-id="e2d86-216">Ezek a következő helyekre lesznek mentve:</span><span class="sxs-lookup"><span data-stu-id="e2d86-216">They are saved in the following locations:</span></span>
  * <span data-ttu-id="e2d86-217">Eseményindító által indított végrehajtás esetén: Vfs/data/jobs/triggered/feladatNeve</span><span class="sxs-lookup"><span data-stu-id="e2d86-217">For triggered execution: Vfs/data/jobs/triggered/jobName</span></span>
  * <span data-ttu-id="e2d86-218">Folyamatos végrehajtás esetén: Vfs/data/jobs/continuous/feladatNeve</span><span class="sxs-lookup"><span data-stu-id="e2d86-218">For continuous execution: Vfs/data/jobs/continuous/jobName</span></span>
* <span data-ttu-id="e2d86-219">**Konfiguráció**: A WebJobs-feladatok a portál, a REST API és a PowerShell használatával konfigurálhatók.</span><span class="sxs-lookup"><span data-stu-id="e2d86-219">**Configuration**: You can configure WebJobs by using the portal, the REST API, and PowerShell.</span></span> <span data-ttu-id="e2d86-220">A feladat szkriptjének gyökérkönyvtárába mentett, settings.job nevű konfigurációs fájllal adhatja meg a feladat konfigurációs adatait.</span><span class="sxs-lookup"><span data-stu-id="e2d86-220">You can use a configuration file named settings.job in the same root directory as the job script to provide configuration information for a job.</span></span> <span data-ttu-id="e2d86-221">Példa:</span><span class="sxs-lookup"><span data-stu-id="e2d86-221">For example:</span></span>
  * <span data-ttu-id="e2d86-222">{ "stopping_wait_time": 60 }</span><span class="sxs-lookup"><span data-stu-id="e2d86-222">{ "stopping_wait_time": 60 }</span></span>
  * <span data-ttu-id="e2d86-223">{ "is_singleton": true }</span><span class="sxs-lookup"><span data-stu-id="e2d86-223">{ "is_singleton": true }</span></span>

#### <a name="considerations"></a><span data-ttu-id="e2d86-224">Megfontolandó szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-224">Considerations</span></span>

* <span data-ttu-id="e2d86-225">Alapértelmezés szerint a WebJobs-feladatok a webalkalmazással együtt méreteződnek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-225">By default, WebJobs scale with the web app.</span></span> <span data-ttu-id="e2d86-226">Az **is_singleton** konfigurációs tulajdonság **true** (igaz) értékre állításával azonban konfigurálhatja úgy a feladatokat, hogy egyetlen példányon fussanak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-226">However, you can configure jobs to run on single instance by setting the **is_singleton** configuration property to **true**.</span></span> <span data-ttu-id="e2d86-227">Az egypéldányos WebJobs-feladatok az olyan tevékenységekhez hasznosak, amelyeket nem szeretne méretezni vagy egyidejűleg több példányban futtatni, például újraindexeléshez, adatelemzéshez és hasonló feladatokhoz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-227">Single instance WebJobs are useful for tasks that you do not want to scale or run as simultaneous multiple instances, such as reindexing, data analysis, and similar tasks.</span></span>
* <span data-ttu-id="e2d86-228">A feladatok a webalkalmazás teljesítményére gyakorolt hatásának minimalizálása érdekében az esetleges hosszabb futású vagy erőforrás-igényesebb WebJobs-feladatok futtatásához célszerű létrehozni egy üres Azure Web App-példányt egy új App Service-csomag keretében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-228">To minimize the impact of jobs on the performance of the web app, consider creating an empty Azure Web App instance in a new App Service plan to host WebJobs that may be long running or resource intensive.</span></span>

### <a name="more-information"></a><span data-ttu-id="e2d86-229">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-229">More information</span></span>
* <span data-ttu-id="e2d86-230">Az [Azure WebJobs ajánlott forrásanyagai](/azure/app-service-web/websites-webjobs-resources) között számos hasznos forrásanyagot, letöltést és mintát talál a WebJobshoz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-230">[Azure WebJobs recommended resources](/azure/app-service-web/websites-webjobs-resources) lists the many useful resources, downloads, and samples for WebJobs.</span></span>

### <a name="azure-virtual-machines"></a><span data-ttu-id="e2d86-231">Azure-alapú virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="e2d86-231">Azure Virtual Machines</span></span>
<span data-ttu-id="e2d86-232">A háttérfeladatok esetenként lehetnek úgy is implementálva, hogy az megakadályozza az üzembe helyezésüket az Azure Web Apps vagy a Cloud Services szolgáltatásban, vagy az is előfordulhat, hogy ezek az alternatívák valamiért nem a legmegfelelőbbek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-232">Background tasks might be implemented in a way that prevents them from being deployed to Azure Web Apps or Cloud Services, or these options might not be convenient.</span></span> <span data-ttu-id="e2d86-233">Tipikus példák erre a Windows-szolgáltatások, valamint a külső fejlesztők által készített segédprogramok és végrehajtható programok.</span><span class="sxs-lookup"><span data-stu-id="e2d86-233">Typical examples are Windows services, and third-party utilities and executable programs.</span></span> <span data-ttu-id="e2d86-234">További példák lehetnek az alkalmazást futtató környezettől eltérő végrehajtási környezethez írt programok.</span><span class="sxs-lookup"><span data-stu-id="e2d86-234">Another example might be programs written for an execution environment that is different than that hosting the application.</span></span> <span data-ttu-id="e2d86-235">Például rendelkezhet egy olyan Unix- vagy Linux-programmal, amelyet egy Windows- vagy .NET-alkalmazásból kíván végrehajtatni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-235">For example, it might be a Unix or Linux program that you want to execute from a Windows or .NET application.</span></span> <span data-ttu-id="e2d86-236">Az Azure-beli virtuális gépek esetében számos különféle operációs rendszer közül választhat, és a szolgáltatásokat és a végrehajtható fájlokat az adott virtuális gépen futtathatja.</span><span class="sxs-lookup"><span data-stu-id="e2d86-236">You can choose from a range of operating systems for an Azure virtual machine, and run your service or executable on that virtual machine.</span></span>

<span data-ttu-id="e2d86-237">Ha segítségre van szüksége azzal kapcsolatban, hogy mikor érdemes a Virtual Machinest választania tekintse meg [az Azure App Service, a Cloud Services és a Virtual Machines összehasonlítását](/azure/app-service-web/choose-web-site-cloud-service-vm/).</span><span class="sxs-lookup"><span data-stu-id="e2d86-237">To help you choose when to use Virtual Machines, see [Azure App Services, Cloud Services and Virtual Machines comparison](/azure/app-service-web/choose-web-site-cloud-service-vm/).</span></span> <span data-ttu-id="e2d86-238">A virtuális gépek beállításokkal kapcsolatos további információkért lásd: [méretek a Windows virtuális gépek az Azure-ban](/azure/virtual-machines/windows/sizes).</span><span class="sxs-lookup"><span data-stu-id="e2d86-238">For information about the options for Virtual Machines, see [Sizes for Windows virtual machines in Azure](/azure/virtual-machines/windows/sizes).</span></span> <span data-ttu-id="e2d86-239">A Virtual Machines használata esetén elérhető operációs rendszerekkel és előre elkészített rendszerképekkel kapcsolatos további információért lásd [az Azure Virtual Machines-piacteret](https://azure.microsoft.com/gallery/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="e2d86-239">For more information about the operating systems and prebuilt images that are available for Virtual Machines, see [Azure Virtual Machines Marketplace](https://azure.microsoft.com/gallery/virtual-machines/).</span></span>

<span data-ttu-id="e2d86-240">Amennyiben a háttérfeladatot egy különálló virtuális gépen szeretné inicializálni, több lehetőség közül választhat:</span><span class="sxs-lookup"><span data-stu-id="e2d86-240">To initiate the background task in a separate virtual machine, you have a range of options:</span></span>

* <span data-ttu-id="e2d86-241">A feladatot végrehajtathatja igény szerint közvetlenül az alkalmazásból egy kérés a feladat által elérhetővé tett végpontra küldésével.</span><span class="sxs-lookup"><span data-stu-id="e2d86-241">You can execute the task on demand directly from your application by sending a request to an endpoint that the task exposes.</span></span> <span data-ttu-id="e2d86-242">Ez a kérés átadja a feladat által igényelt adatokat is.</span><span class="sxs-lookup"><span data-stu-id="e2d86-242">This passes in any data that the task requires.</span></span> <span data-ttu-id="e2d86-243">A feladatot a végpont hívja meg.</span><span class="sxs-lookup"><span data-stu-id="e2d86-243">This endpoint invokes the task.</span></span>
* <span data-ttu-id="e2d86-244">Konfigurálhatja úgy a feladatot, hogy a választott operációs rendszerben elérhető feladatütemező vagy időzítő használatával ütemezetten fusson.</span><span class="sxs-lookup"><span data-stu-id="e2d86-244">You can configure the task to run on a schedule by using a scheduler or timer that is available in your chosen operating system.</span></span> <span data-ttu-id="e2d86-245">Például a Windows rendszeren használhatja a Windows Feladatütemezőt a szkriptek és feladatok végrehajtatására.</span><span class="sxs-lookup"><span data-stu-id="e2d86-245">For example, on Windows you can use Windows Task Scheduler to execute scripts and tasks.</span></span> <span data-ttu-id="e2d86-246">Vagy, ha a virtuális gépen telepítve van az SQL Server, használhatja az SQL Server Agentet a szkriptek és feladatok végrehajtására.</span><span class="sxs-lookup"><span data-stu-id="e2d86-246">Or, if you have SQL Server installed on the virtual machine, you can use the SQL Server Agent to execute scripts and tasks.</span></span>
* <span data-ttu-id="e2d86-247">Az Azure Scheduler használatával inicializálhatja a feladatot egy üzenet a feladat által figyelt üzenetsorhoz történő hozzáadásával, vagy egy kérés a feladat által elérhetővé tett API-ra történő küldésével.</span><span class="sxs-lookup"><span data-stu-id="e2d86-247">You can use Azure Scheduler to initiate the task by adding a message to a queue that the task listens on, or by sending a request to an API that the task exposes.</span></span>

<span data-ttu-id="e2d86-248">A háttérfeladatok inicializálásával kapcsolatban lásd az [eseményindítókat](#triggers) ismertető fenti szakaszt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-248">See the earlier section [Triggers](#triggers) for more information about how you can initiate background tasks.</span></span>  

#### <a name="considerations"></a><span data-ttu-id="e2d86-249">Megfontolandó szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-249">Considerations</span></span>
<span data-ttu-id="e2d86-250">Amikor azt fontolgatja, hogy a háttérfeladatokat egy Azure-beli virtuális gépen helyezze-e üzembe, vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="e2d86-250">Consider the following points when you are deciding whether to deploy background tasks in an Azure virtual machine:</span></span>

* <span data-ttu-id="e2d86-251">A háttérfeladatok egy külön Azure-beli virtuális gépen való futtatása rugalmasságot biztosít, és pontosan szabályozhatóvá teszi az inicializálást, a végrehajtást, az ütemezést és az erőforrás-kiosztást.</span><span class="sxs-lookup"><span data-stu-id="e2d86-251">Hosting background tasks in a separate Azure virtual machine provides flexibility and allows precise control over initiation, execution, scheduling, and resource allocation.</span></span> <span data-ttu-id="e2d86-252">Azonban ha kizárólag a háttérfeladatok futtatásához helyez üzembe egy külön virtuális gépet, az megnöveli a környezet futásidejű költségeit.</span><span class="sxs-lookup"><span data-stu-id="e2d86-252">However, it will increase runtime cost if a virtual machine must be deployed just to run background tasks.</span></span>
* <span data-ttu-id="e2d86-253">Az Azure Portal nem biztosít eszközöket a feladatok monitorozásához és a meghiúsult feladatok automatikus újraindításához – bár az [Azure Resource Manager parancsmagjai](https://msdn.microsoft.com/library/mt125356.aspx) lehetővé teszik a virtuális gép alapvető állapotának monitorozását és a virtuális gép kezelését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-253">There is no facility to monitor the tasks in the Azure portal and no automated restart capability for failed tasks--although you can monitor the basic status of the virtual machine and manage it by using the  [Azure Resource Manager Cmdlets](https://msdn.microsoft.com/library/mt125356.aspx).</span></span> <span data-ttu-id="e2d86-254">A számítási csomópontok folyamatainak és szálainak kezeléséhez azonban nem állnak rendelkezésre eszközök.</span><span class="sxs-lookup"><span data-stu-id="e2d86-254">However, there are no facilities to control processes and threads in compute nodes.</span></span> <span data-ttu-id="e2d86-255">Általában a virtuális gépek használata esetén további erőfeszítésekre van szükség egy olyan mechanizmus megvalósításához, amely rendszerállapot-adatokat gyűjt a feladatból és a virtuális gép operációs rendszeréről.</span><span class="sxs-lookup"><span data-stu-id="e2d86-255">Typically, using a virtual machine will require additional effort to implement a mechanism that collects data from instrumentation in the task, and from the operating system in the virtual machine.</span></span> <span data-ttu-id="e2d86-256">Erre megfelelő megoldást nyújthat a [System Center Azure-hoz készült felügyeleti csomagjának](https://www.microsoft.com/download/details.aspx?id=50013) használata.</span><span class="sxs-lookup"><span data-stu-id="e2d86-256">One solution that might be appropriate is to use the [System Center Management Pack for Azure](https://www.microsoft.com/download/details.aspx?id=50013).</span></span>
* <span data-ttu-id="e2d86-257">Érdemes fontolóra venni HTTP-végpontokon keresztül elérhetővé tett monitorozási mintavételezők létrehozását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-257">You might consider creating monitoring probes that are exposed through HTTP endpoints.</span></span> <span data-ttu-id="e2d86-258">Az ilyen mintavételezők kódja állapotellenőrzéseket hajthat végre, valamint működéssel kapcsolatos adatokat és statisztikákat gyűjthet – vagy összeállíthatja a hibainformációkat, és visszaküldheti egy felügyeleti alkalmazásnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-258">The code for these probes could perform health checks, collect operational information and statistics--or collate error information and return it to a management application.</span></span> <span data-ttu-id="e2d86-259">További információért lásd az [állapot végponti monitorozását végző mintát](../patterns/health-endpoint-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-259">For more information, see [Health Endpoint Monitoring Pattern](../patterns/health-endpoint-monitoring.md).</span></span>

#### <a name="more-information"></a><span data-ttu-id="e2d86-260">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-260">More information</span></span>
* <span data-ttu-id="e2d86-261">[Virtual Machines](https://azure.microsoft.com/services/virtual-machines/) az Azure-on</span><span class="sxs-lookup"><span data-stu-id="e2d86-261">[Virtual Machines](https://azure.microsoft.com/services/virtual-machines/) on Azure</span></span>
* [<span data-ttu-id="e2d86-262">Azure Virtual Machines – gyakori kérdések</span><span class="sxs-lookup"><span data-stu-id="e2d86-262">Azure Virtual Machines FAQ</span></span>](/azure/virtual-machines/virtual-machines-linux-classic-faq?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json)

### <a name="azure-batch"></a><span data-ttu-id="e2d86-263">Azure Batch</span><span class="sxs-lookup"><span data-stu-id="e2d86-263">Azure Batch</span></span> 

<span data-ttu-id="e2d86-264">Amennyiben nagy teljesítményű számítási (HPC) feladatokat szeretne egyszerre több tíz, száz vagy ezer virtuális gépen párhuzamosan futtatni, mérlegelje az [Azure Batch](/azure/batch/) használatát.</span><span class="sxs-lookup"><span data-stu-id="e2d86-264">Consider [Azure Batch](/azure/batch/) if you need to run large, parallel high-performance computing (HPC) workloads across tens, hundreds, or thousands of VMs.</span></span>  

<span data-ttu-id="e2d86-265">A Batch szolgáltatás kiosztja a virtuális gépeket, feladatokat rendel azokhoz, futtatja a feladatokat, és monitorozza az állapotot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-265">The Batch service provisions the VMs, assign tasks to the VMs, runs the tasks, and monitors the progress.</span></span> <span data-ttu-id="e2d86-266">A Batch a számítási feladat igényeinek megfelelően automatikusan méretezi a virtuális gépeket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-266">Batch can automatically scale out the VMs in response to the workload.</span></span> <span data-ttu-id="e2d86-267">A Batch emellett a feladatütemezésről is gondoskodik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-267">Batch also provides job scheduling.</span></span> <span data-ttu-id="e2d86-268">Az Azure Batch a linuxos és a windowsos virtuális gépek használatát egyaránt támogatja.</span><span class="sxs-lookup"><span data-stu-id="e2d86-268">Azure Batch supports both Linux and Windows VMs.</span></span>

#### <a name="considerations"></a><span data-ttu-id="e2d86-269">Megfontolandó szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-269">Considerations</span></span> 

<span data-ttu-id="e2d86-270">A Batch nagyszerűen működik a belsőleg párhuzamos számítási feladatokkal.</span><span class="sxs-lookup"><span data-stu-id="e2d86-270">Batch works well with intrinsically parallel workloads.</span></span> <span data-ttu-id="e2d86-271">Végső soron kevesebb lépéssel hajthat végre párhuzamos számításokat, valamint futtathat [Message Passing Interface- (MPI-) alkalmazásokat](/azure/batch/batch-mpi) olyan párhuzamos feladatoknál, amelyeknél üzeneteket kell továbbítani a csomópontok között.</span><span class="sxs-lookup"><span data-stu-id="e2d86-271">It can also perform parallel calculations with a reduce step at the end, or run [Message Passing Interface (MPI) applications](/azure/batch/batch-mpi) for parallel tasks that require message passing between nodes.</span></span> 

<span data-ttu-id="e2d86-272">Az Azure Batch-feladatok csomópontok (virtuális gépek) készletein futnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-272">An Azure Batch job runs on a pool of nodes (VMs).</span></span> <span data-ttu-id="e2d86-273">Az egyik megközelítésben a készletek csak szükség esetén vannak lefoglalva, majd a feladat befejezése után törlődnek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-273">One approach is to allocate a pool only when needed and then delete it after the job completes.</span></span> <span data-ttu-id="e2d86-274">Ez maximális kihasználtságot biztosít, mivel a csomópontok nincsenek üresjáratban, azonban a feladatnak meg kell várnia a csomópontok lefoglalását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-274">This maximizes utilization, because nodes are not idle, but the job must wait for nodes to be allocated.</span></span> <span data-ttu-id="e2d86-275">Alternatív megoldásként előre is létrehozhat egy készletet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-275">Alternatively, you can create a pool ahead of time.</span></span> <span data-ttu-id="e2d86-276">Ez a megközelítés minimálisra csökkenti a feladatok indításához szükséges időt, azonban előfordulhat, hogy egyes csomópontok tétlenül várakoznak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-276">That approach minimizes the time that it takes for a job to start, but can result in having nodes that sit idle.</span></span> <span data-ttu-id="e2d86-277">További információért lásd [a készletek és a számítási csomópontok élettartamát](/azure/batch/batch-api-basics#pool-and-compute-node-lifetime).</span><span class="sxs-lookup"><span data-stu-id="e2d86-277">For more information, see [Pool and compute node lifetime](/azure/batch/batch-api-basics#pool-and-compute-node-lifetime).</span></span>

#### <a name="more-information"></a><span data-ttu-id="e2d86-278">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-278">More information</span></span> 

* [<span data-ttu-id="e2d86-279">Belsőleg párhuzamos számítási feladatok futtatása a Batch használatával</span><span class="sxs-lookup"><span data-stu-id="e2d86-279">Run intrinsically parallel workloads with Batch</span></span>](/azure/batch/batch-technical-overview) 
* [<span data-ttu-id="e2d86-280">Nagy léptékű párhuzamos számítási megoldások fejlesztése a Batch segítségével</span><span class="sxs-lookup"><span data-stu-id="e2d86-280">Develop large-scale parallel compute solutions with Batch</span></span>](/azure/batch/batch-api-basics) 
* [<span data-ttu-id="e2d86-281">Batch- és HPC-megoldások nagyméretű számítási feladatokhoz</span><span class="sxs-lookup"><span data-stu-id="e2d86-281">Batch and HPC solutions for large-scale computing workloads</span></span>](/azure/batch/batch-hpc-solutions)

### <a name="azure-container-service"></a><span data-ttu-id="e2d86-282">Azure Container Service</span><span class="sxs-lookup"><span data-stu-id="e2d86-282">Azure Container Service</span></span> 

<span data-ttu-id="e2d86-283">Az Azure Container Service használatával virtuális gépek fürtjeit konfigurálhatja és kezelheti az Azure-ban tárolóalapú alkalmazások futtatásához.</span><span class="sxs-lookup"><span data-stu-id="e2d86-283">Azure Container Service lets you configure and manage a cluster of VMs in Azure to run containerized applications.</span></span> <span data-ttu-id="e2d86-284">Lehetővé teszi a választást, hogy Docker Swarmot, DC/OS-t vagy Kubernetest használhasson a vezényléshez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-284">It provides a choice of Docker Swarm, DC/OS, or Kubernetes for orchestration.</span></span> 

<span data-ttu-id="e2d86-285">A tárolók hasznosak lehetnek a háttérfeladatok futtatásához.</span><span class="sxs-lookup"><span data-stu-id="e2d86-285">Containers can be useful for running background jobs.</span></span> <span data-ttu-id="e2d86-286">Többek között a következő előnyöket kínálják:</span><span class="sxs-lookup"><span data-stu-id="e2d86-286">Some of the benefits include:</span></span> 

- <span data-ttu-id="e2d86-287">A tárolók támogatják a nagy sűrűségű üzemeltetést.</span><span class="sxs-lookup"><span data-stu-id="e2d86-287">Containers support high-density hosting.</span></span> <span data-ttu-id="e2d86-288">Az egyes háttérfeladatokat elkülönítheti külön tárolókba, és mindegyik virtuális gépre több tárolót is elhelyezhet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-288">You can isolate a background task in a container, while placing multiple containers in each VM.</span></span>
- <span data-ttu-id="e2d86-289">A tárolóvezénylő kezeli a belső terheléselosztást, konfigurálja a belső hálózatot és egyéb konfigurációs feladatokat végez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-289">The container orchestrator handles internal load balancing, configuring the internal network, and other configuration tasks.</span></span>
- <span data-ttu-id="e2d86-290">A tárolók szükség szerint indíthatók és állíthatók le.</span><span class="sxs-lookup"><span data-stu-id="e2d86-290">Containers can be started and stopped as needed.</span></span> 
- <span data-ttu-id="e2d86-291">Az Azure Container Registry használatával a tárolókat az Azure határain belül regisztrálhatja.</span><span class="sxs-lookup"><span data-stu-id="e2d86-291">Azure Container Registry allows you to register your containers inside Azure boundaries.</span></span> <span data-ttu-id="e2d86-292">Ez biztonsági, adatvédelmi és közelségi előnyökkel jár.</span><span class="sxs-lookup"><span data-stu-id="e2d86-292">This comes with security, privacy, and proximity benefits.</span></span> 

#### <a name="considerations"></a><span data-ttu-id="e2d86-293">Megfontolandó szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-293">Considerations</span></span>

- <span data-ttu-id="e2d86-294">A tárolóvezénylők kezelésének ismeretét igényli.</span><span class="sxs-lookup"><span data-stu-id="e2d86-294">Requires an understanding of how to use a container orchestrator.</span></span> <span data-ttu-id="e2d86-295">Ez a fejlesztői és üzemeltetési csapat készségeitől függően akár problémát is okozhat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-295">Depending on the skillset of your DevOps team, this may or may not be an issue.</span></span>  
- <span data-ttu-id="e2d86-296">A Container Service IaaS-környezetben fut.</span><span class="sxs-lookup"><span data-stu-id="e2d86-296">Container Service runs in an IaaS environment.</span></span> <span data-ttu-id="e2d86-297">A virtuális gépekből álló fürtöket dedikált virtuális hálózatokon belül osztja ki.</span><span class="sxs-lookup"><span data-stu-id="e2d86-297">It provisions a cluster of VMs inside a dedicated VNet.</span></span> 

#### <a name="more-information"></a><span data-ttu-id="e2d86-298">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-298">More information</span></span> 

* [<span data-ttu-id="e2d86-299">Bevezetés a Docker Azure Container Service-t használó tárolóüzemeltetési megoldásaiba</span><span class="sxs-lookup"><span data-stu-id="e2d86-299">Introduction to Docker container hosting solutions with Azure Container Service</span></span>](/azure/container-service/container-service-intro) 
* [<span data-ttu-id="e2d86-300">A privát Docker-tárolójegyzékek bemutatása</span><span class="sxs-lookup"><span data-stu-id="e2d86-300">Introduction to private Docker container registries</span></span>](/azure/container-registry/container-registry-intro) 

### <a name="azure-cloud-services"></a><span data-ttu-id="e2d86-301">Azure Cloud Services</span><span class="sxs-lookup"><span data-stu-id="e2d86-301">Azure Cloud Services</span></span> 
<span data-ttu-id="e2d86-302">A háttérfeladatokat webes szerepkörökben vagy egy külön feldolgozói szerepkörben hajthatja végre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-302">You can execute background tasks within a web role or in a separate worker role.</span></span> <span data-ttu-id="e2d86-303">Amikor a feldolgozói szerepkör használatát mérlegeli, a méretezhetőségi és rugalmassági követelményeket, a feladatok élettartamát, a kiadási ütemezést, a biztonságot, a hibatűrést, a versengést, az összetettséget és a logikai architektúrát mind vegye számításba.</span><span class="sxs-lookup"><span data-stu-id="e2d86-303">When you are deciding whether to use a worker role, consider scalability and elasticity requirements, task lifetime, release cadence, security, fault tolerance, contention, complexity, and the logical architecture.</span></span> <span data-ttu-id="e2d86-304">További információért lásd a [számításierőforrás-konszolidálási mintát](../patterns/compute-resource-consolidation.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-304">For more information, see [Compute Resource Consolidation Pattern](../patterns/compute-resource-consolidation.md).</span></span>

<span data-ttu-id="e2d86-305">A Cloud Services-szerepkörökben a háttérfeladatok többféleképpen implementálhatók:</span><span class="sxs-lookup"><span data-stu-id="e2d86-305">There are several ways to implement background tasks within a Cloud Services role:</span></span>

* <span data-ttu-id="e2d86-306">Hozza létre a **RoleEntryPoint** osztály egy implementációját a szerepkörben, és annak a metódusaival hajtsa végre a háttérfeladatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-306">Create an implementation of the **RoleEntryPoint** class in the role and use its methods to execute background tasks.</span></span> <span data-ttu-id="e2d86-307">A feladatok a WaIISHost.exe környezetében futnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-307">The tasks run in the context of WaIISHost.exe.</span></span> <span data-ttu-id="e2d86-308">A **CloudConfigurationManager** osztály **GetSetting** metódusának használatával tudják betölteni a konfigurációs beállításokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-308">They can use the **GetSetting** method of the **CloudConfigurationManager** class to load configuration settings.</span></span> <span data-ttu-id="e2d86-309">További információért lásd az [életciklus](#lifecycle) ismertetését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-309">For more information, see [Lifecycle](#lifecycle).</span></span>
* <span data-ttu-id="e2d86-310">Indítási feladatok segítségével hajtsa végre a háttérfeladatokat az alkalmazás indításakor.</span><span class="sxs-lookup"><span data-stu-id="e2d86-310">Use startup tasks to execute background tasks when the application starts.</span></span> <span data-ttu-id="e2d86-311">A feladatok háttérben futásának kényszerítéséhez állítsa a **taskType** tulajdonságot a **background** (háttérben) értékre (ha ezt nem teszi meg, az alkalmazásindítási folyamat leáll, és megvárja a feladat befejezését).</span><span class="sxs-lookup"><span data-stu-id="e2d86-311">To force the tasks to continue to run in the background, set the **taskType** property to **background** (if you do not do this, the application startup process will halt and wait for the task to finish).</span></span> <span data-ttu-id="e2d86-312">További információért lásd az [Azure-beli indítási feladatok futtatásának](/azure/cloud-services/cloud-services-startup-tasks) ismertetését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-312">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks).</span></span>
* <span data-ttu-id="e2d86-313">A WebJobs SDK használatával indítási feladatként inicializált WebJobs-feladatokként implementálhatja a háttérfeladatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-313">Use the WebJobs SDK to implement background tasks such as WebJobs that are initiated as a startup task.</span></span> <span data-ttu-id="e2d86-314">További információért lásd a [.NET WebJobs-feladat az Azure App Service-ben történő létrehozását](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started).</span><span class="sxs-lookup"><span data-stu-id="e2d86-314">For more information, see [Create a .NET WebJob in Azure App Service](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started).</span></span>
* <span data-ttu-id="e2d86-315">Egy indítási feladat segítségével telepítsen egy Windows-szolgáltatást, amely végrehajt egy vagy több háttérfeladatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-315">Use a startup task to install a Windows service that executes one or more background tasks.</span></span> <span data-ttu-id="e2d86-316">Annak érdekében, hogy a szolgáltatás a háttérben fusson, állítsa a **taskType** tulajdonságot **background** (háttérben) értékre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-316">You must set the **taskType** property to **background** so that the service executes in the background.</span></span> <span data-ttu-id="e2d86-317">További információért lásd az [Azure-beli indítási feladatok futtatásának](/azure/cloud-services/cloud-services-startup-tasks) ismertetését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-317">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks).</span></span>

<span data-ttu-id="e2d86-318">A háttérfeladatok webes szerepkörben való futtatásának fő előnye az üzemeltetési költségek csökkenése, mivel így nincs szükség további szerepköröket üzembe helyezésére.</span><span class="sxs-lookup"><span data-stu-id="e2d86-318">The main advantage of running background tasks in the web role is the saving in hosting costs because there is no requirement to deploy additional roles.</span></span>

<span data-ttu-id="e2d86-319">A háttérfeladatok feldolgozói szerepkörben való futtatása több előnyt is biztosít:</span><span class="sxs-lookup"><span data-stu-id="e2d86-319">Running background tasks in a worker role has several advantages:</span></span>

* <span data-ttu-id="e2d86-320">Lehetővé teszi a szerepkörtípusok külön méretezését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-320">It allows you to manage scaling separately for each type of role.</span></span> <span data-ttu-id="e2d86-321">Például esetleg az aktuális terhelés kiszolgálására a webes szerepkör több példányára van szükség, a háttérfeladatokat végrehajtó feldolgozói szerepkörből azonban kevesebbre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-321">For example, you might need more instances of a web role to support the current load, but fewer instances of the worker role that executes background tasks.</span></span> <span data-ttu-id="e2d86-322">A háttérfeladat számítási példányainak a felhasználói felületi szerepköröktől való elkülönített méretezésével csökkenthetők az üzemeltetési költségek, miközben elfogadható teljesítmény biztosítható.</span><span class="sxs-lookup"><span data-stu-id="e2d86-322">By scaling background task compute instances separately from the UI roles, you can reduce hosting costs, while maintaining acceptable performance.</span></span>
* <span data-ttu-id="e2d86-323">Leveszi a háttérfeladatok feldolgozása által jelentett többletterhelést a webes szerepkörről.</span><span class="sxs-lookup"><span data-stu-id="e2d86-323">It offloads the processing overhead for background tasks from the web role.</span></span> <span data-ttu-id="e2d86-324">A felhasználói felületet biztosító webes szerepkör rugalmas maradhat, ami akár azt is jelentheti, hogy kevesebb példány szükséges adott mennyiségű felhasználói kérés kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-324">The web role that provides the UI can remain responsive, and it may mean fewer instances are required to support a given volume of requests from users.</span></span>
* <span data-ttu-id="e2d86-325">Lehetővé teszi a kockázatok elkülönítésének megvalósítását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-325">It allows you to implement separation of concerns.</span></span> <span data-ttu-id="e2d86-326">Mindegyik szerepkörtípus egyértelműen meghatározott és kapcsolódó feladatok adott készletét valósíthatja meg.</span><span class="sxs-lookup"><span data-stu-id="e2d86-326">Each role type can implement a specific set of clearly defined and related tasks.</span></span> <span data-ttu-id="e2d86-327">Ezáltal könnyebbé válik a kód megtervezése és karbantartása, mivel az egyes szerepkörök kódja és funkciója kevésbé függ egymástól.</span><span class="sxs-lookup"><span data-stu-id="e2d86-327">This makes designing and maintaining the code easier because there is less interdependence of code and functionality between each role.</span></span>
* <span data-ttu-id="e2d86-328">Emellett segít elkülöníteni a bizalmas folyamatokat és adatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-328">It can help to isolate sensitive processes and data.</span></span> <span data-ttu-id="e2d86-329">Például a felhasználói felületet implementáló webes szerepköröknek nincs szükségük hozzáférésre a feldolgozói szerepkör által kezelt és szabályozott adatokhoz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-329">For example, web roles that implement the UI do not need to have access to data that is managed and controlled by a worker role.</span></span> <span data-ttu-id="e2d86-330">Ez hasznos lehet a biztonság megerősítése szempontjából, különösen a [Gatekeeper-minta](../patterns/gatekeeper.md) és a hasonló minták alkalmazása esetén.</span><span class="sxs-lookup"><span data-stu-id="e2d86-330">This can be useful in strengthening security, especially when you use a pattern such as the [Gatekeeper Pattern](../patterns/gatekeeper.md).</span></span>  

#### <a name="considerations"></a><span data-ttu-id="e2d86-331">Megfontolandó szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-331">Considerations</span></span>
<span data-ttu-id="e2d86-332">Amikor megválasztja, hogyan és hol fogja a háttérfeladatokat üzembe helyezni a Cloud Services webes és feldolgozói szerepkörei segítségével, vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="e2d86-332">Consider the following points when choosing how and where to deploy background tasks when using Cloud Services web and worker roles:</span></span>

* <span data-ttu-id="e2d86-333">A háttérfeladatok meglévő webes szerepkörben való futtatásával költségeket takaríthat meg, ha nem szükséges kizárólag ezekhez a feladatokhoz futtatnia egy külön feldolgozói szerepkört.</span><span class="sxs-lookup"><span data-stu-id="e2d86-333">Hosting background tasks in an existing web role can save the cost of running a separate worker role just for these tasks.</span></span> <span data-ttu-id="e2d86-334">Azonban ez valószínűleg befolyásolja az alkalmazás teljesítményét és rendelkezésre állását, amennyiben versengés van a feldolgozási és egyéb erőforrásokért.</span><span class="sxs-lookup"><span data-stu-id="e2d86-334">However, it is likely to affect the performance and availability of the application if there is contention for processing and other resources.</span></span> <span data-ttu-id="e2d86-335">A külön feldolgozói szerepkör használata mentesíti a webes szerepkört a hosszan futó vagy erőforrás-igényes háttérfeladatok hatásaitól.</span><span class="sxs-lookup"><span data-stu-id="e2d86-335">Using a separate worker role protects the web role from the impact of long-running or resource-intensive background tasks.</span></span>
* <span data-ttu-id="e2d86-336">Ha a háttérfeladatokat a **RoleEntryPoint** osztály használatával teszi elérhetővé, ezt könnyen áthelyezheti egy másik szerepkörre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-336">If you host background tasks by using the **RoleEntryPoint** class, you can easily move this to another role.</span></span> <span data-ttu-id="e2d86-337">Például ha az osztályt egy webes szerepkörben hozza létre, majd később úgy dönt, hogy a feladatokat egy feldolgozói szerepkörben szükséges futtatni, a **RoleEntryPoint** osztály implementációját áthelyezheti a feldolgozói szerepkörre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-337">For example, if you create the class in a web role and later decide that you need to run the tasks in a worker role, you can move the **RoleEntryPoint** class implementation into the worker role.</span></span>
* <span data-ttu-id="e2d86-338">Az indítási feladatok célja egy program vagy szkript végrehajtása.</span><span class="sxs-lookup"><span data-stu-id="e2d86-338">Startup tasks are designed to execute a program or a script.</span></span> <span data-ttu-id="e2d86-339">A háttérfeladatok végrehajtható programként való üzembe helyezése nehezebb feladat lehet, különösen ha ehhez függő szerelvényeket is üzembe kell helyezni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-339">Deploying a background job as an executable program might be more difficult, especially if it also requires deployment of dependent assemblies.</span></span> <span data-ttu-id="e2d86-340">Az indítási feladatok használata esetén könnyebb egy szkriptet létrehozni és használni a háttérfeladat definiálására.</span><span class="sxs-lookup"><span data-stu-id="e2d86-340">It might be easier to deploy and use a script to define a background job when you use startup tasks.</span></span>
* <span data-ttu-id="e2d86-341">A háttérfeladatok meghiúsulását okozó kivételek hatásai eltérőek lehetnek, attól függően, hogyan lettek elérhetővé téve:</span><span class="sxs-lookup"><span data-stu-id="e2d86-341">Exceptions that cause a background task to fail have a different impact, depending on the way that they are hosted:</span></span>
  * <span data-ttu-id="e2d86-342">Ha a **RoleEntryPoint** osztályt használó megközelítést alkalmazza, a meghiúsult feladatok újraindítják a szerepkört, és így a feladat is automatikusan újraindul.</span><span class="sxs-lookup"><span data-stu-id="e2d86-342">If you use the **RoleEntryPoint** class approach, a failed task will cause the role to restart so that the task automatically restarts.</span></span> <span data-ttu-id="e2d86-343">Ez kihatással lehet az alkalmazás rendelkezésre állására.</span><span class="sxs-lookup"><span data-stu-id="e2d86-343">This can affect availability of the application.</span></span> <span data-ttu-id="e2d86-344">Ennek megelőzése érdekében gondoskodjon róla, hogy a **RoleEntryPoint** osztály és az összes háttérfeladat robusztus kivételkezelési képességekkel rendelkezzen.</span><span class="sxs-lookup"><span data-stu-id="e2d86-344">To prevent this, ensure that you include robust exception handling within the **RoleEntryPoint** class and all the background tasks.</span></span> <span data-ttu-id="e2d86-345">Ahol ez szükséges, a meghiúsuló feladatokat programkód használatával indítsa újra, és csak akkor adjon vissza hibát a szerepkör újraindításához, ha nem lehet szabályosan helyreállítani a hibát a kódon belül.</span><span class="sxs-lookup"><span data-stu-id="e2d86-345">Use code to restart tasks that fail where this is appropriate, and throw the exception to restart the role only if you cannot gracefully recover from the failure within your code.</span></span>
  * <span data-ttu-id="e2d86-346">Indítási feladatok használatakor az Ön feladata gondoskodni a feladat-végrehajtás kezeléséről és a hibák ellenőrzéséről.</span><span class="sxs-lookup"><span data-stu-id="e2d86-346">If you use startup tasks, you are responsible for managing the task execution and checking if it fails.</span></span>
* <span data-ttu-id="e2d86-347">Az indítási feladatok kezelése és monitorozása nehezebb, mint a **RoleEntryPoint** osztályt használó megközelítés.</span><span class="sxs-lookup"><span data-stu-id="e2d86-347">Managing and monitoring startup tasks is more difficult than using the **RoleEntryPoint** class approach.</span></span> <span data-ttu-id="e2d86-348">Az Azure WebJobs SDK azonban tartalmaz egy irányítópultot, amely megkönnyíti az indítási feladatokon keresztül inicializált WebJobs-feladatok kezelését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-348">However, the Azure WebJobs SDK includes a dashboard to make it easier to manage WebJobs that you initiate through startup tasks.</span></span>

#### <a name="lifecycle"></a><span data-ttu-id="e2d86-349">Életciklus</span><span class="sxs-lookup"><span data-stu-id="e2d86-349">Lifecycle</span></span> 
 <span data-ttu-id="e2d86-350">Ha úgy dönt, hogy a webes és feldolgozói szerepköröket használó Cloud Services-alkalmazások háttérfeladatait a **RoleEntryPoint** osztály alkalmazásával valósítja meg, az osztály megfelelő használatához fontos megértenie annak életciklusát.</span><span class="sxs-lookup"><span data-stu-id="e2d86-350">If you decide to implement background jobs for Cloud Services applications that use web and worker roles by using the **RoleEntryPoint** class, it is important to understand the lifecycle of this class in order to use it correctly.</span></span>

<span data-ttu-id="e2d86-351">A webes és feldolgozói szerepkörök eltérő szakaszok során haladnak végig az indításuk, futtatásuk és leállításuk folyamán.</span><span class="sxs-lookup"><span data-stu-id="e2d86-351">Web and worker roles go through a set of distinct phases as they start, run, and stop.</span></span> <span data-ttu-id="e2d86-352">A **RoleEntryPoint** osztály események sorát teszi közzé, hogy jelezze, mikor következnek be ezek a szakaszok.</span><span class="sxs-lookup"><span data-stu-id="e2d86-352">The **RoleEntryPoint** class exposes a series of events that indicate when these stages are occurring.</span></span> <span data-ttu-id="e2d86-353">Ezeknek az eseményeknek a használatával inicializálhatja, futtathatja és állíthatja le az egyéni háttérfeladatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-353">You use these to initialize, run, and stop your custom background tasks.</span></span> <span data-ttu-id="e2d86-354">A teljes ciklus a következő:</span><span class="sxs-lookup"><span data-stu-id="e2d86-354">The complete cycle is:</span></span>

* <span data-ttu-id="e2d86-355">Az Azure betölti a szerepkör-szerelvényt, és keres benne egy, a **RoleEntryPoint** osztályból származó osztályt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-355">Azure loads the role assembly and searches it for a class that derives from **RoleEntryPoint**.</span></span>
* <span data-ttu-id="e2d86-356">Ha megtalálja ezt az osztályt, meghívja a **RoleEntryPoint.OnStart()** függvényt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-356">If it finds this class, it calls **RoleEntryPoint.OnStart()**.</span></span> <span data-ttu-id="e2d86-357">Ennek a metódusnak a felülbírásával inicializálhatja a háttérfeladatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-357">You override this method to initialize your background tasks.</span></span>
* <span data-ttu-id="e2d86-358">Az **OnStart** metódus befejeztével az Azure meghívja az **Application_Start()** függvényt az alkalmazás globális fájljában, ha ez megtalálható (például a Global.asax fájl egy, az ASP.NET-et futtató webes szerepkör esetében).</span><span class="sxs-lookup"><span data-stu-id="e2d86-358">After the **OnStart** method has completed, Azure calls **Application_Start()** in the application’s Global file if this is present (for example, Global.asax in a web role running ASP.NET).</span></span>
* <span data-ttu-id="e2d86-359">Az Azure meghívja a **RoleEntryPoint.Run()** függvényt egy új előtérbeli szálon, amely az **OnStart()** függvénnyel párhuzamosan lesz végrehajtva.</span><span class="sxs-lookup"><span data-stu-id="e2d86-359">Azure calls **RoleEntryPoint.Run()** on a new foreground thread that executes in parallel with **OnStart()**.</span></span> <span data-ttu-id="e2d86-360">Ennek a metódusnak a felülbírásával indíthatja el a háttérfeladatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-360">You override this method to start your background tasks.</span></span>
* <span data-ttu-id="e2d86-361">A Run metódus befejeztével az Azure először meghívja az **Application_End()** függvényt az alkalmazás globális fájljában, ha ez megtalálható, majd meghívja a **RoleEntryPoint.OnStop()** függvényt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-361">When the Run method ends, Azure first calls **Application_End()** in the application’s Global file if this is present, and then calls **RoleEntryPoint.OnStop()**.</span></span> <span data-ttu-id="e2d86-362">Az **OnStop** metódus felülbírálásával leállíthatja a háttérfeladatokat, eltávolíthatja a fölöslegessé vált erőforrásokat és objektumokat, valamint lezárhatja azokat a kapcsolatokat, amelyeket a feladatok esetleg használtak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-362">You override the **OnStop** method to stop your background tasks, clean up resources, dispose of objects, and close connections that the tasks may have used.</span></span>
* <span data-ttu-id="e2d86-363">Az Azure feldolgozói szerepköri gazdafolyamata leáll.</span><span class="sxs-lookup"><span data-stu-id="e2d86-363">The Azure worker role host process is stopped.</span></span> <span data-ttu-id="e2d86-364">Ezen a ponton a szerepkör újraindul.</span><span class="sxs-lookup"><span data-stu-id="e2d86-364">At this point, the role will be recycled and will restart.</span></span>

<span data-ttu-id="e2d86-365">További részletekért és a **RoleEntryPoint** osztály metódusainak alkalmazási példájáért lásd a [számításierőforrás-konszolidálási mintát](../patterns/compute-resource-consolidation.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-365">For more details and an example of using the methods of the **RoleEntryPoint** class, see [Compute Resource Consolidation Pattern](../patterns/compute-resource-consolidation.md).</span></span>

#### <a name="implementation-considerations"></a><span data-ttu-id="e2d86-366">Implementálási szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-366">Implementation considerations</span></span>

<span data-ttu-id="e2d86-367">Amikor azt fontolgatja, hogy a háttérfeladatokat egy webes vagy egy feldolgozói szerepkörben valósítsa-e meg, vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="e2d86-367">Consider the following points if you are implementing background tasks in a web or worker role:</span></span>

* <span data-ttu-id="e2d86-368">Az alapértelmezett **Run** metódus implementálása a **RoleEntryPoint** osztályban tartalmazza a **Thread.Sleep(Timeout.Infinite)** meghívását, amely folyamatosan aktívan tartja a szerepkör.</span><span class="sxs-lookup"><span data-stu-id="e2d86-368">The default **Run** method implementation in the **RoleEntryPoint** class contains a call to **Thread.Sleep(Timeout.Infinite)** that keeps the role alive indefinitely.</span></span> <span data-ttu-id="e2d86-369">Ha felülbírálja a **Run** metódust (ami általában szükséges a háttérfeladatok végrehajtásához), nem szabad hagynia, hogy a kód kilépjen a metódusból, hacsak nem szeretné újraindítani a szerepkörpéldányt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-369">If you override the **Run** method (which is typically necessary to execute background tasks), you must not allow your code to exit from the method unless you want to recycle the role instance.</span></span>
* <span data-ttu-id="e2d86-370">A **Run** metódus tipikus megvalósításában a kód elindítja ez egyes háttérfeladatokat, egy ciklus pedig rendszeres időközönként ellenőrzi azok állapotát.</span><span class="sxs-lookup"><span data-stu-id="e2d86-370">A typical implementation of the **Run** method includes code to start each of the background tasks and a loop construct that periodically checks the state of all the background tasks.</span></span> <span data-ttu-id="e2d86-371">Újraindítja a meghiúsult feladatokat, és figyeli a megszakítási tokeneket, amelyek jelzik, ha egy adott feladat befejeződött.</span><span class="sxs-lookup"><span data-stu-id="e2d86-371">It can restart any that fail or monitor for cancellation tokens that indicate that jobs have completed.</span></span>
* <span data-ttu-id="e2d86-372">Ha valamelyik háttérfeladat nem kezelt kivételt jelez, a feladatot újra kell indítani, miközben biztosítani kell, hogy a szerepkörben lévő többi háttérfeladat tovább futhasson.</span><span class="sxs-lookup"><span data-stu-id="e2d86-372">If a background task throws an unhandled exception, that task should be recycled while allowing any other background tasks in the role to continue running.</span></span> <span data-ttu-id="e2d86-373">Azonban ha a kivételt a feladaton kívüli objektumok sérülése okozta, például a megosztott tárolóé, a kivételt a **RoleEntryPoint** osztálynak kezelnie kell, minden feladatot meg kell szakítani, és a **Run** metódust hagyni kell befejeződni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-373">However, if the exception is caused by corruption of objects outside the task, such as shared storage, the exception should be handled by your **RoleEntryPoint** class, all tasks should be cancelled, and the **Run** method should be allowed to end.</span></span> <span data-ttu-id="e2d86-374">Az Azure ezután újraindítja a szerepkört.</span><span class="sxs-lookup"><span data-stu-id="e2d86-374">Azure will then restart the role.</span></span>
* <span data-ttu-id="e2d86-375">Az **OnStop** metódus használatával szüneteltetheti vagy leállíthatja a háttérfeladatokat, és eltávolíthatja a fölöslegessé vált erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-375">Use the **OnStop** method to pause or kill background tasks and clean up resources.</span></span> <span data-ttu-id="e2d86-376">Ez akár a hosszú futású vagy többlépéses feladatok leállítását is jelentheti.</span><span class="sxs-lookup"><span data-stu-id="e2d86-376">This might involve stopping long-running or multistep tasks.</span></span> <span data-ttu-id="e2d86-377">Az adatinkonzisztencia elkerülése érdekében rendkívül fontos végiggondolni, hogy ez miként kivitelezhető.</span><span class="sxs-lookup"><span data-stu-id="e2d86-377">It is vital to consider how this can be done to avoid data inconsistencies.</span></span> <span data-ttu-id="e2d86-378">Ha egy szerepkörpéldány a felhasználó által kezdeményezett leállítástól eltekintve bármely más okból leáll, az **OnStop** metódust futtató kódnak öt percen belül be kell fejeződnie, mielőtt a rendszer kényszeríti a leállását.</span><span class="sxs-lookup"><span data-stu-id="e2d86-378">If a role instance stops for any reason other than a user-initiated shutdown, the code running in the **OnStop** method must be completed within five minutes before it is forcibly terminated.</span></span> <span data-ttu-id="e2d86-379">Gondoskodjon róla, hogy a kód ennyi idő alatt be tud fejeződni, vagy hogy ne okozzon problémát, ha nem tud végigfutni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-379">Ensure that your code can be completed in that time or can tolerate not running to completion.</span></span>  
* <span data-ttu-id="e2d86-380">Az Azure Load Balancer akkor kezdi a szerepkörpéldányra irányítani a forgalmat, amikor a **RoleEntryPoint.OnStart** metódus a **true** (igaz) értéket adja vissza.</span><span class="sxs-lookup"><span data-stu-id="e2d86-380">The Azure load balancer starts directing traffic to the role instance when the **RoleEntryPoint.OnStart** method returns the value **true**.</span></span> <span data-ttu-id="e2d86-381">Ennek okán érdemes lehet a teljes inicializálási kódot az **OnStart** metódusba rakni, hogy a sikeresen nem inicializáló szerepkörpéldányokra ne érkezzen forgalom.</span><span class="sxs-lookup"><span data-stu-id="e2d86-381">Therefore, consider putting all your initialization code in the **OnStart** method so that role instances that do not successfully initialize will not receive any traffic.</span></span>
* <span data-ttu-id="e2d86-382">A **RoleEntryPoint** osztály metódusain felül indítási feladatokat is alkalmazhat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-382">You can use startup tasks in addition to the methods of the **RoleEntryPoint** class.</span></span> <span data-ttu-id="e2d86-383">Az Azure Load Balancerben módosítani kívánt beállítások inicializálásához indítási feladatokat érdemes használni, mivel ezek a feladatok az előtt mennek végbe, hogy a szerepkör bármilyen kérést fogadna.</span><span class="sxs-lookup"><span data-stu-id="e2d86-383">You should use startup tasks to initialize any settings that you need to change in the Azure load balancer because these tasks will execute before the role receives any requests.</span></span> <span data-ttu-id="e2d86-384">További információért lásd az [Azure-beli indítási feladatok futtatásának](/azure/cloud-services/cloud-services-startup-tasks/) ismertetését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-384">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks/).</span></span>
* <span data-ttu-id="e2d86-385">Ha valamelyik indítási feladatban hiba van, előfordulhat, hogy folyamatos újraindulásra kényszeríti a szerepkört.</span><span class="sxs-lookup"><span data-stu-id="e2d86-385">If there is an error in a startup task, it might force the role to continually restart.</span></span> <span data-ttu-id="e2d86-386">Ez megakadályozhatja, hogy a virtuális IP-címet visszaállítsa egy korábban előkészített verzióra, mivel a váltáshoz kizárólagos hozzáférés szükséges a szerepkörhöz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-386">This can prevent you from performing a virtual IP (VIP) address swap back to a previously staged version because the swap requires exclusive access to the role.</span></span> <span data-ttu-id="e2d86-387">Ez pedig nem szerezhető be a szerepkör újraindítása közben.</span><span class="sxs-lookup"><span data-stu-id="e2d86-387">This cannot be obtained while the role is restarting.</span></span> <span data-ttu-id="e2d86-388">A probléma megoldása:</span><span class="sxs-lookup"><span data-stu-id="e2d86-388">To resolve this:</span></span>
  
  * <span data-ttu-id="e2d86-389">Adja hozzá a következő kódot a szerepkör **OnStart** és **Run** metódusának az elejéhez:</span><span class="sxs-lookup"><span data-stu-id="e2d86-389">Add the following code to the beginning of the **OnStart** and **Run** methods in your role:</span></span>
    
    ```C#
    var freeze = CloudConfigurationManager.GetSetting("Freeze");
    if (freeze != null)
    {
      if (Boolean.Parse(freeze))
      {
        Thread.Sleep(System.Threading.Timeout.Infinite);
      }
    }
    ```
    
  * <span data-ttu-id="e2d86-390">Adja hozzá a **Freeze** (Rögzítés) beállítás definícióját logikai értékként a szerepkör ServiceDefinition.csdef és ServiceConfiguration.\*.cscfg fájljához, és állítsa **false** (hamis) értékre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-390">Add the definition of the **Freeze** setting as a Boolean value to the ServiceDefinition.csdef and ServiceConfiguration.\*.cscfg files for the role and set it to **false**.</span></span> <span data-ttu-id="e2d86-391">Ha a szerepkör ismételt újraindítási módba lép, állítsa a beállítást **true** (igaz) értékre, hogy ezzel rögzítse a szerepkör végrehajtását, és lehetővé tegye az átváltását egy előző verzióra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-391">If the role goes into a repeated restart mode, you can change the setting to **true** to freeze role execution and allow it to be swapped with a previous version.</span></span>

#### <a name="more-information"></a><span data-ttu-id="e2d86-392">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-392">More information</span></span>
* [<span data-ttu-id="e2d86-393">Számításierőforrás-konszolidálási minta</span><span class="sxs-lookup"><span data-stu-id="e2d86-393">Compute Resource Consolidation Pattern</span></span>](../patterns/compute-resource-consolidation.md)
* [<span data-ttu-id="e2d86-394">Ismerkedés az Azure WebJobs SDK-val</span><span class="sxs-lookup"><span data-stu-id="e2d86-394">Get started with the Azure WebJobs SDK</span></span>](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started/)


## <a name="partitioning"></a><span data-ttu-id="e2d86-395">Particionálás</span><span class="sxs-lookup"><span data-stu-id="e2d86-395">Partitioning</span></span>
<span data-ttu-id="e2d86-396">Ha úgy dönt, hogy a háttérfeladatokat egy meglévő számítási példányon belül (például egy webalkalmazásban, webes szerepkörben, meglévő feldolgozói szerepkörben vagy virtuális gépben) kezeli, végig kell gondolnia, milyen hatással lesz ez a számítási példány minőségi attribútumaira és magára a háttérfeladatra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-396">If you decide to include background tasks within an existing compute instance (such as a web app, web role, existing worker role, or virtual machine), you must consider how this will affect the quality attributes of the compute instance and the background task itself.</span></span> <span data-ttu-id="e2d86-397">Három tényező segít eldönteni, hogy érdemes-e a feladatokat a meglévő számítási példányokkal közösen elhelyezni, vagy inkább ki kell szervezni azokat külön számítási példányokba:</span><span class="sxs-lookup"><span data-stu-id="e2d86-397">These factors will help you to decide whether to colocate the tasks with the existing compute instance or separate them out into a separate compute instance:</span></span>

* <span data-ttu-id="e2d86-398">**Rendelkezésre állás**: A háttérfeladatok esetében nem feltétlenül szükséges ugyanolyan rendelkezésre állás, mint az alkalmazás egyéb részei, különösen a felhasználói felület és a felhasználói beavatkozás során közvetlenül érintett egyéb részek esetében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-398">**Availability**: Background tasks might not need to have the same level of availability as other parts of the application, in particular the UI and other parts that are directly involved in user interaction.</span></span> <span data-ttu-id="e2d86-399">Mivel a műveletek várakoztathatók, a háttérfeladatok jobban elviselhetik a késéseket, a csatlakozási hibákból eredő újrapróbálkozásokat és a rendelkezésre állást befolyásoló egyéb tényezőket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-399">Background tasks might be more tolerant of latency, retried connection failures, and other factors that affect availability because the operations can be queued.</span></span> <span data-ttu-id="e2d86-400">Azonban elegendő kapacitással kell rendelkezni a kérések felgyülemlésének megakadályozásához, ami blokkolhatja az üzenetsorokat, és egészében érintheti az alkalmazás működését.</span><span class="sxs-lookup"><span data-stu-id="e2d86-400">However, there must be sufficient capacity to prevent the backup of requests that could block queues and affect the application as a whole.</span></span>
* <span data-ttu-id="e2d86-401">**Méretezhetőség**: A háttérfeladatok nagy valószínűséggel különböző méretezhetőségi követelményekkel rendelkeznek, mint a felhasználói felület és az alkalmazás interaktív részei.</span><span class="sxs-lookup"><span data-stu-id="e2d86-401">**Scalability**: Background tasks are likely to have a different scalability requirement than the UI and the interactive parts of the application.</span></span> <span data-ttu-id="e2d86-402">A használati csúcsok esetén szükség lehet a felhasználói felület felskálázására, a függőben lévő háttérfeladatokat azonban kevésbé terhelt időszakokban kevesebb számítási példány használatával is el lehet végezni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-402">Scaling the UI might be necessary to meet peaks in demand, while outstanding background tasks might be completed during less busy times by a fewer number of compute instances.</span></span>
* <span data-ttu-id="e2d86-403">**Rugalmasság**: A kizárólag háttérfeladatokat futtató számítási példányok meghibásodása nem feltétlenül vezet a teljes alkalmazás meghibásodásához, amennyiben ezeknek a feladatoknak a kérései várakoztathatók vagy elhalaszthatók, amíg a feladat újra elérhetővé nem válik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-403">**Resiliency**: Failure of a compute instance that just hosts background tasks might not fatally affect the application as a whole if the requests for these tasks can be queued or postponed until the task is available again.</span></span> <span data-ttu-id="e2d86-404">Ha a számítási példány és/vagy a feladatok egy megfelelő időintervallumon belül újraindíthatók, az alkalmazás felhasználóira ez nem lesz kihatással.</span><span class="sxs-lookup"><span data-stu-id="e2d86-404">If the compute instance and/or tasks can be restarted within an appropriate interval, users of the application might not be affected.</span></span>
* <span data-ttu-id="e2d86-405">**Biztonság**: A háttérfeladatok valószínűleg különböző biztonsági követelményekkel vagy korlátozásokkal rendelkeznek, mint a felhasználói felület vagy az alkalmazás egyéb részei.</span><span class="sxs-lookup"><span data-stu-id="e2d86-405">**Security**: Background tasks might have different security requirements or restrictions than the UI or other parts of the application.</span></span> <span data-ttu-id="e2d86-406">Különálló számítási példány használata esetén eltérő biztonsági környezetet határozhat meg ezekhez a feladatokhoz.</span><span class="sxs-lookup"><span data-stu-id="e2d86-406">By using a separate compute instance, you can specify a different security environment for the tasks.</span></span> <span data-ttu-id="e2d86-407">A Gatekeeper és a hasonló minták használatával a háttérbeli számítási példányokat a maximális biztonság és izoláció érdekében elkülönítheti a felhasználói felülettől.</span><span class="sxs-lookup"><span data-stu-id="e2d86-407">You can also use patterns such as Gatekeeper to isolate the background compute instances from the UI in order to maximize security and separation.</span></span>
* <span data-ttu-id="e2d86-408">**Teljesítmény**: A háttérfeladatok számítási példányainak típusát kiválaszthatja kifejezetten a feladatok teljesítménykövetelményeihez illeszkedően.</span><span class="sxs-lookup"><span data-stu-id="e2d86-408">**Performance**: You can choose the type of compute instance for background tasks to specifically match the performance requirements of the tasks.</span></span> <span data-ttu-id="e2d86-409">Ez azt jelenti, hogy az olyan háttérfeladatokhoz, amelyek nem igényelnek a felhasználói felülethez hasonló feldolgozási kapacitást, egy kevésbé költséges számítási alternatíva is elégséges lehet, vagy épp ellenkezőleg, egy nagyobb példány lehet szükséges, ha további kapacitásokat és erőforrásokat igényelnek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-409">This might mean using a less expensive compute option if the tasks do not require the same processing capabilities as the UI, or a larger instance if they require additional capacity and resources.</span></span>
* <span data-ttu-id="e2d86-410">**Kezelhetőség**: A háttérfeladatok esetleg más fejlesztési és üzembehelyezési léptékkel rendelkeznek, mint a fő alkalmazáskód vagy a felhasználói felület.</span><span class="sxs-lookup"><span data-stu-id="e2d86-410">**Manageability**: Background tasks might have a different development and deployment rhythm from the main application code or the UI.</span></span> <span data-ttu-id="e2d86-411">Ezeket külön számítási példányon beüzemelve egyszerűsíthető a frissítés és a verziókövetés.</span><span class="sxs-lookup"><span data-stu-id="e2d86-411">Deploying them to a separate compute instance can simplify updates and versioning.</span></span>
* <span data-ttu-id="e2d86-412">**Költségek**: Ha a háttérfeladatokhoz külön számítási példányokat ad hozzá, azzal növekednek az üzemeltetési költségek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-412">**Cost**: Adding compute instances to execute background tasks increases hosting costs.</span></span> <span data-ttu-id="e2d86-413">Alaposan gondolja át a további kapacitások és a további költségek közötti egyensúlyt.</span><span class="sxs-lookup"><span data-stu-id="e2d86-413">You should carefully consider the trade-off between additional capacity and these extra costs.</span></span>

<span data-ttu-id="e2d86-414">További információkért lásd a [vezetőválasztási mintát](../patterns/leader-election.md) és a [versengő felhasználók mintáját](../patterns/competing-consumers.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-414">For more information, see [Leader Election Pattern](../patterns/leader-election.md) and [Competing Consumers Pattern](../patterns/competing-consumers.md).</span></span>

## <a name="conflicts"></a><span data-ttu-id="e2d86-415">Ütközések</span><span class="sxs-lookup"><span data-stu-id="e2d86-415">Conflicts</span></span>
<span data-ttu-id="e2d86-416">Ha valamely háttérfeladatnak több példánya létezik, lehetséges, hogy azok versenyezni fognak az erőforrások és szolgáltatások, például az adatbázisok és a tárolók eléréséréért.</span><span class="sxs-lookup"><span data-stu-id="e2d86-416">If you have multiple instances of a background job, it is possible that they will compete for access to resources and services, such as databases and storage.</span></span> <span data-ttu-id="e2d86-417">Az ilyen egyidejű elérés erőforrásversenyhez vezethet, ami pedig ütközéseket okozhat a szolgáltatások rendelkezésre állásában és a tárolóadatok integritásában.</span><span class="sxs-lookup"><span data-stu-id="e2d86-417">This concurrent access can result in resource contention, which might cause conflicts in availability of the services and in the integrity of data in storage.</span></span> <span data-ttu-id="e2d86-418">Az erőforrásversenyt pesszimista zárolási módszer alkalmazásával tudja feloldani.</span><span class="sxs-lookup"><span data-stu-id="e2d86-418">You can resolve resource contention by using a pessimistic locking approach.</span></span> <span data-ttu-id="e2d86-419">Ez megakadályozza, hogy a feladat versengő példányai egyidejűleg érhessék el a szolgáltatásokat, vagy károsíthassák az adatokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-419">This prevents competing instances of a task from concurrently accessing a service or corrupting data.</span></span>

<span data-ttu-id="e2d86-420">Az ütközések feloldásának egy másik módszere a háttérfeladatok egypéldányosként való definiálása, azaz hogy minden esetben csak egy példányban futtathatók.</span><span class="sxs-lookup"><span data-stu-id="e2d86-420">Another approach to resolve conflicts is to define background tasks as a singleton, so that there is only ever one instance running.</span></span> <span data-ttu-id="e2d86-421">Azonban ez megszünteti a többpéldányos konfiguráció kínálta megbízhatósági és teljesítménybeli előnyöket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-421">However, this eliminates the reliability and performance benefits that a multiple-instance configuration can provide.</span></span> <span data-ttu-id="e2d86-422">Ez különösen igaz, ha a felhasználói felület elegendő munkát képes biztosítani, így több háttérfeladatot is lefoglal.</span><span class="sxs-lookup"><span data-stu-id="e2d86-422">This is especially true if the UI can supply sufficient work to keep more than one background task busy.</span></span>

<span data-ttu-id="e2d86-423">Kritikus fontosságú, hogy gondoskodjon róla, hogy a háttérfeladat képes legyen automatikusan újraindulni, és rendelkezzen elegendő kapacitással az igénycsúcsok kielégítéséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-423">It is vital to ensure that the background task can automatically restart and that it has sufficient capacity to cope with peaks in demand.</span></span> <span data-ttu-id="e2d86-424">Ezt úgy érheti el, ha elegendő erőforrással foglalja le a számítási példányokat, vagy ha kialakít egy olyan várakoztatási mechanizmust, amely képes a kéréseket az igény csökkenését követő későbbi végrehajtásra eltárolni, illetve ha ezt a két technikát együtt alkalmazza.</span><span class="sxs-lookup"><span data-stu-id="e2d86-424">You can achieve this by allocating a compute instance with sufficient resources, by implementing a queueing mechanism that can store requests for later execution when demand decreases, or by using a combination of these techniques.</span></span>

## <a name="coordination"></a><span data-ttu-id="e2d86-425">Koordináció</span><span class="sxs-lookup"><span data-stu-id="e2d86-425">Coordination</span></span>
<span data-ttu-id="e2d86-426">Előfordulhat, hogy a háttérfeladat összetett, és több egyedi feladatot kell futtatni az eredmény elérése érdekében vagy az összes követelmény teljesítéséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-426">The background tasks might be complex and might require multiple individual tasks to execute to produce a result or to fulfil all the requirements.</span></span> <span data-ttu-id="e2d86-427">Ezekben a forgatókönyvekben gyakran szokás a feladatokat több kisebb diszkrét lépésre vagy több alfeladatra felosztani, amelyeket több fogyasztó hajthat végre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-427">It is common in these scenarios to divide the task into smaller discreet steps or subtasks that can be executed by multiple consumers.</span></span> <span data-ttu-id="e2d86-428">A többlépéses feladat-végrehajtás hatékonyabb és rugalmasabb tud lenni, mivel az egyes lépések több feladatban is újrafelhasználhatók.</span><span class="sxs-lookup"><span data-stu-id="e2d86-428">Multistep jobs can be more efficient and more flexible because individual steps might be reusable in multiple jobs.</span></span> <span data-ttu-id="e2d86-429">Emellett könnyen bővíthető, csökkenthető vagy módosítható a lépések sora.</span><span class="sxs-lookup"><span data-stu-id="e2d86-429">It is also easy to add, remove, or modify the order of the steps.</span></span>

<span data-ttu-id="e2d86-430">Több feladat és lépés koordinálása kihívást jelenthet, létezik azonban három gyakori minta, amelyek segítségével könnyebben megvalósítható a megoldás:</span><span class="sxs-lookup"><span data-stu-id="e2d86-430">Coordinating multiple tasks and steps can be challenging, but there are three common patterns that you can use to guide your implementation of a solution:</span></span>

* <span data-ttu-id="e2d86-431">**A feladatok felbontása több újrafelhasználható lépésre**.</span><span class="sxs-lookup"><span data-stu-id="e2d86-431">**Decomposing a task into multiple reusable steps**.</span></span> <span data-ttu-id="e2d86-432">Az alkalmazásnak esetleg több, változó összetettségű feladatot kell végrehajtania a feldolgozandó adatokon.</span><span class="sxs-lookup"><span data-stu-id="e2d86-432">An application might be required to perform a variety of tasks of varying complexity on the information that it processes.</span></span> <span data-ttu-id="e2d86-433">Egy egyszerű, de rugalmatlan megközelítés az ilyen alkalmazások megvalósításához, ha ezt a feldolgozást egy monolitikus modulként hajtatjuk végre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-433">A straightforward but inflexible approach to implementing this application might be to perform this processing as a monolithic module.</span></span> <span data-ttu-id="e2d86-434">Ez a megközelítés azonban valószínűleg csökkenti a kód átdolgozásának, optimalizálásának vagy ismételt felhasználásának lehetőségét, amennyiben ugyanilyen feldolgozás máshol is szükséges lenne az alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-434">However, this approach is likely to reduce the opportunities for refactoring the code, optimizing it, or reusing it if parts of the same processing are required elsewhere within the application.</span></span> <span data-ttu-id="e2d86-435">További információért lásd a [csöveket és szűrőket ismertető mintát](../patterns/pipes-and-filters.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-435">For more information, see [Pipes and Filters Pattern](../patterns/pipes-and-filters.md).</span></span>
* <span data-ttu-id="e2d86-436">**A feladatlépések végrehajtásának felügyelete**.</span><span class="sxs-lookup"><span data-stu-id="e2d86-436">**Managing execution of the steps for a task**.</span></span> <span data-ttu-id="e2d86-437">Egy alkalmazásnak esetleg több lépésből álló feladatokat kell végrehajtania (amelyek némelyike esetleg távoli szolgáltatásokat hív meg vagy távoli erőforrásokat ér el).</span><span class="sxs-lookup"><span data-stu-id="e2d86-437">An application might perform tasks that comprise a number of steps (some of which might invoke remote services or access remote resources).</span></span> <span data-ttu-id="e2d86-438">Az egyes lépések egymástól függetlenek is lehetnek, de azokat a feladatot megvalósító alkalmazáslogika vezényli.</span><span class="sxs-lookup"><span data-stu-id="e2d86-438">The individual steps might be independent of each other, but they are orchestrated by the application logic that implements the task.</span></span> <span data-ttu-id="e2d86-439">További információért lásd a [feladatütemező ügynök felügyeleti mintáját](../patterns/scheduler-agent-supervisor.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-439">For more information, see [Scheduler Agent Supervisor Pattern](../patterns/scheduler-agent-supervisor.md).</span></span>
* <span data-ttu-id="e2d86-440">**A meghiúsult feladatlépések helyreállításának felügyelete**.</span><span class="sxs-lookup"><span data-stu-id="e2d86-440">**Managing recovery for task steps that fail**.</span></span> <span data-ttu-id="e2d86-441">Az alkalmazásnak esetleg vissza kell vonnia egy sor – együtt végül egy konzisztens műveletet alkotó – lépésben végrehajtott munkát, ha egy vagy több lépés meghiúsul.</span><span class="sxs-lookup"><span data-stu-id="e2d86-441">An application might need to undo the work that is performed by a series of steps (which together define an eventually consistent operation) if one or more of the steps fail.</span></span> <span data-ttu-id="e2d86-442">További információért lásd a [kompenzáló tranzakció mintáját](../patterns/compensating-transaction.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-442">For more information, see [Compensating Transaction Pattern](../patterns/compensating-transaction.md).</span></span>


## <a name="resiliency-considerations"></a><span data-ttu-id="e2d86-443">Rugalmassággal kapcsolatos szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-443">Resiliency considerations</span></span>
<span data-ttu-id="e2d86-444">A háttérfeladatoknak rugalmasnak kell lenniük, hogy megbízható szolgáltatásokat tudjanak biztosítani az alkalmazásnak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-444">Background tasks must be resilient in order to provide reliable services to the application.</span></span> <span data-ttu-id="e2d86-445">A háttérfeladatok tervezése és kialakítása során vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="e2d86-445">When you are planning and designing background tasks, consider the following points:</span></span>

* <span data-ttu-id="e2d86-446">A háttérfeladatoknak zökkenőmentesen kell tudniuk kezelni a szerepkörök vagy a szolgáltatások újraindítását anélkül, hogy az adatok sérülnének vagy inkonzisztencia keletkezne az alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-446">Background tasks must be able to gracefully handle role or service restarts without corrupting data or introducing inconsistency into the application.</span></span> <span data-ttu-id="e2d86-447">A hosszan futó vagy többlépéses feladatok esetében érdemes lehet *ellenőrzőpontokat* alkalmazni, aminek során a feladatok állapotát menti egy állandó tárolóban vagy üzenetekként egy üzenetsorban, ha az a megfelelőbb.</span><span class="sxs-lookup"><span data-stu-id="e2d86-447">For long-running or multistep tasks, consider using *check pointing* by saving the state of jobs in persistent storage, or as messages in a queue if this is appropriate.</span></span> <span data-ttu-id="e2d86-448">Például megőrizheti az állapotadatokat egy üzenetben az üzenetsorban, majd fokozatosan frissítheti ezt az állapotadatot a tevékenység előrehaladtával, így hiba esetén a feladatot a legutolsó sikeres ellenőrzőponttól kell csak végrehajtani, és nem a legelejétől.</span><span class="sxs-lookup"><span data-stu-id="e2d86-448">For example, you can persist state information in a message in a queue and incrementally update this state information with the task progress so that the task can be processed from the last known good checkpoint--instead of restarting from the beginning.</span></span> <span data-ttu-id="e2d86-449">Azure Service Bus-üzenetsorok használata esetén üzenet-munkamenetek használatával ugyanezt a forgatókönyvet valósíthatja meg.</span><span class="sxs-lookup"><span data-stu-id="e2d86-449">When using Azure Service Bus queues, you can use message sessions to enable the same scenario.</span></span> <span data-ttu-id="e2d86-450">A munkamenetek segítségével mentheti és visszaállíthatja az alkalmazás feldolgozási állapotát, a [SetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.setstate?view=azureservicebus-4.0.0) és a [GetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.getstate?view=azureservicebus-4.0.0) metódus alkalmazásával.</span><span class="sxs-lookup"><span data-stu-id="e2d86-450">Sessions allow you to save and retrieve the application processing state by using the [SetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.setstate?view=azureservicebus-4.0.0) and [GetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.getstate?view=azureservicebus-4.0.0) methods.</span></span> <span data-ttu-id="e2d86-451">A megbízható többlépéses folyamatok és munkafolyamatok tervezésével kapcsolatos további információért lásd a [feladatütemező ügynök felügyeleti mintáját](../patterns/scheduler-agent-supervisor.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-451">For more information about designing reliable multistep processes and workflows, see [Scheduler Agent Supervisor Pattern](../patterns/scheduler-agent-supervisor.md).</span></span>
* <span data-ttu-id="e2d86-452">Ha webes vagy feldolgozói szerepköröket használ több háttérfeladat futtatásához, a **Run** metódus felülbírálását úgy alakítsa ki, hogy az monitorozza a meghiúsult vagy elakadt feladatokat, és indítsa újra azokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-452">When you use web or worker roles to host multiple background tasks, design your override of the **Run** method to monitor for failed or stalled tasks, and restart them.</span></span> <span data-ttu-id="e2d86-453">Ahol ez nem praktikus, és feldolgozói szerepkört használ, a feldolgozói szerepkör újraindítását kikényszerítheti a **Run** metódusból való kilépéssel.</span><span class="sxs-lookup"><span data-stu-id="e2d86-453">Where this is not practical, and you are using a worker role, force the worker role to restart by exiting from the **Run** method.</span></span>
* <span data-ttu-id="e2d86-454">Ha üzenetsorokat használ a háttérfeladatokkal folytatott kommunikációhoz, az üzenetsorok használhatók pufferként, amelyek tárolják a feladatoknak küldött kéréseket, amíg az alkalmazás a szokottnál magasabb terheléssel működik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-454">When you use queues to communicate with background tasks, the queues can act as a buffer to store requests that are sent to the tasks while the application is under higher than usual load.</span></span> <span data-ttu-id="e2d86-455">Így a feladatok kevésbé forgalmas időszakokban utolérhetik a felhasználói felületet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-455">This allows the tasks to catch up with the UI during less busy periods.</span></span> <span data-ttu-id="e2d86-456">Ez azt is jelenti, hogy a szerepkör újraindítása nem blokkolja a felhasználói felületet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-456">It also means that recycling the role will not block the UI.</span></span> <span data-ttu-id="e2d86-457">További információért lásd az [üzenetsor-alapú terheléskiegyenlítési mintát](../patterns/queue-based-load-leveling.md).</span><span class="sxs-lookup"><span data-stu-id="e2d86-457">For more information, see [Queue-Based Load Leveling Pattern](../patterns/queue-based-load-leveling.md).</span></span> <span data-ttu-id="e2d86-458">Ha egyes feladatok fontosabbak a többinél, vegye fontolóra az [elsőbbségi üzenetsor mintájának](../patterns/priority-queue.md) alkalmazását, amellyel biztosítható, hogy ezek a feladatok a kevésbé fontosak előtt fussanak.</span><span class="sxs-lookup"><span data-stu-id="e2d86-458">If some tasks are more important than others, consider implementing the [Priority Queue Pattern](../patterns/priority-queue.md) to ensure that these tasks run before less important ones.</span></span>
* <span data-ttu-id="e2d86-459">Az üzenetek vagy a folyamatüzenetek által inicializált háttérfeladatokat úgy kell kialakítani, hogy kezeljék az inkonzisztenciákat, például a soron kívül érkező üzeneteket, a sorozatosan hibát okozó üzeneteket (más néven *ártalmas üzeneteket*) és a többször kézbesített üzeneteket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-459">Background tasks that are initiated by messages or process messages must be designed to handle inconsistencies, such as messages arriving out of order, messages that repeatedly cause an error (often referred to as *poison messages*), and messages that are delivered more than once.</span></span> <span data-ttu-id="e2d86-460">A következőket ajánljuk figyelmébe:</span><span class="sxs-lookup"><span data-stu-id="e2d86-460">Consider the following:</span></span>
  * <span data-ttu-id="e2d86-461">A meghatározott sorrendben feldolgozandó üzenetek, például amelyek meglévő adatértékek alapján módosítják az adatokat (például egy érték hozzáadása egy meglévő értékhez) esetleg nem a küldés eredeti sorrendjében érkeznek meg.</span><span class="sxs-lookup"><span data-stu-id="e2d86-461">Messages that must be processed in a specific order, such as those that change data based on the existing data value (for example, adding a value to an existing value), might not arrive in the original order in which they were sent.</span></span> <span data-ttu-id="e2d86-462">Vagy az is előfordulhat, hogy az egyes példányok különböző terhelése okán a háttérfeladat különböző példányai különböző sorrendben kezelik azokat.</span><span class="sxs-lookup"><span data-stu-id="e2d86-462">Alternatively, they might be handled by different instances of a background task in a different order due to varying loads on each instance.</span></span> <span data-ttu-id="e2d86-463">A meghatározott sorrendben feldolgozandó üzeneteknek ezért érdemes tartalmazniuk egy sorszámot, kulcsot vagy valamilyen egyéb jelölőt, amelynek segítségével a háttérfeladatok gondoskodhatnak róla, hogy a feldolgozás a megfelelő sorrendben történjen.</span><span class="sxs-lookup"><span data-stu-id="e2d86-463">Messages that must be processed in a specific order should include a sequence number, key, or some other indicator that background tasks can use to ensure that they are processed in the correct order.</span></span> <span data-ttu-id="e2d86-464">Az Azure Service Bus használata esetén üzenet-munkamenetek használatával garantálhatja a megfelelő kézbesítési sorrendet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-464">If you are using Azure Service Bus, you can use message sessions to guarantee the order of delivery.</span></span> <span data-ttu-id="e2d86-465">Általában azonban, ha ez lehetséges, hatékonyabb újratervezni a folyamatot úgy, hogy ne számítson az üzenetek sorrendje.</span><span class="sxs-lookup"><span data-stu-id="e2d86-465">However, it is usually more efficient, where possible, to design the process so that the message order is not important.</span></span>
  * <span data-ttu-id="e2d86-466">A háttérfeladatok általában betekintenek az üzenetekbe az üzenetsorban, ami ideiglenesen elrejti azokat a többi üzenetfogyasztó elől.</span><span class="sxs-lookup"><span data-stu-id="e2d86-466">Typically, a background task will peek at messages in the queue, which temporarily hides them from other message consumers.</span></span> <span data-ttu-id="e2d86-467">Ezután a háttérfeladat törli az üzeneteket azok sikeres feldolgozását követően.</span><span class="sxs-lookup"><span data-stu-id="e2d86-467">Then it deletes the messages after they have been successfully processed.</span></span> <span data-ttu-id="e2d86-468">Ha a háttérfeladat meghiúsul, miközben egy üzenetet dolgoz fel, az üzenet újból megjelenik az üzenetsorban a betekintés időtúllépésének lejártával.</span><span class="sxs-lookup"><span data-stu-id="e2d86-468">If a background task fails when processing a message, that message will reappear on the queue after the peek time-out expires.</span></span> <span data-ttu-id="e2d86-469">A feladat egy másik példánya fogja feldolgozni, vagy ugyanez a példány a következő feldolgozási ciklusban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-469">It will be processed by another instance of the task or during the next processing cycle of this instance.</span></span> <span data-ttu-id="e2d86-470">Ha az üzenet következetesen hibát okoz a fogyasztóban, az blokkolja a feladatot, az üzenetsort és végül magát az alkalmazást is, amikor az üzenetsor megtelik.</span><span class="sxs-lookup"><span data-stu-id="e2d86-470">If the message consistently causes an error in the consumer, it will block the task, the queue, and eventually the application itself when the queue becomes full.</span></span> <span data-ttu-id="e2d86-471">Ezért kritikus fontosságú az ártalmas üzenetek észlelése és eltávolítása az üzenetsorból.</span><span class="sxs-lookup"><span data-stu-id="e2d86-471">Therefore, it is vital to detect and remove poison messages from the queue.</span></span> <span data-ttu-id="e2d86-472">Az Azure Service Bus használata esetén a hibát okozó üzenetek automatikusan vagy manuálisan áthelyezhetők a feldolgozatlan üzenetek társított üzenetsorába.</span><span class="sxs-lookup"><span data-stu-id="e2d86-472">If you are using Azure Service Bus, messages that cause an error can be moved automatically or manually to an associated dead letter queue.</span></span>
  * <span data-ttu-id="e2d86-473">Az üzenetsorok egy *legalább egyszeri* kézbesítési mechanizmust garantálnak, de akár többször is kézbesíthetik ugyanazt az üzenetet.</span><span class="sxs-lookup"><span data-stu-id="e2d86-473">Queues are guaranteed at *least once* delivery mechanisms, but they might deliver the same message more than once.</span></span> <span data-ttu-id="e2d86-474">Ezenkívül ha a háttérfeladat meghiúsul az üzenet feldolgozása után, de még mielőtt törölhetné azt az üzenetsorból, az üzenet ismét elérhető lesz feldolgozásra.</span><span class="sxs-lookup"><span data-stu-id="e2d86-474">In addition, if a background task fails after processing a message but before deleting it from the queue, the message will become available for processing again.</span></span> <span data-ttu-id="e2d86-475">A háttérfeladatoknak idempotenseknek kell lenniük, ami azt jelenti, hogy ugyanannak az üzenetnek a többszöri feldolgozása nem okozhat hibát vagy inkonzisztenciát az alkalmazás adataiban.</span><span class="sxs-lookup"><span data-stu-id="e2d86-475">Background tasks should be idempotent, which means that processing the same message more than once does not cause an error or inconsistency in the application’s data.</span></span> <span data-ttu-id="e2d86-476">Egyes műveletek természetükből fakadóan idempotensek, például ilyen egy tárolt érték átállítása egy megadott új értékre.</span><span class="sxs-lookup"><span data-stu-id="e2d86-476">Some operations are naturally idempotent, such as setting a stored value to a specific new value.</span></span> <span data-ttu-id="e2d86-477">Más műveletek azonban inkonzisztenciát okozhatnak, például ha egy értéket adunk hozzá egy meglévő tárolt értékhez annak ellenőrzése nélkül, hogy az változott-e az üzenet eredeti küldésének időpontjához képest.</span><span class="sxs-lookup"><span data-stu-id="e2d86-477">However, operations such as adding a value to an existing stored value without checking that the stored value is still the same as when the message was originally sent will cause inconsistencies.</span></span> <span data-ttu-id="e2d86-478">Az Azure Service Bus-üzenetsorok konfigurálhatók úgy, hogy automatikusan eltávolítsák a duplikált üzeneteket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-478">Azure Service Bus queues can be configured to automatically remove duplicated messages.</span></span>
  * <span data-ttu-id="e2d86-479">Egyes üzenetküldő rendszerek, például az Azure Storage-üzenetsorok támogatják egy üzenetkivételi számláló tulajdonság használatát, amely azon alkalmak számát jelzi, ahányszor az üzenet ki lett olvasva az üzenetsorból.</span><span class="sxs-lookup"><span data-stu-id="e2d86-479">Some messaging systems, such as Azure storage queues and Azure Service Bus queues, support a de-queue count property that indicates the number of times a message has been read from the queue.</span></span> <span data-ttu-id="e2d86-480">Ez hasznos lehet az ismétlődő és ártalmas üzenetek kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-480">This can be useful in handling repeated and poison messages.</span></span> <span data-ttu-id="e2d86-481">További információért lásd [az aszinkron üzenetkezelés ismertetését](https://msdn.microsoft.com/library/dn589781.aspx) és az [idempotens mintákat](https://blog.jonathanoliver.com/idempotency-patterns/).</span><span class="sxs-lookup"><span data-stu-id="e2d86-481">For more information, see [Asynchronous Messaging Primer](https://msdn.microsoft.com/library/dn589781.aspx) and [Idempotency Patterns](https://blog.jonathanoliver.com/idempotency-patterns/).</span></span>

## <a name="scaling-and-performance-considerations"></a><span data-ttu-id="e2d86-482">A méretezéssel és a teljesítménnyel kapcsolatos szempontok</span><span class="sxs-lookup"><span data-stu-id="e2d86-482">Scaling and performance considerations</span></span>
<span data-ttu-id="e2d86-483">A háttérfeladatoknak elegendő teljesítményt kell biztosítania, hogy ne blokkolhassák az alkalmazást vagy okozhassanak inkonzisztenciát, ha a rendszer terhelése miatt késéssel működnek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-483">Background tasks must offer sufficient performance to ensure they do not block the application, or cause inconsistencies due to delayed operation when the system is under load.</span></span> <span data-ttu-id="e2d86-484">Általában a teljesítmény a háttérfeladatot futtató számítási példányok skálázásával javítható.</span><span class="sxs-lookup"><span data-stu-id="e2d86-484">Typically, performance is improved by scaling the compute instances that host the background tasks.</span></span> <span data-ttu-id="e2d86-485">A háttérfeladatok tervezése és kialakítása során vegye figyelembe a következő szempontokat a skálázás és a teljesítmény kapcsán:</span><span class="sxs-lookup"><span data-stu-id="e2d86-485">When you are planning and designing background tasks, consider the following points around scalability and performance:</span></span>

* <span data-ttu-id="e2d86-486">Az Azure támogatja az automatikus skálázást (a kiterjesztést és a szűkítést egyaránt) az aktuális igény és terhelés alapján – vagy egy előre meghatározott ütemezés szerint a Web Apps, a Cloud Services webes és feldolgozói szerepkörei, valamint a Virtual Machinesben üzemelő környezetek esetében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-486">Azure supports autoscaling (both scaling out and scaling back in) based on current demand and load--or on a predefined schedule, for Web Apps, Cloud Services web and worker roles, and Virtual Machines hosted deployments.</span></span> <span data-ttu-id="e2d86-487">Ennek a szolgáltatásnak a használatával biztosítható, hogy az alkalmazás egésze elegendő teljesítménybeli kapacitással rendelkezzen, ugyanakkor a futtatási költségek minimalizálhatók legyenek.</span><span class="sxs-lookup"><span data-stu-id="e2d86-487">Use this feature to ensure that the application as a whole has sufficient performance capabilities while minimizing runtime costs.</span></span>
* <span data-ttu-id="e2d86-488">Azokban az esetekben, ahol a háttérfeladatok a Cloud Services-alkalmazás más részeitől (például a felhasználói felülettől vagy az olyan összetevőktől, mint az adatelérési réteg) eltérő teljesítménybeli kapacitásokkal rendelkeznek, a háttérfeladatok egy külön feldolgozói szerepkörben való együttes futtatásával a felhasználói felület és a háttérfeladatok egymástól függetlenül méretezhetők a terhelés kezelése érdekében.</span><span class="sxs-lookup"><span data-stu-id="e2d86-488">Where background tasks have a different performance capability from the other parts of a Cloud Services application (for example, the UI or components such as the data access layer), hosting the background tasks together in a separate worker role allows the UI and background task roles to scale independently to manage the load.</span></span> <span data-ttu-id="e2d86-489">Ha több háttérfeladat egymástól jelentősen eltérő teljesítménybeli kapacitásokkal rendelkezik, vegye fontolóra azok külön feldolgozói szerepkörökbe való elosztásának és az egyes szerepkörtípusok egymástól független skálázásának a lehetőségét.</span><span class="sxs-lookup"><span data-stu-id="e2d86-489">If multiple background tasks have significantly different performance capabilities from each other, consider dividing them into separate worker roles and scaling each role type independently.</span></span> <span data-ttu-id="e2d86-490">Vegye figyelembe azonban, hogy ebben az esetben a futtatási költségek magasabbak lesznek, mint ha a feladatokat kevesebb szerepkörben egyesítené.</span><span class="sxs-lookup"><span data-stu-id="e2d86-490">However, note that this might increase runtime costs compared to combining all the tasks into fewer roles.</span></span>
* <span data-ttu-id="e2d86-491">A szerepkörök egyszerű skálázása nem feltétlenül elégséges a terhelés következtében fellépő teljesítményvesztés elkerüléséhez.</span><span class="sxs-lookup"><span data-stu-id="e2d86-491">Simply scaling the roles might not be sufficient to prevent loss of performance under load.</span></span> <span data-ttu-id="e2d86-492">Emellett a tároló-üzenetsorokat és egyéb erőforrásokat is méretezni kellhet, hogy a teljes feldolgozási lánc egyetlen pontja se válhasson szűk keresztmetszetté.</span><span class="sxs-lookup"><span data-stu-id="e2d86-492">You might also need to scale storage queues and other resources to prevent a single point of the overall processing chain from becoming a bottleneck.</span></span> <span data-ttu-id="e2d86-493">Vegye figyelembe továbbá az egyéb korlátokat is, például a tároló, valamint az alkalmazás és a háttérfeladatok által használt egyéb szolgáltatások maximális teljesítményét is.</span><span class="sxs-lookup"><span data-stu-id="e2d86-493">Also, consider other limitations, such as the maximum throughput of storage and other services that the application and the background tasks rely on.</span></span>
* <span data-ttu-id="e2d86-494">A háttérfeladatokat méretezhetően kell kialakítani.</span><span class="sxs-lookup"><span data-stu-id="e2d86-494">Background tasks must be designed for scaling.</span></span> <span data-ttu-id="e2d86-495">Például képesnek kell lenniük dinamikusan észlelni a használatban lévő üzenetsorok számát, hogy a megfelelő üzenetsort figyelhessék, és maguk is a megfelelő üzenetsorba küldjék az üzeneteket.</span><span class="sxs-lookup"><span data-stu-id="e2d86-495">For example, they must be able to dynamically detect the number of storage queues in use in order to listen on or send messages to the appropriate queue.</span></span>
* <span data-ttu-id="e2d86-496">Alapértelmezés szerint a WebJobs-feladatok együtt méreteződnek a társított Azure Web Apps-példánnyal.</span><span class="sxs-lookup"><span data-stu-id="e2d86-496">By default, WebJobs scale with their associated Azure Web Apps instance.</span></span> <span data-ttu-id="e2d86-497">Azonban ha azt szeretné, hogy a WebJobs-feladat csak egy példányban fusson, létrehozhat egy Settings.job fájlt, amely tartalmazza az **{"is_singleton": true}** JSON-adatot.</span><span class="sxs-lookup"><span data-stu-id="e2d86-497">However, if you want a WebJob to run as only a single instance, you can create a Settings.job file that contains the JSON data **{ "is_singleton": true }**.</span></span> <span data-ttu-id="e2d86-498">Ez kényszeríti az Azure-t, hogy a WebJobs-feladatot csak egy példányban futtassa, még ha a kapcsolódó webalkalmazásnak több példánya van is.</span><span class="sxs-lookup"><span data-stu-id="e2d86-498">This forces Azure to only run one instance of the WebJob, even if there are multiple instances of the associated web app.</span></span> <span data-ttu-id="e2d86-499">Ez hasznos módszer lehet az olyan ütemezett feladatokhoz, amelyeket csak egy példányban lehet futtatni.</span><span class="sxs-lookup"><span data-stu-id="e2d86-499">This can be a useful technique for scheduled jobs that must run as only a single instance.</span></span>

## <a name="related-patterns"></a><span data-ttu-id="e2d86-500">Kapcsolódó minták</span><span class="sxs-lookup"><span data-stu-id="e2d86-500">Related patterns</span></span>
* [<span data-ttu-id="e2d86-501">Az aszinkron üzenetkezelés ismertetése</span><span class="sxs-lookup"><span data-stu-id="e2d86-501">Asynchronous Messaging Primer</span></span>](https://msdn.microsoft.com/library/dn589781.aspx)
* [<span data-ttu-id="e2d86-502">Útmutató az automatikus méretezéshez</span><span class="sxs-lookup"><span data-stu-id="e2d86-502">Autoscaling Guidance</span></span>](https://msdn.microsoft.com/library/dn589774.aspx)
* [<span data-ttu-id="e2d86-503">Kompenzáló tranzakció mintája</span><span class="sxs-lookup"><span data-stu-id="e2d86-503">Compensating Transaction Pattern</span></span>](../patterns/compensating-transaction.md)
* [<span data-ttu-id="e2d86-504">Versengő felhasználók mintája</span><span class="sxs-lookup"><span data-stu-id="e2d86-504">Competing Consumers Pattern</span></span>](../patterns/competing-consumers.md)
* [<span data-ttu-id="e2d86-505">Compute-particionálási útmutató</span><span class="sxs-lookup"><span data-stu-id="e2d86-505">Compute Partitioning Guidance</span></span>](https://msdn.microsoft.com/library/dn589773.aspx)
* [<span data-ttu-id="e2d86-506">Számításierőforrás-konszolidálási minta</span><span class="sxs-lookup"><span data-stu-id="e2d86-506">Compute Resource Consolidation Pattern</span></span>](https://msdn.microsoft.com/library/dn589778.aspx)
* [<span data-ttu-id="e2d86-507">Gatekeeper-minta</span><span class="sxs-lookup"><span data-stu-id="e2d86-507">Gatekeeper Pattern</span></span>](../patterns/gatekeeper.md)
* [<span data-ttu-id="e2d86-508">Vezetőválasztási minta</span><span class="sxs-lookup"><span data-stu-id="e2d86-508">Leader Election Pattern</span></span>](../patterns/leader-election.md)
* [<span data-ttu-id="e2d86-509">Csövek és szűrők mintája</span><span class="sxs-lookup"><span data-stu-id="e2d86-509">Pipes and Filters Pattern</span></span>](../patterns/pipes-and-filters.md)
* [<span data-ttu-id="e2d86-510">Elsőbbségi üzenetsor mintája</span><span class="sxs-lookup"><span data-stu-id="e2d86-510">Priority Queue Pattern</span></span>](../patterns/priority-queue.md)
* [<span data-ttu-id="e2d86-511">Üzenetsor-alapú terheléskiegyenlítési minta</span><span class="sxs-lookup"><span data-stu-id="e2d86-511">Queue-based Load Leveling Pattern</span></span>](../patterns/queue-based-load-leveling.md)
* [<span data-ttu-id="e2d86-512">Feladatütemező ügynök felügyeleti mintája</span><span class="sxs-lookup"><span data-stu-id="e2d86-512">Scheduler Agent Supervisor Pattern</span></span>](../patterns/scheduler-agent-supervisor.md)

## <a name="more-information"></a><span data-ttu-id="e2d86-513">További információ</span><span class="sxs-lookup"><span data-stu-id="e2d86-513">More information</span></span>
* [<span data-ttu-id="e2d86-514">Háttérfeladatok végrehajtása</span><span class="sxs-lookup"><span data-stu-id="e2d86-514">Executing Background Tasks</span></span>](https://msdn.microsoft.com/library/ff803365.aspx)
* <span data-ttu-id="e2d86-515">[Azure Cloud Services-szerepkörök életciklusa](https://channel9.msdn.com/Series/Windows-Azure-Cloud-Services-Tutorials/Windows-Azure-Cloud-Services-Role-Lifecycle) (videó)</span><span class="sxs-lookup"><span data-stu-id="e2d86-515">[Azure Cloud Services Role Lifecycle](https://channel9.msdn.com/Series/Windows-Azure-Cloud-Services-Tutorials/Windows-Azure-Cloud-Services-Role-Lifecycle) (video)</span></span>
* [<span data-ttu-id="e2d86-516">Mi az Azure WebJobs SDK?</span><span class="sxs-lookup"><span data-stu-id="e2d86-516">What is the Azure WebJobs SDK</span></span>](https://docs.microsoft.com/azure/app-service-web/websites-dotnet-webjobs-sdk)
* [<span data-ttu-id="e2d86-517">Háttérfeladatok futtatása WebJobs-feladatokkal</span><span class="sxs-lookup"><span data-stu-id="e2d86-517">Run Background tasks with WebJobs</span></span>](https://docs.microsoft.com/azure/app-service-web/web-sites-create-web-jobs)
* [<span data-ttu-id="e2d86-518">Azure-üzenetsorok és Service Bus-üzenetsorok összehasonlítása</span><span class="sxs-lookup"><span data-stu-id="e2d86-518">Azure Queues and Service Bus Queues - Compared and Contrasted</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted)
* [<span data-ttu-id="e2d86-519">A diagnosztika engedélyezése a Cloud Servicesben</span><span class="sxs-lookup"><span data-stu-id="e2d86-519">How to Enable Diagnostics in a Cloud Service</span></span>](https://docs.microsoft.com/azure/cloud-services/cloud-services-dotnet-diagnostics)

