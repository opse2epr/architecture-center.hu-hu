---
title: CI/CD a mikroszolgáltatásokhoz
description: Folyamatos integráció és folyamatos készregyártás a mikroszolgáltatásokat.
author: MikeWasson
ms.date: 03/27/2019
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: microservices
ms.openlocfilehash: c52ff3d0a330f564e5f7e9b0b07f0ba84c328c8b
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59639784"
---
# <a name="cicd-for-microservices-architectures"></a><span data-ttu-id="d154f-103">CI/CD-mikroszolgáltatás-architektúrákat</span><span class="sxs-lookup"><span data-stu-id="d154f-103">CI/CD for microservices architectures</span></span>

<span data-ttu-id="d154f-104">Gyorsabb kiadási ciklusokhoz főbb előnyei a mikroszolgáltatás-architektúrákat tartoznak.</span><span class="sxs-lookup"><span data-stu-id="d154f-104">Faster release cycles are one of the major advantages of microservices architectures.</span></span> <span data-ttu-id="d154f-105">Azonban egy jó CI/CD-folyamat nélkül nem érhető el a rugalmasságot, mellyel a mikroszolgáltatások garantálniuk.</span><span class="sxs-lookup"><span data-stu-id="d154f-105">But without a good CI/CD process, you won't achieve the agility that microservices promise.</span></span> <span data-ttu-id="d154f-106">Ez a cikk a kihívásokat ismerteti, és javasolja a probléma néhány olyan módszert.</span><span class="sxs-lookup"><span data-stu-id="d154f-106">This article describes the challenges and recommends some approaches to the problem.</span></span>

## <a name="what-is-cicd"></a><span data-ttu-id="d154f-107">Mit jelent a CI/CD-ről?</span><span class="sxs-lookup"><span data-stu-id="d154f-107">What is CI/CD?</span></span>

<span data-ttu-id="d154f-108">Amikor CI/CD az, hogy valóban több kapcsolódó folyamatok beszélünk: Folyamatos integráció, a folyamatos teljesítés és a folyamatos üzembe helyezés.</span><span class="sxs-lookup"><span data-stu-id="d154f-108">When we talk about CI/CD, we're really talking about several related processes: Continuous integration, continuous delivery, and continuous deployment.</span></span>

- <span data-ttu-id="d154f-109">**Folyamatos integráció**.</span><span class="sxs-lookup"><span data-stu-id="d154f-109">**Continuous integration**.</span></span> <span data-ttu-id="d154f-110">Kód gyakran összefésülés megtörténne a fő ágat.</span><span class="sxs-lookup"><span data-stu-id="d154f-110">Code changes are frequently merged into the main branch.</span></span> <span data-ttu-id="d154f-111">Automatikus buildelési és tesztelési folyamatokat győződjön meg arról, hogy kódot a fő ág mindig gyártási minőségű.</span><span class="sxs-lookup"><span data-stu-id="d154f-111">Automated build and test processes ensure that code in the main branch is always production-quality.</span></span>

- <span data-ttu-id="d154f-112">**A folyamatos teljesítés**.</span><span class="sxs-lookup"><span data-stu-id="d154f-112">**Continuous delivery**.</span></span> <span data-ttu-id="d154f-113">Adja át a CI folyamat kódváltozások a rendszer automatikusan közzéteszi a utolsóig üzemi környezetben.</span><span class="sxs-lookup"><span data-stu-id="d154f-113">Any code changes that pass the CI process are automatically published to a production-like environment.</span></span> <span data-ttu-id="d154f-114">Az élő éles környezetben való üzembe helyezés manuális jóváhagyásra lehet szükség, de egyébként automatizált.</span><span class="sxs-lookup"><span data-stu-id="d154f-114">Deployment into the live production environment may require manual approval, but is otherwise automated.</span></span> <span data-ttu-id="d154f-115">Az a célja, hogy a kód mindig legyen *készen* helyezheti éles üzembe.</span><span class="sxs-lookup"><span data-stu-id="d154f-115">The goal is that your code should always be *ready* to deploy into production.</span></span>

- <span data-ttu-id="d154f-116">**Folyamatos üzembe helyezés**.</span><span class="sxs-lookup"><span data-stu-id="d154f-116">**Continuous deployment**.</span></span> <span data-ttu-id="d154f-117">Kód módosítja, hogy a rendszer automatikusan telepíti az előző két lépést pass *éles környezetbe*.</span><span class="sxs-lookup"><span data-stu-id="d154f-117">Code changes that pass the previous two steps are automatically deployed *into production*.</span></span>

<span data-ttu-id="d154f-118">Az alábbiakban néhány célja a mikroszolgáltatási architektúra egy robusztus CI/CD folyamatot:</span><span class="sxs-lookup"><span data-stu-id="d154f-118">Here are some goals of a robust CI/CD process for a microservices architecture:</span></span>

- <span data-ttu-id="d154f-119">Minden egyes csapat létrehozhat és üzembe helyezése a szolgáltatások egymástól függetlenül, tulajdonos érintő vagy más csapatok megszakítása nélkül.</span><span class="sxs-lookup"><span data-stu-id="d154f-119">Each team can build and deploy the services that it owns independently, without affecting or disrupting other teams.</span></span>

- <span data-ttu-id="d154f-120">A szolgáltatás egy új verziója éles üzembe helyezés, mielőtt megtörténik fejlesztési/tesztelési/QA Environment ellenőrzés céljából.</span><span class="sxs-lookup"><span data-stu-id="d154f-120">Before a new version of a service is deployed to production, it gets deployed to dev/test/QA environments for validation.</span></span> <span data-ttu-id="d154f-121">Minőségi kapuk a rendszer minden egyes fázisában érvényesíti.</span><span class="sxs-lookup"><span data-stu-id="d154f-121">Quality gates are enforced at each stage.</span></span>

- <span data-ttu-id="d154f-122">A szolgáltatás egy új verziója is telepíthető az előző verzió párhuzamosan lesz.</span><span class="sxs-lookup"><span data-stu-id="d154f-122">A new version of a service can be deployed side by side with the previous version.</span></span>

- <span data-ttu-id="d154f-123">Megfelelő hozzáférés-vezérlési házirendeket vannak érvényben.</span><span class="sxs-lookup"><span data-stu-id="d154f-123">Sufficient access control policies are in place.</span></span>

- <span data-ttu-id="d154f-124">A tárolóalapú számítási feladatokhoz megbízható a tárolórendszerképeket az éles környezetben üzembe helyezett.</span><span class="sxs-lookup"><span data-stu-id="d154f-124">For containerized workloads, you can trust the container images that are deployed to production.</span></span>

## <a name="why-a-robust-cicd-pipeline-matters"></a><span data-ttu-id="d154f-125">Miért fontos a egy robusztus CI/CD-folyamat</span><span class="sxs-lookup"><span data-stu-id="d154f-125">Why a robust CI/CD pipeline matters</span></span>

<span data-ttu-id="d154f-126">A hagyományos monolitikus alkalmazások esetén nincs egy egyetlen build folyamatot, amelynek a kimenete az alkalmazás futtatható.</span><span class="sxs-lookup"><span data-stu-id="d154f-126">In a traditional monolithic application, there is a single build pipeline whose output is the application executable.</span></span> <span data-ttu-id="d154f-127">Minden fejlesztési munka hírcsatornák a folyamatba.</span><span class="sxs-lookup"><span data-stu-id="d154f-127">All development work feeds into this pipeline.</span></span> <span data-ttu-id="d154f-128">Ha egy magas prioritású hiba található, a javítás kell lennie integrált, tesztelését és kiadását, amely késleltetheti-e új funkciók megjelenésével.</span><span class="sxs-lookup"><span data-stu-id="d154f-128">If a high-priority bug is found, a fix must be integrated, tested, and published, which can delay the release of new features.</span></span> <span data-ttu-id="d154f-129">Jól faktorált modulokat, és a szolgáltatás ágak használatával kódmódosításokat minimalizálása érdekében csökkentheti ezeket a problémákat.</span><span class="sxs-lookup"><span data-stu-id="d154f-129">You can mitigate these problems by having well-factored modules and using feature branches to minimize the impact of code changes.</span></span> <span data-ttu-id="d154f-130">Azonban, ha az alkalmazás összetettebb növekszik, és további szolgáltatások lesznek hozzáadva, mikroszolgáltatásokká kiadási folyamata általában törékennyé teszi és valószínűleg érvényteleníteni válik.</span><span class="sxs-lookup"><span data-stu-id="d154f-130">But as the application grows more complex, and more features are added, the release process for a monolith tends to become more brittle and likely to break.</span></span>

<span data-ttu-id="d154f-131">A mikroszolgáltatások filozófia a következő soha nem kell egy hosszú kibocsátási train, ahol minden egyes csapat beolvasása a sor van.</span><span class="sxs-lookup"><span data-stu-id="d154f-131">Following the microservices philosophy, there should never be a long release train where every team has to get in line.</span></span> <span data-ttu-id="d154f-132">"A" módosításait a szolgáltatás részeként történik, hogy a "B" várakozás nélkül is megjelenhetnek egy tetszőleges időpontban, frissítési szolgáltatás hangolt tesztelését és üzembe helyezve.</span><span class="sxs-lookup"><span data-stu-id="d154f-132">The team that builds service "A" can release an update at any time, without waiting for changes in service "B" to be merged, tested, and deployed.</span></span>

![CI/CD mikroszolgáltatásokká ábrája](./images/cicd-monolith.png)

<span data-ttu-id="d154f-134">A kiadások gyors megjelenését eléréséhez a kibocsátási folyamat automatizált és a kockázat minimalizálása érdekében magas megbízhatóságú kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d154f-134">To achieve a high release velocity, your release pipeline must be automated and highly reliable, to minimize risk.</span></span> <span data-ttu-id="d154f-135">Ha felszabadít éles naponta vagy naponta többször, regressziót vagy szolgáltatáskimaradás nagyon ritkán kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d154f-135">If you release to production daily or multiple times a day, regressions or service disruptions must be very rare.</span></span> <span data-ttu-id="d154f-136">Egyszerre egy rossz frissítés üzembe helyezése, ha rendelkeznie kell egy megbízható módszerre gyorsan visszaállni vagy előregörgethet egy korábbi verzióját, a szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="d154f-136">At the same time, if a bad update does get deployed, you must have a reliable way to quickly roll back or roll forward to a previous version of a service.</span></span>

## <a name="challenges"></a><span data-ttu-id="d154f-137">Problémák</span><span class="sxs-lookup"><span data-stu-id="d154f-137">Challenges</span></span>

- <span data-ttu-id="d154f-138">**Sok kis független kódbázissal**.</span><span class="sxs-lookup"><span data-stu-id="d154f-138">**Many small independent code bases**.</span></span> <span data-ttu-id="d154f-139">Minden egyes csapat felelős a saját szolgáltatás, amelynek a saját build folyamat létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="d154f-139">Each team is responsible for building its own service, with its own build pipeline.</span></span> <span data-ttu-id="d154f-140">Egyes szervezetekben a csapat a előfordulhat, hogy külön kódtárházak.</span><span class="sxs-lookup"><span data-stu-id="d154f-140">In some organizations, teams may use separate code repositories.</span></span> <span data-ttu-id="d154f-141">Olyan helyzet, amelyben az ismeretek, hogyan hozhat létre a rendszer a csapatok között megoszlik, és a szervezet senki sem tudja, hogy a teljes alkalmazás központi telepítése különálló tárházak vezethet.</span><span class="sxs-lookup"><span data-stu-id="d154f-141">Separate repositories can lead to a situation where the knowledge of how to build the system is spread across teams, and nobody in the organization knows how to deploy the entire application.</span></span> <span data-ttu-id="d154f-142">Például mi történik, a vész-helyreállítási helyzetekre, ha gyorsan üzembe helyezhet egy új fürtre van szüksége?</span><span class="sxs-lookup"><span data-stu-id="d154f-142">For example, what happens in a disaster recovery scenario, if you need to quickly deploy to a new cluster?</span></span>

    <span data-ttu-id="d154f-143">**Kockázatcsökkentési**: Rendelkezik egy egységes és automatikus készíthet és helyezhet üzembe szolgáltatásokat, így ezt a tudást nem "rejtett" belül minden egyes csapat.</span><span class="sxs-lookup"><span data-stu-id="d154f-143">**Mitigation**: Have a unified and automated pipeline to build and deploy services, so that this knowledge is not "hidden" within each team.</span></span>

- <span data-ttu-id="d154f-144">**Több nyelv és keretrendszer**.</span><span class="sxs-lookup"><span data-stu-id="d154f-144">**Multiple languages and frameworks**.</span></span> <span data-ttu-id="d154f-145">Az egyes csapata a saját technológiák vegyítése használatával nehézkes lehet a szervezet egészében működő egyetlen buildelési folyamat létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="d154f-145">With each team using its own mix of technologies, it can be difficult to create a single build process that works across the organization.</span></span> <span data-ttu-id="d154f-146">A létrehozási folyamat kellően rugalmas ahhoz, hogy minden egyes csapat tesztkörnyezetéhez, az általuk választott nyelvet vagy keretrendszert kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d154f-146">The build process must be flexible enough that every team can adapt it for their choice of language or framework.</span></span>

    <span data-ttu-id="d154f-147">**Kockázatcsökkentési**: A létrehozási folyamat minden egyes szolgáltatás tárolóba.</span><span class="sxs-lookup"><span data-stu-id="d154f-147">**Mitigation**: Containerize the build process for each service.</span></span> <span data-ttu-id="d154f-148">Ezzel a módszerrel az összeállítási rendszer ugyanúgy képesnek kell lennie a tárolók futtatásához.</span><span class="sxs-lookup"><span data-stu-id="d154f-148">That way, the build system just needs to be able to run the containers.</span></span>

- <span data-ttu-id="d154f-149">**Integráció és a load testing**.</span><span class="sxs-lookup"><span data-stu-id="d154f-149">**Integration and load testing**.</span></span> <span data-ttu-id="d154f-150">Csapatok számára a saját tempójában frissítéseket ad ki ez kihívást jelenthet robusztus – teljes körű tesztelés, különösen ha szolgáltatások függőségekkel rendelkezik más szolgáltatások tervezéséhez.</span><span class="sxs-lookup"><span data-stu-id="d154f-150">With teams releasing updates at their own pace, it can be challenging to design robust end-to-end testing, especially when services have dependencies on other services.</span></span> <span data-ttu-id="d154f-151">Ezen felül egy teljes éles fürtöt futtat költséges lehet, ezért nem valószínű, hogy minden egyes csapat a saját teljes fürtöt fog futni éles skálázását követve rugalmasan méretezhető, csak teszteléshez.</span><span class="sxs-lookup"><span data-stu-id="d154f-151">Moreover, running a full production cluster can be expensive, so it's unlikely that every team will run its own full cluster at production scales, just for testing.</span></span>

- <span data-ttu-id="d154f-152">**Kiadáskezelés**.</span><span class="sxs-lookup"><span data-stu-id="d154f-152">**Release management**.</span></span> <span data-ttu-id="d154f-153">Minden egyes csapat egy frissítés telepítése éles képesnek kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d154f-153">Every team should be able to deploy an update to production.</span></span> <span data-ttu-id="d154f-154">Ez nem jelenti azt, hogy minden csapattag engedélyekkel rendelkezik-e.</span><span class="sxs-lookup"><span data-stu-id="d154f-154">That doesn't mean that every team member has permissions to do so.</span></span> <span data-ttu-id="d154f-155">Azonban egy központosított Kiadáskezelő szerepkör kellene csökkentheti a központi telepítések adatról van szó.</span><span class="sxs-lookup"><span data-stu-id="d154f-155">But having a centralized Release Manager role can reduce the velocity of deployments.</span></span>

    <span data-ttu-id="d154f-156">**Kockázatcsökkentési**: A további, hogy a CI/CD-folyamat automatikus, és megbízható, a kevésbé ott kell lennie egy központi hatóság szüksége.</span><span class="sxs-lookup"><span data-stu-id="d154f-156">**Mitigation**: The more that your CI/CD process is automated and reliable, the less there should be a need for a central authority.</span></span> <span data-ttu-id="d154f-157">Ugyanakkor előfordulhat, hogy kisebb hibajavítások és a főbb funkciókat frissítések kiadása különböző házirendeket.</span><span class="sxs-lookup"><span data-stu-id="d154f-157">That said, you might have different policies for releasing major feature updates versus minor bug fixes.</span></span> <span data-ttu-id="d154f-158">Folyamatban decentralizált nulla cégirányítási nem jelenti azt.</span><span class="sxs-lookup"><span data-stu-id="d154f-158">Being decentralized doesn't mean zero governance.</span></span>

- <span data-ttu-id="d154f-159">**Szolgáltatási hírek**.</span><span class="sxs-lookup"><span data-stu-id="d154f-159">**Service updates**.</span></span> <span data-ttu-id="d154f-160">Amikor új verzióra frissít egy szolgáltatás, azt más a tőle függő szolgáltatások nem szünet.</span><span class="sxs-lookup"><span data-stu-id="d154f-160">When you update a service to a new version, it shouldn't break other services that depend on it.</span></span>

    <span data-ttu-id="d154f-161">**Kockázatcsökkentési**: Központi telepítési módszerek, például a kék-zöld vagy canary kiadás használata a nem kompatibilitástörő változások.</span><span class="sxs-lookup"><span data-stu-id="d154f-161">**Mitigation**: Use deployment techniques such as blue-green or canary release for non-breaking changes.</span></span> <span data-ttu-id="d154f-162">Parancsban történt használhatatlanná API-módosítás, párhuzamosan lesz az előző verzió az új verzió telepítése.</span><span class="sxs-lookup"><span data-stu-id="d154f-162">For breaking API changes, deploy the new version side by side with the previous version.</span></span> <span data-ttu-id="d154f-163">Ezzel a módszerrel szolgáltatásokat, amelyek az előző API felhasználására is frissíthetők és az új API tesztelése.</span><span class="sxs-lookup"><span data-stu-id="d154f-163">That way, services that consume the previous API can be updated and tested for the new API.</span></span> <span data-ttu-id="d154f-164">Lásd: [szolgáltatások frissítése](#updating-services), az alábbi.</span><span class="sxs-lookup"><span data-stu-id="d154f-164">See [Updating services](#updating-services), below.</span></span>

## <a name="monorepo-vs-multi-repo"></a><span data-ttu-id="d154f-165">Monorepo vs több adattár</span><span class="sxs-lookup"><span data-stu-id="d154f-165">Monorepo vs multi-repo</span></span>

<span data-ttu-id="d154f-166">Mielőtt létrehozná a CI/CD munkafolyamat, ismernie kell a hogyan kódbázis fog strukturált és felügyelt.</span><span class="sxs-lookup"><span data-stu-id="d154f-166">Before creating a CI/CD workflow, you must know how the code base will be structured and managed.</span></span>

- <span data-ttu-id="d154f-167">Működnek-e a teams, külön tárházakban vagy egy monorepo (egyetlen adattár)?</span><span class="sxs-lookup"><span data-stu-id="d154f-167">Do teams work in separate repositories or in a monorepo (single repository)?</span></span>
- <span data-ttu-id="d154f-168">Mi az az elágazási stratégia?</span><span class="sxs-lookup"><span data-stu-id="d154f-168">What is your branching strategy?</span></span>
- <span data-ttu-id="d154f-169">Akik beküldéssel telepíthet az éles környezetbe?</span><span class="sxs-lookup"><span data-stu-id="d154f-169">Who can push code to production?</span></span> <span data-ttu-id="d154f-170">Egy kiadási szerepkör van?</span><span class="sxs-lookup"><span data-stu-id="d154f-170">Is there a release manager role?</span></span>

<span data-ttu-id="d154f-171">A monorepo megközelítés hozd hónappal számolunk, de vannak előnyei és hátrányai is.</span><span class="sxs-lookup"><span data-stu-id="d154f-171">The monorepo approach has been gaining favor but there are advantages and disadvantages to both.</span></span>

| &nbsp; | <span data-ttu-id="d154f-172">Monorepo</span><span class="sxs-lookup"><span data-stu-id="d154f-172">Monorepo</span></span> | <span data-ttu-id="d154f-173">Több adattárakkal</span><span class="sxs-lookup"><span data-stu-id="d154f-173">Multiple repos</span></span> |
|--------|----------|----------------|
| <span data-ttu-id="d154f-174">**Előnyök**</span><span class="sxs-lookup"><span data-stu-id="d154f-174">**Advantages**</span></span> | <span data-ttu-id="d154f-175">Kód megosztása</span><span class="sxs-lookup"><span data-stu-id="d154f-175">Code sharing</span></span><br/><span data-ttu-id="d154f-176">Könnyebben szabványosíthatja a kódot, és azokat az eszközöket</span><span class="sxs-lookup"><span data-stu-id="d154f-176">Easier to standardize code and tooling</span></span><br/><span data-ttu-id="d154f-177">Könnyebben újrabontása kód</span><span class="sxs-lookup"><span data-stu-id="d154f-177">Easier to refactor code</span></span><br/><span data-ttu-id="d154f-178">Könnyebben – a szabályzat egyetlen nézetben</span><span class="sxs-lookup"><span data-stu-id="d154f-178">Discoverability - single view of the code</span></span><br/> | <span data-ttu-id="d154f-179">Egyértelmű tulajdonjog csapatonként</span><span class="sxs-lookup"><span data-stu-id="d154f-179">Clear ownership per team</span></span><br/><span data-ttu-id="d154f-180">Potenciálisan kevesebb ütközések egyesítése</span><span class="sxs-lookup"><span data-stu-id="d154f-180">Potentially fewer merge conflicts</span></span><br/><span data-ttu-id="d154f-181">Elválasztás álló kényszerítése segít</span><span class="sxs-lookup"><span data-stu-id="d154f-181">Helps to enforce decoupling of microservices</span></span> |
| <span data-ttu-id="d154f-182">**Problémák**</span><span class="sxs-lookup"><span data-stu-id="d154f-182">**Challenges**</span></span> | <span data-ttu-id="d154f-183">Megosztott programkód módosítása hatással lehet a több mikroszolgáltatások</span><span class="sxs-lookup"><span data-stu-id="d154f-183">Changes to shared code can affect multiple microservices</span></span><br/><span data-ttu-id="d154f-184">Az egyesítési ütközések nagyobb lehetőségeit</span><span class="sxs-lookup"><span data-stu-id="d154f-184">Greater potential for merge conflicts</span></span><br/><span data-ttu-id="d154f-185">Azokat az eszközöket kell méretezhető, nagy méretű kódbázis</span><span class="sxs-lookup"><span data-stu-id="d154f-185">Tooling must scale to a large code base</span></span><br/><span data-ttu-id="d154f-186">Hozzáférés-vezérlés</span><span class="sxs-lookup"><span data-stu-id="d154f-186">Access control</span></span><br/><span data-ttu-id="d154f-187">Összetettebb telepítési folyamat</span><span class="sxs-lookup"><span data-stu-id="d154f-187">More complex deployment process</span></span> | <span data-ttu-id="d154f-188">Nehezebb lehet megosztani a kódot</span><span class="sxs-lookup"><span data-stu-id="d154f-188">Harder to share code</span></span><br/><span data-ttu-id="d154f-189">Nehezebb kódolási szabványok kikényszerítésére</span><span class="sxs-lookup"><span data-stu-id="d154f-189">Harder to enforce coding standards</span></span><br/><span data-ttu-id="d154f-190">Függőségkezelés</span><span class="sxs-lookup"><span data-stu-id="d154f-190">Dependency management</span></span><br/><span data-ttu-id="d154f-191">Kód alap, a gyenge felderíthetőség szórt</span><span class="sxs-lookup"><span data-stu-id="d154f-191">Diffuse code base, poor discoverability</span></span><br/><span data-ttu-id="d154f-192">Megosztott infrastruktúra hiánya</span><span class="sxs-lookup"><span data-stu-id="d154f-192">Lack of shared infrastructure</span></span>

## <a name="updating-services"></a><span data-ttu-id="d154f-193">Szolgáltatás frissítése</span><span class="sxs-lookup"><span data-stu-id="d154f-193">Updating services</span></span>

<span data-ttu-id="d154f-194">Számos különféle stratégiát, amely már éles környezetben a szolgáltatás frissítése.</span><span class="sxs-lookup"><span data-stu-id="d154f-194">There are various strategies for updating a service that's already in production.</span></span> <span data-ttu-id="d154f-195">Itt három általános beállítások tárgyaljuk: A működés közbeni frissítés, a kék-zöld üzembe helyezés és a canary kiadás.</span><span class="sxs-lookup"><span data-stu-id="d154f-195">Here we discuss three common options: Rolling update, blue-green deployment, and canary release.</span></span>

### <a name="rolling-updates"></a><span data-ttu-id="d154f-196">A működés közbeni frissítés</span><span class="sxs-lookup"><span data-stu-id="d154f-196">Rolling updates</span></span>

<span data-ttu-id="d154f-197">A működés közbeni frissítés a szolgáltatás új példányok üzembe helyezésekor, és az új példányok, indítsa el azonnal a kérelmek fogadására.</span><span class="sxs-lookup"><span data-stu-id="d154f-197">In a rolling update, you deploy new instances of a service, and the new instances start receiving requests right away.</span></span> <span data-ttu-id="d154f-198">Az új példányok merülnek fel, mint az előző példányok törlődnek.</span><span class="sxs-lookup"><span data-stu-id="d154f-198">As the new instances come up, the previous instances are removed.</span></span>

<span data-ttu-id="d154f-199">**Példa:**</span><span class="sxs-lookup"><span data-stu-id="d154f-199">**Example.**</span></span> <span data-ttu-id="d154f-200">Kubernetes, a működés közbeni frissítések alapértelmezés szerint akkor, ha frissíti a pod specifikációja üzembe helyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="d154f-200">In Kubernetes, rolling updates are the default behavior when you update the pod spec for a Deployment.</span></span> <span data-ttu-id="d154f-201">A központi telepítési vezérlő hoz létre egy új ReplicaSet a frissített podok számára.</span><span class="sxs-lookup"><span data-stu-id="d154f-201">The Deployment controller creates a new ReplicaSet for the updated pods.</span></span> <span data-ttu-id="d154f-202">Ezután a méretezés során az új ReplicaSet vertikális leskálázást a régit, a kívánt replikáinak száma fenntartása közben.</span><span class="sxs-lookup"><span data-stu-id="d154f-202">Then it scales up the new ReplicaSet while scaling down the old one, to maintain the desired replica count.</span></span> <span data-ttu-id="d154f-203">Régi podok azzal nem törli, amíg készen áll az újakat.</span><span class="sxs-lookup"><span data-stu-id="d154f-203">It doesn't delete old pods until the new ones are ready.</span></span> <span data-ttu-id="d154f-204">Kubernetes előzményeket a frissítést, így állíthat vissza egy frissítést szükség esetén.</span><span class="sxs-lookup"><span data-stu-id="d154f-204">Kubernetes keeps a history of the update, so you can roll back an update if needed.</span></span>

<span data-ttu-id="d154f-205">Egy igazi kihívást a működés közbeni frissítés, hogy a frissítési folyamat alatt vegyesen a régi és új verziókat futtató és forgalmat fogadó.</span><span class="sxs-lookup"><span data-stu-id="d154f-205">One challenge of rolling updates is that during the update process, a mix of old and new versions are running and receiving traffic.</span></span> <span data-ttu-id="d154f-206">Ebben az időszakban bármilyen kérést sikerült irányítva a két verzió valamelyikéhez.</span><span class="sxs-lookup"><span data-stu-id="d154f-206">During this period, any request could get routed to either of the two versions.</span></span>

<span data-ttu-id="d154f-207">Kompatibilitástörő API-módosítás, bevált gyakorlat, hogy mindkét verziót egymás mellett támogatja, mindaddig, amíg az előző változat összes ügyfelei már frissítettek.</span><span class="sxs-lookup"><span data-stu-id="d154f-207">For breaking API changes, a good practice is to support both versions side by side, until all clients of the previous version are updated.</span></span> <span data-ttu-id="d154f-208">Lásd: [API-k verziókezelése](./design/api-design.md#api-versioning).</span><span class="sxs-lookup"><span data-stu-id="d154f-208">See [API versioning](./design/api-design.md#api-versioning).</span></span>

### <a name="blue-green-deployment"></a><span data-ttu-id="d154f-209">Kék-zöld üzembe helyezés</span><span class="sxs-lookup"><span data-stu-id="d154f-209">Blue-green deployment</span></span>

<span data-ttu-id="d154f-210">A kék-zöld üzembe helyezés helyezi üzembe az új verziót az előző verzió mellett.</span><span class="sxs-lookup"><span data-stu-id="d154f-210">In a blue-green deployment, you deploy the new version alongside the previous version.</span></span> <span data-ttu-id="d154f-211">Ellenőrizze, hogy az új verziót, akkor váltson egyszerre az előző verzióhoz képest az új verzió minden forgalmat.</span><span class="sxs-lookup"><span data-stu-id="d154f-211">After you validate the new version, you switch all traffic at once from the previous version to the new version.</span></span> <span data-ttu-id="d154f-212">A váltás után az alkalmazás kapcsolatos problémákat figyeli.</span><span class="sxs-lookup"><span data-stu-id="d154f-212">After the switch, you monitor the application for any problems.</span></span> <span data-ttu-id="d154f-213">Ha hiba lép fel, kicserélheti az a korábbi verzióra.</span><span class="sxs-lookup"><span data-stu-id="d154f-213">If something goes wrong, you can swap back to the old version.</span></span> <span data-ttu-id="d154f-214">Ha nem talált nincs probléma, törölheti a régi verzióját.</span><span class="sxs-lookup"><span data-stu-id="d154f-214">Assuming there are no problems, you can delete the old version.</span></span>

<span data-ttu-id="d154f-215">Egy hagyományos monolitikus vagy N szintű alkalmazáshoz a kék-zöld üzembe helyezés általában kizárólag két azonos környezet kiépítése.</span><span class="sxs-lookup"><span data-stu-id="d154f-215">With a more traditional monolithic or N-tier application, blue-green deployment generally meant provisioning two identical environments.</span></span> <span data-ttu-id="d154f-216">Szeretné az új verzió üzembe helyezése átmeneti környezetben, akkor az átmeneti ügyfél forgalom átirányítása &mdash; például virtuális IP-CÍMEK felcserélésével címek.</span><span class="sxs-lookup"><span data-stu-id="d154f-216">You would deploy the new version to a staging environment, then redirect client traffic to the staging environment &mdash; for example, by swapping VIP addresses.</span></span> <span data-ttu-id="d154f-217">A mikroszolgáltatási architektúrákban frissítések fordulhat elő, a mikroszolgáltatás-szintjén, így általában szeretné ugyanabban a környezetben helyezze üzembe a frissítést, és felcserélni service discovery mechanizmus használata.</span><span class="sxs-lookup"><span data-stu-id="d154f-217">In a microservices architecture, updates happen at the microservice level, so you would typically deploy the update into the same environment and use a service discovery mechanism to swap.</span></span>

<span data-ttu-id="d154f-218">**Példa**.</span><span class="sxs-lookup"><span data-stu-id="d154f-218">**Example**.</span></span> <span data-ttu-id="d154f-219">A Kubernetes nem kell tennie a kék-zöld üzembe önálló fürt üzembe helyezése.</span><span class="sxs-lookup"><span data-stu-id="d154f-219">In Kubernetes, you don't need to provision a separate cluster to do blue-green deployments.</span></span> <span data-ttu-id="d154f-220">Ehelyett kihasználhatja a választók.</span><span class="sxs-lookup"><span data-stu-id="d154f-220">Instead, you can take advantage of selectors.</span></span> <span data-ttu-id="d154f-221">Hozzon létre egy új központi telepítési erőforrás egy új pod specifikációja és címkék külön készletét.</span><span class="sxs-lookup"><span data-stu-id="d154f-221">Create a new Deployment resource with a new pod spec and a different set of labels.</span></span> <span data-ttu-id="d154f-222">Hozza létre a központi telepítés nélkül a korábbi központi telepítés törlését vagy módosítását a szolgáltatás, amely azt mutat.</span><span class="sxs-lookup"><span data-stu-id="d154f-222">Create this deployment, without deleting the previous deployment or modifying the service that points to it.</span></span> <span data-ttu-id="d154f-223">Miután az új podok is futnak, frissítheti a szolgáltatás választóra felel meg az új központi telepítés.</span><span class="sxs-lookup"><span data-stu-id="d154f-223">Once the new pods are running, you can update the service's selector to match the new deployment.</span></span>

<span data-ttu-id="d154f-224">Egy kék-zöld üzembe helyezés hátránya, hogy a frissítés során futtatja kétszer, számos podok a szolgáltatáshoz (az aktuális és a következő).</span><span class="sxs-lookup"><span data-stu-id="d154f-224">One drawback of blue-green deployment is that during the update, you are running twice as many pods for the service (current and next).</span></span> <span data-ttu-id="d154f-225">Ha a podok sok CPU és memória-erőforrások, szükség lehet horizontális felskálázása a fürt ideiglenesen az erőforrás-használat kezelésére.</span><span class="sxs-lookup"><span data-stu-id="d154f-225">If the pods require a lot of CPU or memory resources, you may need to scale out the cluster temporarily to handle the resource consumption.</span></span>

### <a name="canary-release"></a><span data-ttu-id="d154f-226">Canary kiadás</span><span class="sxs-lookup"><span data-stu-id="d154f-226">Canary release</span></span>

<span data-ttu-id="d154f-227">Canary kiadás, a bevezetés során fokozatosan egy frissített verziót egy kis mennyiségű ügyfelet.</span><span class="sxs-lookup"><span data-stu-id="d154f-227">In a canary release, you roll out an updated version to a small number of clients.</span></span> <span data-ttu-id="d154f-228">Az új service viselkedését majd mielőtt megvalósítaná minden ügyfélnek figyeli.</span><span class="sxs-lookup"><span data-stu-id="d154f-228">Then you monitor the behavior of the new service before rolling it out to all clients.</span></span> <span data-ttu-id="d154f-229">Ez lehetővé teszi egy lassú bevezetés, mégpedig szabályozott módon tegye, tekintse át az adatokon, és helyszíni problémák előtt az összes érintett felhasználókat.</span><span class="sxs-lookup"><span data-stu-id="d154f-229">This lets you do a slow rollout in a controlled fashion, observe real data, and spot problems before all customers are affected.</span></span>

<span data-ttu-id="d154f-230">Canary kiadás meg kell dinamikusan irányíthatja a kérelmeket a szolgáltatás különböző verzióit azért bonyolultabb, mint kék-zöld vagy a működés közbeni frissítés kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="d154f-230">A canary release is more complex to manage than either blue-green or rolling update, because you must dynamically route requests to different versions of the service.</span></span>

<span data-ttu-id="d154f-231">**Példa**.</span><span class="sxs-lookup"><span data-stu-id="d154f-231">**Example**.</span></span> <span data-ttu-id="d154f-232">A Kubernetes konfigurálhatja egy szolgáltatás span két replikakészletekhez (egy minden verzió esetében) és a replika számát manuálisan módosíthatja.</span><span class="sxs-lookup"><span data-stu-id="d154f-232">In Kubernetes, you can configure a Service to span two replica sets (one for each version) and adjust the replica counts manually.</span></span> <span data-ttu-id="d154f-233">Azonban ez a megközelítés inkább coarse-grained, Kubernetes betöltése módja miatt elosztja a podok között.</span><span class="sxs-lookup"><span data-stu-id="d154f-233">However, this approach is rather coarse-grained, because of the way Kubernetes load balances across pods.</span></span> <span data-ttu-id="d154f-234">Például ha 10 replika összesen, akkor is csak áthelyezni a forgalmat 10 %-os lépésekben.</span><span class="sxs-lookup"><span data-stu-id="d154f-234">For example, if you have a total of 10 replicas, you can only shift traffic in 10% increments.</span></span> <span data-ttu-id="d154f-235">Egy szolgáltatás háló használja, ha a szolgáltatás háló útválasztási szabályok segítségével canary kiadás ennél kifinomultabb stratégiát megvalósítása.</span><span class="sxs-lookup"><span data-stu-id="d154f-235">If you are using a service mesh, you can use the service mesh routing rules to implement a more sophisticated canary release strategy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d154f-236">További lépések</span><span class="sxs-lookup"><span data-stu-id="d154f-236">Next steps</span></span>

<span data-ttu-id="d154f-237">Ismerje meg, mikroszolgáltatások, Kubernetes futó adott CI/CD-eljárások.</span><span class="sxs-lookup"><span data-stu-id="d154f-237">Learn specific CI/CD practices for microservices running on Kubernetes.</span></span>

- [<span data-ttu-id="d154f-238">CI/CD-mikroszolgáltatások a kubernetes használatával</span><span class="sxs-lookup"><span data-stu-id="d154f-238">CI/CD for microservices on Kubernetes</span></span>](./ci-cd-kubernetes.md)