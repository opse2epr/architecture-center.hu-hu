---
title: "CI/CD-jét mikroszolgáltatások"
description: "Folyamatos integrációt és mikroszolgáltatások folyamatos szállítási"
author: MikeWasson
ms.date: 12/08/2017
ms.openlocfilehash: 7d8a81b7bc236e50d722a68a0115b9220d4e094f
ms.sourcegitcommit: 786bafefc731245414c3c1510fc21027afe303dc
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 12/12/2017
---
# <a name="designing-microservices-continuous-integration"></a><span data-ttu-id="f8034-103">Mikroszolgáltatások tervezése: folyamatos integrációt</span><span class="sxs-lookup"><span data-stu-id="f8034-103">Designing microservices: Continuous integration</span></span>

<span data-ttu-id="f8034-104">Folyamatos integrációt és folyamatos kézbesítési (CI/CD) a kulcsfontosságú követelmény az mikroszolgáltatások sikeres megvalósításához.</span><span class="sxs-lookup"><span data-stu-id="f8034-104">Continuous integration and continuous delivery (CI/CD) are a key requirement for achieving success with microservices.</span></span> <span data-ttu-id="f8034-105">Egy jó CI/CD folyamat nélkül, nem érhető el a agilitást, amely mikroszolgáltatások készletéről.</span><span class="sxs-lookup"><span data-stu-id="f8034-105">Without a good CI/CD process, you will not achieve the agility that microservices promise.</span></span> <span data-ttu-id="f8034-106">A CI/CD kapcsolatban felmerülő kihívások mikroszolgáltatások némelyike erednek több kódbázis és a különböző szolgáltatásokat a heterogén buildkörnyezeteket.</span><span class="sxs-lookup"><span data-stu-id="f8034-106">Some of the CI/CD challenges for microservices arise from having multiple code bases and heterogenous build environments for the various services.</span></span> <span data-ttu-id="f8034-107">Ez a fejezet ismerteti, a kihívás, és azt javasolja, hogy az egyes módszerek a problémára.</span><span class="sxs-lookup"><span data-stu-id="f8034-107">This chapter describes the challenges and recommends some approaches to the problem.</span></span>

![](./images/ci-cd.png)

<span data-ttu-id="f8034-108">Gyorsabb kiadás ciklusok a legnagyobb okai a mikroszolgáltatások architektúra elfogadására.</span><span class="sxs-lookup"><span data-stu-id="f8034-108">Faster release cycles are one of the biggest reasons to adopt a microservices architecture.</span></span> 

<span data-ttu-id="f8034-109">Egy tisztán egységes alkalmazásban nincs kimenete az alkalmazás futtatható fájlját egy összeállítási folyamat.</span><span class="sxs-lookup"><span data-stu-id="f8034-109">In a purely monolithic application, there is a single build pipeline whose output is the application executable.</span></span> <span data-ttu-id="f8034-110">Minden fejlesztési munkahelyi hírcsatornák be ez az adatcsatorna esetén.</span><span class="sxs-lookup"><span data-stu-id="f8034-110">All development work feeds into this pipeline.</span></span> <span data-ttu-id="f8034-111">Egy magas prioritású hiba található, ha egy javítást kell lehet integrált, tesztelni, és közzé, amely késleltetheti-e a kiadás az új funkciók.</span><span class="sxs-lookup"><span data-stu-id="f8034-111">If a high-priority bug is found, a fix must be integrated, tested, and published, which can delay the release of new features.</span></span> <span data-ttu-id="f8034-112">IGAZ, hogy ezek a problémák csökkentheti jól faktorált modulokat, és használja a szolgáltatás ágak kódmódosításokat hatás minimalizálása érdekében.</span><span class="sxs-lookup"><span data-stu-id="f8034-112">It's true that you can mitigate these problems by having well-factored modules and using feature branches to minimize the impact of code changes.</span></span> <span data-ttu-id="f8034-113">De, ha az alkalmazás növekszik összetettebb, és további szolgáltatások lesznek hozzáadva, egy monolit kiadás folyamatát jobban rideg, és valószínűleg törés válnak.</span><span class="sxs-lookup"><span data-stu-id="f8034-113">But as the application grows more complex, and more features are added, the release process for a monolith tends to become more brittle and likely to break.</span></span> 

<span data-ttu-id="f8034-114">Következő mikroszolgáltatások alapvetően soha nem kell egy hosszú kiadás vonat, ahol minden csoport rendelkezik sorában lekérdezni.</span><span class="sxs-lookup"><span data-stu-id="f8034-114">Following the microservices philosophy, there should never be a long release train where every team has to get in line.</span></span> <span data-ttu-id="f8034-115">A szolgáltatás "A" módosítások szolgáltatásban való egyesíthetők, "B" várakozás nélkül is megjelenhetnek egy frissítés bármikor, épülő csapat tesztelése és telepítése.</span><span class="sxs-lookup"><span data-stu-id="f8034-115">The team that builds service "A" can release an update at any time, without waiting for changes in service "B" to be merged, tested, and deployed.</span></span> <span data-ttu-id="f8034-116">A CI/CD folyamat fontos, hogy ez lehetséges.</span><span class="sxs-lookup"><span data-stu-id="f8034-116">The CI/CD process is critical to making this possible.</span></span> <span data-ttu-id="f8034-117">A kiadási folyamat kell automatizált és nagymértékben megbízható, így frissítéseinek telepítéséhez a kockázata, így a lehető legkisebb.</span><span class="sxs-lookup"><span data-stu-id="f8034-117">Your release pipeline must be automated and highly reliable, so that the risks of deploying updates are minimized.</span></span> <span data-ttu-id="f8034-118">Ha naponta vagy naponta több alkalommal felszabadítása vannak üzemi környezetben, regresszió vagy szolgáltatás zavarokat nagyon ritkán fordul elő kell lennie.</span><span class="sxs-lookup"><span data-stu-id="f8034-118">If you are releasing to production daily or multiple times a day, regressions or service disruptions must be very rare.</span></span> <span data-ttu-id="f8034-119">Egy időben Ha egy hibás frissítés telepítve, rendelkeznie kell gyorsan állíthatja vissza, illetve egy korábbi verzióját a szolgáltatás előregörgetéseket megbízható módot.</span><span class="sxs-lookup"><span data-stu-id="f8034-119">At the same time, if a bad update does get deployed, you must have a reliable way to quickly roll back or roll forward to a previous version of a service.</span></span>

![](./images/cicd-monolith.png)

<span data-ttu-id="f8034-120">Ha a döntésről bővebben CI/CD, azt vannak valóban van szó több kapcsolódó folyamatokhoz: folyamatos integrációt, a folyamatos és a folyamatos üzembe helyezést.</span><span class="sxs-lookup"><span data-stu-id="f8034-120">When we talk about CI/CD, we are really talking about several related processes: Continuous integration, continuous delivery, and continuous deployment.</span></span>

- <span data-ttu-id="f8034-121">Folyamatos integrációt azt jelenti, hogy kódmódosításokat gyakran egyesülnek a főágba automatizált build használatával győződjön meg arról, hogy a főágba kód mindig kiváló minőségben folyamatok tesztelése.</span><span class="sxs-lookup"><span data-stu-id="f8034-121">Continuous integration means that code changes are frequently merged into the main branch, using automated build and test processes to ensure that  code in the main branch is always production-quality.</span></span>

- <span data-ttu-id="f8034-122">Folyamatos kézbesítési azt jelenti, hogy a kód módosítására, amelyek megfelelnek a CI-folyamat automatikusan közzétett hasonló környezethez.</span><span class="sxs-lookup"><span data-stu-id="f8034-122">Continuous delivery means that code changes that pass the CI process are automatically published to a production-like environment.</span></span> <span data-ttu-id="f8034-123">Az éles környezetbe telepítés manuális jóváhagyásra lehet szükség, de egyébként automatikus.</span><span class="sxs-lookup"><span data-stu-id="f8034-123">Deployment into the live production environment may require manual approval, but is otherwise automated.</span></span> <span data-ttu-id="f8034-124">A célja, hogy a kód mindig legyen *készen* való telepítése éles környezetben.</span><span class="sxs-lookup"><span data-stu-id="f8034-124">The goal is that your code should always be *ready* to deploy into production.</span></span>

- <span data-ttu-id="f8034-125">Folyamatos üzembe helyezés, az azt jelenti, hogy a kód módosítására, amelyek megfelelnek a CI/CD folyamat automatikusan telepítve éles környezetben.</span><span class="sxs-lookup"><span data-stu-id="f8034-125">Continuous deployment means that code changes that pass the CI/CD process are automatically deployed into production.</span></span>

<span data-ttu-id="f8034-126">Kontextusában Kubernetes és mikroszolgáltatások létrehozására a CI szakasz aggasztanak létrehozása és tesztelése tároló képek és kérdez le ezeket a képeket tároló beállításjegyzékbeli, hogy.</span><span class="sxs-lookup"><span data-stu-id="f8034-126">In the context of Kubernetes and microservices, the CI stage is concerned with building and testing container images, and pushing those images to a container registry.</span></span> <span data-ttu-id="f8034-127">A telepítési fázisban pod specifikációk frissítése a legújabb éles kép átvételéhez.</span><span class="sxs-lookup"><span data-stu-id="f8034-127">In the deployment stage, pod specs are updated to pick up the latest production image.</span></span>

## <a name="challenges"></a><span data-ttu-id="f8034-128">Kihívásai</span><span class="sxs-lookup"><span data-stu-id="f8034-128">Challenges</span></span>

- <span data-ttu-id="f8034-129">**Sok kisméretű független kódbázis**.</span><span class="sxs-lookup"><span data-stu-id="f8034-129">**Many small independent code bases**.</span></span> <span data-ttu-id="f8034-130">Minden team saját szolgáltatása, és a saját build összeállításáért felelős.</span><span class="sxs-lookup"><span data-stu-id="f8034-130">Each team is responsible for building its own service, with its own build pipeline.</span></span> <span data-ttu-id="f8034-131">Egyes szervezeteknél csoportokat használhat külön adattárakban.</span><span class="sxs-lookup"><span data-stu-id="f8034-131">In some organizations, teams may use separate code repositories.</span></span> <span data-ttu-id="f8034-132">Ez a helyzet, ahol csoportok között megoszlik hogyan hozhat létre a rendszer ismerete, és a szervezet senki sem tudja, hogy a teljes alkalmazás központi telepítéséről vezethet.</span><span class="sxs-lookup"><span data-stu-id="f8034-132">This could lead to a situation where the knowledge of how to build the system is spread across teams, and nobody in the organization knows how to deploy the entire application.</span></span> <span data-ttu-id="f8034-133">Például mi történik, a vész-helyreállítási forgatókönyv, ha szeretné gyorsan üzembe helyezhet egy új fürtre?</span><span class="sxs-lookup"><span data-stu-id="f8034-133">For example, what happens in a disaster recovery scenario, if you need to quickly deploy to a new cluster?</span></span>   

- <span data-ttu-id="f8034-134">**Több nyelv és keretrendszer**.</span><span class="sxs-lookup"><span data-stu-id="f8034-134">**Multiple languages and frameworks**.</span></span> <span data-ttu-id="f8034-135">Minden egyes csapattal, a saját vegyesen technológiák használatával nehézkes lehet, amely a teljes szervezetben egyetlen build folyamatot létrehozni.</span><span class="sxs-lookup"><span data-stu-id="f8034-135">With each team using its own mix of technologies, it can be difficult to create a single build process that works across the organization.</span></span> <span data-ttu-id="f8034-136">A létrehozási folyamat kellően rugalmas ahhoz, hogy minden team módosíthatja azt a nyelvet vagy keretrendszert az általuk választott kell lennie.</span><span class="sxs-lookup"><span data-stu-id="f8034-136">The build process must be flexible enough that every team can adapt it for their choice of language or framework.</span></span> 

- <span data-ttu-id="f8034-137">**Integráció és a betöltés tesztelés**.</span><span class="sxs-lookup"><span data-stu-id="f8034-137">**Integration and load testing**.</span></span> <span data-ttu-id="f8034-138">A saját tempójában frissítések felszabadítása csapatok azt kihívást jelenthet robusztus-végpontok tesztelése, különösen ha szolgáltatások függőségi viszonyban vannak más szolgáltatások tervezéséhez.</span><span class="sxs-lookup"><span data-stu-id="f8034-138">With teams releasing updates at their own pace, it can be challenging to design robust end-to-end testing, especially when services have dependencies on other services.</span></span> <span data-ttu-id="f8034-139">Ezenkívül egy teljes éles fürt futtató lehet költséges, így nem valószínű, hogy minden team fogja tudni futtatni a saját teljes fürt éles méretezik csak teszteléshez.</span><span class="sxs-lookup"><span data-stu-id="f8034-139">Moreover, running a full production cluster can be expensive, so it's unlikely that every team will be able to run its own full cluster at production scales, just for testing.</span></span> 

- <span data-ttu-id="f8034-140">**Kiadáskezelés**.</span><span class="sxs-lookup"><span data-stu-id="f8034-140">**Release management**.</span></span> <span data-ttu-id="f8034-141">Minden csoport lehetővé teszi egy frissítés telepítését üzemi környezetben kell rendelkeznie.</span><span class="sxs-lookup"><span data-stu-id="f8034-141">Every team should have the ability to deploy an update to production.</span></span> <span data-ttu-id="f8034-142">Ez nem jelenti azt, hogy minden csapattag ehhez engedélyekkel rendelkezik-e.</span><span class="sxs-lookup"><span data-stu-id="f8034-142">That doesn't mean that every team member has permissions to do so.</span></span> <span data-ttu-id="f8034-143">Azonban rendelkezik egy központosított Kiadáskezelő szerepkör csökkentheti a sebesség, a központi telepítések.</span><span class="sxs-lookup"><span data-stu-id="f8034-143">But having a centralized Release Manager role can reduce the velocity of deployments.</span></span> <span data-ttu-id="f8034-144">A további, hogy a CI/CD folyamat automatikus, és megbízható, kevesebb e kell lennie egy központi hatóság szükség.</span><span class="sxs-lookup"><span data-stu-id="f8034-144">The more that your CI/CD process is automated and reliable, the less there should be a need for a central authority.</span></span> <span data-ttu-id="f8034-145">Említett, előfordulhat, hogy eltérő házirendek a fő funkció frissítések kisebb hibák javításával és felszabadítása.</span><span class="sxs-lookup"><span data-stu-id="f8034-145">That said, you might have different policies for releasing major feature updates versus minor bug fixes.</span></span> <span data-ttu-id="f8034-146">Decentralizált alatt nem jelenti azt nulla irányítás kell lennie.</span><span class="sxs-lookup"><span data-stu-id="f8034-146">Being decentralized does not mean there should be zero governance.</span></span>

- <span data-ttu-id="f8034-147">**Tároló kép versioning**.</span><span class="sxs-lookup"><span data-stu-id="f8034-147">**Container image versioning**.</span></span> <span data-ttu-id="f8034-148">A fejlesztési és tesztelési ciklus során a CI/CD folyamat sok tároló lemezképet fog létrehozni.</span><span class="sxs-lookup"><span data-stu-id="f8034-148">During the development and test cycle, the CI/CD process will build many container images.</span></span> <span data-ttu-id="f8034-149">Csak a kiadásban a zel olyanokat is, majd közül csak az adott kiadás jelöltek fogja lekérni leküldött éles környezetben.</span><span class="sxs-lookup"><span data-stu-id="f8034-149">Only some of those are candidates for release, and then only some of those release candidates will get pushed into production.</span></span> <span data-ttu-id="f8034-150">Törölje a jelet versioning stratégiát, megállapításához, hogy mely képek üzemi jelenleg telepítve vannak, és vissza lehet vonni egy korábbi verzióját szükség kell.</span><span class="sxs-lookup"><span data-stu-id="f8034-150">You should have a clear versioning strategy, so that you know which images are currently deployed to production, and can roll back to a previous version if necessary.</span></span> 

- <span data-ttu-id="f8034-151">**Frissítheti a szolgáltatást**.</span><span class="sxs-lookup"><span data-stu-id="f8034-151">**Service updates**.</span></span> <span data-ttu-id="f8034-152">Amikor új verzióra frissít egy szolgáltatás, azt nem szabad törés attól függő más szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="f8034-152">When you update a service to a new version, it shouldn't break other services that depend on it.</span></span> <span data-ttu-id="f8034-153">Ha így tesz, a működés közbeni frissítés, egy adott időn belül verzióit vegyesen futtatásakor lesz.</span><span class="sxs-lookup"><span data-stu-id="f8034-153">If you do a rolling update, there will be a period of time when a mix of versions is running.</span></span> 
 
<span data-ttu-id="f8034-154">Ezek a kihívások alapvető feszültség tükrözik.</span><span class="sxs-lookup"><span data-stu-id="f8034-154">These challenges reflect a fundamental tension.</span></span> <span data-ttu-id="f8034-155">Másrészről szükséges működjön, a lehető függetlenül.</span><span class="sxs-lookup"><span data-stu-id="f8034-155">On the one hand, teams need to work as independently as possible.</span></span> <span data-ttu-id="f8034-156">Néhány koordinációs, másrészt van szükség, hogy egy személy teheti a feladatokat, például az integráció a teszt, az új fürtön a teljes megoldás újbóli vagy rossz frissítés visszaállítása.</span><span class="sxs-lookup"><span data-stu-id="f8034-156">On the other hand, some coordination is needed so that a single person can do tasks like running an integration test, redeploying the entire solution to a new cluster, or rolling back a bad update.</span></span> 
 
## <a name="cicd-approaches-for-microservices"></a><span data-ttu-id="f8034-157">CI/CD megközelítés használatos mikroszolgáltatások</span><span class="sxs-lookup"><span data-stu-id="f8034-157">CI/CD approaches for microservices</span></span>

<span data-ttu-id="f8034-158">Ajánlott minden szolgáltatás-csoport containerize azok összeállító környezetet.</span><span class="sxs-lookup"><span data-stu-id="f8034-158">It's a good practice for every service team to containerize their build environment.</span></span> <span data-ttu-id="f8034-159">Ebben a tárolóban kell rendelkeznie az összes build eszköz a kód összetevők, a szolgáltatás létrehozásához szükséges.</span><span class="sxs-lookup"><span data-stu-id="f8034-159">This container should have all of the build tools necessary to build the code artifacts for their service.</span></span> <span data-ttu-id="f8034-160">Gyakran a nyelv és keretrendszer hivatalos Docker kép is megtalálhatja.</span><span class="sxs-lookup"><span data-stu-id="f8034-160">Often you can find an official Docker image for your language and framework.</span></span> <span data-ttu-id="f8034-161">Akkor `docker run` vagy a Docker Compose a build futtatásához.</span><span class="sxs-lookup"><span data-stu-id="f8034-161">Then you can use `docker run` or Docker Compose to run the build.</span></span> 

<span data-ttu-id="f8034-162">Ezzel a megközelítéssel nagyon egyszerű, egy új build környezet beállítása.</span><span class="sxs-lookup"><span data-stu-id="f8034-162">With this approach, it's trivial to set up a new build environment.</span></span> <span data-ttu-id="f8034-163">Egy fejlesztő, akinek szeretne készíteni a kód nem kell telepítenie a build eszközöket, de egyszerűen futtatja a tároló kép.</span><span class="sxs-lookup"><span data-stu-id="f8034-163">A developer who wants to build your code doesn't need to install a set of build tools, but simply runs the container image.</span></span> <span data-ttu-id="f8034-164">Lehet, hogy ennél is fontosabb, a build kiszolgáló beállítható úgy, hogy ugyanazt végzi.</span><span class="sxs-lookup"><span data-stu-id="f8034-164">Perhaps more importantly, your build server can be configured to do the same thing.</span></span> <span data-ttu-id="f8034-165">Ezzel a módszerrel nem kell ezekhez az eszközökhöz a build-kiszolgálóra telepítse, vagy eszközök ütköző verzióinak kezelése.</span><span class="sxs-lookup"><span data-stu-id="f8034-165">That way, you don't need to install those tools onto the build server, or manage conflicting versions of tools.</span></span> 

<span data-ttu-id="f8034-166">A helyi fejlesztéshez és teszteléshez használja a Docker belül egy tárolót a szolgáltatás futtatásához.</span><span class="sxs-lookup"><span data-stu-id="f8034-166">For local development and testing, use Docker to run the service inside a container.</span></span> <span data-ttu-id="f8034-167">Ez a folyamat részeként szükség lehet más tárolókat utánzatait szolgáltatások vagy a helyi tesztelés szükséges teszt adatbázisok futtatásához.</span><span class="sxs-lookup"><span data-stu-id="f8034-167">As part of this process, you may need to run other containers that have mock services or test databases needed for local testing.</span></span> <span data-ttu-id="f8034-168">Ezekhez a tárolókhoz koordinálja a Docker Compose használatával, vagy helyileg történő futtatása Kubernetes Minikube segítségével.</span><span class="sxs-lookup"><span data-stu-id="f8034-168">You could use Docker Compose to coordinate these containers, or use Minikube to run Kubernetes locally.</span></span> 

<span data-ttu-id="f8034-169">Amikor készen áll a kód, nyisson meg egy lekérési kérelmet és egyesítési fő be.</span><span class="sxs-lookup"><span data-stu-id="f8034-169">When the code is ready, open a pull request and merge into master.</span></span> <span data-ttu-id="f8034-170">Ez feladatot indít el a build kiszolgálón:</span><span class="sxs-lookup"><span data-stu-id="f8034-170">This will start a job on the build server:</span></span>

1. <span data-ttu-id="f8034-171">A kód eszközök felépítéséhez.</span><span class="sxs-lookup"><span data-stu-id="f8034-171">Build the code assets.</span></span> 
2. <span data-ttu-id="f8034-172">A kód egység tesztek futtatásához.</span><span class="sxs-lookup"><span data-stu-id="f8034-172">Run unit tests against the code.</span></span>
3. <span data-ttu-id="f8034-173">A tároló lemezképet létre.</span><span class="sxs-lookup"><span data-stu-id="f8034-173">Build the container image.</span></span>
4. <span data-ttu-id="f8034-174">Tesztelje a tároló kép működési tesztek futtatása a futó tárolóba.</span><span class="sxs-lookup"><span data-stu-id="f8034-174">Test the container image by running functional tests on a running container.</span></span> <span data-ttu-id="f8034-175">Ez a lépés is tényleges hibákat a Docker-fájlban, például egy hibás belépési ponthoz.</span><span class="sxs-lookup"><span data-stu-id="f8034-175">This step can catch errors in the Docker file, such as a bad entry point.</span></span>
5. <span data-ttu-id="f8034-176">Küldje le a lemezképet tároló beállításjegyzékbeli.</span><span class="sxs-lookup"><span data-stu-id="f8034-176">Push the image to a container registry.</span></span>
6. <span data-ttu-id="f8034-177">A tesztfürthöz frissítése az új lemezkép integrációs tesztek futtatásához.</span><span class="sxs-lookup"><span data-stu-id="f8034-177">Update the test cluster with the new image to run integration tests.</span></span>

<span data-ttu-id="f8034-178">Ha a kép készen éles környezetben, frissítse a telepítési fájlok a legújabb kép, bármely Kubernetes konfigurációs fájlokat adja meg szükség szerint.</span><span class="sxs-lookup"><span data-stu-id="f8034-178">When the image is ready to go into production, update the deployment files as needed to specify the latest image, including any Kubernetes configuration files.</span></span> <span data-ttu-id="f8034-179">Az éles fürt követően telepítse a frissítést.</span><span class="sxs-lookup"><span data-stu-id="f8034-179">Then apply the update to the production cluster.</span></span>

<span data-ttu-id="f8034-180">Az alábbiakban néhány javaslatot adja meg a megfelelő központi telepítések további megbízható:</span><span class="sxs-lookup"><span data-stu-id="f8034-180">Here are some recommendations for making deployments more reliable:</span></span>
 
- <span data-ttu-id="f8034-181">Adja meg a teljes szervezetre kiterjedő egyezmények tároló címkék, versioning és elnevezési szabályai a fürthöz (három munkaállomás-csoporttal, szolgáltatások és így tovább) üzembe helyezett erőforrás.</span><span class="sxs-lookup"><span data-stu-id="f8034-181">Define organization-wide conventions for container tags, versioning, and naming conventions for resources deployed to the cluster (pods, services, and so on).</span></span> <span data-ttu-id="f8034-182">Amely megkönnyítheti a telepítési problémák elemzéséhez.</span><span class="sxs-lookup"><span data-stu-id="f8034-182">That can make it easier to diagnose deployment issues.</span></span> 

- <span data-ttu-id="f8034-183">Hozzon létre két külön nyilvántartó, egy fejlesztési/tesztelési és egy üzemi.</span><span class="sxs-lookup"><span data-stu-id="f8034-183">Create two separate container registries, one for development/testing and one for production.</span></span> <span data-ttu-id="f8034-184">Lemezkép nem leküldéses a termelési beállításjegyzék, amíg készen áll az éles üzembe helyezés.</span><span class="sxs-lookup"><span data-stu-id="f8034-184">Don't push an image to the production registry until you're ready to deploy it into production.</span></span> <span data-ttu-id="f8034-185">Ha ez az eljárás egyesíthető szemantikai versioning tároló képek, csökkentheti az esélyét, hogy véletlenül telepítése egy olyan verzióra, a kiadáshoz nem engedélyezett.</span><span class="sxs-lookup"><span data-stu-id="f8034-185">If you combine this practice with semantic versioning of container images, it can reduce the chance of accidentally deploying a version that wasn't approved for release.</span></span>

## <a name="updating-services"></a><span data-ttu-id="f8034-186">Frissítési szolgáltatások</span><span class="sxs-lookup"><span data-stu-id="f8034-186">Updating services</span></span>

<span data-ttu-id="f8034-187">Nincsenek olyan szolgáltatás, amely már szerepel a termelési frissítési különböző stratégiákat.</span><span class="sxs-lookup"><span data-stu-id="f8034-187">There are various strategies for updating a service that's already in production.</span></span> <span data-ttu-id="f8034-188">Itt három közös beállításokat tárgyaljuk: működés közbeni frissítés, kék, zöld telepítési és Kanári kiadás.</span><span class="sxs-lookup"><span data-stu-id="f8034-188">Here we discuss three common options: Rolling update, blue-green deployment, and canary release.</span></span>

### <a name="rolling-update"></a><span data-ttu-id="f8034-189">Működés közbeni frissítés</span><span class="sxs-lookup"><span data-stu-id="f8034-189">Rolling update</span></span> 

<span data-ttu-id="f8034-190">A működés közbeni frissítés a szolgáltatás új példányának telepítése, és az új példányok megkezdése kérelmek azonnal.</span><span class="sxs-lookup"><span data-stu-id="f8034-190">In a rolling update, you deploy new instances of a service, and the new instances start receiving requests right away.</span></span> <span data-ttu-id="f8034-191">Az új példányok kapja meg, mert a rendszer eltávolítja a korábbi példányok.</span><span class="sxs-lookup"><span data-stu-id="f8034-191">As the new instances come up, the previous instances are removed.</span></span>

<span data-ttu-id="f8034-192">Működés közbeni frissítés esetén Kubernetes az alapértelmezett viselkedés, a központi telepítés pod spec frissítésekor.</span><span class="sxs-lookup"><span data-stu-id="f8034-192">Rolling updates are the default behavior in Kubernetes when you update the pod spec for a Deployment.</span></span> <span data-ttu-id="f8034-193">A központi telepítés tartományvezérlő létrehoz egy új ReplicaSet esetében a frissített három munkaállomás-csoporttal.</span><span class="sxs-lookup"><span data-stu-id="f8034-193">The Deployment controller creates a new ReplicaSet for the updated pods.</span></span> <span data-ttu-id="f8034-194">Majd méretezés során az új ReplicaSet le a régit, a kívánt replikaszám fenntartásához méretezés közben.</span><span class="sxs-lookup"><span data-stu-id="f8034-194">Then it scales up the new ReplicaSet while scaling down the old one, to maintain the desired replica count.</span></span> <span data-ttu-id="f8034-195">Amíg az új címkék készen áll az nem törli a régi három munkaállomás-csoporttal.</span><span class="sxs-lookup"><span data-stu-id="f8034-195">It doesn't delete old pods until the new ones are ready.</span></span> <span data-ttu-id="f8034-196">Kubernetes tartja a frissítési előzményeket, így kubectl használatával állítsa vissza egy frissítés szükség esetén.</span><span class="sxs-lookup"><span data-stu-id="f8034-196">Kubernetes keeps a history of the update, so you can use kubectl to roll back an update if needed.</span></span> 

<span data-ttu-id="f8034-197">Ha a szolgáltatás indítása sok feladat hajt végre, megadhat egy készenléti mintavételt.</span><span class="sxs-lookup"><span data-stu-id="f8034-197">If your service performs a long startup task, you can define a readiness probe.</span></span> <span data-ttu-id="f8034-198">A készenléti mintavételi jelentést készít, megkezdheti a forgalom fogadására a tároló esetén.</span><span class="sxs-lookup"><span data-stu-id="f8034-198">The readiness probe reports when the container is ready to start receiving traffic.</span></span> <span data-ttu-id="f8034-199">Kubernetes nem forgalmat küldeni fogyasztanak, amíg a mintavétel sikeresnek jelzi.</span><span class="sxs-lookup"><span data-stu-id="f8034-199">Kubernetes won't send traffic to the pod until the probe reports success.</span></span> 

<span data-ttu-id="f8034-200">A működés közbeni frissítések az egyik kihívás, hogy a frissítési folyamat alatt vegyesen a régi és új verzióinak futtatását és forgalom fogadására.</span><span class="sxs-lookup"><span data-stu-id="f8034-200">One challenge of rolling updates is that during the update process, a mix of old and new versions are running and receiving traffic.</span></span> <span data-ttu-id="f8034-201">Ebben az időszakban a kérelem sikerült beolvasása irányítja át a két egyikét.</span><span class="sxs-lookup"><span data-stu-id="f8034-201">During this period, any request could get routed to either of the two versions.</span></span> <span data-ttu-id="f8034-202">Előfordulhat, hogy vagy nem problémákhoz vezethet, attól függően, hogy a két verziója közötti különbségek hatókör.</span><span class="sxs-lookup"><span data-stu-id="f8034-202">That may or may not cause problems, depending on the scope of the changes between the two versions.</span></span> 

### <a name="blue-green-deployment"></a><span data-ttu-id="f8034-203">Kék-zöld központi telepítés</span><span class="sxs-lookup"><span data-stu-id="f8034-203">Blue-green deployment</span></span>

<span data-ttu-id="f8034-204">A kék-zöld telepítésében központi telepítése mellett az előző verzió új verziója.</span><span class="sxs-lookup"><span data-stu-id="f8034-204">In a blue-green deployment, you deploy the new version alongside the previous version.</span></span> <span data-ttu-id="f8034-205">Után az új verzió ellenőrzéséhez át kell váltania az új verzió egyszerre korábbi verziójából származó összes forgalmat.</span><span class="sxs-lookup"><span data-stu-id="f8034-205">After you validate the new version, you switch all traffic at once from the previous version to the new version.</span></span> <span data-ttu-id="f8034-206">A kapcsoló után figyelheti az alkalmazást a problémákat.</span><span class="sxs-lookup"><span data-stu-id="f8034-206">After the switch, you monitor the application for any problems.</span></span> <span data-ttu-id="f8034-207">Ha valamilyen hiba, a régi verzióról kicserélheti.</span><span class="sxs-lookup"><span data-stu-id="f8034-207">If something goes wrong, you can swap back to the old version.</span></span> <span data-ttu-id="f8034-208">Ha nem jelez problémákat, törölheti a régi verzióját.</span><span class="sxs-lookup"><span data-stu-id="f8034-208">Assuming there are no problems, you can delete the old version.</span></span>

<span data-ttu-id="f8034-209">Hagyományos egységes vagy N szintű alkalmazással kék, zöld telepítési általában azt jelentette, hogy két azonos környezet kiépítési.</span><span class="sxs-lookup"><span data-stu-id="f8034-209">With a more traditional monolithic or N-tier application, blue-green deployment generally meant provisioning two identical environments.</span></span> <span data-ttu-id="f8034-210">Lenne az új verzió telepítése az átmeneti környezetben való használatra, majd ügyfél forgalmát átirányítja az átmeneti &mdash; például által csere VIP-címek.</span><span class="sxs-lookup"><span data-stu-id="f8034-210">You would deploy the new version to a staging environment, then redirect client traffic to the staging environment &mdash; for example, by swapping VIP addresses.</span></span>

<span data-ttu-id="f8034-211">A Kubernetes nem kell kiépíteni egy külön fürt kék-zöld központi telepítések elvégzéséhez.</span><span class="sxs-lookup"><span data-stu-id="f8034-211">In Kubernetes, you don't need to provision a separate cluster to do blue-green deployments.</span></span> <span data-ttu-id="f8034-212">Ehelyett kihasználhatja a választók.</span><span class="sxs-lookup"><span data-stu-id="f8034-212">Instead, you can take advantage of selectors.</span></span> <span data-ttu-id="f8034-213">Hozzon létre egy új központi telepítési erőforrást egy új pod spec és egy másik címkék.</span><span class="sxs-lookup"><span data-stu-id="f8034-213">Create a new Deployment resource with a new pod spec and a different set of labels.</span></span> <span data-ttu-id="f8034-214">Hozza létre a központi telepítés, a korábbi központi telepítés törölhessék vagy módosíthassák a rá mutató szolgáltatás nélkül.</span><span class="sxs-lookup"><span data-stu-id="f8034-214">Create this deployment, without deleting the previous deployment or modifying the service that points to it.</span></span> <span data-ttu-id="f8034-215">Miután az új három munkaállomás-csoporttal futnak, a szolgáltatás választó megfelelően az új központi telepítési frissítheti.</span><span class="sxs-lookup"><span data-stu-id="f8034-215">Once the new pods are running, you can update the service's selector to match the new deployment.</span></span> 

<span data-ttu-id="f8034-216">A kék-zöld központi telepítések előnye, hogy a szolgáltatás minden a három munkaállomás-csoporttal vált egy időben.</span><span class="sxs-lookup"><span data-stu-id="f8034-216">An advantage of blue-green deployments is that the service switches all the pods at the same time.</span></span> <span data-ttu-id="f8034-217">Után a szolgáltatás frissítve lett, új kérések beolvasása irányítása az új verzióra.</span><span class="sxs-lookup"><span data-stu-id="f8034-217">After the service is updated, all new requests get routed to the new version.</span></span> <span data-ttu-id="f8034-218">Egyik hátránya, hogy a frissítés során futtatja kétszer, számos három munkaállomás-csoporttal a szolgáltatás (az aktuális és a következő).</span><span class="sxs-lookup"><span data-stu-id="f8034-218">One drawback is that during the update, you are running twice as many pods for the service (current and next).</span></span> <span data-ttu-id="f8034-219">Ha a három munkaállomás-csoporttal van szükség a CPU és memória-erőforrásokat számos, szükség lehet terjessze ki a fürt ideiglenesen az erőforrás-felhasználás kezelésére.</span><span class="sxs-lookup"><span data-stu-id="f8034-219">If the pods require a lot of CPU or memory resources, you may need to scale out the cluster temporarily to handle the resource consumption.</span></span> 

### <a name="canary-release"></a><span data-ttu-id="f8034-220">Kanári kiadás</span><span class="sxs-lookup"><span data-stu-id="f8034-220">Canary release</span></span>

<span data-ttu-id="f8034-221">Egy Kanári kiadásban megkezdik frissített verzióját egy kis ügyfelek számára.</span><span class="sxs-lookup"><span data-stu-id="f8034-221">In a canary release, you roll out an updated version to a small number of clients.</span></span> <span data-ttu-id="f8034-222">Az új szolgáltatás működését majd mielőtt végrehajtaná az összes ügyfél figyelheti.</span><span class="sxs-lookup"><span data-stu-id="f8034-222">Then you monitor the behavior of the new service before rolling it out to all clients.</span></span> <span data-ttu-id="f8034-223">Ez lehetővé teszi egy lassú bevezetés szabályozott módon tegye, tekintse át az adatok Valóságosak, és a problémák előtt az összes ügyfelet érintenének.</span><span class="sxs-lookup"><span data-stu-id="f8034-223">This lets you do a slow rollout in a controlled fashion, observe real data, and spot problems before all customers are affected.</span></span>

<span data-ttu-id="f8034-224">Kanári kiadási nem kezeléséhez kék-zöld vagy a működés közbeni frissítés, mint összetett, mert a szolgáltatás különböző verzióihoz való dinamikusan kell továbbítani kérelmek.</span><span class="sxs-lookup"><span data-stu-id="f8034-224">A canary release is more complex to manage than either blue-green or rolling update, because you must dynamically route requests to different versions of the service.</span></span> <span data-ttu-id="f8034-225">Kubernetes konfigurálhatja egy szolgáltatás span két replikakészletekhez (minden verzió egyet), és módosítsa kézzel a replikát számát.</span><span class="sxs-lookup"><span data-stu-id="f8034-225">In Kubernetes, you can configure a Service to span two replica sets (one for each version) and adjust the replica counts manually.</span></span> <span data-ttu-id="f8034-226">Azonban ez a megközelítés ahelyett, hogy coarse-grained, három munkaállomás-csoporttal keresztül kiegyensúlyozza Kubernetes betöltése módjával.</span><span class="sxs-lookup"><span data-stu-id="f8034-226">However, this approach is rather coarse-grained, because of the way Kubernetes load balances across pods.</span></span> <span data-ttu-id="f8034-227">Például ha tíz replikák összesen, akkor is csak az eltolás mértékét megadó 10 %-os lépésekben forgalmat.</span><span class="sxs-lookup"><span data-stu-id="f8034-227">For example, if you have a total of ten replicas, you can only shift traffic in 10% increments.</span></span> <span data-ttu-id="f8034-228">Szolgáltatás rácsvonal használ, ha a szolgáltatás háló útválasztási szabályokat segítségével kifinomultabb Kanári kiadási stratégia megvalósításához.</span><span class="sxs-lookup"><span data-stu-id="f8034-228">If you are using a service mesh, you can use the service mesh routing rules to implement a more sophisticated canary release strategy.</span></span> <span data-ttu-id="f8034-229">Íme néhány forrás, amelyek segíthetnek:</span><span class="sxs-lookup"><span data-stu-id="f8034-229">Here are some resources that may be helpful:</span></span>

- <span data-ttu-id="f8034-230">Szolgáltatás háló nélkül Kubernetes: [Kanári központi telepítések](https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments)</span><span class="sxs-lookup"><span data-stu-id="f8034-230">Kubernetes without service mesh: [Canary deployments](https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/#canary-deployments)</span></span>
- <span data-ttu-id="f8034-231">Linkerd: [irányítása dinamikus](https://linkerd.io/features/routing/)</span><span class="sxs-lookup"><span data-stu-id="f8034-231">Linkerd: [Dynamic request routing](https://linkerd.io/features/routing/)</span></span>
- <span data-ttu-id="f8034-232">Istio: [Kanári üzembe helyezése Istio](https://istio.io/blog/canary-deployments-using-istio.html)</span><span class="sxs-lookup"><span data-stu-id="f8034-232">Istio: [Canary Deployments using Istio](https://istio.io/blog/canary-deployments-using-istio.html)</span></span>

## <a name="conclusion"></a><span data-ttu-id="f8034-233">Összegzés</span><span class="sxs-lookup"><span data-stu-id="f8034-233">Conclusion</span></span>

<span data-ttu-id="f8034-234">Az elmúlt években egy tengeri változás történt az iparág, egy mozdulattal épület *rekord rendszerek* az épület *engagement rendszerek*.</span><span class="sxs-lookup"><span data-stu-id="f8034-234">In recent years, there has been a sea change in the industry, a movement from building *systems of record* to building *systems of engagement*.</span></span>

<span data-ttu-id="f8034-235">Rekord rendszereket hagyományos vissza office-kezelési alkalmazások.</span><span class="sxs-lookup"><span data-stu-id="f8034-235">Systems of record are traditional back-office data management applications.</span></span> <span data-ttu-id="f8034-236">Ezek a rendszerek középpontjában van gyakran helyezkedik el, amely a igazság egyetlen forrása egy RDBMS.</span><span class="sxs-lookup"><span data-stu-id="f8034-236">At the heart of these systems there often sits an RDBMS that is the single source of truth.</span></span> <span data-ttu-id="f8034-237">A kifejezés "engagement rendszer" követel Geoffrey Moore annak 2011 dokumentum *rendszerek az Engagement és a jövőben vállalati informatikai*.</span><span class="sxs-lookup"><span data-stu-id="f8034-237">The term "system of engagement" is credited to Geoffrey Moore, in his 2011 paper *Systems of Engagement and the Future of Enterprise IT*.</span></span> <span data-ttu-id="f8034-238">Bevonási rendszereket alkalmazások kommunikáció és az együttműködési összpontosít.</span><span class="sxs-lookup"><span data-stu-id="f8034-238">Systems of engagement are applications focused on communication and collaboration.</span></span> <span data-ttu-id="f8034-239">Valós idejű személyek szolgáltatáshoz csatlakozik.</span><span class="sxs-lookup"><span data-stu-id="f8034-239">They connect people in real time.</span></span> <span data-ttu-id="f8034-240">Rendelkezésre álló 24/7 kell lenniük.</span><span class="sxs-lookup"><span data-stu-id="f8034-240">They must be available 24/7.</span></span> <span data-ttu-id="f8034-241">Új szolgáltatások rendszeresen új, anélkül, hogy az alkalmazás offline állapotba helyezése.</span><span class="sxs-lookup"><span data-stu-id="f8034-241">New features are introduced regularly without taking the application offline.</span></span> <span data-ttu-id="f8034-242">Felhasználók várhatóan több és kevesebb türelmet nem várt késedelmeket vagy leállás.</span><span class="sxs-lookup"><span data-stu-id="f8034-242">Users expect more and are less patient of unexpected delays or downtime.</span></span>

<span data-ttu-id="f8034-243">A fogyasztó címtérben jobb felhasználói élményt mérhető üzleti értéke lehet.</span><span class="sxs-lookup"><span data-stu-id="f8034-243">In the consumer space, a better user experience can have measurable business value.</span></span> <span data-ttu-id="f8034-244">Ennyi idő alatt, amely a felhasználó kapcsolatba lép egy alkalmazással is lefordítása közvetlenül bevétel.</span><span class="sxs-lookup"><span data-stu-id="f8034-244">The amount of time that a user engages with an application may translate directly into revenue.</span></span> <span data-ttu-id="f8034-245">És abban a tartományban, üzleti rendszerek, felhasználók elvárásainak megváltoztak.</span><span class="sxs-lookup"><span data-stu-id="f8034-245">And in the realm of business systems, users' expectations have changed.</span></span> <span data-ttu-id="f8034-246">Ha ezek a rendszerek célja a kommunikáció és az együttműködés elősegítése, akkor szükséges, azok a felhasználók felé néző alkalmazások köteg.</span><span class="sxs-lookup"><span data-stu-id="f8034-246">If these systems aim to foster communication and collaboration, they must take their cue from consumer-facing applications.</span></span>

<span data-ttu-id="f8034-247">Mikroszolgáltatások a változó fekvő választ.</span><span class="sxs-lookup"><span data-stu-id="f8034-247">Microservices are a response to this changing landscape.</span></span> <span data-ttu-id="f8034-248">Decomposing egy egységes alkalmazás lazán összekapcsolt szolgáltatások egy csoporthoz, azt is szabályozhatja a kiadási ciklus minden szolgáltatás, és állásidő vagy megtörje a módosítások nélkül gyakori frissítések engedélyezése.</span><span class="sxs-lookup"><span data-stu-id="f8034-248">By decomposing a monolithic application into a group of loosely coupled services, we can control the release cycle of each service, and enable frequent updates without downtime or breaking changes.</span></span> <span data-ttu-id="f8034-249">Mikroszolgáltatások létrehozására is hozzájárulhat a méretezhetőséget, hiba elkülönítési és rugalmasság.</span><span class="sxs-lookup"><span data-stu-id="f8034-249">Microservices also help with scalability, failure isolation, and resiliency.</span></span> <span data-ttu-id="f8034-250">Eközben felhőplatformokkal van így könnyebben létrehozása és futtatása mikroszolgáltatások létrehozására, az automatizált üzembe helyezést számítási erőforrásokat, a tároló orchestrators egy szolgáltatás, valamint eseményvezérelt kiszolgáló nélküli környezetekben.</span><span class="sxs-lookup"><span data-stu-id="f8034-250">Meanwhile, cloud platforms are making it easier to build and run microservices, with automated provisioning of compute resources, container orchestrators as a service, and event-driven serverless environments.</span></span>

<span data-ttu-id="f8034-251">De azt látja, mint mikroszolgáltatások architektúrák lehetőség van-e nagy mennyiségű kihívást.</span><span class="sxs-lookup"><span data-stu-id="f8034-251">But as we've seen, microservices architectures also being a lot of challenges.</span></span> <span data-ttu-id="f8034-252">A sikeres, kell elindítania teli kialakítást.</span><span class="sxs-lookup"><span data-stu-id="f8034-252">To succeed, you must start from a solid design.</span></span> <span data-ttu-id="f8034-253">Meg kell helyezni, gondosan meg kell hogy elemzése a tartományhoz, technológiák kiválasztása, adatok modellezését, API-k tervezésekor, és egy összetett DevOps kulturális környezet létrehozása.</span><span class="sxs-lookup"><span data-stu-id="f8034-253">You must put careful thought into analyzing the domain, choosing technologies, modeling data, designing APIs, and building a mature DevOps culture.</span></span> <span data-ttu-id="f8034-254">Reméljük, hogy ez az útmutató, és az ahhoz mellékelt [megvalósítása hivatkozhat](https://github.com/mspnp/microservices-reference-implementation), az út megvilágítására hozzájárult.</span><span class="sxs-lookup"><span data-stu-id="f8034-254">We hope that this guide, and the accompanying [reference implementation](https://github.com/mspnp/microservices-reference-implementation), has helped to illuminate the journey.</span></span> 

