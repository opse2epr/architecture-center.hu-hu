---
title: API-átjárókkal
description: Mikroszolgáltatások átjárói API
author: MikeWasson
ms.date: 12/08/2017
ms.openlocfilehash: 6483d416363e24f4084d6b856847a740bf4054d9
ms.sourcegitcommit: a8453c4bc7c870fa1a12bb3c02e3b310db87530c
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 12/29/2017
---
# <a name="designing-microservices-api-gateways"></a><span data-ttu-id="65b25-103">Mikroszolgáltatások tervezése: API átjárók</span><span class="sxs-lookup"><span data-stu-id="65b25-103">Designing microservices: API gateways</span></span>

<span data-ttu-id="65b25-104">Mikroszolgáltatások architektúra esetén előfordulhat, hogy módosításának ügyfél egynél több előtér-szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="65b25-104">In a microservices architecture, a client might interact with more than one front-end service.</span></span> <span data-ttu-id="65b25-105">Megadott ezt a tényt, hogyan nem ügyfelet, hogy milyen végpontok hívására?</span><span class="sxs-lookup"><span data-stu-id="65b25-105">Given this fact, how does a client know what endpoints to call?</span></span> <span data-ttu-id="65b25-106">Mi történik, ha az új szolgáltatások új vagy meglévő szolgáltatások átkerült vannak?</span><span class="sxs-lookup"><span data-stu-id="65b25-106">What happens when new services are introduced, or existing services are refactored?</span></span> <span data-ttu-id="65b25-107">Hogyan tegye kezeli a szolgáltatások SSL lezárást, hitelesítési és más okok?</span><span class="sxs-lookup"><span data-stu-id="65b25-107">How do services handle SSL termination, authentication, and other concerns?</span></span> <span data-ttu-id="65b25-108">Egy *API átjáró* ezekkel a kihívásokkal megoldására segítségével.</span><span class="sxs-lookup"><span data-stu-id="65b25-108">An *API gateway* can help to address these challenges.</span></span> 

![](./images/gateway.png)

## <a name="what-is-an-api-gateway"></a><span data-ttu-id="65b25-109">Mi az az API-átjáró?</span><span class="sxs-lookup"><span data-stu-id="65b25-109">What is an API gateway?</span></span>

<span data-ttu-id="65b25-110">Az API-átjáró ügyfelek és a szolgáltatások közötti helyezkedik el.</span><span class="sxs-lookup"><span data-stu-id="65b25-110">An API gateway sits between clients and services.</span></span> <span data-ttu-id="65b25-111">Úgy működik, mint egy fordított proxy services ügyfelek útválasztási kérelmeit.</span><span class="sxs-lookup"><span data-stu-id="65b25-111">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="65b25-112">Több területet különböző feladatokat, mint a hitelesítés, az SSL-lezárást és sebességkorlátozást azt is végrehajthatja.</span><span class="sxs-lookup"><span data-stu-id="65b25-112">It may also perform various cross-cutting tasks such as authentication, SSL termination, and rate limiting.</span></span> <span data-ttu-id="65b25-113">Ha nem telepít egy átjárót, az ügyfelek kell kérelmet küldeni közvetlenül előtér-szolgáltatásokat.</span><span class="sxs-lookup"><span data-stu-id="65b25-113">If you don't deploy a gateway, clients must send requests directly to front-end services.</span></span> <span data-ttu-id="65b25-114">Van azonban néhány jelentkezik, mintha közvetlenül az ügyfelek számára szolgáltatásokat érintő lehetséges problémákat:</span><span class="sxs-lookup"><span data-stu-id="65b25-114">However, there are some potential problems with exposing services directly to clients:</span></span>

- <span data-ttu-id="65b25-115">Összetett Ügyfélkód eredményezhet.</span><span class="sxs-lookup"><span data-stu-id="65b25-115">It can result in complex client code.</span></span> <span data-ttu-id="65b25-116">Az ügyfél kell nyomon követésére több végpontot, és rugalmas módon kijavíthassa a hibákat.</span><span class="sxs-lookup"><span data-stu-id="65b25-116">The client must keep track of multiple endpoints, and handle failures in a resilient way.</span></span> 
- <span data-ttu-id="65b25-117">Az ügyfél és a háttérkiszolgáló közötti hoz létre.</span><span class="sxs-lookup"><span data-stu-id="65b25-117">It creates coupling between the client and the backend.</span></span> <span data-ttu-id="65b25-118">Az ügyfélnek tudnia kell, hogyan vannak kiválasztott az adott szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="65b25-118">The client needs to know how the individual services are decomposed.</span></span> <span data-ttu-id="65b25-119">Amelyről nehezebb megőrzése az ügyfél és is nehezebben azonosítóterületen szolgáltatásokhoz.</span><span class="sxs-lookup"><span data-stu-id="65b25-119">That makes it harder to maintain the client and also harder to refactor services.</span></span>
- <span data-ttu-id="65b25-120">Egy művelettel több szolgáltatás hívásainak lehet szükség.</span><span class="sxs-lookup"><span data-stu-id="65b25-120">A single operation might require calls to multiple services.</span></span> <span data-ttu-id="65b25-121">Hogy több hálózati eredmény is kerekíteni között az ügyfél és a kiszolgáló hozzáadása jelentős késés való adatváltások számát.</span><span class="sxs-lookup"><span data-stu-id="65b25-121">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> 
- <span data-ttu-id="65b25-122">Minden egyes nyilvánosan elérhető szolgáltatás vonatkozik, például a hitelesítés, az SSL és az ügyfél sebesség korlátozása kell kezelni.</span><span class="sxs-lookup"><span data-stu-id="65b25-122">Each public-facing service must handle concerns such as authentication, SSL, and client rate limiting.</span></span> 
- <span data-ttu-id="65b25-123">Szolgáltatások elérhetővé kell tenni egy ügyfél-barát protokoll, például a http- vagy WebSocket.</span><span class="sxs-lookup"><span data-stu-id="65b25-123">Services must expose a client-friendly protocol such as HTTP or WebSocket.</span></span> <span data-ttu-id="65b25-124">Ez korlátozza, hogy a választott [kommunikációs protokollokat](./interservice-communication.md).</span><span class="sxs-lookup"><span data-stu-id="65b25-124">This limits the choice of [communication protocols](./interservice-communication.md).</span></span> 
- <span data-ttu-id="65b25-125">Azokat a szolgáltatásokat, nyilvános végpontok egy potenciális támadási felületet, és a megerősített kell lennie.</span><span class="sxs-lookup"><span data-stu-id="65b25-125">Services with public endpoints are a potential attack surface, and must be hardened.</span></span>

<span data-ttu-id="65b25-126">Átjáró segítségével a következő problémák az ügynökök szolgáltatások leválasztásával.</span><span class="sxs-lookup"><span data-stu-id="65b25-126">A gateway helps to address these issues by decoupling clients from services.</span></span> <span data-ttu-id="65b25-127">Átjárók számos különböző funkciót hajthat végre, és előfordulhat, hogy nem kell az összes.</span><span class="sxs-lookup"><span data-stu-id="65b25-127">Gateways can perform a number of different functions, and you may not need all of them.</span></span> <span data-ttu-id="65b25-128">A függvény a következő kialakítási minta sorolhatók:</span><span class="sxs-lookup"><span data-stu-id="65b25-128">The functions can be grouped into the following design patterns:</span></span>

<span data-ttu-id="65b25-129">[Átjáró útválasztási](../patterns/gateway-routing.md).</span><span class="sxs-lookup"><span data-stu-id="65b25-129">[Gateway Routing](../patterns/gateway-routing.md).</span></span> <span data-ttu-id="65b25-130">Az átjáró használatára, egy vagy több háttérbeli szolgáltatások használata réteg 7 útválasztási kérelem továbbításához fordított proxy.</span><span class="sxs-lookup"><span data-stu-id="65b25-130">Use the gateway as a reverse proxy to route requests to one or more backend services, using layer 7 routing.</span></span> <span data-ttu-id="65b25-131">Az átjáró egy végpontot biztosít az ügyfelek számára, és segít használata leválasztja az ügyfelek szolgáltatásokból.</span><span class="sxs-lookup"><span data-stu-id="65b25-131">The gateway provides a single endpoint for clients, and helps to decouple clients from services.</span></span> 

<span data-ttu-id="65b25-132">[Átjáró összesítési](../patterns/gateway-aggregation.md).</span><span class="sxs-lookup"><span data-stu-id="65b25-132">[Gateway Aggregation](../patterns/gateway-aggregation.md).</span></span> <span data-ttu-id="65b25-133">Segítségével az átjáró több egyes kérelmeket az egy kérelemhez.</span><span class="sxs-lookup"><span data-stu-id="65b25-133">Use the gateway to aggregate multiple individual requests into a single request.</span></span> <span data-ttu-id="65b25-134">Ebben a mintában érvényes, ha egy művelettel több háttér-Services-hívások szükségesek.</span><span class="sxs-lookup"><span data-stu-id="65b25-134">This pattern applies when a single operation requires calls to multiple backend services.</span></span> <span data-ttu-id="65b25-135">Az ügyfél egy kérést küld az átjárót.</span><span class="sxs-lookup"><span data-stu-id="65b25-135">The client sends one request to the gateway.</span></span> <span data-ttu-id="65b25-136">Az átjáró kiszállítja kéréseket a különböző háttér-szolgáltatások és aggregálja az eredményeket, majd elküldi az ügyfélnek.</span><span class="sxs-lookup"><span data-stu-id="65b25-136">The gateway dispatches requests to the various backend services, and then aggregates the results and sends them back to the client.</span></span> <span data-ttu-id="65b25-137">Ez segít csökkenteni az ügyfél és a háttérkiszolgáló közötti chattiness.</span><span class="sxs-lookup"><span data-stu-id="65b25-137">This helps to reduce chattiness between the client and the backend.</span></span> 

<span data-ttu-id="65b25-138">[Átjáró kiszervezésével](../patterns/gateway-offloading.md).</span><span class="sxs-lookup"><span data-stu-id="65b25-138">[Gateway Offloading](../patterns/gateway-offloading.md).</span></span> <span data-ttu-id="65b25-139">Az átjáró használatához kiszervezéséhez funkció az egyes szolgáltatások az átjáróra, különösen több területet vonatkozik.</span><span class="sxs-lookup"><span data-stu-id="65b25-139">Use the gateway to offload functionality from individual services to the gateway, particularly cross-cutting concerns.</span></span> <span data-ttu-id="65b25-140">Egy helyen ahelyett, hogy ezek kivitelezésével felelős így minden szolgáltatás konszolidálhatják ezeket a funkciókat a hasznos lehet.</span><span class="sxs-lookup"><span data-stu-id="65b25-140">It can be useful to consolidate these functions into one place, rather than making every service responsible for implementing them.</span></span> <span data-ttu-id="65b25-141">Ez különösen igaz szolgáltatások megfelelően, például a hitelesítési és engedélyezési megvalósításához speciális ismeretek szükségesek.</span><span class="sxs-lookup"><span data-stu-id="65b25-141">This is particularly true for features that requires specialized skills to implement correctly, such as authentication and authorization.</span></span> 

<span data-ttu-id="65b25-142">Az alábbiakban néhány olyan funkciót, amely egy átjáró kiszervezett sikerült:</span><span class="sxs-lookup"><span data-stu-id="65b25-142">Here are some examples of functionality that could be offloaded to a gateway:</span></span>

- <span data-ttu-id="65b25-143">SSL-lezárást</span><span class="sxs-lookup"><span data-stu-id="65b25-143">SSL termination</span></span>
- <span data-ttu-id="65b25-144">Hitelesítés</span><span class="sxs-lookup"><span data-stu-id="65b25-144">Authentication</span></span>
- <span data-ttu-id="65b25-145">IP-engedélyezése</span><span class="sxs-lookup"><span data-stu-id="65b25-145">IP whitelisting</span></span>
- <span data-ttu-id="65b25-146">Ügyfél sebessége (sávszélesség-szabályozás) korlátozása</span><span class="sxs-lookup"><span data-stu-id="65b25-146">Client rate limiting (throttling)</span></span>
- <span data-ttu-id="65b25-147">Naplózás és figyelés</span><span class="sxs-lookup"><span data-stu-id="65b25-147">Logging and monitoring</span></span>
- <span data-ttu-id="65b25-148">Gyorsítótár válasz</span><span class="sxs-lookup"><span data-stu-id="65b25-148">Response caching</span></span>
- <span data-ttu-id="65b25-149">Web application firewall (Webalkalmazási tűzfal)</span><span class="sxs-lookup"><span data-stu-id="65b25-149">Web application firewall</span></span>
- <span data-ttu-id="65b25-150">A GZIP-tömörítés</span><span class="sxs-lookup"><span data-stu-id="65b25-150">GZIP compression</span></span>
- <span data-ttu-id="65b25-151">Statikus tartalom karbantartása</span><span class="sxs-lookup"><span data-stu-id="65b25-151">Servicing static content</span></span>

## <a name="choosing-a-gateway-technology"></a><span data-ttu-id="65b25-152">Egy átjáró technológia kiválasztása</span><span class="sxs-lookup"><span data-stu-id="65b25-152">Choosing a gateway technology</span></span>

<span data-ttu-id="65b25-153">Íme néhány lehetőség egy API-átjáró megvalósítása az alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="65b25-153">Here are some options for implementing an API gateway in your application.</span></span>

- <span data-ttu-id="65b25-154">**Fordított proxykiszolgáló**.</span><span class="sxs-lookup"><span data-stu-id="65b25-154">**Reverse proxy server**.</span></span> <span data-ttu-id="65b25-155">Nginx és a haproxy esetén támogatja a szolgáltatások, mint a hálózati terheléselosztást, SSL, népszerű fordított proxy-kiszolgálót, és 7 útválasztási réteg.</span><span class="sxs-lookup"><span data-stu-id="65b25-155">Nginx and HAProxy are popular reverse proxy servers that support features such as load balancing, SSL, and layer 7 routing.</span></span> <span data-ttu-id="65b25-156">Mindkettő ingyenes, nyílt forráskódú termékek, további lehetőségeket biztosítanak, és a beállítások támogató fizetett verzióval.</span><span class="sxs-lookup"><span data-stu-id="65b25-156">They are both free, open-source products, with paid editions that provide additional features and support options.</span></span> <span data-ttu-id="65b25-157">Nginx és a haproxy esetén is gazdag szolgáltatáskészletek és nagy teljesítményű mindkét érett terméket.</span><span class="sxs-lookup"><span data-stu-id="65b25-157">Nginx and HAProxy are both mature products with rich feature sets and high performance.</span></span> <span data-ttu-id="65b25-158">A külső modulok vagy egyéni parancsfájlok írásával a Lua őket kiterjesztheti.</span><span class="sxs-lookup"><span data-stu-id="65b25-158">You can extend them with third-party modules or by writing custom scripts in Lua.</span></span> <span data-ttu-id="65b25-159">Nginx NginScript néven parancsfájl-kezelési JavaScript-alapú modul is támogatja.</span><span class="sxs-lookup"><span data-stu-id="65b25-159">Nginx also supports a JavaScript-based scripting module called NginScript.</span></span>

- <span data-ttu-id="65b25-160">**Háló érkező szolgáltatásvezérlővel**.</span><span class="sxs-lookup"><span data-stu-id="65b25-160">**Service mesh ingress controller**.</span></span> <span data-ttu-id="65b25-161">Ha például linkerd vagy Istio szolgáltatás rácsvonal használ, fontolja meg a biztosított szolgáltatásokat is a érkező vezérlő által az adott szolgáltatás háló.</span><span class="sxs-lookup"><span data-stu-id="65b25-161">If you are using a service mesh such as linkerd or Istio, consider the features that are provided by the ingress controller for that service mesh.</span></span> <span data-ttu-id="65b25-162">Például a Istio érkező vezérlő támogatja a réteg 7 útválasztási, HTTP átirányításokat, az újrapróbálkozások és egyéb szolgáltatásokat.</span><span class="sxs-lookup"><span data-stu-id="65b25-162">For example, the Istio ingress controller supports layer 7 routing, HTTP redirects, retries, and other features.</span></span> 

- <span data-ttu-id="65b25-163">[Az Azure Alkalmazásátjáró](/azure/application-gateway/).</span><span class="sxs-lookup"><span data-stu-id="65b25-163">[Azure Application Gateway](/azure/application-gateway/).</span></span> <span data-ttu-id="65b25-164">Alkalmazásátjáró egy felügyelt terheléselosztási szolgáltatást, amely útválasztási réteg-7- és SSL-lezárást hajthatnak végre.</span><span class="sxs-lookup"><span data-stu-id="65b25-164">Application Gateway is a managed load balancing service that can perform layer-7 routing and SSL termination.</span></span> <span data-ttu-id="65b25-165">Webalkalmazási tűzfal (WAF) is biztosít.</span><span class="sxs-lookup"><span data-stu-id="65b25-165">It also provides a web application firewall (WAF).</span></span>

- <span data-ttu-id="65b25-166">[Az Azure API Management](/azure/api-management/).</span><span class="sxs-lookup"><span data-stu-id="65b25-166">[Azure API Management](/azure/api-management/).</span></span> <span data-ttu-id="65b25-167">Az API Management az API-k közzétételéhez külső és belső ügyfeleknek olyan azonnal használható megoldás.</span><span class="sxs-lookup"><span data-stu-id="65b25-167">API Management is a turnkey solution for publishing APIs to external and internal customers.</span></span> <span data-ttu-id="65b25-168">Jól lehet egy nyilvánosan elérhető API, beleértve a sebességkorlátozást, listázása IP fehér és hitelesítés használata az Azure Active Directory vagy az egyéb identitás-szolgáltatóktól funkciókat biztosít.</span><span class="sxs-lookup"><span data-stu-id="65b25-168">It provides features that are useful for managing a public-facing API, including rate limiting, IP white listing, and authentication using Azure Active Directory or other identity providers.</span></span> <span data-ttu-id="65b25-169">A terheléselosztást, API Management nem végrehajtani, így például az Alkalmazásátjáró vagy fordított proxy terheléselosztó együtt kell használni.</span><span class="sxs-lookup"><span data-stu-id="65b25-169">API Management doesn't perform any load balancing, so it should be used in conjunction with a load balancer such as Application Gateway or a reverse proxy.</span></span>

<span data-ttu-id="65b25-170">Átjáró technológia kiválasztásakor vegye figyelembe a következőket:</span><span class="sxs-lookup"><span data-stu-id="65b25-170">When choosing a gateway technology, consider the following:</span></span>

<span data-ttu-id="65b25-171">**Szolgáltatások**.</span><span class="sxs-lookup"><span data-stu-id="65b25-171">**Features**.</span></span> <span data-ttu-id="65b25-172">A felsorolt lehetőségek mindenekelőtt réteg 7 útválasztást támogatnak, de egyéb funkciók változhatnak támogatása.</span><span class="sxs-lookup"><span data-stu-id="65b25-172">The options listed above all support layer 7 routing, but support for other features will vary.</span></span> <span data-ttu-id="65b25-173">Attól függően, hogy a szükséges szolgáltatások egynél több átjáró központi telepítését.</span><span class="sxs-lookup"><span data-stu-id="65b25-173">Depending on the features that you need, you might deploy more than one gateway.</span></span> 

<span data-ttu-id="65b25-174">**Központi telepítési**.</span><span class="sxs-lookup"><span data-stu-id="65b25-174">**Deployment**.</span></span> <span data-ttu-id="65b25-175">Az Azure Application Gateway és API-kezelés a felügyelt szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="65b25-175">Azure Application Gateway and API Management are managed services.</span></span> <span data-ttu-id="65b25-176">Nginx és a haproxy esetén általában a fürtben található tárolók fog futni, de a fürtön kívüli dedikált virtuális gépek számára is telepíthető.</span><span class="sxs-lookup"><span data-stu-id="65b25-176">Nginx and HAProxy will typically run in containers inside the cluster, but can also be deployed to dedicated VMs outside of the cluster.</span></span> <span data-ttu-id="65b25-177">Ez az átjáró többi részét a munkaterhelésből elkülöníti megoldás, ám magasabb kezelési terhelés mellett.</span><span class="sxs-lookup"><span data-stu-id="65b25-177">This isolates the gateway from the rest of the workload, but incurs higher management overhead.</span></span>

<span data-ttu-id="65b25-178">**Felügyeleti**.</span><span class="sxs-lookup"><span data-stu-id="65b25-178">**Management**.</span></span> <span data-ttu-id="65b25-179">Szolgáltatások frissítése, vagy új szolgáltatással bővül, az átjáró útválasztási szabályok esetleg frissítenie kell.</span><span class="sxs-lookup"><span data-stu-id="65b25-179">When services are updated or new services are added, the gateway routing rules may need to be updated.</span></span> <span data-ttu-id="65b25-180">Vegye figyelembe, hogyan fogja kezelni ezt a folyamatot.</span><span class="sxs-lookup"><span data-stu-id="65b25-180">Consider how this process will be managed.</span></span> <span data-ttu-id="65b25-181">Hasonló feltételek vonatkoznak, SSL-tanúsítványok, IP-whitelists és egyéb konfigurációs aspektusainak kezelése.</span><span class="sxs-lookup"><span data-stu-id="65b25-181">Similar considerations apply to managing SSL certificates, IP whitelists, and other aspects of configuration.</span></span>

## <a name="deployment-considerations"></a><span data-ttu-id="65b25-182">Telepítési szempontok</span><span class="sxs-lookup"><span data-stu-id="65b25-182">Deployment considerations</span></span>

### <a name="deploying-nginx-or-haproxy-to-kubernetes"></a><span data-ttu-id="65b25-183">Nginx vagy haproxy esetén történő telepítésének Kubernetes</span><span class="sxs-lookup"><span data-stu-id="65b25-183">Deploying Nginx or HAProxy to Kubernetes</span></span>

<span data-ttu-id="65b25-184">Mint Kubernetes Nginx vagy haproxy esetén telepítheti egy [ReplicaSet](https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/) vagy [DaemonSet](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) , amely megadja, hogy a Nginx vagy haproxy esetén tároló-lemezképet.</span><span class="sxs-lookup"><span data-stu-id="65b25-184">You can deploy Nginx or HAProxy to Kubernetes as a [ReplicaSet](https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/) or [DaemonSet](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) that specifies the Nginx or HAProxy container image.</span></span> <span data-ttu-id="65b25-185">Egy ConfigMap a konfigurációs fájl tárolása a proxy, és csatlakoztassa a ConfigMap kötetként.</span><span class="sxs-lookup"><span data-stu-id="65b25-185">Use a ConfigMap to store the configuration file for the proxy, and mount the ConfigMap as a volume.</span></span> <span data-ttu-id="65b25-186">Hozzon létre teszi közzé az átjárón keresztül az Azure Load Balancer terheléselosztó típusú szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="65b25-186">Create a service of type LoadBalancer to expose the gateway through an Azure Load Balancer.</span></span> 

<!-- - Configure a readiness probe that serves a static file from the gateway (rather than routing to another service). -->

<span data-ttu-id="65b25-187">A másik lehetőség az érkező vezérlőhöz létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="65b25-187">An alternative is to create an Ingress Controller.</span></span> <span data-ttu-id="65b25-188">Az érkező vezérlőhöz, amely telepít egy terheléselosztót vagy fordított proxykiszolgáló Kubernetes erőforrás.</span><span class="sxs-lookup"><span data-stu-id="65b25-188">An Ingress Controller is a Kubernetes resource that deploys a load balancer or reverse proxy server.</span></span> <span data-ttu-id="65b25-189">Több megvalósítások létezik, például a Nginx és a haproxy esetén.</span><span class="sxs-lookup"><span data-stu-id="65b25-189">Several implementations exist, including Nginx and HAProxy.</span></span> <span data-ttu-id="65b25-190">Egy érkező nevű külön erőforrás érkező vezérlő, például az útválasztási szabályokat és a TLS-tanúsítványok beállításokat határoz meg.</span><span class="sxs-lookup"><span data-stu-id="65b25-190">A separate resource called an Ingress defines settings for the Ingress Controller, such as routing rules and TLS certificates.</span></span> <span data-ttu-id="65b25-191">Ezzel a módszerrel nem kell összetett konfigurációs fájlok egy adott proxykiszolgáló server technológiára jellemző kezelése.</span><span class="sxs-lookup"><span data-stu-id="65b25-191">That way, you don't need to manage complex configuration files that are specific to a particular proxy server technology.</span></span> <span data-ttu-id="65b25-192">Érkező tartományvezérlők továbbra is Kubernetes szolgáltatása beta írásának időpontjában, és a szolgáltatás továbbra is fejleszteni.</span><span class="sxs-lookup"><span data-stu-id="65b25-192">Ingress Controllers are still a beta feature of Kubernetes at the time of this writing, and the feature will continue to evolve.</span></span>

<span data-ttu-id="65b25-193">Az átjáró egy potenciális szűk vagy az kritikus hibapont a rendszerben, ezért mindig telepíteni a magas rendelkezésre állás érdekében legalább két replika.</span><span class="sxs-lookup"><span data-stu-id="65b25-193">The gateway is a potential bottleneck or single point of failure in the system, so always deploy at least two replicas for high availability.</span></span> <span data-ttu-id="65b25-194">Szükség lehet további, a replikák horizontális terhelésétől függően.</span><span class="sxs-lookup"><span data-stu-id="65b25-194">You may need to scale out the replicas further, depending on the load.</span></span> 

<span data-ttu-id="65b25-195">Figyelembe venni az átjáró fut a dedikált meg a fürtben lévő csomópontok.</span><span class="sxs-lookup"><span data-stu-id="65b25-195">Also consider running the gateway on a dedicated set of nodes in the cluster.</span></span> <span data-ttu-id="65b25-196">Ezt a módszert használja a következő előnyöket nyújtja:</span><span class="sxs-lookup"><span data-stu-id="65b25-196">Benefits to this approach include:</span></span>

- <span data-ttu-id="65b25-197">Elszigetelés.</span><span class="sxs-lookup"><span data-stu-id="65b25-197">Isolation.</span></span> <span data-ttu-id="65b25-198">Minden bejövő forgalom kerül el lehet különíteni a háttér-szolgáltatások csomópontok készletét.</span><span class="sxs-lookup"><span data-stu-id="65b25-198">All inbound traffic goes to a fixed set of nodes, which can be isolated from backend services.</span></span>

- <span data-ttu-id="65b25-199">Stabil konfigurációs.</span><span class="sxs-lookup"><span data-stu-id="65b25-199">Stable configuration.</span></span> <span data-ttu-id="65b25-200">Ha az átjáró helytelenül van konfigurálva, a teljes alkalmazás elérhetetlenné válnának.</span><span class="sxs-lookup"><span data-stu-id="65b25-200">If the gateway is misconfigured, the entire application may become unavailable.</span></span> 

- <span data-ttu-id="65b25-201">Teljesítmény.</span><span class="sxs-lookup"><span data-stu-id="65b25-201">Performance.</span></span> <span data-ttu-id="65b25-202">Érdemes lehet egy meghatározott Virtuálisgép-konfiguráció használata az átjáró teljesítményének javítására szolgál.</span><span class="sxs-lookup"><span data-stu-id="65b25-202">You may want to use a specific VM configuration for the gateway for performance reasons.</span></span>

<!-- - Load balancing. You can configure the external load balancer so that requests always go to a gateway node. That can save a network hop, which would otherwise happen whenever a request lands on a node that isn't running a gateway pod. This consideration applies mainly to large clusters, where the gateway runs on a relatively small fraction of the total nodes. In Azure Container Service (ACS), this approach currently requires [ACS Engine](https://github.com/Azure/acs-engine)) which allows you to create multiple agent pools. Then you can deploy the gateway as a DaemonSet to the front-end pool. -->

### <a name="azure-application-gateway"></a><span data-ttu-id="65b25-203">Azure Application Gateway</span><span class="sxs-lookup"><span data-stu-id="65b25-203">Azure Application Gateway</span></span>

<span data-ttu-id="65b25-204">Csatlakozás az Azure-ban Kubernetes fürtre Alkalmazásátjáró:</span><span class="sxs-lookup"><span data-stu-id="65b25-204">To connect Application Gateway to a Kubernetes cluster in Azure:</span></span>

1. <span data-ttu-id="65b25-205">A fürt virtuális hálózatot hozzon létre egy üres alhálózatot.</span><span class="sxs-lookup"><span data-stu-id="65b25-205">Create an empty subnet in the cluster VNet.</span></span>
2. <span data-ttu-id="65b25-206">Alkalmazás-átjáró üzembe helyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="65b25-206">Deploy Application Gateway.</span></span>
3. <span data-ttu-id="65b25-207">Hozzon létre egy Kubernetes szolgáltatás típus =[NodePort](https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport).</span><span class="sxs-lookup"><span data-stu-id="65b25-207">Create a Kubernetes service with type=[NodePort](https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport).</span></span> <span data-ttu-id="65b25-208">Ez a szolgáltatás minden egyes csomóponton mutatja meg, hogy az elérhető a fürtön kívül.</span><span class="sxs-lookup"><span data-stu-id="65b25-208">This exposes the service on each node so that it can be reached from outside the cluster.</span></span> <span data-ttu-id="65b25-209">A terheléselosztó nem hoz létre.</span><span class="sxs-lookup"><span data-stu-id="65b25-209">It does not create a load balancer.</span></span>
5. <span data-ttu-id="65b25-210">A hozzárendelt portszámot a szolgáltatáshoz tartozó lekérdezése.</span><span class="sxs-lookup"><span data-stu-id="65b25-210">Get the assigned port number for the service.</span></span>
6. <span data-ttu-id="65b25-211">Vegyen fel egy Application Gateway ahol:</span><span class="sxs-lookup"><span data-stu-id="65b25-211">Add an Application Gateway rule where:</span></span>
    - <span data-ttu-id="65b25-212">A háttérkészlet az ügynök virtuális gépeket tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="65b25-212">The backend pool contains the agent VMs.</span></span>
    - <span data-ttu-id="65b25-213">A HTTP-beállítással a port számát.</span><span class="sxs-lookup"><span data-stu-id="65b25-213">The HTTP setting specifies the service port number.</span></span>
    - <span data-ttu-id="65b25-214">80/443-as porton figyeli a átjáró figyelő</span><span class="sxs-lookup"><span data-stu-id="65b25-214">The gateway listener listens on ports 80/443</span></span>
    
<span data-ttu-id="65b25-215">Állítsa be a példányszám 2 vagy több, a magas rendelkezésre állás.</span><span class="sxs-lookup"><span data-stu-id="65b25-215">Set the instance count to 2 or more for high availability.</span></span>

### <a name="azure-api-management"></a><span data-ttu-id="65b25-216">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="65b25-216">Azure API Management</span></span> 

<span data-ttu-id="65b25-217">Az API Management Kubernetes fürt az Azure-ban való csatlakozáshoz:</span><span class="sxs-lookup"><span data-stu-id="65b25-217">To connect API Management to a Kubernetes cluster in Azure:</span></span>

1. <span data-ttu-id="65b25-218">A fürt virtuális hálózatot hozzon létre egy üres alhálózatot.</span><span class="sxs-lookup"><span data-stu-id="65b25-218">Create an empty subnet in the cluster VNet.</span></span>
2. <span data-ttu-id="65b25-219">Az adott alhálózat API Management központi telepítését.</span><span class="sxs-lookup"><span data-stu-id="65b25-219">Deploy API Management to that subnet.</span></span>
3. <span data-ttu-id="65b25-220">Terheléselosztó típusú Kubernetes szolgáltatás létrehozása.</span><span class="sxs-lookup"><span data-stu-id="65b25-220">Create a Kubernetes service of type LoadBalancer.</span></span> <span data-ttu-id="65b25-221">Használja a [belső terheléselosztó](https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer) létrehozni a belső terheléselosztót, egy internetre irányuló terheléselosztót helyett az alapértelmezett jegyzet.</span><span class="sxs-lookup"><span data-stu-id="65b25-221">Use the [internal load balancer](https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer) annotation to create an internal load balancer, instead of an Internet-facing load balancer, which is the default.</span></span>
4. <span data-ttu-id="65b25-222">A privát IP-cím keresése a belső terheléselosztó kubectl vagy az Azure parancssori felület használatával.</span><span class="sxs-lookup"><span data-stu-id="65b25-222">Find the private IP of the internal load balancer, using kubectl or the Azure CLI.</span></span>
5. <span data-ttu-id="65b25-223">Az API Management segítségével hozzon létre egy API-t, amely a saját IP-címet a terheléselosztó irányítja.</span><span class="sxs-lookup"><span data-stu-id="65b25-223">Use API Management to create an API that directs to the private IP address of the load balancer.</span></span>

<span data-ttu-id="65b25-224">Fontolja meg az API Management kombinálásával fordított proxy, hogy Nginx, haproxy esetén vagy Azure Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="65b25-224">Consider combining API Management with a reverse proxy, whether Nginx, HAProxy, or Azure Application Gateway.</span></span> <span data-ttu-id="65b25-225">Az Alkalmazásátjáró API Management használatával kapcsolatos információkért lásd: [API Management integrálható egy belső virtuális Hálózatot az Alkalmazásátjáró](/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway).</span><span class="sxs-lookup"><span data-stu-id="65b25-225">For information about using API Management with Application Gateway, see [Integrate API Management in an internal VNET with Application Gateway](/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway).</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="65b25-226">Naplózás és figyelés</span><span class="sxs-lookup"><span data-stu-id="65b25-226">Logging and monitoring</span></span>](./logging-monitoring.md)
