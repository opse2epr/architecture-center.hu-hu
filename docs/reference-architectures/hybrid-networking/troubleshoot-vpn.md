---
title: Hibrid VPN-kapcsolat hibaelhárítása
titleSuffix: Azure Reference Architectures
description: Végezzen hibaelhárítást a VPN gateway kapcsolati percalapú egy a helyszíni hálózat és az Azure.
author: telmosampaio
ms.date: 10/08/2018
ms.topic: article
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: networking
ms.openlocfilehash: 49dfcf444665ef526e76cac0f4ad13104a142840
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54485927"
---
# <a name="troubleshoot-a-hybrid-vpn-connection"></a><span data-ttu-id="7229b-103">Hibrid VPN-kapcsolat hibaelhárítása</span><span class="sxs-lookup"><span data-stu-id="7229b-103">Troubleshoot a hybrid VPN connection</span></span>

<span data-ttu-id="7229b-104">Ez a cikk egy VPN-átjárókapcsolat a helyszíni hálózat és az Azure közötti hibaelhárítási tippek biztosít.</span><span class="sxs-lookup"><span data-stu-id="7229b-104">This article gives some tips for troubleshooting a VPN gateway connection between an on-premises network and Azure.</span></span> <span data-ttu-id="7229b-105">Általános információk a VPN-nel kapcsolatos gyakori hibák elhárításáról: [VPN-nel kapcsolatos gyakori hibák elhárítása][troubleshooting-vpn-errors].</span><span class="sxs-lookup"><span data-stu-id="7229b-105">For general information on troubleshooting common VPN-related errors, see [Troubleshooting common VPN related errors][troubleshooting-vpn-errors].</span></span>

## <a name="verify-the-vpn-appliance-is-functioning-correctly"></a><span data-ttu-id="7229b-106">Ellenőrizze, hogy a VPN-berendezés megfelelően működik-e</span><span class="sxs-lookup"><span data-stu-id="7229b-106">Verify the VPN appliance is functioning correctly</span></span>

<span data-ttu-id="7229b-107">Az alábbi javaslatok segítenek meghatározni, hogy a helyszíni VPN-berendezés megfelelően működik-e.</span><span class="sxs-lookup"><span data-stu-id="7229b-107">The following recommendations are useful for determining if your on-premises VPN appliance is functioning correctly.</span></span>

<span data-ttu-id="7229b-108">**Ellenőrizze a VPN-berendezés által létrehozott naplófájlokat hibák és meghibásodások vonatkozásában.**</span><span class="sxs-lookup"><span data-stu-id="7229b-108">**Check any log files generated by the VPN appliance for errors or failures.**</span></span> <span data-ttu-id="7229b-109">Ez segít meghatározni, hogy a VPN-berendezés helyesen működik-e.</span><span class="sxs-lookup"><span data-stu-id="7229b-109">This will help you determine if the VPN appliance is functioning correctly.</span></span> <span data-ttu-id="7229b-110">Ennek az információnak a helye a berendezéstől függően változik.</span><span class="sxs-lookup"><span data-stu-id="7229b-110">The location of this information will vary according to your appliance.</span></span> <span data-ttu-id="7229b-111">Ha például a Windows Server 2012 RRAS szolgáltatását használja, az alábbi PowerShell-paranccsal jelenítheti meg az RRAS szolgáltatással kapcsolatos hibaeseményekre vonatkozó információkat:</span><span class="sxs-lookup"><span data-stu-id="7229b-111">For example, if you are using RRAS on Windows Server 2012, you can use the following PowerShell command to display error event information for the RRAS service:</span></span>

```PowerShell
Get-EventLog -LogName System -EntryType Error -Source RemoteAccess | Format-List -Property *
```

<span data-ttu-id="7229b-112">Az egyes bejegyzések *Üzenet* tulajdonsága tartalmaz hibaleírást.</span><span class="sxs-lookup"><span data-stu-id="7229b-112">The *Message* property of each entry provides a description of the error.</span></span> <span data-ttu-id="7229b-113">Néhány gyakori példa:</span><span class="sxs-lookup"><span data-stu-id="7229b-113">Some common examples are:</span></span>

- <span data-ttu-id="7229b-114">Hogy nem tud csatlakozni, valószínűleg helytelen az Azure VPN gateway az RRAS VPN hálózatiadapter-konfigurációjában megadott IP-cím miatt.</span><span class="sxs-lookup"><span data-stu-id="7229b-114">Inability to connect, possibly due to an incorrect IP address specified for the Azure VPN gateway in the RRAS VPN network interface configuration.</span></span>

  ```console
  EventID            : 20111
  MachineName        : on-prem-vm
  Data               : {41, 3, 0, 0}
  Index              : 14231
  Category           : (0)
  CategoryNumber     : 0
  EntryType          : Error
  Message            : RoutingDomainID- {00000000-0000-0000-0000-000000000000}: A demand dial connection to the remote
                          interface AzureGateway on port VPN2-4 was successfully initiated but failed to complete
                          successfully because of the  following error: The network connection between your computer and
                          the VPN server could not be established because the remote server is not responding. This could
                          be because one of the network devices (for example, firewalls, NAT, routers, and so on) between your computer
                          and the remote server is not configured to allow VPN connections. Please contact your
                          Administrator or your service provider to determine which device may be causing the problem.
  Source             : RemoteAccess
  ReplacementStrings : {{00000000-0000-0000-0000-000000000000}, AzureGateway, VPN2-4, The network connection between
                          your computer and the VPN server could not be established because the remote server is not
                          responding. This could be because one of the network devices (for example, firewalls, NAT, routers, and so on)
                          between your computer and the remote server is not configured to allow VPN connections. Please
                          contact your Administrator or your service provider to determine which device may be causing the
                          problem.}
  InstanceId         : 20111
  TimeGenerated      : 3/18/2016 1:26:02 PM
  TimeWritten        : 3/18/2016 1:26:02 PM
  UserName           :
  Site               :
  Container          :
  ```

- <span data-ttu-id="7229b-115">Az RRAS VPN hálózatiadapter-konfigurációjában megadott helytelen megosztott kulcsot.</span><span class="sxs-lookup"><span data-stu-id="7229b-115">The wrong shared key being specified in the RRAS VPN network interface configuration.</span></span>

  ```console
  EventID            : 20111
  MachineName        : on-prem-vm
  Data               : {233, 53, 0, 0}
  Index              : 14245
  Category           : (0)
  CategoryNumber     : 0
  EntryType          : Error
  Message            : RoutingDomainID- {00000000-0000-0000-0000-000000000000}: A demand dial connection to the remote
                          interface AzureGateway on port VPN2-4 was successfully initiated but failed to complete
                          successfully because of the  following error: Internet key exchange (IKE) authentication credentials are unacceptable.

  Source             : RemoteAccess
  ReplacementStrings : {{00000000-0000-0000-0000-000000000000}, AzureGateway, VPN2-4, IKE authentication credentials are
                          unacceptable.
                          }
  InstanceId         : 20111
  TimeGenerated      : 3/18/2016 1:34:22 PM
  TimeWritten        : 3/18/2016 1:34:22 PM
  UserName           :
  Site               :
  Container          :
  ```

<span data-ttu-id="7229b-116">Az alábbi PowerShell-paranccsal lekérheti a RRAS szolgáltatáson keresztül megkísérelt csatlakozásra vonatkozó eseménynapló-adatokat is:</span><span class="sxs-lookup"><span data-stu-id="7229b-116">You can also obtain event log information about attempts to connect through the RRAS service using the following PowerShell command:</span></span>

```powershell
Get-EventLog -LogName Application -Source RasClient | Format-List -Property *
```

<span data-ttu-id="7229b-117">Ha nem sikerül a csatlakozás, ez a napló az alábbihoz hasonló hibákat fog tartalmazni:</span><span class="sxs-lookup"><span data-stu-id="7229b-117">In the event of a failure to connect, this log will contain errors that look similar to the following:</span></span>

```console
EventID            : 20227
MachineName        : on-prem-vm
Data               : {}
Index              : 4203
Category           : (0)
CategoryNumber     : 0
EntryType          : Error
Message            : CoId={B4000371-A67F-452F-AA4C-3125AA9CFC78}: The user SYSTEM dialed a connection named
                        AzureGateway that has failed. The error code returned on failure is 809.
Source             : RasClient
ReplacementStrings : {{B4000371-A67F-452F-AA4C-3125AA9CFC78}, SYSTEM, AzureGateway, 809}
InstanceId         : 20227
TimeGenerated      : 3/18/2016 1:29:21 PM
TimeWritten        : 3/18/2016 1:29:21 PM
UserName           :
Site               :
Container          :
```

## <a name="verify-connectivity"></a><span data-ttu-id="7229b-118">Ellenőrizze a kapcsolatot</span><span class="sxs-lookup"><span data-stu-id="7229b-118">Verify connectivity</span></span>

<span data-ttu-id="7229b-119">**Ellenőrizze a kapcsolatot és az útválasztást a VPN-átjárón.**</span><span class="sxs-lookup"><span data-stu-id="7229b-119">**Verify connectivity and routing across the VPN gateway.**</span></span> <span data-ttu-id="7229b-120">Előfordulhat, hogy a VPN-berendezés nem megfelelően irányítja a forgalmat az Azure VPN Gatewayen keresztül.</span><span class="sxs-lookup"><span data-stu-id="7229b-120">The VPN appliance may not be correctly routing traffic through the Azure VPN Gateway.</span></span> <span data-ttu-id="7229b-121">Egy [PsPing][psping] eszközhöz hasonló eszközzel ellenőrizheti a kapcsolatot és az útválasztást a VPN-átjárón.</span><span class="sxs-lookup"><span data-stu-id="7229b-121">Use a tool such as [PsPing][psping] to verify connectivity and routing across the VPN gateway.</span></span> <span data-ttu-id="7229b-122">Ha például tesztelni szeretné a csatlakozást egy helyszíni gép és egy, a virtuális hálózaton található webkiszolgáló között, futtassa az alábbi parancsot (a `<<web-server-address>>` helyére írja a webkiszolgáló címét):</span><span class="sxs-lookup"><span data-stu-id="7229b-122">For example, to test connectivity from an on-premises machine to a web server located on the VNet, run the following command (replacing `<<web-server-address>>` with the address of the web server):</span></span>

```console
PsPing -t <<web-server-address>>:80
```

<span data-ttu-id="7229b-123">Ha a helyszíni gép át tudja irányítani a forgalmat a webkiszolgálóra, az alábbihoz hasonló kimenetnek kell megjelennie:</span><span class="sxs-lookup"><span data-stu-id="7229b-123">If the on-premises machine can route traffic to the web server, you should see output similar to the following:</span></span>

```console
D:\PSTools>psping -t 10.20.0.5:80

PsPing v2.01 - PsPing - ping, latency, bandwidth measurement utility
Copyright (C) 2012-2014 Mark Russinovich
Sysinternals - www.sysinternals.com

TCP connect to 10.20.0.5:80:
Infinite iterations (warmup 1) connecting test:
Connecting to 10.20.0.5:80 (warmup): 6.21ms
Connecting to 10.20.0.5:80: 3.79ms
Connecting to 10.20.0.5:80: 3.44ms
Connecting to 10.20.0.5:80: 4.81ms

    Sent = 3, Received = 3, Lost = 0 (0% loss),
    Minimum = 3.44ms, Maximum = 4.81ms, Average = 4.01ms
```

<span data-ttu-id="7229b-124">Ha a helyi számítógép nem tud kommunikálni a megadott céllal, az alábbihoz hasonló üzenetek jelennek meg:</span><span class="sxs-lookup"><span data-stu-id="7229b-124">If the on-premises machine cannot communicate with the specified destination, you will see messages like this:</span></span>

```console
D:\PSTools>psping -t 10.20.1.6:80

PsPing v2.01 - PsPing - ping, latency, bandwidth measurement utility
Copyright (C) 2012-2014 Mark Russinovich
Sysinternals - www.sysinternals.com

TCP connect to 10.20.1.6:80:
Infinite iterations (warmup 1) connecting test:
Connecting to 10.20.1.6:80 (warmup): This operation returned because the timeout period expired.
Connecting to 10.20.1.6:80: This operation returned because the timeout period expired.
Connecting to 10.20.1.6:80: This operation returned because the timeout period expired.
Connecting to 10.20.1.6:80: This operation returned because the timeout period expired.
Connecting to 10.20.1.6:80:
    Sent = 3, Received = 0, Lost = 3 (100% loss),
    Minimum = 0.00ms, Maximum = 0.00ms, Average = 0.00ms
```

<span data-ttu-id="7229b-125">**Ellenőrizze, hogy a helyszíni tűzfal engedélyezi-e a VPN-forgalom áthaladását, és hogy a megfelelő portok vannak-e megnyitva.**</span><span class="sxs-lookup"><span data-stu-id="7229b-125">**Verify that the on-premises firewall allows VPN traffic to pass and that the correct ports are opened.**</span></span>

<span data-ttu-id="7229b-126">**Győződjön meg arról, hogy a helyszíni VPN-berendezés, amely az Azure VPN gateway kompatibilis titkosítási módszert használja.**</span><span class="sxs-lookup"><span data-stu-id="7229b-126">**Verify that the on-premises VPN appliance uses an encryption method that is compatible with the Azure VPN gateway.**</span></span> <span data-ttu-id="7229b-127">A házirendalapú útválasztás esetében az Azure VPN-átjáró az AES256, az AES128 és a 3DES titkosítási algoritmust támogatja.</span><span class="sxs-lookup"><span data-stu-id="7229b-127">For policy-based routing, the Azure VPN gateway supports the AES256, AES128, and 3DES encryption algorithms.</span></span> <span data-ttu-id="7229b-128">Az útvonalalapú átjárók az AES256 és 3DES titkosítási algoritmust támogatják.</span><span class="sxs-lookup"><span data-stu-id="7229b-128">Route-based gateways support AES256 and 3DES.</span></span> <span data-ttu-id="7229b-129">További információkért lásd: [tudnivalók a VPN-eszközök és IPsec/IKE-paramétereinek Site-to-Site VPN Gateway-kapcsolatok][vpn-appliance].</span><span class="sxs-lookup"><span data-stu-id="7229b-129">For more information, see [About VPN devices and IPsec/IKE parameters for Site-to-Site VPN Gateway connections][vpn-appliance].</span></span>

## <a name="check-for-problems-with-the-azure-vpn-gateway"></a><span data-ttu-id="7229b-130">Az Azure VPN-átjáróval kapcsolatos problémák ellenőrzése</span><span class="sxs-lookup"><span data-stu-id="7229b-130">Check for problems with the Azure VPN gateway</span></span>

<span data-ttu-id="7229b-131">Az alábbi javaslatok segítenek megállapítani, van-e probléma az Azure VPN-átjáróval:</span><span class="sxs-lookup"><span data-stu-id="7229b-131">The following recommendations are useful for determining if there is a problem with the Azure VPN gateway:</span></span>

<span data-ttu-id="7229b-132">**Vizsgálja meg az Azure VPN gateway diagnosztikai naplóinak potenciális problémákat.**</span><span class="sxs-lookup"><span data-stu-id="7229b-132">**Examine Azure VPN gateway diagnostic logs for potential issues.**</span></span> <span data-ttu-id="7229b-133">Lásd: [lépésről lépésre: Az Azure Resource Manager virtuális hálózati átjáró diagnosztikai naplók rögzítése][gateway-diagnostic-logs].</span><span class="sxs-lookup"><span data-stu-id="7229b-133">See [Step-by-Step: Capturing Azure Resource Manager VNET Gateway Diagnostic Logs][gateway-diagnostic-logs].</span></span>

<span data-ttu-id="7229b-134">**Ellenőrizze, hogy az Azure VPN-átjáró és a helyszíni VPN-berendezés ugyanazt a megosztott hitelesítési kulcsot használja-e.**</span><span class="sxs-lookup"><span data-stu-id="7229b-134">**Verify that the Azure VPN gateway and on-premises VPN appliance are configured with the same shared authentication key.**</span></span> <span data-ttu-id="7229b-135">Az Azure VPN-átjáró által tárolt megosztott kulcsot az alábbi Azure CLI-paranccsal tekintheti meg:</span><span class="sxs-lookup"><span data-stu-id="7229b-135">You can view the shared key stored by the Azure VPN gateway using the following Azure CLI command:</span></span>

```azurecli
azure network vpn-connection shared-key show <<resource-group>> <<vpn-connection-name>>
```

<span data-ttu-id="7229b-136">Használja a helyszíni VPN-berendezéshez megfelelő parancsot a berendezéshez konfigurált megosztott kulcs megjelenítéséhez.</span><span class="sxs-lookup"><span data-stu-id="7229b-136">Use the command appropriate for your on-premises VPN appliance to show the shared key configured for that appliance.</span></span>

<span data-ttu-id="7229b-137">Győződjön meg arról, hogy az Azure VPN-átjárónak helyet adó *GatewaySubnet* alhálózat nincs NSG-hez társítva.</span><span class="sxs-lookup"><span data-stu-id="7229b-137">Verify that the *GatewaySubnet* subnet holding the Azure VPN gateway is not associated with an NSG.</span></span>

<span data-ttu-id="7229b-138">Az alhálózati adatokat a következő Azure CLI-paranccsal tekintheti meg:</span><span class="sxs-lookup"><span data-stu-id="7229b-138">You can view the subnet details using the following Azure CLI command:</span></span>

```azurecli
azure network vnet subnet show -g <<resource-group>> -e <<vnet-name>> -n GatewaySubnet
```

<span data-ttu-id="7229b-139">Biztosítására ne legyen nevű adatmező *hálózati biztonsági csoportjának azonosítója*.</span><span class="sxs-lookup"><span data-stu-id="7229b-139">Ensure there is no data field named *Network Security Group ID*.</span></span> <span data-ttu-id="7229b-140">Az alábbi példa bemutatja egy olyan *GatewaySubnet*-példány eredményeit, amelyhez hozzá van rendelve egy NSG (*VPN-Gateway-Group*).</span><span class="sxs-lookup"><span data-stu-id="7229b-140">The following example shows the results for an instance of the *GatewaySubnet* that has an assigned NSG (*VPN-Gateway-Group*).</span></span> <span data-ttu-id="7229b-141">Emiatt előfordulhat, hogy az átjáró hibásan működik, ha vannak szabályok meghatározva az NSG-hez.</span><span class="sxs-lookup"><span data-stu-id="7229b-141">This can prevent the gateway from working correctly if there are any rules defined for this NSG.</span></span>

```console
C:\>azure network vnet subnet show -g profx-prod-rg -e profx-vnet -n GatewaySubnet
    info:    Executing command network vnet subnet show
    + Looking up virtual network "profx-vnet"
    + Looking up the subnet "GatewaySubnet"
    data:    Id                              : /subscriptions/########-####-####-####-############/resourceGroups/profx-prod-rg/providers/Microsoft.Network/virtualNetworks/profx-vnet/subnets/GatewaySubnet
    data:    Name                            : GatewaySubnet
    data:    Provisioning state              : Succeeded
    data:    Address prefix                  : 10.20.3.0/27
    data:    Network Security Group id       : /subscriptions/########-####-####-####-############/resourceGroups/profx-prod-rg/providers/Microsoft.Network/networkSecurityGroups/VPN-Gateway-Group
    info:    network vnet subnet show command OK
```

<span data-ttu-id="7229b-142">**Ellenőrizze, hogy az Azure virtuális hálózat virtuális gépeinek konfigurációja engedélyezi-e a virtuális hálózaton kívülről érkező forgalmat.**</span><span class="sxs-lookup"><span data-stu-id="7229b-142">**Verify that the virtual machines in the Azure VNet are configured to permit traffic coming in from outside the VNet.**</span></span> <span data-ttu-id="7229b-143">Ellenőrizze az összes, a virtuális gépeket tartalmazó alhálózatokhoz társított NSG-szabályt.</span><span class="sxs-lookup"><span data-stu-id="7229b-143">Check any NSG rules associated with subnets containing these virtual machines.</span></span> <span data-ttu-id="7229b-144">Az alábbi Azure CLI-paranccsal megtekintheti az összes NSG-szabályt:</span><span class="sxs-lookup"><span data-stu-id="7229b-144">You can view all NSG rules using the following Azure CLI command:</span></span>

```azurecli
azure network nsg show -g <<resource-group>> -n <<nsg-name>>
```

<span data-ttu-id="7229b-145">**Ellenőrizze, hogy csatlakoztatva van-e az Azure VPN-átjáró.**</span><span class="sxs-lookup"><span data-stu-id="7229b-145">**Verify that the Azure VPN gateway is connected.**</span></span> <span data-ttu-id="7229b-146">A következő Azure PowerShell-paranccsal ellenőrizheti az Azure VPN-kapcsolat aktuális állapotát.</span><span class="sxs-lookup"><span data-stu-id="7229b-146">You can use the following Azure PowerShell command to check the current status of the Azure VPN connection.</span></span> <span data-ttu-id="7229b-147">A `<<connection-name>>` paraméter a virtuális hálózati átjárót és a helyi átjárót társító Azure VPN-kapcsolat neve.</span><span class="sxs-lookup"><span data-stu-id="7229b-147">The `<<connection-name>>` parameter is the name of the Azure VPN connection that links the virtual network gateway and the local gateway.</span></span>

```powershell
Get-AzureRmVirtualNetworkGatewayConnection -Name <<connection-name>> - ResourceGroupName <<resource-group>>
```

<span data-ttu-id="7229b-148">Az alábbi kódrészletek kiemelik azt a kimenetet, amely az átjáró csatlakoztatásakor (első példa) és leválasztásakor (második példa) jön létre:</span><span class="sxs-lookup"><span data-stu-id="7229b-148">The following snippets highlight the output generated if the gateway is connected (the first example), and disconnected (the second example):</span></span>

```powershell
PS C:\> Get-AzureRmVirtualNetworkGatewayConnection -Name profx-gateway-connection -ResourceGroupName profx-prod-rg

AuthorizationKey           :
VirtualNetworkGateway1     : Microsoft.Azure.Commands.Network.Models.PSVirtualNetworkGateway
VirtualNetworkGateway2     :
LocalNetworkGateway2       : Microsoft.Azure.Commands.Network.Models.PSLocalNetworkGateway
Peer                       :
ConnectionType             : IPsec
RoutingWeight              : 0
SharedKey                  : ####################################
ConnectionStatus           : Connected
EgressBytesTransferred     : 55254803
IngressBytesTransferred    : 32227221
ProvisioningState          : Succeeded
...
```

```powershell
PS C:\> Get-AzureRmVirtualNetworkGatewayConnection -Name profx-gateway-connection2 -ResourceGroupName profx-prod-rg

AuthorizationKey           :
VirtualNetworkGateway1     : Microsoft.Azure.Commands.Network.Models.PSVirtualNetworkGateway
VirtualNetworkGateway2     :
LocalNetworkGateway2       : Microsoft.Azure.Commands.Network.Models.PSLocalNetworkGateway
Peer                       :
ConnectionType             : IPsec
RoutingWeight              : 0
SharedKey                  : ####################################
ConnectionStatus           : NotConnected
EgressBytesTransferred     : 0
IngressBytesTransferred    : 0
ProvisioningState          : Succeeded
...
```

## <a name="miscellaneous-issues"></a><span data-ttu-id="7229b-149">Egyéb problémák</span><span class="sxs-lookup"><span data-stu-id="7229b-149">Miscellaneous issues</span></span>

<span data-ttu-id="7229b-150">Az alábbi javaslatok segítenek megállapítani, hogy van-e probléma a virtuális gazdagép konfigurációjával, a hálózati sávszélesség felhasználásával vagy az alkalmazás teljesítményével:</span><span class="sxs-lookup"><span data-stu-id="7229b-150">The following recommendations are useful for determining if there is an issue with Host VM configuration, network bandwidth utilization, or application performance:</span></span>

<span data-ttu-id="7229b-151">**Tűzfal-konfiguráció ellenőrzése.**</span><span class="sxs-lookup"><span data-stu-id="7229b-151">**Verify firewall configuration.**</span></span> <span data-ttu-id="7229b-152">Győződjön meg arról, hogy az alhálózat az Azure virtuális gépeken futó vendég operációs rendszerben a tűzfal megfelelően van konfigurálva, hogy a helyi IP-címtartományokkal engedélyezett forgalmat.</span><span class="sxs-lookup"><span data-stu-id="7229b-152">Verify that the firewall in the guest operating system running on the Azure VMs in the subnet is configured correctly to allow permitted traffic from the on-premises IP ranges.</span></span>

<span data-ttu-id="7229b-153">**Ellenőrizze, hogy a forgalom mennyisége nem közelít-e az Azure VPN-átjárón rendelkezésre álló sávszélesség korlátjához.**</span><span class="sxs-lookup"><span data-stu-id="7229b-153">**Verify that the volume of traffic is not close to the limit of the bandwidth available to the Azure VPN gateway.**</span></span> <span data-ttu-id="7229b-154">Ennek az ellenőrzési módja a helyszínen futó VPN-berendezéstől függ.</span><span class="sxs-lookup"><span data-stu-id="7229b-154">How to verify this depends on the VPN appliance running on-premises.</span></span> <span data-ttu-id="7229b-155">Ha például a Windows Server 2012 RRAS szolgáltatását használja, a teljesítményfigyelő segítségével nyomon követheti a VPN-kapcsolaton keresztül fogadott és küldött adatok mennyiségét.</span><span class="sxs-lookup"><span data-stu-id="7229b-155">For example, if you are using RRAS on Windows Server 2012, you can use Performance Monitor to track the volume of data being received and transmitted over the VPN connection.</span></span> <span data-ttu-id="7229b-156">A *Távelérés (RAS) áttekintése* objektum segítségével válassza ki a *Fogadott bájtok/mp* és a *Küldési sebesség (bájt/s)* számlálókat:</span><span class="sxs-lookup"><span data-stu-id="7229b-156">Using the *RAS Total* object, select the *Bytes Received/Sec* and *Bytes Transmitted/Sec* counters:</span></span>

![Teljesítményszámlálók a VPN-hálózati forgalom figyelésére](../_images/guidance-hybrid-network-vpn/RRAS-perf-counters.png)

<span data-ttu-id="7229b-158">Meg kell az eredményeket hasonlítsa össze a rendelkezésre álló sávszélesség VPN-átjáróhoz (a 100 MB/s VpnGw3 termékváltozat 1,25 GB/s, az alapszintű Termékváltozat esetén):</span><span class="sxs-lookup"><span data-stu-id="7229b-158">You should compare the results with the bandwidth available to the VPN gateway (from 100 Mbps for the Basic SKU to 1.25 Gbps for VpnGw3 SKU):</span></span>

![Példa VPN hálózat teljesítménye ábra](../_images/guidance-hybrid-network-vpn/RRAS-perf-graph.png)

<span data-ttu-id="7229b-160">**Győződjön meg arról, hogy az alkalmazásterheléshez megfelelő számban és méretben telepített virtuális gépeket.**</span><span class="sxs-lookup"><span data-stu-id="7229b-160">**Verify that you have deployed the right number and size of VMs for your application load.**</span></span> <span data-ttu-id="7229b-161">Állapítsa meg, hogy nem lassúak-e az Azure virtuális hálózat virtuális gépei.</span><span class="sxs-lookup"><span data-stu-id="7229b-161">Determine if any of the virtual machines in the Azure VNet are running slowly.</span></span> <span data-ttu-id="7229b-162">Ha igen, akkor lehet, hogy túl vannak terhelve. Elképzelhető, hogy túl kevés gép van a terhelés kezeléséhez, vagy nincsenek megfelelően konfigurálva a terheléselosztók.</span><span class="sxs-lookup"><span data-stu-id="7229b-162">If so, they may be overloaded, there may be too few to handle the load, or the load-balancers may not be configured correctly.</span></span> <span data-ttu-id="7229b-163">Ennek meghatározásához, [rögzítse és elemezze a diagnosztikai adatokat][azure-vm-diagnostics].</span><span class="sxs-lookup"><span data-stu-id="7229b-163">To determine this, [capture and analyze diagnostic information][azure-vm-diagnostics].</span></span> <span data-ttu-id="7229b-164">Az eredményeket megvizsgálhatja az Azure Portal segítségével, de számos külső féltől származó, a teljesítményadatok részleteibe bepillantást engedő eszköz is a rendelkezésére áll.</span><span class="sxs-lookup"><span data-stu-id="7229b-164">You can examine the results using the Azure portal, but many third-party tools are also available that can provide detailed insights into the performance data.</span></span>

<span data-ttu-id="7229b-165">**Ellenőrizze, hogy az alkalmazás hatékonyan használja-e a felhőerőforrásokat.**</span><span class="sxs-lookup"><span data-stu-id="7229b-165">**Verify that the application is making efficient use of cloud resources.**</span></span> <span data-ttu-id="7229b-166">Az egyes virtuális gépeken futó kialakítási alkalmazáskód, amelynek feladata meghatározni, hogy az alkalmazások a lehető legjobban kihasználják-e az erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="7229b-166">Instrument application code running on each VM to determine whether applications are making the best use of resources.</span></span> <span data-ttu-id="7229b-167">Használhatja például az [Application Insights][application-insights] eszközt.</span><span class="sxs-lookup"><span data-stu-id="7229b-167">You can use tools such as [Application Insights][application-insights].</span></span>

<!-- links -->

[application-insights]: /azure/application-insights/app-insights-overview-usage
[azure-vm-diagnostics]: https://azure.microsoft.com/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/
[gateway-diagnostic-logs]: https://blogs.technet.microsoft.com/keithmayer/2016/10/12/step-by-step-capturing-azure-resource-manager-arm-vnet-gateway-diagnostic-logs/
[psping]: https://technet.microsoft.com/sysinternals/jj729731.aspx
[troubleshooting-vpn-errors]: https://blogs.technet.microsoft.com/rrasblog/2009/08/12/troubleshooting-common-vpn-related-errors/
[vpn-appliance]: /azure/vpn-gateway/vpn-gateway-about-vpn-devices
