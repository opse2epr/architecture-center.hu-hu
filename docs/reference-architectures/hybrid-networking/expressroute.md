---
title: Helyszíni hálózat csatlakoztatása az Azure-hoz ExpressRoute használatával
titleSuffix: Azure Reference Architectures
description: Az Azure virtuális hálózat és a egy helyszíni hálózat az Azure ExpressRoute használatával összekapcsolt kiterjedő helyek közötti biztonságos hálózati architektúra megvalósítása.
author: telmosampaio
ms.date: 10/22/2017
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seodec18, networking
ms.openlocfilehash: 5c010df534bc43bd4c954c7f008b28cbb6a5641a
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 03/20/2019
ms.locfileid: "58298577"
---
# <a name="connect-an-on-premises-network-to-azure-using-expressroute"></a><span data-ttu-id="ec324-103">Helyszíni hálózat csatlakoztatása az Azure-hoz ExpressRoute használatával</span><span class="sxs-lookup"><span data-stu-id="ec324-103">Connect an on-premises network to Azure using ExpressRoute</span></span>

<span data-ttu-id="ec324-104">Ez a referenciaarchitektúra azt mutatja be, hogyan kapcsolható össze egy helyszíni hálózat az Azure virtuális hálózataival az [Azure ExpressRoute][expressroute-introduction] segítségével.</span><span class="sxs-lookup"><span data-stu-id="ec324-104">This reference architecture shows how to connect an on-premises network to virtual networks on Azure, using [Azure ExpressRoute][expressroute-introduction].</span></span> <span data-ttu-id="ec324-105">Az ExpressRoute-kapcsolatok dedikált, privát kapcsolatot használnak egy külső kapcsolatszolgáltatón keresztül.</span><span class="sxs-lookup"><span data-stu-id="ec324-105">ExpressRoute connections use a private, dedicated connection through a third-party connectivity provider.</span></span> <span data-ttu-id="ec324-106">A privát kapcsolat kiterjeszti a helyszíni hálózatot az Azure-ba.</span><span class="sxs-lookup"><span data-stu-id="ec324-106">The private connection extends your on-premises network into Azure.</span></span> <span data-ttu-id="ec324-107">[**A megoldás üzembe helyezése.**](#deploy-the-solution)</span><span class="sxs-lookup"><span data-stu-id="ec324-107">[**Deploy this solution**](#deploy-the-solution).</span></span>

<span data-ttu-id="ec324-108">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="ec324-108">![[0]][0]</span></span>

<span data-ttu-id="ec324-109">*Töltse le az architektúra [Visio-fájlját][visio-download].*</span><span class="sxs-lookup"><span data-stu-id="ec324-109">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="ec324-110">Architektúra</span><span class="sxs-lookup"><span data-stu-id="ec324-110">Architecture</span></span>

<span data-ttu-id="ec324-111">Az architektúra a következőkben leírt összetevőkből áll.</span><span class="sxs-lookup"><span data-stu-id="ec324-111">The architecture consists of the following components.</span></span>

- <span data-ttu-id="ec324-112">**Helyszíni vállalati hálózat**.</span><span class="sxs-lookup"><span data-stu-id="ec324-112">**On-premises corporate network**.</span></span> <span data-ttu-id="ec324-113">A cégen belül futó helyi magánhálózat.</span><span class="sxs-lookup"><span data-stu-id="ec324-113">A private local-area network running within an organization.</span></span>

- <span data-ttu-id="ec324-114">**ExpressRoute-kapcsolatcsoport**.</span><span class="sxs-lookup"><span data-stu-id="ec324-114">**ExpressRoute circuit**.</span></span> <span data-ttu-id="ec324-115">A kapcsolatszolgáltató által biztosított 2. vagy 3. rétegbeli kapcsolatcsoport, amely a peremhálózati útválasztókon keresztül kapcsolja össze a helyszíni hálózatot az Azure-ral.</span><span class="sxs-lookup"><span data-stu-id="ec324-115">A layer 2 or layer 3 circuit supplied by the connectivity provider that joins the on-premises network with Azure through the edge routers.</span></span> <span data-ttu-id="ec324-116">A kapcsolatcsoport a kapcsolatszolgáltató által felügyelt hardveres infrastruktúrát használja.</span><span class="sxs-lookup"><span data-stu-id="ec324-116">The circuit uses the hardware infrastructure managed by the connectivity provider.</span></span>

- <span data-ttu-id="ec324-117">**Helyi peremhálózati útválasztók**.</span><span class="sxs-lookup"><span data-stu-id="ec324-117">**Local edge routers**.</span></span> <span data-ttu-id="ec324-118">A helyszíni hálózatot a szolgáltató által kezelt kapcsolatcsoporttal összekapcsoló útválasztók.</span><span class="sxs-lookup"><span data-stu-id="ec324-118">Routers that connect the on-premises network to the circuit managed by the provider.</span></span> <span data-ttu-id="ec324-119">A kapcsolat kiépítésének módjától függően előfordulhat, hogy meg kell adnia az útválasztók által használt nyilvános IP-címeket.</span><span class="sxs-lookup"><span data-stu-id="ec324-119">Depending on how your connection is provisioned, you may need to provide the public IP addresses used by the routers.</span></span>
- <span data-ttu-id="ec324-120">**A Microsoft peremhálózati útválasztói**.</span><span class="sxs-lookup"><span data-stu-id="ec324-120">**Microsoft edge routers**.</span></span> <span data-ttu-id="ec324-121">Két útválasztó egy aktív-aktív, magas rendelkezésre állású konfigurációban.</span><span class="sxs-lookup"><span data-stu-id="ec324-121">Two routers in an active-active highly available configuration.</span></span> <span data-ttu-id="ec324-122">Ezek az útválasztók lehetővé teszik a kapcsolatszolgáltató számára a kapcsolatcsoportok közvetlen csatlakoztatását az adatközpontjaikhoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-122">These routers enable a connectivity provider to connect their circuits directly to their datacenter.</span></span> <span data-ttu-id="ec324-123">A kapcsolat kiépítésének módjától függően előfordulhat, hogy meg kell adnia az útválasztók által használt nyilvános IP-címeket.</span><span class="sxs-lookup"><span data-stu-id="ec324-123">Depending on how your connection is provisioned, you may need to provide the public IP addresses used by the routers.</span></span>

- <span data-ttu-id="ec324-124">**Azure-beli virtuális hálózatok**.</span><span class="sxs-lookup"><span data-stu-id="ec324-124">**Azure virtual networks (VNets)**.</span></span> <span data-ttu-id="ec324-125">Mindegyik virtuális hálózat egy adott Azure-régióban található, és több alkalmazásréteget is üzemeltethet.</span><span class="sxs-lookup"><span data-stu-id="ec324-125">Each VNet resides in a single Azure region, and can host multiple application tiers.</span></span> <span data-ttu-id="ec324-126">Az alkalmazásrétegek alhálózatokkal szegmentálhatók az egyes virtuális hálózatokban.</span><span class="sxs-lookup"><span data-stu-id="ec324-126">Application tiers can be segmented using subnets in each VNet.</span></span>

- <span data-ttu-id="ec324-127">**Nyilvános Azure-szolgáltatások**.</span><span class="sxs-lookup"><span data-stu-id="ec324-127">**Azure public services**.</span></span> <span data-ttu-id="ec324-128">A hibrid alkalmazásokban használható Azure-szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="ec324-128">Azure services that can be used within a hybrid application.</span></span> <span data-ttu-id="ec324-129">Ezek a szolgáltatások az interneten keresztül is elérhetők, ExpressRoute-kapcsolatcsoporttal történő használatuk azonban alacsony késést és kiszámíthatóbb teljesítményt biztosít, mert a forgalomnak nem kell áthaladnia az interneten.</span><span class="sxs-lookup"><span data-stu-id="ec324-129">These services are also available over the Internet, but accessing them using an ExpressRoute circuit provides low latency and more predictable performance, because traffic does not go through the Internet.</span></span> <span data-ttu-id="ec324-130">A kapcsolatok [nyilvános társviszony-létesítéssel][expressroute-peering] jönnek létre, és a vállalat tulajdonában álló vagy a kapcsolatszolgáltató által biztosított címeket használják.</span><span class="sxs-lookup"><span data-stu-id="ec324-130">Connections are performed using [public peering][expressroute-peering], with addresses that are either owned by your organization or supplied by your connectivity provider.</span></span>

- <span data-ttu-id="ec324-131">**Office 365-szolgáltatások**.</span><span class="sxs-lookup"><span data-stu-id="ec324-131">**Office 365 services**.</span></span> <span data-ttu-id="ec324-132">A Microsoft által biztosított, nyilvánosan elérhető Office 365-alkalmazások és -szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="ec324-132">The publicly available Office 365 applications and services provided by Microsoft.</span></span> <span data-ttu-id="ec324-133">A kapcsolatok [Microsoft társviszony-létesítéssel][expressroute-peering] jönnek létre, és a vállalat tulajdonában álló vagy a kapcsolatszolgáltató által biztosított címeket használják.</span><span class="sxs-lookup"><span data-stu-id="ec324-133">Connections are performed using [Microsoft peering][expressroute-peering], with addresses that are either owned by your organization or supplied by your connectivity provider.</span></span> <span data-ttu-id="ec324-134">Microsoft társviszony-létesítéssel közvetlenül kapcsolódhat a Microsoft CRM Online szolgáltatáshoz is.</span><span class="sxs-lookup"><span data-stu-id="ec324-134">You can also connect directly to Microsoft CRM Online through Microsoft peering.</span></span>

- <span data-ttu-id="ec324-135">**Kapcsolatszolgáltatók** (nem láthatók).</span><span class="sxs-lookup"><span data-stu-id="ec324-135">**Connectivity providers** (not shown).</span></span> <span data-ttu-id="ec324-136">Olyan vállalatok, amelyek 2. vagy 3. rétegbeli kapcsolattal biztosítják az Ön adatközpontja és egy Azure-adatközpont közötti csatlakozást.</span><span class="sxs-lookup"><span data-stu-id="ec324-136">Companies that provide a connection either using layer 2 or layer 3 connectivity between your datacenter and an Azure datacenter.</span></span>

## <a name="recommendations"></a><span data-ttu-id="ec324-137">Javaslatok</span><span class="sxs-lookup"><span data-stu-id="ec324-137">Recommendations</span></span>

<span data-ttu-id="ec324-138">Az alábbi javaslatok a legtöbb forgatókönyvre vonatkoznak.</span><span class="sxs-lookup"><span data-stu-id="ec324-138">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="ec324-139">Kövesse ezeket a javaslatokat, ha nincsenek ezeket felülíró követelményei.</span><span class="sxs-lookup"><span data-stu-id="ec324-139">Follow these recommendations unless you have a specific requirement that overrides them.</span></span>

### <a name="connectivity-providers"></a><span data-ttu-id="ec324-140">Kapcsolatszolgáltatók</span><span class="sxs-lookup"><span data-stu-id="ec324-140">Connectivity providers</span></span>

<span data-ttu-id="ec324-141">Az adott helynek megfelelő ExpressRoute-kapcsolatszolgáltatót válasszon.</span><span class="sxs-lookup"><span data-stu-id="ec324-141">Select a suitable ExpressRoute connectivity provider for your location.</span></span> <span data-ttu-id="ec324-142">Az Ön helyén elérhető kapcsolatszolgáltatók listájának a lekéréséhez használja az alábbi Azure PowerShell-parancsot:</span><span class="sxs-lookup"><span data-stu-id="ec324-142">To get a list of connectivity providers available at your location, use the following Azure PowerShell command:</span></span>

```powershell
Get-AzureRmExpressRouteServiceProvider
```

<span data-ttu-id="ec324-143">Az ExpressRoute-kapcsolatszolgáltatók az alábbi módokon létesítenek kapcsolatot az Ön adatközpontja és a Microsoft között:</span><span class="sxs-lookup"><span data-stu-id="ec324-143">ExpressRoute connectivity providers connect your datacenter to Microsoft in the following ways:</span></span>

- <span data-ttu-id="ec324-144">**Közös elhelyezés felhőalapú adatcsere keretében**.</span><span class="sxs-lookup"><span data-stu-id="ec324-144">**Co-located at a cloud exchange**.</span></span> <span data-ttu-id="ec324-145">Ha közösen van elhelyezve egy felhőalapú adatcserével rendelkező létesítményben, virtuális keresztkapcsolatokat rendelhet az Azure-hoz a közös környezet szolgáltatójának Ethernet-adatcserélőjén keresztül.</span><span class="sxs-lookup"><span data-stu-id="ec324-145">If you're co-located in a facility with a cloud exchange, you can order virtual cross-connections to Azure through the co-location provider’s Ethernet exchange.</span></span> <span data-ttu-id="ec324-146">A közöskörnyezet-szolgáltatók 2. rétegbeli keresztkapcsolatokat vagy felügyelt, 3. rétegbeli keresztkapcsolatokat kínálnak a közös elhelyezési létesítményben lévő infrastruktúra és az Azure között.</span><span class="sxs-lookup"><span data-stu-id="ec324-146">Co-location providers can offer either layer 2 cross-connections, or managed layer 3 cross-connections between your infrastructure in the co-location facility and Azure.</span></span>
- <span data-ttu-id="ec324-147">**Pontok közötti Ethernet-kapcsolatok**.</span><span class="sxs-lookup"><span data-stu-id="ec324-147">**Point-to-point Ethernet connections**.</span></span> <span data-ttu-id="ec324-148">A helyszíni adatközpontokat/irodákat pontok közötti Ethernet-hivatkozásokon keresztül is csatlakoztathatja az Azure-hoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-148">You can connect your on-premises datacenters/offices to Azure through point-to-point Ethernet links.</span></span> <span data-ttu-id="ec324-149">A pontok közötti Ethernet-szolgáltatók 2. rétegbeli kapcsolatokat vagy felügyelt, 3. rétegbeli kapcsolatokat kínálnak az adott hely és az Azure között.</span><span class="sxs-lookup"><span data-stu-id="ec324-149">Point-to-point Ethernet providers can offer layer 2 connections, or managed layer 3 connections between your site and Azure.</span></span>
- <span data-ttu-id="ec324-150">**Bármely elemek közötti (IPVPN-) hálózatok**.</span><span class="sxs-lookup"><span data-stu-id="ec324-150">**Any-to-any (IPVPN) networks**.</span></span> <span data-ttu-id="ec324-151">Nagykiterjedésű hálózatát (wide area network, WAN) is integrálhatja az Azure-ral.</span><span class="sxs-lookup"><span data-stu-id="ec324-151">You can integrate your wide area network (WAN) with Azure.</span></span> <span data-ttu-id="ec324-152">Az IPVPN-szolgáltatók (jellemzően egy MPLS VPN) bármilyen elemek között létesíthető kapcsolatot kínálnak a fiókirodák és az adatközpontok közötti kapcsolatokhoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-152">Internet protocol virtual private network (IPVPN) providers (typically a multiprotocol label switching VPN) offer any-to-any connectivity between your branch offices and datacenters.</span></span> <span data-ttu-id="ec324-153">Az Azure összekapcsolható a WAN hálózattal, így ugyanúgy jelenik meg, mint bármely másik fiókiroda.</span><span class="sxs-lookup"><span data-stu-id="ec324-153">Azure can be interconnected to your WAN to make it look just like any other branch office.</span></span> <span data-ttu-id="ec324-154">A WAN-szolgáltatók jellemzően 3. rétegbeli felügyelt kapcsolatokat kínálnak.</span><span class="sxs-lookup"><span data-stu-id="ec324-154">WAN providers typically offer managed layer 3 connectivity.</span></span>

<span data-ttu-id="ec324-155">További információ a kapcsolatszolgáltatókról: [ExpressRoute – áttekintés][expressroute-introduction].</span><span class="sxs-lookup"><span data-stu-id="ec324-155">For more information about connectivity providers, see the [ExpressRoute introduction][expressroute-introduction].</span></span>

### <a name="expressroute-circuit"></a><span data-ttu-id="ec324-156">ExpressRoute-kapcsolatcsoport</span><span class="sxs-lookup"><span data-stu-id="ec324-156">ExpressRoute circuit</span></span>

<span data-ttu-id="ec324-157">Gondoskodjon róla, hogy a cég megfeleljen az [ExpressRoute előfeltételeinek][expressroute-prereqs], mert ezek hiányában nem tud az Azure-hoz csatlakozni.</span><span class="sxs-lookup"><span data-stu-id="ec324-157">Ensure that your organization has met the [ExpressRoute prerequisite requirements][expressroute-prereqs] for connecting to Azure.</span></span>

<span data-ttu-id="ec324-158">Ha még nem tette meg, vegyen fel egy `GatewaySubnet` nevű alhálózatot az Azure-beli virtuális hálózatba, és hozzon létre egy ExpressRoute virtuális hálózati átjárót az Azure VPN Gateway szolgáltatással.</span><span class="sxs-lookup"><span data-stu-id="ec324-158">If you haven't already done so, add a subnet named `GatewaySubnet` to your Azure VNet and create an ExpressRoute virtual network gateway using the Azure VPN gateway service.</span></span> <span data-ttu-id="ec324-159">További információ a folyamattal kapcsolatban: [Az ExpressRoute kapcsolatcsoport-kiépítési munkafolyamatai és a kapcsolatcsoportok állapotai][ExpressRoute-provisioning].</span><span class="sxs-lookup"><span data-stu-id="ec324-159">For more information about this process, see [ExpressRoute workflows for circuit provisioning and circuit states][ExpressRoute-provisioning].</span></span>

<span data-ttu-id="ec324-160">Hozzon létre egy ExpressRoute-kapcsolatcsoportot az alábbi lépéseket követve:</span><span class="sxs-lookup"><span data-stu-id="ec324-160">Create an ExpressRoute circuit as follows:</span></span>

1. <span data-ttu-id="ec324-161">Futtassa az alábbi PowerShell-parancsot:</span><span class="sxs-lookup"><span data-stu-id="ec324-161">Run the following PowerShell command:</span></span>

    ```powershell
    New-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>> -Location <<location>> -SkuTier <<sku-tier>> -SkuFamily <<sku-family>> -ServiceProviderName <<service-provider-name>> -PeeringLocation <<peering-location>> -BandwidthInMbps <<bandwidth-in-mbps>>
    ```

2. <span data-ttu-id="ec324-162">Küldje el az új kapcsolatcsoport `ServiceKey` kulcsát a szolgáltatónak.</span><span class="sxs-lookup"><span data-stu-id="ec324-162">Send the `ServiceKey` for the new circuit to the service provider.</span></span>

3. <span data-ttu-id="ec324-163">Várjon, amíg a szolgáltató üzembe helyezi a kapcsolatcsoportot.</span><span class="sxs-lookup"><span data-stu-id="ec324-163">Wait for the provider to provision the circuit.</span></span> <span data-ttu-id="ec324-164">A kapcsolatcsoport üzembehelyezési állapotának az ellenőrzéséhez futtassa az alábbi PowerShell-parancsot:</span><span class="sxs-lookup"><span data-stu-id="ec324-164">To verify the provisioning state of a circuit, run the following PowerShell command:</span></span>

    ```powershell
    Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    ```

    <span data-ttu-id="ec324-165">A kimenet `Service Provider` szakaszának `Provisioning state` mezőjében az állapot `NotProvisioned` állapotról `Provisioned` állapotra változik, ha a kapcsolatcsoport készen áll.</span><span class="sxs-lookup"><span data-stu-id="ec324-165">The `Provisioning state` field in the `Service Provider` section of the output will change from `NotProvisioned` to `Provisioned` when the circuit is ready.</span></span>

    > [!NOTE]
    > <span data-ttu-id="ec324-166">Ha 3. rétegbeli kapcsolatot használ, a szolgáltatónak kell konfigurálnia és felügyelnie az útválasztást Ön helyett.</span><span class="sxs-lookup"><span data-stu-id="ec324-166">If you're using a layer 3 connection, the provider should configure and manage routing for you.</span></span> <span data-ttu-id="ec324-167">Ehhez biztosítania kell a megfelelő útválasztás megvalósításához szükséges információkat a szolgáltatónak.</span><span class="sxs-lookup"><span data-stu-id="ec324-167">You provide the information necessary to enable the provider to implement the appropriate routes.</span></span>
    >
    >

4. <span data-ttu-id="ec324-168">Ha 2. rétegbeli kapcsolatot használ:</span><span class="sxs-lookup"><span data-stu-id="ec324-168">If you're using a layer 2 connection:</span></span>

    1. <span data-ttu-id="ec324-169">Foglaljon le két, érvényes nyilvános IP-címekből álló /30 alhálózatot a megvalósítani kívánt társviszony-létesítések minden típusa számára.</span><span class="sxs-lookup"><span data-stu-id="ec324-169">Reserve two /30 subnets composed of valid public IP addresses for each type of peering you want to implement.</span></span> <span data-ttu-id="ec324-170">Ezen /30 alhálózatok segítségével biztosíthatók az IP-címek a kapcsolatcsoporthoz használt útválasztóknak.</span><span class="sxs-lookup"><span data-stu-id="ec324-170">These /30 subnets will be used to provide IP addresses for the routers used for the circuit.</span></span> <span data-ttu-id="ec324-171">Ha magánhálózati, nyilvános és Microsoft társviszony-létesítést valósít meg, összesen 6, érvényes nyilvános IP-címekkel rendelkező /30 alhálózatra lesz szüksége.</span><span class="sxs-lookup"><span data-stu-id="ec324-171">If you are implementing private, public, and Microsoft peering, you'll need 6 /30 subnets with valid public IP addresses.</span></span>

    2. <span data-ttu-id="ec324-172">Konfigurálja az útválasztást az ExpressRoute-kapcsolatcsoporthoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-172">Configure routing for the ExpressRoute circuit.</span></span> <span data-ttu-id="ec324-173">Futtassa az alábbi PowerShell-parancsokat a konfigurálni kívánt társviszony-létesítések mindegyik típusára (magánhálózati, nyilvános és Microsoft) vonatkozóan.</span><span class="sxs-lookup"><span data-stu-id="ec324-173">Run the following PowerShell commands for each type of peering you want to configure (private, public, and Microsoft).</span></span> <span data-ttu-id="ec324-174">További információt az [ExpressRoute-kapcsolatcsoport útválasztásának létrehozásával és módosításával][configure-expressroute-routing] foglalkozó cikkben talál.</span><span class="sxs-lookup"><span data-stu-id="ec324-174">For more information, see [Create and modify routing for an ExpressRoute circuit][configure-expressroute-routing].</span></span>

        ```powershell
        Set-AzureRmExpressRouteCircuitPeeringConfig -Name <<peering-name>> -Circuit <<circuit-name>> -PeeringType <<peering-type>> -PeerASN <<peer-asn>> -PrimaryPeerAddressPrefix <<primary-peer-address-prefix>> -SecondaryPeerAddressPrefix <<secondary-peer-address-prefix>> -VlanId <<vlan-id>>

        Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit <<circuit-name>>
        ```

    3. <span data-ttu-id="ec324-175">Foglalja le az érvényes nyilvános IP-címek egy másik készletét, amelyet a nyilvános és a Microsoft társviszony-létesítés hálózati címfordításához (network address translation, NAT) fog használni.</span><span class="sxs-lookup"><span data-stu-id="ec324-175">Reserve another pool of valid public IP addresses to use for network address translation (NAT) for public and Microsoft peering.</span></span> <span data-ttu-id="ec324-176">Ajánlott eltérő készleteket használni mindegyik társviszony-létesítéshez.</span><span class="sxs-lookup"><span data-stu-id="ec324-176">It is recommended to have a different pool for each peering.</span></span> <span data-ttu-id="ec324-177">Adja meg a készletet a kapcsolatszolgáltatónak, hogy az konfigurálhassa a Border Gateway Protocol- (BGP-) hirdetéseket az adott tartományok számára.</span><span class="sxs-lookup"><span data-stu-id="ec324-177">Specify the pool to your connectivity provider, so they can configure border gateway protocol (BGP) advertisements for those ranges.</span></span>

5. <span data-ttu-id="ec324-178">Futtassa az alábbi PowerShell-parancsokat, hogy a virtuális magánhálózatot vagy -hálózatokat az ExpressRoute-kapcsolatcsoporthoz csatlakoztassa.</span><span class="sxs-lookup"><span data-stu-id="ec324-178">Run the following PowerShell commands to link your private VNet(s) to the ExpressRoute circuit.</span></span> <span data-ttu-id="ec324-179">További információért tekintése át a [virtuális hálózat ExpressRoute-kapcsolatcsoporttal történő összekapcsolásával][link-vnet-to-expressroute] foglalkozó cikket.</span><span class="sxs-lookup"><span data-stu-id="ec324-179">For more information,see [Link a virtual network to an ExpressRoute circuit][link-vnet-to-expressroute].</span></span>

    ```powershell
    $circuit = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    $gw = Get-AzureRmVirtualNetworkGateway -Name <<gateway-name>> -ResourceGroupName <<resource-group>>
    New-AzureRmVirtualNetworkGatewayConnection -Name <<connection-name>> -ResourceGroupName <<resource-group>> -Location <<location> -VirtualNetworkGateway1 $gw -PeerId $circuit.Id -ConnectionType ExpressRoute
    ```

<span data-ttu-id="ec324-180">Különböző régiókban található virtuális hálózatokat is csatlakoztathat ugyanahhoz az ExpressRoute-kapcsolatcsoporthoz, feltéve, hogy az ExpressRoute-kapcsolatcsoport és a virtuális hálózatok mindegyike ugyanazon geopolitikai régióban található.</span><span class="sxs-lookup"><span data-stu-id="ec324-180">You can connect multiple VNets located in different regions to the same ExpressRoute circuit, as long as all VNets and the ExpressRoute circuit are located within the same geopolitical region.</span></span>

### <a name="troubleshooting"></a><span data-ttu-id="ec324-181">Hibaelhárítás</span><span class="sxs-lookup"><span data-stu-id="ec324-181">Troubleshooting</span></span>

<span data-ttu-id="ec324-182">Ha egy korábban működő ExpressRoute-kapcsolatcsoport többé nem kapcsolódik, és semmilyen konfigurációs módosítást nem hajtott végre a helyszíni vagy a virtuális magánhálózaton, előfordulhat, hogy a kapcsolatszolgáltatóhoz kell fordulnia, és vele együttműködve kell elhárítania a problémát.</span><span class="sxs-lookup"><span data-stu-id="ec324-182">If a previously functioning ExpressRoute circuit now fails to connect, in the absence of any configuration changes on-premises or within your private VNet, you may need to contact the connectivity provider and work with them to correct the issue.</span></span> <span data-ttu-id="ec324-183">A következő PowerShell-parancsok segítségével győződjön meg arról, hogy az ExpressRoute-kapcsolatcsoport kiépítését:</span><span class="sxs-lookup"><span data-stu-id="ec324-183">Use the following PowerShell commands to verify that the ExpressRoute circuit has been provisioned:</span></span>

```powershell
Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
```

<span data-ttu-id="ec324-184">A parancs kimenete a kapcsolatcsoport számos tulajdonságát megjeleníti, ilyen például az alább látható `ProvisioningState`, `CircuitProvisioningState` és `ServiceProviderProvisioningState`.</span><span class="sxs-lookup"><span data-stu-id="ec324-184">The output of this command shows several properties for your circuit, including `ProvisioningState`, `CircuitProvisioningState`, and `ServiceProviderProvisioningState` as shown below.</span></span>

```powershell
ProvisioningState                : Succeeded
Sku                              : {
                                     "Name": "Standard_MeteredData",
                                     "Tier": "Standard",
                                     "Family": "MeteredData"
                                   }
CircuitProvisioningState         : Enabled
ServiceProviderProvisioningState : NotProvisioned
```

<span data-ttu-id="ec324-185">Ha a `ProvisioningState` értéke nem `Succeeded` lesz, miután megpróbált létrehozni egy új kapcsolatcsoportot, távolítsa el a kapcsolatcsoportot az alábbi paranccsal, és próbálkozzon újra a létrehozásával.</span><span class="sxs-lookup"><span data-stu-id="ec324-185">If the `ProvisioningState` is not set to `Succeeded` after you tried to create a new circuit, remove the circuit by using the command below and try to create it again.</span></span>

```powershell
Remove-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
```

<span data-ttu-id="ec324-186">Ha a szolgáltató már üzembe helyezte a kapcsolatcsoportot, és a `ProvisioningState` értéke `Failed`, vagy a `CircuitProvisioningState` értéke nem `Enabled`, a szolgáltatótól kérhet további segítséget.</span><span class="sxs-lookup"><span data-stu-id="ec324-186">If your provider had already provisioned the circuit, and the `ProvisioningState` is set to `Failed`, or the `CircuitProvisioningState` is not `Enabled`, contact your provider for further assistance.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="ec324-187">Méretezési szempontok</span><span class="sxs-lookup"><span data-stu-id="ec324-187">Scalability considerations</span></span>

<span data-ttu-id="ec324-188">Az ExpressRoute-kapcsolatcsoportok nagy sávszélességű útvonalat biztosítanak a hálózatok között.</span><span class="sxs-lookup"><span data-stu-id="ec324-188">ExpressRoute circuits provide a high bandwidth path between networks.</span></span> <span data-ttu-id="ec324-189">Általánosságban elmondható, hogy minél nagyobb a sávszélesség, annál nagyobb a költség.</span><span class="sxs-lookup"><span data-stu-id="ec324-189">Generally, the higher the bandwidth the greater the cost.</span></span>

<span data-ttu-id="ec324-190">Az ExpressRoute két [díjszabási csomagot][expressroute-pricing] kínál, amelyek közül az egyik forgalmi díjas, a másik pedig korlátlan adatforgalmú.</span><span class="sxs-lookup"><span data-stu-id="ec324-190">ExpressRoute offers two [pricing plans][expressroute-pricing] to customers, a metered plan and an unlimited data plan.</span></span> <span data-ttu-id="ec324-191">A díjak a kapcsolatcsoport sávszélességétől függően változnak.</span><span class="sxs-lookup"><span data-stu-id="ec324-191">Charges vary according to circuit bandwidth.</span></span> <span data-ttu-id="ec324-192">A rendelkezésre álló sávszélesség nagy valószínűséggel szolgáltatónként eltérő lesz.</span><span class="sxs-lookup"><span data-stu-id="ec324-192">Available bandwidth will likely vary from provider to provider.</span></span> <span data-ttu-id="ec324-193">A `Get-AzureRmExpressRouteServiceProvider` parancsmaggal tekintheti át az adott régióban elérhető szolgáltatókat és az általuk kínált sávszélességet.</span><span class="sxs-lookup"><span data-stu-id="ec324-193">Use the `Get-AzureRmExpressRouteServiceProvider` cmdlet to see the providers available in your region and the bandwidths that they offer.</span></span>

<span data-ttu-id="ec324-194">Egy ExpressRoute-kapcsolatcsoport adott számú társviszony-létesítés és virtuális hálózati kapcsolat támogatására képes.</span><span class="sxs-lookup"><span data-stu-id="ec324-194">A single ExpressRoute circuit can support a certain number of peerings and VNet links.</span></span> <span data-ttu-id="ec324-195">További információt az [ExpressRoute-ra vonatkozó korlátozásokkal](/azure/azure-subscription-service-limits) foglalkozó cikkben talál.</span><span class="sxs-lookup"><span data-stu-id="ec324-195">See [ExpressRoute limits](/azure/azure-subscription-service-limits) for more information.</span></span>

<span data-ttu-id="ec324-196">Felár ellenében az ExpressRoute Prémium bővítménye további képességeket biztosít:</span><span class="sxs-lookup"><span data-stu-id="ec324-196">For an extra charge, the ExpressRoute Premium add-on provides some additional capability:</span></span>

- <span data-ttu-id="ec324-197">Magasabb útvonalkorlát, amely a nyilvános és a magánhálózati társviszony-létesítésekre is vonatkozik.</span><span class="sxs-lookup"><span data-stu-id="ec324-197">Increased route limits for public and private peering.</span></span>
- <span data-ttu-id="ec324-198">Több virtuális hálózati kapcsolat ExpressRoute-kapcsolatcsoportonként.</span><span class="sxs-lookup"><span data-stu-id="ec324-198">Increased number of VNet links per ExpressRoute circuit.</span></span>
- <span data-ttu-id="ec324-199">Globális kapcsolódás a szolgáltatásokhoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-199">Global connectivity for services.</span></span>

<span data-ttu-id="ec324-200">További információ: [ExpressRoute – díjszabás][expressroute-pricing].</span><span class="sxs-lookup"><span data-stu-id="ec324-200">See [ExpressRoute pricing][expressroute-pricing] for details.</span></span>

<span data-ttu-id="ec324-201">Az ExpressRoute-kapcsolatcsoportok úgy vannak kialakítva, hogy felár nélkül is lehetővé tegyék a hálózati forgalom átmeneti növelését a megvásárolt sávszélesség legfeljebb kétszereséig.</span><span class="sxs-lookup"><span data-stu-id="ec324-201">ExpressRoute circuits are designed to allow temporary network bursts up to two times the bandwidth limit that you procured for no additional cost.</span></span> <span data-ttu-id="ec324-202">Ez redundáns kapcsolatok használatával érhető el,</span><span class="sxs-lookup"><span data-stu-id="ec324-202">This is achieved by using redundant links.</span></span> <span data-ttu-id="ec324-203">de nem mindegyik kapcsolatszolgáltató támogatja ezt a funkciót.</span><span class="sxs-lookup"><span data-stu-id="ec324-203">However, not all connectivity providers support this feature.</span></span> <span data-ttu-id="ec324-204">Ha úgy gondolja, hogy szüksége lenne rá, mindenképpen ellenőrizze, hogy a kapcsolatszolgáltató engedélyezi-e a funkció használatát.</span><span class="sxs-lookup"><span data-stu-id="ec324-204">Verify that your connectivity provider enables this feature before depending on it.</span></span>

<span data-ttu-id="ec324-205">Jóllehet egyes szolgáltatók engedélyezik a sávszélesség módosítását, mindenképpen olyan kezdeti sávszélességet válasszon, amely meghaladja az igényeit, és teret hagy a növekedésre.</span><span class="sxs-lookup"><span data-stu-id="ec324-205">Although some providers allow you to change your bandwidth, make sure you pick an initial bandwidth that surpasses your needs and provides room for growth.</span></span> <span data-ttu-id="ec324-206">Ha a jövőben növelnie kell a sávszélességet, mindössze két lehetőség áll a rendelkezésére:</span><span class="sxs-lookup"><span data-stu-id="ec324-206">If you need to increase bandwidth in the future, you are left with two options:</span></span>

- <span data-ttu-id="ec324-207">Növelheti a sávszélességet.</span><span class="sxs-lookup"><span data-stu-id="ec324-207">Increase the bandwidth.</span></span> <span data-ttu-id="ec324-208">Lehetőség szerint kerülje ezt a megoldást, mert nem minden szolgáltató teszi lehetővé a sávszélesség dinamikus növelését.</span><span class="sxs-lookup"><span data-stu-id="ec324-208">You should avoid this option as much as possible, and not all providers allow you to increase bandwidth dynamically.</span></span> <span data-ttu-id="ec324-209">De ha mindenképpen szükség van, egyeztessen a szolgáltatóval, hogy változó ExpressRoute sávszélesség tulajdonságok PowerShell parancsaival támogatja-e.</span><span class="sxs-lookup"><span data-stu-id="ec324-209">But if a bandwidth increase is needed, check with your provider to verify they support changing ExpressRoute bandwidth properties via PowerShell commands.</span></span> <span data-ttu-id="ec324-210">Ha támogatja, akkor futtassa az alábbi parancsokat.</span><span class="sxs-lookup"><span data-stu-id="ec324-210">If they do, run the commands below.</span></span>

    ```powershell
    $ckt = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>
    $ckt.ServiceProviderProperties.BandwidthInMbps = <<bandwidth-in-mbps>>
    Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit $ckt
    ```

    <span data-ttu-id="ec324-211">A sávszélességet a kapcsolat megszakadása nélkül növelheti.</span><span class="sxs-lookup"><span data-stu-id="ec324-211">You can increase the bandwidth without loss of connectivity.</span></span> <span data-ttu-id="ec324-212">A sávszélesség csökkentése azonban a kapcsolat megszakadását eredményezi, mert törölnie kell a kapcsolatcsoportot, és újra létre kell hoznia az új konfigurációval.</span><span class="sxs-lookup"><span data-stu-id="ec324-212">Downgrading the bandwidth will result in disruption in connectivity, because you must delete the circuit and recreate it with the new configuration.</span></span>

- <span data-ttu-id="ec324-213">Módosíthatja a díjcsomagot és/vagy Prémium csomagra válthat.</span><span class="sxs-lookup"><span data-stu-id="ec324-213">Change your pricing plan and/or upgrade to Premium.</span></span> <span data-ttu-id="ec324-214">Ehhez futtassa az alábbi parancsokat.</span><span class="sxs-lookup"><span data-stu-id="ec324-214">To do so, run the following commands.</span></span> <span data-ttu-id="ec324-215">Az `Sku.Tier` tulajdonság `Standard` vagy `Premium` lehet, az `Sku.Name` tulajdonság pedig `MeteredData` vagy `UnlimitedData`.</span><span class="sxs-lookup"><span data-stu-id="ec324-215">The `Sku.Tier` property can be `Standard` or `Premium`; the `Sku.Name` property can be `MeteredData` or `UnlimitedData`.</span></span>

    ```powershell
    $ckt = Get-AzureRmExpressRouteCircuit -Name <<circuit-name>> -ResourceGroupName <<resource-group>>

    $ckt.Sku.Tier = "Premium"
    $ckt.Sku.Family = "MeteredData"
    $ckt.Sku.Name = "Premium_MeteredData"

    Set-AzureRmExpressRouteCircuit -ExpressRouteCircuit $ckt
    ```

    > [!IMPORTANT]
    > <span data-ttu-id="ec324-216">Az `Sku.Name` tulajdonságnak egyeznie kell az `Sku.Tier` és az `Sku.Family` tulajdonsággal.</span><span class="sxs-lookup"><span data-stu-id="ec324-216">Make sure the `Sku.Name` property matches the `Sku.Tier` and `Sku.Family`.</span></span> <span data-ttu-id="ec324-217">Ha módosítja a családot és a szintet, a nevet azonban nem, a rendszer letiltja a kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="ec324-217">If you change the family and tier, but not the name, your connection will be disabled.</span></span>
    >
    >

    <span data-ttu-id="ec324-218">A termékváltozat a kapcsolat megszakadása nélkül módosítható magasabb szintűre, de a korlátlan díjcsomagot nem módosíthatja forgalmi díjas csomagra.</span><span class="sxs-lookup"><span data-stu-id="ec324-218">You can upgrade the SKU without disruption, but you cannot switch from the unlimited pricing plan to metered.</span></span> <span data-ttu-id="ec324-219">Ha a termékváltozatot alacsonyabb szintre módosítja, a sávszélesség-használatnak a standard termékváltozat alapértelmezett korlátozásán belül kell maradnia.</span><span class="sxs-lookup"><span data-stu-id="ec324-219">When downgrading the SKU, your bandwidth consumption must remain within the default limit of the standard SKU.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="ec324-220">Rendelkezésre állási szempontok</span><span class="sxs-lookup"><span data-stu-id="ec324-220">Availability considerations</span></span>

<span data-ttu-id="ec324-221">Az ExpressRoute nem támogatja az útválasztó-redundancia protokollokat (amilyen például a Hot Standby Routing Protocol (HSRP) és a Virtual Router Redundancy Protocol (VRRP)) a magas rendelkezésre állás megvalósításához.</span><span class="sxs-lookup"><span data-stu-id="ec324-221">ExpressRoute does not support router redundancy protocols such as hot standby routing protocol (HSRP) and virtual router redundancy protocol (VRRP) to implement high availability.</span></span> <span data-ttu-id="ec324-222">Helyettük a társviszonyonként meglévő BGP-munkamenetek redundáns párját használja.</span><span class="sxs-lookup"><span data-stu-id="ec324-222">Instead, it uses a redundant pair of BGP sessions per peering.</span></span> <span data-ttu-id="ec324-223">A hálózattal létesített magas rendelkezésre állású kapcsolatok elősegítése érdekében az Azure két redundáns portot biztosít két útválasztón (amelyek a Microsoft-peremhálózat részei) egy aktív-aktív konfigurációban.</span><span class="sxs-lookup"><span data-stu-id="ec324-223">To facilitate highly-available connections to your network, Azure provisions you with two redundant ports on two routers (part of the Microsoft edge) in an active-active configuration.</span></span>

<span data-ttu-id="ec324-224">Alapértelmezés szerint a BGP-munkamenetek üresjárati időkorlátja 60 másodperc.</span><span class="sxs-lookup"><span data-stu-id="ec324-224">By default, BGP sessions use an idle timeout value of 60 seconds.</span></span> <span data-ttu-id="ec324-225">Ha egy munkamenet háromszor túllépi az időkorlátot (összesen 180 másodperc), a rendszer rendelkezésre nem állóként jelöli meg az útválasztót, és minden forgalmat a fennmaradó útválasztóra irányít át.</span><span class="sxs-lookup"><span data-stu-id="ec324-225">If a session times out three times (180 seconds total), the router is marked as unavailable, and all traffic is redirected to the remaining router.</span></span> <span data-ttu-id="ec324-226">Előfordulhat, hogy ez a 180 másodperces időkorlát túl hosszú, ha kritikus alkalmazásokról van szó.</span><span class="sxs-lookup"><span data-stu-id="ec324-226">This 180-second timeout might be too long for critical applications.</span></span> <span data-ttu-id="ec324-227">Ilyenkor módosíthatja a BGP üresjárati beállításait a helyszíni útválasztón egy kisebb értékre.</span><span class="sxs-lookup"><span data-stu-id="ec324-227">If so, you can change your BGP time-out settings on the on-premises router to a smaller value.</span></span>

<span data-ttu-id="ec324-228">Az Azure-kapcsolat magas rendelkezésre állását különböző módokon konfigurálhatja, a használt szolgáltató típusától, valamint a konfigurálni kívánt ExpressRoute-kapcsolatcsoportok és virtuális hálózati átjárókapcsolatok számától függően.</span><span class="sxs-lookup"><span data-stu-id="ec324-228">You can configure high availability for your Azure connection in different ways, depending on the type of provider you use, and the number of ExpressRoute circuits and virtual network gateway connections you're willing to configure.</span></span> <span data-ttu-id="ec324-229">Az alábbiakban a rendelkezésre állással kapcsolatos lehetőségeket foglaljuk össze:</span><span class="sxs-lookup"><span data-stu-id="ec324-229">The following summarizes your availability options:</span></span>

- <span data-ttu-id="ec324-230">Ha 2. rétegbeli kapcsolatot használ, helyezzen üzembe redundáns útválasztókat a helyszíni hálózaton egy aktív-aktív konfigurációban.</span><span class="sxs-lookup"><span data-stu-id="ec324-230">If you're using a layer 2 connection, deploy redundant routers in your on-premises network in an active-active configuration.</span></span> <span data-ttu-id="ec324-231">Csatlakoztassa az elsődleges kapcsolatcsoportot az egyik útválasztóhoz, a másodlagos kapcsolatcsoportot pedig a másikhoz.</span><span class="sxs-lookup"><span data-stu-id="ec324-231">Connect the primary circuit to one router, and the secondary circuit to the other.</span></span> <span data-ttu-id="ec324-232">Így magas rendelkezésre állású kapcsolattal fog rendelkezni a kapcsolat mindkét végén.</span><span class="sxs-lookup"><span data-stu-id="ec324-232">This will give you a highly available connection at both ends of the connection.</span></span> <span data-ttu-id="ec324-233">Erre akkor van szükség, ha ExpressRoute szolgáltatói szerződést (SLA) igényel.</span><span class="sxs-lookup"><span data-stu-id="ec324-233">This is necessary if you require the ExpressRoute service level agreement (SLA).</span></span> <span data-ttu-id="ec324-234">További információt az [Azure ExpressRoute-ra vonatkozó szolgáltatói szerződést][sla-for-expressroute] ismertető cikkben talál.</span><span class="sxs-lookup"><span data-stu-id="ec324-234">See [SLA for Azure ExpressRoute][sla-for-expressroute] for details.</span></span>

    <span data-ttu-id="ec324-235">Az alábbi ábrán az a konfiguráció látható, amely elsődleges és a másodlagos kapcsolatcsoporthoz csatlakoztatott redundáns helyszíni útválasztókból áll.</span><span class="sxs-lookup"><span data-stu-id="ec324-235">The following diagram shows a configuration with redundant on-premises routers connected to the primary and secondary circuits.</span></span> <span data-ttu-id="ec324-236">Az egyes kapcsolatcsoportok egy nyilvános és egy magánhálózati társviszony-létesítés forgalmát kezelik (mindegyik társviszony-létesítés számára ki lett jelölve egy pár /30 címtér az előző szakaszban leírtak szerint).</span><span class="sxs-lookup"><span data-stu-id="ec324-236">Each circuit handles the traffic for a public peering and a private peering (each peering is designated a pair of /30 address spaces, as described in the previous section).</span></span>

    <span data-ttu-id="ec324-237">![[1]][1]</span><span class="sxs-lookup"><span data-stu-id="ec324-237">![[1]][1]</span></span>

- <span data-ttu-id="ec324-238">Ha 3. rétegbeli kapcsolatot használ, ellenőrizze, hogy az biztosít-e a rendelkezésre állást Ön helyett kezelő redundáns BGP-munkameneteket.</span><span class="sxs-lookup"><span data-stu-id="ec324-238">If you're using a layer 3 connection, verify that it provides redundant BGP sessions that handle availability for you.</span></span>

- <span data-ttu-id="ec324-239">Csatlakoztassa a virtuális hálózatot több ExpressRoute-kapcsolatcsoporthoz, amelyet különböző szolgáltatók biztosítanak.</span><span class="sxs-lookup"><span data-stu-id="ec324-239">Connect the VNet to multiple ExpressRoute circuits, supplied by different service providers.</span></span> <span data-ttu-id="ec324-240">Ez a stratégia fokozza a magas rendelkezésre állást, és vészhelyreállítási képességeket is biztosít.</span><span class="sxs-lookup"><span data-stu-id="ec324-240">This strategy provides additional high-availability and disaster recovery capabilities.</span></span>

- <span data-ttu-id="ec324-241">Konfiguráljon helyek közötti VPN-t feladatátvételi útvonalként az ExpressRoute számára.</span><span class="sxs-lookup"><span data-stu-id="ec324-241">Configure a site-to-site VPN as a failover path for ExpressRoute.</span></span> <span data-ttu-id="ec324-242">Ezzel a lehetőséggel az a cikk foglalkozik bővebben, amely a [helyszíni hálózat és az Azure VPN-feladatátvételt biztosító ExpressRoute használatával történő csatlakoztatását][highly-available-network-architecture] ismerteti.</span><span class="sxs-lookup"><span data-stu-id="ec324-242">For more about this option, see [Connect an on-premises network to Azure using ExpressRoute with VPN failover][highly-available-network-architecture].</span></span> <span data-ttu-id="ec324-243">A lehetőség csak magánhálózati társviszony-létesítések esetén érhető el.</span><span class="sxs-lookup"><span data-stu-id="ec324-243">This option only applies to private peering.</span></span> <span data-ttu-id="ec324-244">Azure- és Office 365-szolgáltatások esetében az internet az egyedüli feladatátvételi útvonal.</span><span class="sxs-lookup"><span data-stu-id="ec324-244">For Azure and Office 365 services, the Internet is the only failover path.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="ec324-245">Felügyeleti szempontok</span><span class="sxs-lookup"><span data-stu-id="ec324-245">Manageability considerations</span></span>

<span data-ttu-id="ec324-246">Az [Azure Connectivity Toolkit (AzureCT)][azurect] eszközzel monitorozhatja a helyszíni adatközpont és az Azure közötti kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="ec324-246">You can use the [Azure Connectivity Toolkit (AzureCT)][azurect] to monitor connectivity between your on-premises datacenter and Azure.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="ec324-247">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="ec324-247">Security considerations</span></span>

<span data-ttu-id="ec324-248">Az Azure-kapcsolat biztonsági beállításait különböző módokon konfigurálhatja a biztonsági megfontolásoktól és a megfelelőségi igényektől függően.</span><span class="sxs-lookup"><span data-stu-id="ec324-248">You can configure security options for your Azure connection in different ways, depending on your security concerns and compliance needs.</span></span>

<span data-ttu-id="ec324-249">Az ExpressRoute a 3. rétegben működik.</span><span class="sxs-lookup"><span data-stu-id="ec324-249">ExpressRoute operates in layer 3.</span></span> <span data-ttu-id="ec324-250">Az alkalmazásréteget fenyegető kockázatok egy olyan hálózati biztonsági berendezéssel előzhetők meg, amely megbízható erőforrásokra korlátozza a forgalmat.</span><span class="sxs-lookup"><span data-stu-id="ec324-250">Threats in the application layer can be prevented by using a network security appliance that restricts traffic to legitimate resources.</span></span> <span data-ttu-id="ec324-251">A nyilvános társviszony-létesítést használó ExpressRoute-kapcsolatok emellett csak a helyszínről kezdeményezhetők.</span><span class="sxs-lookup"><span data-stu-id="ec324-251">Additionally, ExpressRoute connections using public peering can only be initiated from on-premises.</span></span> <span data-ttu-id="ec324-252">Ez meggátolja a rosszindulatú szolgáltatásokat abban, hogy az internetről hozzáférhessenek a helyszíni adatokhoz, és jogtalanul felhasználják azokat.</span><span class="sxs-lookup"><span data-stu-id="ec324-252">This prevents a rogue service from accessing and compromising on-premises data from the Internet.</span></span>

<span data-ttu-id="ec324-253">A biztonság maximalizálása érdekében a hálózati biztonsági berendezéseket a helyszíni hálózat és a szolgáltató peremhálózati útválasztói között helyezze üzembe.</span><span class="sxs-lookup"><span data-stu-id="ec324-253">To maximize security, add network security appliances between the on-premises network and the provider edge routers.</span></span> <span data-ttu-id="ec324-254">Így könnyebben korlátozható a virtuális hálózatról érkező jogosulatlan forgalom:</span><span class="sxs-lookup"><span data-stu-id="ec324-254">This will help to restrict the inflow of unauthorized traffic from the VNet:</span></span>

<span data-ttu-id="ec324-255">![[2]][2]</span><span class="sxs-lookup"><span data-stu-id="ec324-255">![[2]][2]</span></span>

<span data-ttu-id="ec324-256">Naplózási vagy megfelelőségi okokból szükség lehet a virtuális hálózaton futó összetevők közvetlen internet-hozzáférésének a letiltására, valamint a [kényszerített bújtatás][forced-tunneling] megvalósítására.</span><span class="sxs-lookup"><span data-stu-id="ec324-256">For auditing or compliance purposes, it may be necessary to prohibit direct access from components running in the VNet to the Internet and implement [forced tunneling][forced-tunneling].</span></span> <span data-ttu-id="ec324-257">Ebben az esetben az internetes forgalmat át kell irányítani, naplózható a helyszínen futó proxyra.</span><span class="sxs-lookup"><span data-stu-id="ec324-257">In this situation, Internet traffic should be redirected back through a proxy running on-premises where it can be audited.</span></span> <span data-ttu-id="ec324-258">A proxy konfigurálható a nem engedélyezett forgalom kijutásának a megakadályozására és az esetlegesen rosszindulatú bejövő forgalom szűrésére.</span><span class="sxs-lookup"><span data-stu-id="ec324-258">The proxy can be configured to block unauthorized traffic flowing out, and filter potentially malicious inbound traffic.</span></span>

<span data-ttu-id="ec324-259">![[3]][3]</span><span class="sxs-lookup"><span data-stu-id="ec324-259">![[3]][3]</span></span>

<span data-ttu-id="ec324-260">A biztonság maximalizálása érdekében ne engedélyezze nyilvános IP-címek használatát a virtuális gépek számára, és NSG-k használatával biztosítsa, hogy a virtuális gépek ne lehessenek nyilvánosan elérhetők.</span><span class="sxs-lookup"><span data-stu-id="ec324-260">To maximize security, do not enable a public IP address for your VMs, and use NSGs to ensure that these VMs aren't publicly accessible.</span></span> <span data-ttu-id="ec324-261">Gondoskodni kell arról, hogy a virtuális gépeket csak a belső IP-címekkel lehessen elérni.</span><span class="sxs-lookup"><span data-stu-id="ec324-261">VMs should only be available using the internal IP address.</span></span> <span data-ttu-id="ec324-262">Ezek a címek az ExpressRoute-hálózaton keresztül tehetők elérhetővé, ami lehetővé teszi a helyszíni fejlesztési és üzemeltetési csapat számára a konfigurálást vagy a karbantartást.</span><span class="sxs-lookup"><span data-stu-id="ec324-262">These addresses can be made accessible through the ExpressRoute network, enabling on-premises DevOps staff to perform configuration or maintenance.</span></span>

<span data-ttu-id="ec324-263">Ha a virtuális gépek felügyeleti végpontjait egy külső hálózaton kell közzétennie, NSG-k vagy hozzáférés-vezérlési listák használatával korlátozhatja az érintett portok láthatóságát az engedélyezett IP-címekre vagy hálózatokra.</span><span class="sxs-lookup"><span data-stu-id="ec324-263">If you must expose management endpoints for VMs to an external network, use NSGs or access control lists to restrict the visibility of these ports to a whitelist of IP addresses or networks.</span></span>

> [!NOTE]
> <span data-ttu-id="ec324-264">Az Azure Portal használatával üzembe helyezett Azure-beli virtuális gépek alapértelmezés szerint egy nyilvános IP-címet tartalmaznak, amely lehetővé teszi a bejelentkezésen alapuló hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="ec324-264">By default, Azure VMs deployed through the Azure portal include a public IP address that provides login access.</span></span>
>

## <a name="deploy-the-solution"></a><span data-ttu-id="ec324-265">A megoldás üzembe helyezése</span><span class="sxs-lookup"><span data-stu-id="ec324-265">Deploy the solution</span></span>

<span data-ttu-id="ec324-266">**Előfeltételek**.</span><span class="sxs-lookup"><span data-stu-id="ec324-266">**Prerequisites**.</span></span> <span data-ttu-id="ec324-267">Rendelkeznie kell egy megfelelő hálózati berendezéssel konfigurált meglévő helyszíni infrastruktúrával.</span><span class="sxs-lookup"><span data-stu-id="ec324-267">You must have an existing on-premises infrastructure already configured with a suitable network appliance.</span></span>

<span data-ttu-id="ec324-268">A megoldás üzembe helyezéséhez hajtsa végre az alábbi lépéseket.</span><span class="sxs-lookup"><span data-stu-id="ec324-268">To deploy the solution, perform the following steps.</span></span>

<!-- markdownlint-disable MD033 -->

1. <span data-ttu-id="ec324-269">Kattintson az alábbi gombra:</span><span class="sxs-lookup"><span data-stu-id="ec324-269">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fhybrid-networking%2Fexpressroute%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>

2. <span data-ttu-id="ec324-270">Várja meg, amíg a hivatkozás megnyílik az Azure Portalon, majd kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="ec324-270">Wait for the link to open in the Azure portal, then follow these steps:</span></span>
   - <span data-ttu-id="ec324-271">Az **Erőforráscsoport** neve már meg van adva a paraméterfájlban, ezért válassza az **Új létrehozása** lehetőséget és a szövegmezőbe írja az `ra-hybrid-er-rg` karakterláncot.</span><span class="sxs-lookup"><span data-stu-id="ec324-271">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-hybrid-er-rg` in the text box.</span></span>
   - <span data-ttu-id="ec324-272">Válassza ki a régiót a **Hely** legördülő listából.</span><span class="sxs-lookup"><span data-stu-id="ec324-272">Select the region from the **Location** drop down box.</span></span>
   - <span data-ttu-id="ec324-273">Ne szerkessze a **Sablon gyökér szintű URI-je** vagy a **Paraméter gyökér szintű URI-je** szövegmezőt.</span><span class="sxs-lookup"><span data-stu-id="ec324-273">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   - <span data-ttu-id="ec324-274">Tekintse át a használati feltételeket, majd kattintson az **Elfogadom a fenti feltételeket** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="ec324-274">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   - <span data-ttu-id="ec324-275">Kattintson a **Vásárlás** gombra.</span><span class="sxs-lookup"><span data-stu-id="ec324-275">Click the **Purchase** button.</span></span>

3. <span data-ttu-id="ec324-276">Várjon, amíg az üzembe helyezés befejeződik.</span><span class="sxs-lookup"><span data-stu-id="ec324-276">Wait for the deployment to complete.</span></span>

4. <span data-ttu-id="ec324-277">Kattintson az alábbi gombra:</span><span class="sxs-lookup"><span data-stu-id="ec324-277">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fhybrid-networking%2Fexpressroute%2Fazuredeploy-expressRouteCircuit.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>

5. <span data-ttu-id="ec324-278">Várja meg, amíg a hivatkozás megnyílik az Azure Portalon, majd kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="ec324-278">Wait for the link to open in the Azure portal, then follow these steps:</span></span>
   - <span data-ttu-id="ec324-279">Válassza az **Erőforráscsoport** szakasz **Meglévő használata** elemét, és írja be az `ra-hybrid-er-rg` karakterláncot a szövegmezőbe.</span><span class="sxs-lookup"><span data-stu-id="ec324-279">Select **Use existing** in the **Resource group** section and enter `ra-hybrid-er-rg` in the text box.</span></span>
   - <span data-ttu-id="ec324-280">Válassza ki a régiót a **Hely** legördülő listából.</span><span class="sxs-lookup"><span data-stu-id="ec324-280">Select the region from the **Location** drop down box.</span></span>
   - <span data-ttu-id="ec324-281">Ne szerkessze a **Sablon gyökér szintű URI-je** vagy a **Paraméter gyökér szintű URI-je** szövegmezőt.</span><span class="sxs-lookup"><span data-stu-id="ec324-281">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   - <span data-ttu-id="ec324-282">Tekintse át a használati feltételeket, majd kattintson az **Elfogadom a fenti feltételeket** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="ec324-282">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   - <span data-ttu-id="ec324-283">Kattintson a **Vásárlás** gombra.</span><span class="sxs-lookup"><span data-stu-id="ec324-283">Click the **Purchase** button.</span></span>

6. <span data-ttu-id="ec324-284">Várjon, amíg az üzembe helyezés befejeződik.</span><span class="sxs-lookup"><span data-stu-id="ec324-284">Wait for the deployment to complete.</span></span>

<!-- markdownlint-enable MD033 -->

<!-- links -->

[forced-tunneling]: ../dmz/secure-vnet-hybrid.md
[highly-available-network-architecture]: ./expressroute-vpn-failover.md

[expressroute-technical-overview]: /azure/expressroute/expressroute-introduction
[expressroute-prereqs]: /azure/expressroute/expressroute-prerequisites
[configure-expressroute-routing]: /azure/expressroute/expressroute-howto-routing-arm
[sla-for-expressroute]: https://azure.microsoft.com/support/legal/sla/expressroute
[link-vnet-to-expressroute]: /azure/expressroute/expressroute-howto-linkvnet-arm
[ExpressRoute-provisioning]: /azure/expressroute/expressroute-workflows
[expressroute-introduction]: /azure/expressroute/expressroute-introduction
[expressroute-peering]: /azure/expressroute/expressroute-circuit-peerings
[expressroute-pricing]: https://azure.microsoft.com/pricing/details/expressroute/
[expressroute-limits]: /azure/azure-subscription-service-limits#networking-limits
[azurect]: https://github.com/Azure/NetworkMonitoring/tree/master/AzureCT
[visio-download]: https://archcenter.blob.core.windows.net/cdn/hybrid-network-architectures.vsdx
[er-circuit-parameters]: https://github.com/mspnp/reference-architectures/tree/master/hybrid-networking/expressroute/parameters/expressRouteCircuit.parameters.json
[azure-powershell-download]: /powershell/azure/overview
[azure-cli]: /cli/azure/install-azure-cli

[0]: ./images/expressroute.png "Hibrid hálózati architektúra az Azure ExpressRoute használatával"
[1]: ../_images/guidance-hybrid-network-expressroute/figure2.png "Redundáns útválasztók használata elsődleges és másodlagos ExpressRoute-kapcsolatcsoportokkal"
[2]: ../_images/guidance-hybrid-network-expressroute/figure3.png "Biztonsági eszközök hozzáadása a helyszíni hálózathoz"
[3]: ../_images/guidance-hybrid-network-expressroute/figure4.png "Kényszerített bújtatás használata az internetes forgalom naplózására"
[4]: ../_images/guidance-hybrid-network-expressroute/figure5.png "ExpressRoute-kapcsolatcsoport ServiceKey kulcsának megkeresése"
