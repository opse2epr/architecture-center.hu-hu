---
title: AD DS-erőforráserdő létrehozása az Azure-ban
description: >-
  Megbízható Active Directory-tartomány létrehozása az Azure-ban.

  guidance,vpn-gateway,expressroute,load-balancer,virtual-network,active-directory
author: telmosampaio
ms.date: 11/28/2016
pnp.series.title: Identity management
pnp.series.prev: adds-extend-domain
pnp.series.next: adfs
cardTitle: Create an AD DS forest in Azure
ms.openlocfilehash: e32a6420821e70c84e77d2c39614f0c45efbb7e2
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/06/2018
---
# <a name="create-an-active-directory-domain-services-ad-ds-resource-forest-in-azure"></a><span data-ttu-id="ae7e5-104">Active Directory Domain Services- (AD DS-) erőforráserdő létrehozása az Azure-ban</span><span class="sxs-lookup"><span data-stu-id="ae7e5-104">Create an Active Directory Domain Services (AD DS) resource forest in Azure</span></span>

<span data-ttu-id="ae7e5-105">A referenciaarchitektúra bemutatja, hogyan hozható létre egy külön Active Directory-tartomány az Azure-ban, amelyet a helyszíni AD-erdőben található tartományok megbízhatónak tekintenek.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-105">This reference architecture shows how to create a separate Active Directory domain in Azure that is trusted by domains in your on-premises AD forest.</span></span> [<span data-ttu-id="ae7e5-106">**A megoldás üzembe helyezése**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-106">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="ae7e5-107">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="ae7e5-107">[![0]][0]</span></span> 

<span data-ttu-id="ae7e5-108">*Töltse le az architektúra [Visio-fájlját][visio-download].*</span><span class="sxs-lookup"><span data-stu-id="ae7e5-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

<span data-ttu-id="ae7e5-109">Az Active Directory Domain Services (AD DS) hierarchikus struktúrában tárolja az identitásadatokat.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-109">Active Directory Domain Services (AD DS) stores identity information in a hierarchical structure.</span></span> <span data-ttu-id="ae7e5-110">A hierarchikus struktúra legfelső szintű csomópontját erdőnek hívják.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-110">The top node in the hierarchical structure is known as a forest.</span></span> <span data-ttu-id="ae7e5-111">Az erdő tartományokat, a tartományok pedig egyéb típusú objektumokat tartalmaznak.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-111">A forest contains domains, and domains contain other types of objects.</span></span> <span data-ttu-id="ae7e5-112">Ez a referenciaarchitektúra egy AD DS-erdőt hoz létre az Azure-ban, amely egyirányú kimenő bizalmi kapcsolattal rendelkezik egy helyszíni tartománnyal.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-112">This reference architecture creates an AD DS forest in Azure with a one-way outgoing trust relationship with an on-premises domain.</span></span> <span data-ttu-id="ae7e5-113">Az Azure-ban lévő erdő tartalmaz egy olyan tartományt, amely a helyszínen nem létezik.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-113">The forest in Azure contains a domain that does not exist on-premises.</span></span> <span data-ttu-id="ae7e5-114">A bizalmi kapcsolat miatt a helyszíni tartományokra történő bejelentkezések megbízhatók a külön Azure-tartományban lévő erőforrások eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-114">Because of the trust relationship, logons made against on-premises domains can be trusted for access to resources in the separate Azure domain.</span></span> 

<span data-ttu-id="ae7e5-115">Az architektúra gyakori használati módjai például a felhőben tárolt objektumok és identitások biztonsági elkülönítésének fenntartása, illetve az egyes tartományok migrálása a helyszínről a felhőbe.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-115">Typical uses for this architecture include maintaining security separation for objects and identities held in the cloud, and migrating individual domains from on-premises to the cloud.</span></span> 

<span data-ttu-id="ae7e5-116">További szempontok: [Megoldás választása a helyszíni Active Directory Azure-ral való integrálásához][considerations].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-116">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span> 

## <a name="architecture"></a><span data-ttu-id="ae7e5-117">Architektúra</span><span class="sxs-lookup"><span data-stu-id="ae7e5-117">Architecture</span></span>

<span data-ttu-id="ae7e5-118">Az architektúra a következő összetevőket tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-118">The architecture has the following components.</span></span>

* <span data-ttu-id="ae7e5-119">**Helyszíni hálózat**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-119">**On-premises network**.</span></span> <span data-ttu-id="ae7e5-120">A helyszíni hálózat a saját Active Directory-erdőjét és tartományait tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-120">The on-premises network contains its own Active Directory forest and domains.</span></span>
* <span data-ttu-id="ae7e5-121">**Active Directory-kiszolgálók**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-121">**Active Directory servers**.</span></span> <span data-ttu-id="ae7e5-122">Ezek a felhőben virtuális gépként futó tartományvezérlők, amelyek tartományi szolgáltatásokat biztosítanak.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-122">These are domain controllers implementing domain services running as VMs in the cloud.</span></span> <span data-ttu-id="ae7e5-123">Ezek a kiszolgálók egy egy vagy több tartományt tartalmazó erdőt üzemeltetnek a helyszíniektől elkülönítve.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-123">These servers host a forest containing one or more domains, separate from those located on-premises.</span></span>
* <span data-ttu-id="ae7e5-124">**Egyirányú bizalmi kapcsolat**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-124">**One-way trust relationship**.</span></span> <span data-ttu-id="ae7e5-125">Az ábrán az Azure-ban lévő tartományból a helyszíni tartományba tartó egyirányú bizalmi kapcsolatra látható egy példa.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-125">The example in the diagram shows a one-way trust from the domain in Azure to the on-premises domain.</span></span> <span data-ttu-id="ae7e5-126">Ez a kapcsolat lehetővé teszi a helyszíni felhasználók számára, hogy elérjék az Azure-ban lévő tartomány erőforrásait, de fordított irányban ez nem lehetséges.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-126">This relationship enables on-premises users to access resources in the domain in Azure, but not the other way around.</span></span> <span data-ttu-id="ae7e5-127">Kétirányú megbízhatósági kapcsolat is létrehozható, ha a felhőalapú felhasználóknak is hozzáférést kell biztosítani a helyszíni erőforrásokhoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-127">It is possible to create a two-way trust if cloud users also require access to on-premises resources.</span></span>
* <span data-ttu-id="ae7e5-128">**Active Directory-alhálózat**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-128">**Active Directory subnet**.</span></span> <span data-ttu-id="ae7e5-129">Az AD DS-kiszolgálók külön alhálózaton üzemelnek.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-129">The AD DS servers are hosted in a separate subnet.</span></span> <span data-ttu-id="ae7e5-130">A hálózati biztonsági csoport (NSG) szabályai megvédik az AD DS-kiszolgálókat, és tűzfalat biztosítanak a nem várt forrásból érkező adatforgalom ellen.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-130">Network security group (NSG) rules protect the AD DS servers and provide a firewall against traffic from unexpected sources.</span></span>
* <span data-ttu-id="ae7e5-131">**Azure-átjáró**.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-131">**Azure gateway**.</span></span> <span data-ttu-id="ae7e5-132">Az Azure-átjáró kapcsolatot biztosít a helyszíni hálózat és az Azure-beli virtuális hálózat között.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-132">The Azure gateway provides a connection between the on-premises network and the Azure VNet.</span></span> <span data-ttu-id="ae7e5-133">Ez lehet [VPN-kapcsolat] [ azure-vpn-gateway] vagy [Azure ExpressRoute][azure-expressroute].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-133">This can be a [VPN connection][azure-vpn-gateway] or [Azure ExpressRoute][azure-expressroute].</span></span> <span data-ttu-id="ae7e5-134">További információ: [Biztonságos hibrid hálózati architektúra megvalósítása az Azure-ban][implementing-a-secure-hybrid-network-architecture].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-134">For more information, see [Implementing a secure hybrid network architecture in Azure][implementing-a-secure-hybrid-network-architecture].</span></span>

## <a name="recommendations"></a><span data-ttu-id="ae7e5-135">Javaslatok</span><span class="sxs-lookup"><span data-stu-id="ae7e5-135">Recommendations</span></span>

<span data-ttu-id="ae7e5-136">Az Active Directory Azure-ban való megvalósítására vonatkozó konkrét ajánlásokért tekintse meg az alábbi cikkeket:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-136">For specific recommendations on implementing Active Directory in Azure, see the following articles:</span></span>

- <span data-ttu-id="ae7e5-137">[Az Azure Active Directory Domain Services (AD DS) kiterjesztése az Azure-ra][adds-extend-domain].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-137">[Extending Active Directory Domain Services (AD DS) to Azure][adds-extend-domain].</span></span> 
- <span data-ttu-id="ae7e5-138">[Útmutató a Windows Server Active Directory szolgáltatás Azure-beli virtuális gépekre való telepítéséhez][ad-azure-guidelines].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-138">[Guidelines for Deploying Windows Server Active Directory on Azure Virtual Machines][ad-azure-guidelines].</span></span>

### <a name="trust"></a><span data-ttu-id="ae7e5-139">Bizalmi kapcsolat</span><span class="sxs-lookup"><span data-stu-id="ae7e5-139">Trust</span></span>

<span data-ttu-id="ae7e5-140">A helyszíni tartományokat nem ugyanaz az erdő tartalmazza, mint a felhőben lévőket.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-140">The on-premises domains are contained within a different forest from the domains in the cloud.</span></span> <span data-ttu-id="ae7e5-141">A helyszíni felhasználók felhőbeli hitelesítésének engedélyezéséhez az Azure-ban lévő tartományoknak meg kell bízniuk a helyszíni erdőben található bejelentkezési tartományban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-141">To enable authentication of on-premises users in the cloud, the domains in Azure must trust the logon domain in the on-premises forest.</span></span> <span data-ttu-id="ae7e5-142">Hasonlóképpen, ha a felhő bejelentkezési tartományt biztosít a külső felhasználók számára, szükség lehet arra, hogy a helyszíni erdő megbízzon a felhőtartományban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-142">Similarly, if the cloud provides a logon domain for external users, it may be necessary for the on-premises forest to trust the cloud domain.</span></span>

<span data-ttu-id="ae7e5-143">Bizalmi kapcsolatokat létesíthet erdőszinten [erdőszintű bizalmi kapcsolatok létrehozásával][creating-forest-trusts] vagy tartományszinten [külső bizalmi kapcsolatok létrehozásával][creating-external-trusts].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-143">You can establish trusts at the forest level by [creating forest trusts][creating-forest-trusts], or at the domain level by [creating external trusts][creating-external-trusts].</span></span> <span data-ttu-id="ae7e5-144">Az erdőszintű bizalmi kapcsolat két erdő összes tartománya között kapcsolatot hoz létre.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-144">A forest level trust creates a relationship between all domains in two forests.</span></span> <span data-ttu-id="ae7e5-145">A külső tartományszintű bizalmi kapcsolat csak két adott tartomány között hoz létre kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-145">An external domain level trust only creates a relationship between two specified domains.</span></span> <span data-ttu-id="ae7e5-146">Különböző erdőkben lévő tartományok között csak külső tartományszintű bizalmi kapcsolatot hozzon létre.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-146">You should only create external domain level trusts between domains in different forests.</span></span>

<span data-ttu-id="ae7e5-147">A bizalmi kapcsolatok lehetnek egyirányúak vagy kétirányúak:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-147">Trusts can be unidirectional (one-way) or bidirectional (two-way):</span></span>

* <span data-ttu-id="ae7e5-148">Az egyirányú bizalmi kapcsolat lehetővé teszi egy tartományban vagy erdőben (*bejövő* tartomány vagy erdő) lévő felhasználóknak, hogy hozzáférjenek a másikban (*kimenő* tartomány vagy erdő) tárolt erőforrásokhoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-148">A one-way trust enables users in one domain or forest (known as the *incoming* domain or forest) to access the resources held in another (the *outgoing* domain or forest).</span></span>
* <span data-ttu-id="ae7e5-149">A kétirányú bizalmi kapcsolat lehetővé teszi a tartományban vagy az erdőben lévő felhasználók számára, hogy hozzáférjenek a másikban tárolt erőforrásokhoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-149">A two-way trust enables users in either domain or forest to access resources held in the other.</span></span>

<span data-ttu-id="ae7e5-150">A következő táblázat összefoglalja a bizalmi kapcsolati konfigurációkat néhány egyszerű forgatókönyvhöz:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-150">The following table summarizes trust configurations for some simple scenarios:</span></span>

| <span data-ttu-id="ae7e5-151">Forgatókönyv</span><span class="sxs-lookup"><span data-stu-id="ae7e5-151">Scenario</span></span> | <span data-ttu-id="ae7e5-152">Helyszíni bizalmi kapcsolat</span><span class="sxs-lookup"><span data-stu-id="ae7e5-152">On-premises trust</span></span> | <span data-ttu-id="ae7e5-153">Felhőbeli bizalmi kapcsolat</span><span class="sxs-lookup"><span data-stu-id="ae7e5-153">Cloud trust</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ae7e5-154">A helyszíni felhasználóknak hozzá kell férniük a felhőben lévő erőforrásokhoz, de fordított irányban ez nem szükséges</span><span class="sxs-lookup"><span data-stu-id="ae7e5-154">On-premises users require access to resources in the cloud, but not vice versa</span></span> |<span data-ttu-id="ae7e5-155">Egyirányú, bejövő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-155">One-way, incoming</span></span> |<span data-ttu-id="ae7e5-156">Egyirányú, kimenő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-156">One-way, outgoing</span></span> |
| <span data-ttu-id="ae7e5-157">A felhőbeli felhasználóknak hozzá kell férniük a helyszíni erőforrásokhoz, de fordított irányban ez nem szükséges</span><span class="sxs-lookup"><span data-stu-id="ae7e5-157">Users in the cloud require access to resources located on-premises, but not vice versa</span></span> |<span data-ttu-id="ae7e5-158">Egyirányú, kimenő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-158">One-way, outgoing</span></span> |<span data-ttu-id="ae7e5-159">Egyirányú, bejövő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-159">One-way, incoming</span></span> |
| <span data-ttu-id="ae7e5-160">A felhőben lévő és a helyszíni felhasználóknak is hozzá kell férniük a felhőben és a helyszínen tárolt erőforrásokhoz is</span><span class="sxs-lookup"><span data-stu-id="ae7e5-160">Users in the cloud and on-premises both requires access to resources held in the cloud and on-premises</span></span> |<span data-ttu-id="ae7e5-161">Kétirányú, bejövő és kimenő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-161">Two-way, incoming and outgoing</span></span> |<span data-ttu-id="ae7e5-162">Kétirányú, bejövő és kimenő</span><span class="sxs-lookup"><span data-stu-id="ae7e5-162">Two-way, incoming and outgoing</span></span> |

## <a name="scalability-considerations"></a><span data-ttu-id="ae7e5-163">Méretezési szempontok</span><span class="sxs-lookup"><span data-stu-id="ae7e5-163">Scalability considerations</span></span>

<span data-ttu-id="ae7e5-164">Az Active Directory automatikusan skálázható az ugyanazon tartományba tartozó tartományvezérlők esetén.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-164">Active Directory is automatically scalable for domain controllers that are part of the same domain.</span></span> <span data-ttu-id="ae7e5-165">A kérelmek a tartományok összes vezérlője között oszlanak meg.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-165">Requests are distributed across all controllers within a domain.</span></span> <span data-ttu-id="ae7e5-166">Ha hozzáad egy másik tartományvezérlőt, ez automatikusan szinkronizálódik a tartománnyal.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-166">You can add another domain controller, and it synchronizes automatically with the domain.</span></span> <span data-ttu-id="ae7e5-167">Ne konfiguráljon külön terheléselosztót arra, hogy a tartományban lévő vezérlőkre irányítsa a forgalmat.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-167">Do not configure a separate load balancer to direct traffic to controllers within the domain.</span></span> <span data-ttu-id="ae7e5-168">Győződjön meg arról, hogy minden tartományvezérlő elegendő memória-és tároló-erőforrással rendelkezik a tartomány-adatbázis kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-168">Ensure that all domain controllers have sufficient memory and storage resources to handle the domain database.</span></span> <span data-ttu-id="ae7e5-169">Minden tartományvezérlő virtuális gépet ugyanakkora méretűre állítson be.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-169">Make all domain controller VMs the same size.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="ae7e5-170">Rendelkezésre állási szempontok</span><span class="sxs-lookup"><span data-stu-id="ae7e5-170">Availability considerations</span></span>

<span data-ttu-id="ae7e5-171">Építsen ki legalább két tartományvezérlőt minden tartományhoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-171">Provision at least two domain controllers for each domain.</span></span> <span data-ttu-id="ae7e5-172">Ez lehetővé teszi a kiszolgálók közötti automatikus replikációt.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-172">This enables automatic replication between servers.</span></span> <span data-ttu-id="ae7e5-173">Hozzon létre egy rendelkezésre állási csoportot az egyes tartományokat kezelő, Active Directory-kiszolgálóként működő virtuális gépekhez.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-173">Create an availability set for the VMs acting as Active Directory servers handling each domain.</span></span> <span data-ttu-id="ae7e5-174">Helyezzen el legalább két kiszolgálót ebben a rendelkezésre állási csoportban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-174">Put at least two servers in this availability set.</span></span>

<span data-ttu-id="ae7e5-175">Vegye fontolóra, hogy minden tartományban kijelöljön egy vagy több kiszolgálót [készenléti műveleti főkiszolgálónak][standby-operations-masters], arra az esetre, ha nem sikerülne csatlakozni a mozgó egyedüli főkiszolgálói (FSMO) szerepkört betöltő kiszolgálóhoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-175">Also, consider designating one or more servers in each domain as [standby operations masters][standby-operations-masters] in case connectivity to a server acting as a flexible single master operation (FSMO) role fails.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="ae7e5-176">Felügyeleti szempontok</span><span class="sxs-lookup"><span data-stu-id="ae7e5-176">Manageability considerations</span></span>

<span data-ttu-id="ae7e5-177">További információ a kezelési és monitorozási szempontokról: [Az Active Directory kiterjesztése az Azure-ra][adds-extend-domain].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-177">For information about management and monitoring considerations, see [Extending Active Directory to Azure][adds-extend-domain].</span></span> 
 
<span data-ttu-id="ae7e5-178">További információ: [Az Active Directory monitorozása][monitoring_ad].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-178">For additional information, see [Monitoring Active Directory][monitoring_ad].</span></span> <span data-ttu-id="ae7e5-179">A feladatok megkönnyítéséhez olyan eszközöket is telepíthet a kezelési alhálózatban lévő monitorozási kiszolgálókra, mint a [Microsoft Systems Center][microsoft_systems_center].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-179">You can install tools such as [Microsoft Systems Center][microsoft_systems_center] on a monitoring server in the management subnet to help perform these tasks.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="ae7e5-180">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="ae7e5-180">Security considerations</span></span>

<span data-ttu-id="ae7e5-181">Az erdőszintű bizalmi kapcsolatok tranzitívak.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-181">Forest level trusts are transitive.</span></span> <span data-ttu-id="ae7e5-182">Ha erdőszintű bizalmi kapcsolatot hoz létre egy helyszíni és egy felhőben lévő erdő között, a bizalmi kapcsolat az ezekben az erdőkben létrehozott új tartományokra is kiterjed.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-182">If you establish a forest level trust between an on-premises forest and a forest in the cloud, this trust is extended to other new domains created in either forest.</span></span> <span data-ttu-id="ae7e5-183">Ha biztonsági okokból tartományokat használ az elkülönítéshez, érdemes lehet csak tartományszintű bizalmi kapcsolatokat létrehoznia.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-183">If you use domains to provide separation for security purposes, consider creating trusts at the domain level only.</span></span> <span data-ttu-id="ae7e5-184">A tartományszintű bizalmi kapcsolatok nem tranzitívak.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-184">Domain level trusts are non-transitive.</span></span>

<span data-ttu-id="ae7e5-185">Active Directory-specifikus biztonsági szempontokért tekintse meg [Az Active Directory Azure-ra való kiterjesztését][adds-extend-domain] ismertető cikk biztonsági szempontokról szóló szakaszát.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-185">For Active Directory-specific security considerations, see the security considerations section in [Extending Active Directory to Azure][adds-extend-domain].</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="ae7e5-186">A megoldás üzembe helyezése</span><span class="sxs-lookup"><span data-stu-id="ae7e5-186">Deploy the solution</span></span>

<span data-ttu-id="ae7e5-187">Ezen referenciaarchitektúra üzembe helyezéséhez rendelkezésre áll egy megoldás a [GitHubon][github].</span><span class="sxs-lookup"><span data-stu-id="ae7e5-187">A solution is available on [GitHub][github] to deploy this reference architecture.</span></span> <span data-ttu-id="ae7e5-188">A megoldást üzembe helyező Powershell-szkript futtatásához az Azure CLI legújabb verziójára lesz szükség.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-188">You will need the latest version of the Azure CLI to run the Powershell script that deploys the solution.</span></span> <span data-ttu-id="ae7e5-189">A referenciaarchitektúra üzembe helyezéséhez kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-189">To deploy the reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="ae7e5-190">Töltse le vagy klónozza a megoldásmappát a [GitHubról][github] a helyi számítógépére.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-190">Download or clone the solution folder from [GitHub][github] to your local machine.</span></span>

2. <span data-ttu-id="ae7e5-191">Nyissa meg az Azure CLI-t, és lépjen a helyi megoldásmappára.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-191">Open the Azure CLI and navigate to the local solution folder.</span></span>

3. <span data-ttu-id="ae7e5-192">Futtassa az alábbi parancsot:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-192">Run the following command:</span></span>
   
    ```Powershell
    .\Deploy-ReferenceArchitecture.ps1 <subscription id> <location> <mode>
    ```
   
    <span data-ttu-id="ae7e5-193">Cserélje le a `<subscription id>` értékét a saját Azure-előfizetése azonosítójára.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-193">Replace `<subscription id>` with your Azure subscription ID.</span></span>
   
    <span data-ttu-id="ae7e5-194">A `<location>` paraméter esetében adjon meg egy Azure-régiót (pl. `eastus` vagy `westus`).</span><span class="sxs-lookup"><span data-stu-id="ae7e5-194">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span>
   
    <span data-ttu-id="ae7e5-195">A `<mode>` paraméter az üzembe helyezés részletességét vezérli. Értékei a következők lehetnek:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-195">The `<mode>` parameter controls the granularity of the deployment, and can be one of the following values:</span></span>
   
   * <span data-ttu-id="ae7e5-196">`Onpremise`: a szimulált helyszíni környezetet helyezi üzembe.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-196">`Onpremise`: deploys the simulated on-premises environment.</span></span>
   * <span data-ttu-id="ae7e5-197">`Infrastructure`: a virtuális hálózat infrastruktúráját és a jump boxot helyezi üzembe az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-197">`Infrastructure`: deploys the VNet infrastructure and jump box in Azure.</span></span>
   * <span data-ttu-id="ae7e5-198">`CreateVpn`: az Azure-beli virtuális hálózati átjárót telepíti, és csatlakoztatja a szimulált a helyszíni hálózathoz.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-198">`CreateVpn`: deploys the Azure virtual network gateway and connects it to the simulated on-premises network.</span></span>
   * <span data-ttu-id="ae7e5-199">`AzureADDS`: üzembe helyezi az Active Directory DS-kiszolgálóként működő virtuális gépeket, telepíti az Active Directoryt ezeken a virtuális gépeken, és üzembe helyezi a tartományt az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-199">`AzureADDS`: deploys the VMs acting as Active Directory DS servers, deploys Active Directory to these VMs, and deploys the domain in Azure.</span></span>
   * <span data-ttu-id="ae7e5-200">`WebTier`: üzembe helyezi a webes szintű virtuális gépeket és a terheléselosztót.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-200">`WebTier`: deploys the web tier VMs and load balancer.</span></span>
   * <span data-ttu-id="ae7e5-201">`Prepare`: az összes fenti környezetet üzembe helyezi.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-201">`Prepare`: deploys all of the preceding deployments.</span></span> <span data-ttu-id="ae7e5-202">**Ez a lehetőség ajánlott, ha nem rendelkezik meglévő helyszíni hálózattal, de telepíteni kívánja a fentebb ismertetett teljes referenciaarchitektúrát tesztelés vagy értékelés céljából.**</span><span class="sxs-lookup"><span data-stu-id="ae7e5-202">**This is the recommended option if If you do not have an existing on-premises network but you want to deploy the complete reference architecture described above for testing or evaluation.**</span></span> 
   * <span data-ttu-id="ae7e5-203">`Workload`: üzembe helyezi az üzleti és adatszintű virtuális gépeket és a terheléselosztókat.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-203">`Workload`: deploys the business and data tier VMs and load balancers.</span></span> <span data-ttu-id="ae7e5-204">Vegye figyelembe, hogy ezeket a virtuális gépeket a `Prepare` üzembe helyezés nem tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-204">Note that these VMs are not included in the `Prepare` deployment.</span></span>

4. <span data-ttu-id="ae7e5-205">Várjon, amíg az üzembe helyezés befejeződik.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-205">Wait for the deployment to complete.</span></span> <span data-ttu-id="ae7e5-206">Ha a `Prepare` üzembe helyezést választja, a folyamat több órát vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-206">If you are deploying the `Prepare` deployment, it will take several hours.</span></span>
     
5. <span data-ttu-id="ae7e5-207">Ha szimulált helyszíni konfigurációt használ, konfigurálja a bejövő bizalmi kapcsolatot:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-207">If you are using the simulated on-premises configuration, configure the incoming trust relationship:</span></span>
   
   1. <span data-ttu-id="ae7e5-208">Csatlakozzon a jump boxhoz (<em>ra-adtrust-mgmt-vm1</em> a <em>ra-adtrust-security-rg</em> erőforráscsoportban).</span><span class="sxs-lookup"><span data-stu-id="ae7e5-208">Connect to the jump box (<em>ra-adtrust-mgmt-vm1</em> in the <em>ra-adtrust-security-rg</em> resource group).</span></span> <span data-ttu-id="ae7e5-209">Jelentkezzen be <em>testuser</em> felhasználónévvel és az <em>AweS0me@PW</em> jelszóval.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-209">Log in as <em>testuser</em> with password <em>AweS0me@PW</em>.</span></span>
   2. <span data-ttu-id="ae7e5-210">A jump boxon nyisson meg egy RDP-munkamenetet a <em>contoso.com</em> tartomány (a helyszíni tartomány) első virtuális gépén.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-210">On the jump box open an RDP session on the first VM in the <em>contoso.com</em> domain (the on-premises domain).</span></span> <span data-ttu-id="ae7e5-211">A virtuális gép IP-címe: 192.168.0.4.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-211">This VM has the IP address 192.168.0.4.</span></span> <span data-ttu-id="ae7e5-212">A felhasználónév <em>contoso\testuser</em>, a jelszó pedig <em>AweS0me@PW</em>.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-212">The username is <em>contoso\testuser</em> with password <em>AweS0me@PW</em>.</span></span>
   3. <span data-ttu-id="ae7e5-213">A *treyresearch.com* tartományból bejövő bizalmi kapcsolat létrehozásához töltse le és futtassa az [incoming-trust.ps1][incoming-trust] szkriptet.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-213">Download the [incoming-trust.ps1][incoming-trust] script and run it to create the incoming trust from the *treyresearch.com* domain.</span></span>

6. <span data-ttu-id="ae7e5-214">Ha saját helyszíni infrastruktúrát használ:</span><span class="sxs-lookup"><span data-stu-id="ae7e5-214">If you are using your own on-premises infrastructure:</span></span>
   
   1. <span data-ttu-id="ae7e5-215">Töltse le az [incoming-trust.ps1][incoming-trust] szkriptet.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-215">Download the [incoming-trust.ps1][incoming-trust] script.</span></span>
   2. <span data-ttu-id="ae7e5-216">Szerkessze a szkriptet, és cserélje le a `$TrustedDomainName` változó értékét a saját tartománya nevére.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-216">Edit the script and replace the value of the `$TrustedDomainName` variable with the name of your own domain.</span></span>
   3. <span data-ttu-id="ae7e5-217">Futtassa a szkriptet.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-217">Run the script.</span></span>

7. <span data-ttu-id="ae7e5-218">A jump boxról csatlakozzon a <em>treyresearch.com</em> tartomány (a felhőbeli lévő tartomány) első virtuális gépéhez.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-218">From the jump-box, connect to the first VM in the <em>treyresearch.com</em> domain (the domain in the cloud).</span></span> <span data-ttu-id="ae7e5-219">A virtuális gép IP-címe: 10.0.4.4.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-219">This VM has the IP address 10.0.4.4.</span></span> <span data-ttu-id="ae7e5-220">A felhasználónév <em>treyresearch\testuser</em>, a jelszó pedig <em>AweS0me@PW</em>.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-220">The username is <em>treyresearch\testuser</em> with password <em>AweS0me@PW</em>.</span></span>

8. <span data-ttu-id="ae7e5-221">A *treyresearch.com* tartományból bejövő bizalmi kapcsolat létrehozásához töltse le és futtassa az [outgoing-trust.ps1][outgoing-trust] szkriptet.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-221">Download the [outgoing-trust.ps1][outgoing-trust] script and run it to create the incoming trust from the *treyresearch.com* domain.</span></span> <span data-ttu-id="ae7e5-222">Ha a saját helyszíni gépeket használ, először szerkessze a szkriptet.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-222">If you are using your own on-premises machines, then edit the script first.</span></span> <span data-ttu-id="ae7e5-223">A `$TrustedDomainName` változót állítsa a helyszíni tartomány nevére, és adja meg az adott tartományhoz tartozó Active Directory DS-kiszolgálók IP-címeit a `$TrustedDomainDnsIpAddresses` változóban.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-223">Set the `$TrustedDomainName` variable to the name of your on-premises domain, and specify the IP addresses of the Active Directory DS servers for this domain in the `$TrustedDomainDnsIpAddresses` variable.</span></span>

9. <span data-ttu-id="ae7e5-224">Várjon néhány percet, amíg az előző lépések befejeződnek, majd csatlakozzon egy helyszíni virtuális géphez, és végezze el a [bizalmi kapcsolat ellenőrzését][verify-a-trust] ismertető cikk lépéseit annak megállapításához, hogy a *contoso.com* és a *treyresearch.com* tartományok közötti bizalmi kapcsolat megfelelően van-e konfigurálva.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-224">Wait a few minutes for the previous steps to complete, then connect to an on-premises VM and perform the steps outlined in the article [Verify a Trust][verify-a-trust] to determine whether the trust relationship between the *contoso.com* and *treyresearch.com* domains is correctly configured.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ae7e5-225">További lépések</span><span class="sxs-lookup"><span data-stu-id="ae7e5-225">Next steps</span></span>

* <span data-ttu-id="ae7e5-226">A [helyszíni AD DS-tartomány Azure-ra való kiterjesztésére][adds-extend-domain] vonatkozó ajánlott eljárások megismerése</span><span class="sxs-lookup"><span data-stu-id="ae7e5-226">Learn the best practices for [extending your on-premises AD DS domain to Azure][adds-extend-domain]</span></span>
* <span data-ttu-id="ae7e5-227">Az Azure-alapú [AD FS-infrastruktúra létrehozására][adfs] vonatkozó ajánlott eljárások megismerése.</span><span class="sxs-lookup"><span data-stu-id="ae7e5-227">Learn the best practices for [creating an AD FS infrastructure][adfs] in Azure.</span></span>

<!-- links -->
[adds-extend-domain]: adds-extend-domain.md
[adfs]: adfs.md

[implementing-a-secure-hybrid-network-architecture]: ../dmz/secure-vnet-hybrid.md
[implementing-a-secure-hybrid-network-architecture-with-internet-access]: ../dmz/secure-vnet-dmz.md

[running-VMs-for-an-N-tier-architecture-on-Azure]: ../virtual-machines-windows/n-tier.md

[ad-azure-guidelines]: https://msdn.microsoft.com/library/azure/jj156090.aspx
[azure-expressroute]: https://azure.microsoft.com/documentation/articles/expressroute-introduction/
[azure-vpn-gateway]: https://azure.microsoft.com/documentation/articles/vpn-gateway-about-vpngateways/
[considerations]: ./considerations.md
[creating-external-trusts]: https://technet.microsoft.com/library/cc816837(v=ws.10).aspx
[creating-forest-trusts]: https://technet.microsoft.com/library/cc816810(v=ws.10).aspx
[github]: https://github.com/mspnp/reference-architectures/tree/master/identity/adds-forest
[incoming-trust]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/extensions/incoming-trust.ps1
[microsoft_systems_center]: https://www.microsoft.com/server-cloud/products/system-center-2016/
[monitoring_ad]: https://msdn.microsoft.com/library/bb727046.aspx
[resource-manager-overview]: /azure/azure-resource-manager/resource-group-overview
[solution-script]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/Deploy-ReferenceArchitecture.ps1
[standby-operations-masters]: https://technet.microsoft.com/library/cc794737(v=ws.10).aspx
[outgoing-trust]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/extensions/outgoing-trust.ps1
[verify-a-trust]: https://technet.microsoft.com/library/cc753821.aspx
[visio-download]: https://archcenter.blob.core.windows.net/cdn/identity-architectures.vsdx
[0]: ./images/adds-forest.png "Biztonságos hibrid hálózati architektúra külön Active Directory-tartományokkal"