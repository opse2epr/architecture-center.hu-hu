---
title: "Az Azure Active Directory tartományi szolgáltatások (AD DS) kiterjesztése"
description: "Hogyan valósítja meg az Active Directory engedélyezési egy biztonságos hibrid hálózati architektúra az Azure-ban.\nútmutatást, vpn-átjáró, expressroute, terheléselosztó, virtuális hálózat, active Directoryval"
author: telmosampaio
ms.date: 11/28/2016
pnp.series.title: Identity management
pnp.series.prev: azure-ad
pnp.series.next: adds-forest
ms.openlocfilehash: 216c59a0a5912d0fe90011e49ad20eb017ada6be
ms.sourcegitcommit: 8ab30776e0c4cdc16ca0dcc881960e3108ad3e94
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 12/08/2017
---
# <a name="extend-active-directory-domain-services-ad-ds-to-azure"></a><span data-ttu-id="5fd8a-104">Az Azure Active Directory tartományi szolgáltatások (AD DS) kiterjesztése</span><span class="sxs-lookup"><span data-stu-id="5fd8a-104">Extend Active Directory Domain Services (AD DS) to Azure</span></span>

<span data-ttu-id="5fd8a-105">A referencia-architektúrában bemutatja, hogyan terjeszthető ki az Active Directory környezet az Azure-bA elosztott hitelesítési szolgáltatásokat használó [Active Directory tartományi szolgáltatások (AD DS)][active-directory-domain-services].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-105">This reference architecture shows how to extend your Active Directory environment to Azure to provide distributed authentication services using [Active Directory Domain Services (AD DS)][active-directory-domain-services].</span></span>  [<span data-ttu-id="5fd8a-106">**A megoldás üzembe helyezése**.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-106">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="5fd8a-107">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="5fd8a-107">[![0]][0]</span></span> 

<span data-ttu-id="5fd8a-108">*Töltse le az architektúra [Visio-fájlját][visio-download].*</span><span class="sxs-lookup"><span data-stu-id="5fd8a-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

<span data-ttu-id="5fd8a-109">Active Directory tartományi szolgáltatások felhasználói, számítógép, alkalmazás vagy többi egy biztonsági tartomány szereplő identitások hitelesítésére szolgál.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-109">AD DS is used to authenticate user, computer, application, or other identities that are included in a security domain.</span></span> <span data-ttu-id="5fd8a-110">Lehet üzemeltethető a helyszínen, de ha az alkalmazás üzemel részben a helyszíni és részben az Azure-ban Ez a funkció az Azure-ban replikálásához hatékonyabb lehet.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-110">It can be hosted on-premises, but if your application is hosted partly on-premises and partly in Azure, it may be more efficient to replicate this functionality in Azure.</span></span> <span data-ttu-id="5fd8a-111">Ez csökkentheti a várakozási okozta hitelesítési küld, és fut a helyszíni AD DS biztonsági helyi engedélyezési kérelmeket a felhőből.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-111">This can reduce the latency caused by sending authentication and local authorization requests from the cloud back to AD DS running on-premises.</span></span> 

<span data-ttu-id="5fd8a-112">Ez az architektúra gyakran használják VPN- vagy ExpressRoute kapcsolattal csatlakoztatott a helyszíni hálózat és az Azure virtuális hálózat.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-112">This architecture is commonly used when the on-premises network and the Azure virtual network are connected by a VPN or ExpressRoute connection.</span></span> <span data-ttu-id="5fd8a-113">Ez az architektúra is támogatja a kétirányú replikációt, azaz a módosítás helyi vagy a felhőben, és mindkét források konzisztens megmarad.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-113">This architecture also supports bidirectional replication, meaning changes can be made either on-premises or in the cloud, and both sources will be kept consistent.</span></span> <span data-ttu-id="5fd8a-114">Ez az architektúra a gyakori felhasználási, amelyben funkciók a helyszíni és Azure-ban, és az alkalmazások és szolgáltatásokról, amelyek a hitelesítés elvégzésére Active Directory használatával közötti elosztott hibrid alkalmazások közé tartoznak.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-114">Typical uses for this architecture include hybrid applications in which functionality is distributed between on-premises and Azure, and applications and services that perform authentication using Active Directory.</span></span>

<span data-ttu-id="5fd8a-115">További szempontokat lásd: [megoldás választása a integrálása a helyszíni Active Directoryról szinkronizálva az Azure][considerations].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-115">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span> 

## <a name="architecture"></a><span data-ttu-id="5fd8a-116">Architektúra</span><span class="sxs-lookup"><span data-stu-id="5fd8a-116">Architecture</span></span> 

<span data-ttu-id="5fd8a-117">Ez az architektúra kibővíti az architektúra látható [Azure és az Internet között DMZ][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-117">This architecture extends the architecture shown in [DMZ between Azure and the Internet][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span></span> <span data-ttu-id="5fd8a-118">A következő összetevőket tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-118">It has the following components.</span></span>

* <span data-ttu-id="5fd8a-119">**A helyszíni hálózat**.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-119">**On-premises network**.</span></span> <span data-ttu-id="5fd8a-120">A helyszíni hálózat helyi Active Directory-kiszolgálók által végrehajtható műveleteket hitelesítési és engedélyezési helyszíni található összetevőket tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-120">The on-premises network includes local Active Directory servers that can perform authentication and authorization for components located on-premises.</span></span>
* <span data-ttu-id="5fd8a-121">**Active Directory-kiszolgálók**.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-121">**Active Directory servers**.</span></span> <span data-ttu-id="5fd8a-122">Ezek a tartományvezérlők végrehajtási a directory services (AD DS) futtató virtuális gépek a felhőben.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-122">These are domain controllers implementing directory services (AD DS) running as VMs in the cloud.</span></span> <span data-ttu-id="5fd8a-123">Ezek a kiszolgálók az Azure virtuális hálózatban futtat összetevők is hitelesítésre.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-123">These servers can provide authentication of components running in your Azure virtual network.</span></span>
* <span data-ttu-id="5fd8a-124">**Active Directory-alhálózathoz**.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-124">**Active Directory subnet**.</span></span> <span data-ttu-id="5fd8a-125">Az Active Directory tartományi szolgáltatások kiszolgálókon tárolt külön alhálózathoz.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-125">The AD DS servers are hosted in a separate subnet.</span></span> <span data-ttu-id="5fd8a-126">Hálózati biztonsági csoport (NSG) szabályok az Active Directory tartományi szolgáltatások kiszolgálók védelméhez, és adja meg a tűzfal váratlan forrásból ellen.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-126">Network security group (NSG) rules protect the AD DS servers and provide a firewall against traffic from unexpected sources.</span></span>
* <span data-ttu-id="5fd8a-127">**Azure átjáró és az Active Directory-szinkronizálás**.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-127">**Azure Gateway and Active Directory synchronization**.</span></span> <span data-ttu-id="5fd8a-128">Az Azure átjáró biztosítja a kapcsolatot a helyszíni hálózat és az Azure VNet között.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-128">The Azure gateway provides a connection between the on-premises network and the Azure VNet.</span></span> <span data-ttu-id="5fd8a-129">Ez lehet egy [VPN-kapcsolat] [ azure-vpn-gateway] vagy [Azure ExpressRoute][azure-expressroute].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-129">This can be a [VPN connection][azure-vpn-gateway] or [Azure ExpressRoute][azure-expressroute].</span></span> <span data-ttu-id="5fd8a-130">Az Active Directory-kiszolgálók, a felhőben és helyszíni közötti összes szinkronizálási kérelem továbbítása az átjárót.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-130">All synchronization requests between the Active Directory servers in the cloud and on-premises pass through the gateway.</span></span> <span data-ttu-id="5fd8a-131">Felhasználó által definiált útvonalak (udr-EK) kezeli a helyszíni forgalomhoz, amely az Azure-bA útválasztást.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-131">User-defined routes (UDRs) handle routing for on-premises traffic that passes to Azure.</span></span> <span data-ttu-id="5fd8a-132">Az Active Directory-kiszolgálók érkező vagy oda irányuló forgalom nem halad át a hálózati virtuális készülékek (NVAs) lehet használni.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-132">Traffic to and from the Active Directory servers does not pass through the network virtual appliances (NVAs) used in this scenario.</span></span>

<span data-ttu-id="5fd8a-133">Udr-EK és a NVAs konfigurálásával kapcsolatos további információkért lásd: [valósít meg olyan biztonságos hibrid hálózati architektúra Azure][implementing-a-secure-hybrid-network-architecture].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-133">For more information about configuring UDRs and the NVAs, see [Implementing a secure hybrid network architecture in Azure][implementing-a-secure-hybrid-network-architecture].</span></span> 

## <a name="recommendations"></a><span data-ttu-id="5fd8a-134">Ajánlatok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-134">Recommendations</span></span>

<span data-ttu-id="5fd8a-135">Az alábbi javaslatok a legtöbb forgatókönyvre vonatkoznak.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-135">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="5fd8a-136">Kövesse ezeket a javaslatokat, ha nincsenek ezeket felülíró követelményei.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-136">Follow these recommendations unless you have a specific requirement that overrides them.</span></span> 

### <a name="vm-recommendations"></a><span data-ttu-id="5fd8a-137">Virtuális gépekre vonatkozó javaslatok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-137">VM recommendations</span></span>

<span data-ttu-id="5fd8a-138">Határozza meg a [Virtuálisgép-méretet] [ vm-windows-sizes] követelmények, a hitelesítési kérelmek várható mennyisége alapján.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-138">Determine your [VM size][vm-windows-sizes] requirements based on the expected volume of authentication requests.</span></span> <span data-ttu-id="5fd8a-139">Használja a kiindulási pontként a helyszíni AD DS futtató gépek előírásainak, és egyezik meg azokat az Azure Virtuálisgép-méretek.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-139">Use the specifications of the machines hosting AD DS on premises as a starting point, and match them with the Azure VM sizes.</span></span> <span data-ttu-id="5fd8a-140">Központi telepítésének végrehajtása után figyelni kihasználtságát és a skála felfelé vagy lefelé a tényleges betöltést a virtuális gépeken alapul.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-140">Once deployed, monitor utilization and scale up or down based on the actual load on the VMs.</span></span> <span data-ttu-id="5fd8a-141">Active Directory tartományi szolgáltatások tartományvezérlő méretezéssel kapcsolatos további információkért lásd: [kapacitástervezés Active Directory tartományi szolgáltatások][capacity-planning-for-adds].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-141">For more information about sizing AD DS domain controllers, see [Capacity Planning for Active Directory Domain Services][capacity-planning-for-adds].</span></span>

<span data-ttu-id="5fd8a-142">Hozzon létre egy külön virtuális adatlemez az adatbázis, a naplókat, és a SYSVOL tárolására az Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-142">Create a separate virtual data disk for storing the database, logs, and SYSVOL for Active Directory.</span></span> <span data-ttu-id="5fd8a-143">Az operációs rendszer ugyanazon a lemezen tárolja ezeket az elemeket.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-143">Do not store these items on the same disk as the operating system.</span></span> <span data-ttu-id="5fd8a-144">Vegye figyelembe, hogy alapértelmezés szerint egy virtuális géphez csatolt adatok lemezt használjon író gyorsítótárazást.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-144">Note that by default, data disks that are attached to a VM use write-through caching.</span></span> <span data-ttu-id="5fd8a-145">Azonban az űrlap gyorsítótárazásának ütközhetnek Active Directory tartományi szolgáltatások követelményeinek.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-145">However, this form of caching can conflict with the requirements of AD DS.</span></span> <span data-ttu-id="5fd8a-146">Emiatt, állítsa be a *állomás gyorsítótár beállításokat szabályozó* beállítása a adatlemez *nincs*.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-146">For this reason, set the *Host Cache Preference* setting on the data disk to *None*.</span></span> <span data-ttu-id="5fd8a-147">További információkért lásd: [a Windows Server AD DS-adatbázis és a SYSVOL helyét][adds-data-disks].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-147">For more information, see [Placement of the Windows Server AD DS database and SYSVOL][adds-data-disks].</span></span>

<span data-ttu-id="5fd8a-148">Legalább két virtuális gépeket futtató tartományvezérlők Active Directory tartományi szolgáltatások telepítéséhez, és hozzáadhatja őket a egy [rendelkezésre állási csoport][availability-set].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-148">Deploy at least two VMs running AD DS as domain controllers and add them to an [availability set][availability-set].</span></span>

### <a name="networking-recommendations"></a><span data-ttu-id="5fd8a-149">Hálózatokra vonatkozó javaslatok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-149">Networking recommendations</span></span>

<span data-ttu-id="5fd8a-150">Konfigurálja a virtuális gép hálózati kártya (NIC) Active Directory tartományi szolgáltatások kiszolgálónként teljes tartománynevek szolgáltatási (DNS) támogatása statikus magánhálózati IP-cím.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-150">Configure the VM network interface (NIC) for each AD DS server with a static private IP address for full domain name service (DNS) support.</span></span> <span data-ttu-id="5fd8a-151">További információkért lásd: [hozzá statikus magánhálózati IP-cím beállítása az Azure portálon][set-a-static-ip-address].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-151">For more information, see [How to set a static private IP address in the Azure portal][set-a-static-ip-address].</span></span>

> [!NOTE]
> <span data-ttu-id="5fd8a-152">Bármely AD DS-ben a virtuális gép hálózati Adapternek nem konfigurál egy nyilvános IP-címet.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-152">Do not configure the VM NIC for any AD DS with a public IP address.</span></span> <span data-ttu-id="5fd8a-153">Lásd: [biztonsági szempontok] [ security-considerations] további részleteket.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-153">See [Security considerations][security-considerations] for more details.</span></span>
> 
> 

<span data-ttu-id="5fd8a-154">Az Active Directory-alhálózathoz NSG bejövő forgalom engedélyezése a helyszíni szabályok igényel.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-154">The Active Directory subnet NSG requires rules to permit incoming traffic from on-premises.</span></span> <span data-ttu-id="5fd8a-155">Részletes információk az Active Directory tartományi szolgáltatások által használt portokon: [Active Directory és az Active Directory Domain Services Port Requirements][ad-ds-ports].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-155">For detailed information on the ports used by AD DS, see [Active Directory and Active Directory Domain Services Port Requirements][ad-ds-ports].</span></span> <span data-ttu-id="5fd8a-156">Gondoskodjon arról is, a UDR táblák nem irányíthatja a NVAs ebben az architektúrában használt Active Directory tartományi szolgáltatások forgalmát.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-156">Also, ensure the UDR tables do not route AD DS traffic through the NVAs used in this architecture.</span></span> 

### <a name="active-directory-site"></a><span data-ttu-id="5fd8a-157">Active Directory-hely</span><span class="sxs-lookup"><span data-stu-id="5fd8a-157">Active Directory site</span></span>

<span data-ttu-id="5fd8a-158">Az AD DS-ben a hely a fizikai hely, hálózati vagy eszközök jelöli.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-158">In AD DS, a site represents a physical location, network, or collection of devices.</span></span> <span data-ttu-id="5fd8a-159">Az AD DS-helyek Active Directory tartományi szolgáltatások adatbázis-replikáció kezelésére AD DS-objektum, amely közel egy másik találhatók, és a nagy sebességű hálózati csatlakoztatott csoportosításával szolgálnak.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-159">AD DS sites are used to manage AD DS database replication by grouping together AD DS objects that are located close to one another and are connected by a high speed network.</span></span> <span data-ttu-id="5fd8a-160">Active Directory tartományi szolgáltatások jelölje be az AD DS adatbázis, a helyek közötti replacating legjobb stratégiája logikát tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-160">AD DS includes logic to select the best strategy for replacating the AD DS database between sites.</span></span>

<span data-ttu-id="5fd8a-161">Azt javasoljuk, hogy hozzon létre egy AD DS-helyen, beleértve a az alkalmazás az Azure-ban meghatározott alhálózatokat.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-161">We recommend that you create an AD DS site including the subnets defined for your application in Azure.</span></span> <span data-ttu-id="5fd8a-162">Ezt követően konfigurálja a helykapcsolatot közé a helyszíni AD DS-helyek és az Active Directory tartományi szolgáltatások automatikusan végrehajtják a lehető leghatékonyabb adatbázis-replikáció.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-162">Then, configure a site link between your on-premises AD DS sites, and AD DS will automatically perform the most efficient database replication possible.</span></span> <span data-ttu-id="5fd8a-163">Vegye figyelembe, hogy az adatbázis-replikáció a kezdeti konfiguráció túl kevés igényel.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-163">Note that this database replication requires little beyond the initial configuration.</span></span>

### <a name="active-directory-operations-masters"></a><span data-ttu-id="5fd8a-164">Active Directory műveleti főkiszolgálók</span><span class="sxs-lookup"><span data-stu-id="5fd8a-164">Active Directory operations masters</span></span>

<span data-ttu-id="5fd8a-165">A műveleti főkiszolgáló szerepkör rendelhet az Active Directory tartományi szolgáltatások tartományvezérlő támogatja a konzisztencia-ellenőrzés az Active Directory tartományi szolgáltatások replikációs adatbázisok példányai között.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-165">The operations masters role can be assigned to AD DS domain controllers to support consistency checking between instances of replicated AD DS databases.</span></span> <span data-ttu-id="5fd8a-166">Öt műveleti főkiszolgálói szerepkörök állnak rendelkezésre: séma-főkiszolgáló, a tartománynév-kiosztási főkiszolgálót, a relatív azonosítók főkiszolgálója, a elsődleges tartományvezérlő fő emulátor és a infrastruktúra-főkiszolgálóhoz.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-166">There are five operations master roles: schema master, domain naming master, relative identifier master, primary domain controller master emulator, and infrastructure master.</span></span> <span data-ttu-id="5fd8a-167">Ezek a szerepkörök kapcsolatos további információkért lásd: [Mik azok a műveleti főkiszolgálók?] [ad-ds-operations-masters].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-167">For more information about these roles, see [What are Operations Masters?][ad-ds-operations-masters].</span></span>

<span data-ttu-id="5fd8a-168">Azt javasoljuk, hogy nem rendel műveleti főkiszolgálói szerepkörökre az Azure szolgáltatásba telepített tartományvezérlőre.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-168">We recommend you do not assign operations masters roles to the domain controllers deployed in Azure.</span></span>

### <a name="monitoring"></a><span data-ttu-id="5fd8a-169">Monitorozás</span><span class="sxs-lookup"><span data-stu-id="5fd8a-169">Monitoring</span></span>

<span data-ttu-id="5fd8a-170">A tartományvezérlő virtuális gépeket, valamint az AD DS szolgáltatások erőforrások figyelése, és hozzon létre egy csomagot, hogy gyorsan javítsa az esetleges problémákat.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-170">Monitor the resources of the domain controller VMs as well as the AD DS Services and create a plan to quickly correct any problems.</span></span> <span data-ttu-id="5fd8a-171">További információkért lásd: [Active Directory figyelési][monitoring_ad].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-171">For more information, see [Monitoring Active Directory][monitoring_ad].</span></span> <span data-ttu-id="5fd8a-172">Eszközök is telepítheti, mint [Microsoft Systems Center] [ microsoft_systems_center] a felügyeleti kiszolgálón (lásd az architektúra diagramja) segítségével a következő feladatok végrehajtására.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-172">You can also install tools such as [Microsoft Systems Center][microsoft_systems_center] on the monitoring server (see the architecture diagram) to help perform these tasks.</span></span>  

## <a name="scalability-considerations"></a><span data-ttu-id="5fd8a-173">Méretezési szempontok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-173">Scalability considerations</span></span>

<span data-ttu-id="5fd8a-174">Active Directory tartományi szolgáltatások célja, a méretezhetőség érdekében.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-174">AD DS is designed for scalability.</span></span> <span data-ttu-id="5fd8a-175">Nem kell terheléselosztót vagy az Active Directory tartományi szolgáltatások tartományvezérlő kéréseiket forgalom vezérlő konfigurálása.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-175">You don't need to configure a load balancer or traffic controller to direct requests to AD DS domain controllers.</span></span> <span data-ttu-id="5fd8a-176">A csak méretezhetőség szempont, hogy az Adatbetöltési követelményeinek futó Active Directory tartományi szolgáltatások a hálózat megfelelő méretűek a virtuális gép konfigurálásához, a figyelheti a virtuális gépek és a skála felfelé vagy lefelé szükség szerint terhelését.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-176">The only scalability consideration is to configure the VMs running AD DS with the correct size for your network load requirements, monitor the load on the VMs, and scale up or down as necessary.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="5fd8a-177">Rendelkezésre állási szempontok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-177">Availability considerations</span></span>

<span data-ttu-id="5fd8a-178">A az AD DS-ben futó virtuális gépeket telepíteni egy [rendelkezésre állási csoport][availability-set].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-178">Deploy the VMs running AD DS into an [availability set][availability-set].</span></span> <span data-ttu-id="5fd8a-179">Fontolja meg is, a szerepkör hozzárendelése [készenléti műveleti főkiszolgáló] [ standby-operations-masters] legalább egy kiszolgálót, és esetleg a követelményeitől függően több.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-179">Also, consider assigning the role of [standby operations master][standby-operations-masters] to at least one server, and possibly more depending on your requirements.</span></span> <span data-ttu-id="5fd8a-180">A készenléti műveleti főkiszolgáló egy aktív másolatot készít a műveleti főkiszolgáló, amely a feladatátvétel során főkiszolgálók kiszolgáló elsődleges műveletek helyett használható.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-180">A standby operations master is an active copy of the operations master that can be used in place of the primary operations masters server during fail over.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="5fd8a-181">Felügyeleti szempontok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-181">Manageability considerations</span></span>

<span data-ttu-id="5fd8a-182">Rendszeresen biztonsági másolatokat Active Directory tartományi Szolgáltatásokban.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-182">Perform regular AD DS backups.</span></span> <span data-ttu-id="5fd8a-183">Nem egyszerűen másolása a VHD-fájlok helyett rendszeres biztonsági mentéseket a tartományvezérlők, mert az Active Directory tartományi szolgáltatások adatbázis-fájl a virtuális merevlemez nem, előfordulhat, konzisztens állapotban másolását követően lehetetlenné indítsa újra az adatbázist.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-183">Don't simply copy the VHD files of domain controllers instead of performing regular backups, because the AD DS database file on the VHD may not be in a consistent state when it's copied, making it impossible to restart the database.</span></span>

<span data-ttu-id="5fd8a-184">Nem állnak le egy tartományvezérlő virtuális Gépnek az Azure portál használatával.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-184">Do not shut down a domain controller VM using Azure portal.</span></span> <span data-ttu-id="5fd8a-185">Ehelyett állítsa le és indítsa újra a vendég operációs rendszerből.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-185">Instead, shut down and restart from the guest operating system.</span></span> <span data-ttu-id="5fd8a-186">A portálon keresztül kikapcsol a virtuális gép felszabadítása, amely mindkét alaphelyzetbe állítja a `VM-GenerationID` és a `invocationID` az Active Directory-tárház.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-186">Shutting down through the portal causes the VM to be deallocated, which resets both the `VM-GenerationID` and the `invocationID` of the Active Directory repository.</span></span> <span data-ttu-id="5fd8a-187">Ez az Active Directory tartományi szolgáltatások relatív azonosító (RID) készlet elveti jelöli meg a SYSVOL nem mérvadó, és előfordulhat, hogy a tartományvezérlő újrakonfigurálása.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-187">This discards the AD DS relative identifier (RID) pool and marks SYSVOL as nonauthoritative, and may require reconfiguration of the domain controller.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="5fd8a-188">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="5fd8a-188">Security considerations</span></span>

<span data-ttu-id="5fd8a-189">AD DS-kiszolgálók hitelesítési szolgáltatásokat nyújtanak, és egy vonzó célhoz támadások.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-189">AD DS servers provide authentication services and are an attractive target for attacks.</span></span> <span data-ttu-id="5fd8a-190">A biztonságos, megelőzése közvetlen internetkapcsolattal helyezi el az Active Directory tartományi szolgáltatások kiszolgálók külön alhálózathoz van egy tűzfal működött egy NSG.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-190">To secure them, prevent direct Internet connectivity by placing the AD DS servers in a separate subnet with an NSG acting as a firewall.</span></span> <span data-ttu-id="5fd8a-191">Zárja be az Active Directory tartományi szolgáltatások kiszolgálók szükséges hitelesítési, engedélyezési és szinkronizálási kiszolgáló kivételével minden port.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-191">Close all ports on the AD DS servers except those necessary for authentication, authorization, and server synchronization.</span></span> <span data-ttu-id="5fd8a-192">További információkért lásd: [Active Directory és az Active Directory Domain Services Port Requirements][ad-ds-ports].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-192">For more information, see [Active Directory and Active Directory Domain Services Port Requirements][ad-ds-ports].</span></span>

<span data-ttu-id="5fd8a-193">Vegye fontolóra egy további biztonsági szegélyhálózati körül alhálózatokat és NVAs, két kiszolgálók leírtak [valósít meg olyan biztonságos hibrid hálózati architektúra Internet-hozzáféréssel rendelkező Azure] [ implementing-a-secure-hybrid-network-architecture-with-internet-access].</span><span class="sxs-lookup"><span data-stu-id="5fd8a-193">Consider implementing an additional security perimeter around servers with a pair of subnets and NVAs, as described in [Implementing a secure hybrid network architecture with Internet access in Azure][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span></span>

<span data-ttu-id="5fd8a-194">A BitLocker vagy a Azure lemeztitkosítás segítségével titkosíthatja a lemezt az AD DS-adatbázis tárolásához.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-194">Use either BitLocker or Azure disk encryption to encrypt the disk hosting the AD DS database.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="5fd8a-195">A megoldás üzembe helyezése</span><span class="sxs-lookup"><span data-stu-id="5fd8a-195">Deploy the solution</span></span>

<span data-ttu-id="5fd8a-196">A megoldás érhető el a [GitHub] [ github] központi telepítése a referencia-architektúrában.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-196">A solution is available on [GitHub][github] to deploy this reference architecture.</span></span> <span data-ttu-id="5fd8a-197">Szüksége lesz a legújabb verzióját a [Azure CLI] [ azure-powershell] futtatni a Powershell-parancsfájlt, amely a megoldás telepít.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-197">You will need the latest version of the [Azure CLI][azure-powershell] to run the Powershell script that deploys the solution.</span></span> <span data-ttu-id="5fd8a-198">A referencia-architektúrában telepítéséhez kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="5fd8a-198">To deploy the reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="5fd8a-199">Töltse le, vagy klónozza a megoldás mappát [GitHub] [ github] a helyi számítógépre.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-199">Download or clone the solution folder from [GitHub][github] to your local machine.</span></span>

2. <span data-ttu-id="5fd8a-200">Nyissa meg az Azure parancssori felület, és keresse meg a helyi mappát.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-200">Open the Azure CLI and navigate to the local solution folder.</span></span>

3. <span data-ttu-id="5fd8a-201">Futtassa az alábbi parancsot:</span><span class="sxs-lookup"><span data-stu-id="5fd8a-201">Run the following command:</span></span>
    ```Powershell
    .\Deploy-ReferenceArchitecture.ps1 <subscription id> <location> <mode>
    ```
    <span data-ttu-id="5fd8a-202">Cserélje le `<subscription id>` az Azure-előfizetés-azonosítóval.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-202">Replace `<subscription id>` with your Azure subscription ID.</span></span>
    <span data-ttu-id="5fd8a-203">A `<location>` paraméter esetében adjon meg egy Azure-régiót (pl. `eastus` vagy `westus`).</span><span class="sxs-lookup"><span data-stu-id="5fd8a-203">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span>
    <span data-ttu-id="5fd8a-204">A `<mode>` paraméter szabályozza a lépésköz legyen a központi telepítést, és a következő értékek egyike lehet:</span><span class="sxs-lookup"><span data-stu-id="5fd8a-204">The `<mode>` parameter controls the granularity of the deployment, and can be one of the following values:</span></span>
    * <span data-ttu-id="5fd8a-205">`Onpremise`: a helyszíni szimulált környezetben telepíti.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-205">`Onpremise`: deploys the simulated on-premises environment.</span></span>
    * <span data-ttu-id="5fd8a-206">`Infrastructure`: az Azure virtuális hálózat infrastruktúra és a jump mezőben telepíti.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-206">`Infrastructure`: deploys the VNet infrastructure and jump box in Azure.</span></span>
    * <span data-ttu-id="5fd8a-207">`CreateVpn`: az Azure virtuális hálózati átjáró telepíti, és azt a szimulált a helyszíni hálózathoz csatlakozik.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-207">`CreateVpn`: deploys the Azure virtual network gateway and connects it to the simulated on-premises network.</span></span>
    * <span data-ttu-id="5fd8a-208">`AzureADDS`: telepíti az Active Directory tartományi szolgáltatások kiszolgálóként működnek virtuális gépek, virtuális gépeken telepíti az Active Directory és az Azure-ban a tartomány telepíti.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-208">`AzureADDS`: deploys the VMs acting as AD DS servers, deploys Active Directory to these VMs, and deploys the domain in Azure.</span></span>
    * <span data-ttu-id="5fd8a-209">`Workload`: a nyilvános és titkos DMZ-k és a munkaterhelés szint telepíti.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-209">`Workload`: deploys the public and private DMZs and the workload tier.</span></span>
    * <span data-ttu-id="5fd8a-210">`All`: az előző központitelepítéseinek listáját, telepíti.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-210">`All`: deploys all of the preceding deployments.</span></span> <span data-ttu-id="5fd8a-211">**Ez a lehetőség ajánlott, ha Ha nem rendelkezik meglévő helyszíni hálózati, de a fent ismertetett tesztelési vagy a kiértékelési teljes referencia-architektúrában telepíteni szeretné.**</span><span class="sxs-lookup"><span data-stu-id="5fd8a-211">**This is the recommended option if If you do not have an existing on-premises network but you want to deploy the complete reference architecture described above for testing or evaluation.**</span></span>

4. <span data-ttu-id="5fd8a-212">Várjon, amíg az üzembe helyezés befejeződik.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-212">Wait for the deployment to complete.</span></span> <span data-ttu-id="5fd8a-213">Ha telepíti a `All` központi telepítését, a több óráig tart.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-213">If you are deploying the `All` deployment, it will take several hours.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5fd8a-214">További lépések</span><span class="sxs-lookup"><span data-stu-id="5fd8a-214">Next steps</span></span>

* <span data-ttu-id="5fd8a-215">A gyakorlati tanácsokat [létrehozása az Active Directory tartományi szolgáltatások Erőforráserdő] [ adds-resource-forest] az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-215">Learn the best practices for [creating an AD DS resource forest][adds-resource-forest] in Azure.</span></span>
* <span data-ttu-id="5fd8a-216">A gyakorlati tanácsokat [egy Active Directory összevonási szolgáltatások (AD FS) infrastruktúra létrehozásának] [ adfs] az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="5fd8a-216">Learn the best practices for [creating an Active Directory Federation Services (AD FS) infrastructure][adfs] in Azure.</span></span>

<!-- links -->
[adds-resource-forest]: adds-forest.md
[adfs]: adfs.md

[implementing-a-secure-hybrid-network-architecture]: ../dmz/secure-vnet-hybrid.md
[implementing-a-secure-hybrid-network-architecture-with-internet-access]: ../dmz/secure-vnet-dmz.md

[active-directory-domain-services]: https://technet.microsoft.com/library/dd448614.aspx
[adds-data-disks]: https://msdn.microsoft.com/library/azure/jj156090.aspx#BKMK_PlaceDB
[ad-ds-operations-masters]: https://technet.microsoft.com/library/cc779716(v=ws.10).aspx
[ad-ds-ports]: https://technet.microsoft.com/library/dd772723(v=ws.11).aspx
[availability-set]: /azure/virtual-machines/virtual-machines-windows-create-availability-set
[azure-expressroute]: https://azure.microsoft.com/documentation/articles/expressroute-introduction/
[azure-powershell]: /powershell/azureps-cmdlets-docs
[azure-vpn-gateway]: https://azure.microsoft.com/documentation/articles/vpn-gateway-about-vpngateways/
[capacity-planning-for-adds]: http://social.technet.microsoft.com/wiki/contents/articles/14355.capacity-planning-for-active-directory-domain-services.aspx
[considerations]: ./considerations.md
[GitHub]: https://github.com/mspnp/reference-architectures/tree/master/identity/adds-extend-domain
[microsoft_systems_center]: https://www.microsoft.com/server-cloud/products/system-center-2016/
[monitoring_ad]: https://msdn.microsoft.com/library/bb727046.aspx
[security-considerations]: #security-considerations
[set-a-static-ip-address]: https://azure.microsoft.com/documentation/articles/virtual-networks-static-private-ip-arm-pportal/
[standby-operations-masters]: https://technet.microsoft.com/library/cc794737(v=ws.10).aspx
[visio-download]: https://archcenter.azureedge.net/cdn/identity-architectures.vsdx
[vm-windows-sizes]: /azure/virtual-machines/virtual-machines-windows-sizes

[0]: ./images/adds-extend-domain.png "biztonságos és az Active Directory hibrid hálózati architektúra"
