---
title: A Python-modellek valós idejű pontozása
titleSuffix: Azure Reference Architectures
description: Ez a referenciaarchitektúra bemutatja, hogyan helyezhet üzembe Python-modelleket az Azure-ra előrejelzéseket valós idejű webszolgáltatásként.
author: msalvaris
ms.date: 01/28/2019
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat-ai
ms.openlocfilehash: ba2d9a295e5a231f0ffca9e3cf2d53ace4deddfe
ms.sourcegitcommit: 1ee873aaf40010eb2a38314ac56974bc9e227736
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 01/28/2019
ms.locfileid: "55141033"
---
# <a name="real-time-scoring-of-python-scikit-learn-and-deep-learning-models-on-azure"></a><span data-ttu-id="5bfb0-103">Valós idejű pontozási Python Scikit-ismerje meg, és a deep learning-modellek az Azure-ban</span><span class="sxs-lookup"><span data-stu-id="5bfb0-103">Real-time scoring of Python Scikit-Learn and deep learning models on Azure</span></span>

<span data-ttu-id="5bfb0-104">Ez a referenciaarchitektúra bemutatja, hogyan helyezhet üzembe Python modelleket webszolgáltatásként, hogy az Azure Machine Learning szolgáltatás használatával valós idejű előrejelzéseket végezzen.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-104">This reference architecture shows how to deploy Python models as web services to make real-time predictions using the Azure Machine Learning service.</span></span> <span data-ttu-id="5bfb0-105">Két esetben terjed ki: reguláris Python-modellek és a konkrét követelmények, deep learning-modellek üzembe helyezésének telepítése.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-105">Two scenarios are covered: deploying regular Python models, and the specific requirements of deploying deep learning models.</span></span> <span data-ttu-id="5bfb0-106">Mindkét forgatókönyvet használja az architektúra látható.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-106">Both scenarios use the architecture shown.</span></span>

<span data-ttu-id="5bfb0-107">Ez az architektúra két hivatkozás megvalósításait érhetők el a Githubon, egyet-egyet [rendszeres Python modellek] [ github-python] és a egy [deep learning-modellek] [ github-dl].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-107">Two reference implementations for this architecture are available on GitHub, one for [regular Python models][github-python] and one for [deep learning models][github-dl].</span></span>

![Az Azure-ban a Python-modellek a valós idejű pontozás architektúra diagramja](./_images/python-model-architecture.png)

## <a name="scenarios"></a><span data-ttu-id="5bfb0-109">Forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="5bfb0-109">Scenarios</span></span>

<span data-ttu-id="5bfb0-110">A referencia-megvalósítások Ez az architektúra használatával két forgatókönyvet mutatják be.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-110">The reference implementations demonstrate two scenarios using this architecture.</span></span>

<span data-ttu-id="5bfb0-111">**1. forgatókönyv: Gyakori kérdések a megfelelő**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-111">**Scenario 1: FAQ matching**.</span></span> <span data-ttu-id="5bfb0-112">Ebből a forgatókönyvből megtudhatja, hogyan helyezhet üzembe egy gyakori kérdések (GYIK) megfelelő modellt webszolgáltatásként, amely felhasználói kérdések adatokat biztosít.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-112">This scenario shows how to deploy a frequently asked questions (FAQ) matching model as a web service to provide predictions for user questions.</span></span> <span data-ttu-id="5bfb0-113">Ebben a forgatókönyvben az architektúra diagramját "bemeneti adatok" felhasználói kérdések felel meg a gyakori kérdések listáját tartalmazó szöveges karakterlánc hivatkozik.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-113">For this scenario, "Input Data" in the architecture diagram refers to text strings containing user questions to match with a list of FAQs.</span></span> <span data-ttu-id="5bfb0-114">Ebben a forgatókönyvben készült a [scikit-további] [ scikit] machine learning-kódtár Pythonhoz készült, de bármilyen forgatókönyvhöz, amely a Python-modell segítségével valós idejű előrejelzéseket általánosítva is.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-114">This scenario is designed for the [scikit-learn][scikit] machine learning library for Python, but can be generalized to any scenario that uses Python models to make real-time predictions.</span></span>

<span data-ttu-id="5bfb0-115">Ebben a forgatókönyvben az adatok egy részét Stack Overflow kérdés, amely tartalmazza az eredeti kérdések, JavaScript, az ismétlődő kérdések és a válaszok címkével használ.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-115">This scenario uses a subset of Stack Overflow question data that includes original questions tagged as JavaScript, their duplicate questions, and their answers.</span></span> <span data-ttu-id="5bfb0-116">Ez betanítja a scikit-ismerje meg a folyamat használatával előrejelzi az egyes az eredeti kérdések a ismétlődő kérdés egyezés valószínűségét.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-116">It trains a scikit-learn pipeline to predict the match probability of a duplicate question with each of the original questions.</span></span> <span data-ttu-id="5bfb0-117">Ezek az előrejelzések egy REST API-végpont használatával valós időben történik.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-117">These predictions are made in real time using a REST API endpoint.</span></span>

<span data-ttu-id="5bfb0-118">Az architektúra az alkalmazás folyamata a következőképpen történik:</span><span class="sxs-lookup"><span data-stu-id="5bfb0-118">The application flow for this architecture is as follows:</span></span>

1. <span data-ttu-id="5bfb0-119">A betanított modell regisztrálva van a Machine Learning-modell beállításjegyzék.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-119">The trained model is registered to the Machine Learning model registry.</span></span>
2. <span data-ttu-id="5bfb0-120">A Machine Learning szolgáltatás egy Docker-rendszerképet, amely tartalmazza a modell és a pontozó szkript hoz létre.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-120">The Machine Learning service creates a Docker image that includes the model and scoring script.</span></span>
3. <span data-ttu-id="5bfb0-121">Machine Learning webszolgáltatásként üzembe helyezi a pontozási lemezképet az Azure Kubernetes Service (AKS).</span><span class="sxs-lookup"><span data-stu-id="5bfb0-121">Machine Learning deploys the scoring image on Azure Kubernetes Service (AKS) as a web service.</span></span>
4. <span data-ttu-id="5bfb0-122">Az ügyfél a kódolt kérdés adatokkal HTTP POST-kérelmet küld.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-122">The client sends an HTTP POST request with the encoded question data.</span></span>
5. <span data-ttu-id="5bfb0-123">A webszolgáltatás a gépi tanulás által létrehozott kibontja a kérdést a kérelemből.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-123">The web service created by Machine Learning extracts the question from the request.</span></span>
6. <span data-ttu-id="5bfb0-124">A kérdés a Scikit-további adatfolyamat-modell featurization és pontozás küld.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-124">The question is sent to the Scikit-learn pipeline model for featurization and scoring.</span></span> 
7. <span data-ttu-id="5bfb0-125">A megfelelő – gyakori kérdések a kérdéseket a pontszámok is küld vissza az ügyfélnek.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-125">The matching FAQ questions with their scores are returned to the client.</span></span>

<span data-ttu-id="5bfb0-126">Íme egy Képernyőkép a PéldaAlkalmazás, amely az eredményeket fel:</span><span class="sxs-lookup"><span data-stu-id="5bfb0-126">Here is a screenshot of the example app that consumes the results:</span></span>

![A PéldaAlkalmazás képernyőképe](./_images/python-faq-matches.png)

<span data-ttu-id="5bfb0-128">**2. forgatókönyv: Kép besorolási**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-128">**Scenario 2: Image classification**.</span></span> <span data-ttu-id="5bfb0-129">Ez a forgatókönyv bemutatja, hogyan modell üzembe helyezése Konvolúciós Neurális hálózat (CNN) webszolgáltatásként, amely előrejelzéseket meg képeket.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-129">This scenario shows how to deploy a Convolutional Neural Network (CNN) model as a web service to provide predictions on images.</span></span> <span data-ttu-id="5bfb0-130">Ebben a forgatókönyvben az architektúra diagramját "bemeneti adatok" képfájlok hivatkozik.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-130">For this scenario, "Input Data" in the architecture diagram refers to image files.</span></span> <span data-ttu-id="5bfb0-131">Cnn-EK nagyon hatékonyak a számítógépes látástechnológiai olyan feladatokhoz, mint a képek besorolása és objektumfelismeréshez.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-131">CNNs are very effective in computer vision for tasks such as image classification and object detection.</span></span> <span data-ttu-id="5bfb0-132">Ebben a forgatókönyvben a keretrendszereket, TensorFlow, a Keras (háttérrendszerrel a tensorflow-hoz) és a PyTorch lett tervezve.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-132">This scenario is designed for the frameworks TensorFlow, Keras (with the TensorFlow back end), and PyTorch.</span></span> <span data-ttu-id="5bfb0-133">Azonban azt is általánosítva bármilyen forgatókönyvhöz, amely valós idejű előrejelzéseket deep learning-modellek segítségével.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-133">However, it can be generalized to any scenario that uses deep learning models to make real-time predictions.</span></span>

<span data-ttu-id="5bfb0-134">Ez a forgatókönyv ResNet-152 előre betanított modell előre jelezni az eseménykategóriát épít – 1 K (1000 osztályok) adatkészlet tanított használ (lásd az alábbi ábrát) lemezkép tartozik.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-134">This scenario uses a pre-trained ResNet-152 model trained on ImageNet-1K (1,000 classes) dataset to predict which category (see figure below) an image belongs to.</span></span> <span data-ttu-id="5bfb0-135">Ezek az előrejelzések egy REST API-végpont használatával valós időben történik.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-135">These predictions are made in real time using a REST API endpoint.</span></span>

![Előrejelzés – példa](./_images/python-example-predictions.png)

<span data-ttu-id="5bfb0-137">Deep learning-modellhez az alkalmazás folyamata a következőképpen történik:</span><span class="sxs-lookup"><span data-stu-id="5bfb0-137">The application flow for the deep learning model is as follows:</span></span>

1. <span data-ttu-id="5bfb0-138">A deep learning-modell regisztrálva van a Machine Learning-modell beállításjegyzék.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-138">The deep learning model is registered to the Machine Learning model registry.</span></span>
2. <span data-ttu-id="5bfb0-139">A Machine Learning szolgáltatás egy docker-rendszerképet, beleértve a modell és a pontozó szkript hoz létre.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-139">The Machine Learning service creates a docker image including the model and scoring script.</span></span>
3. <span data-ttu-id="5bfb0-140">Machine Learning webszolgáltatásként üzembe helyezi a pontozási lemezképet az Azure Kubernetes Service (AKS).</span><span class="sxs-lookup"><span data-stu-id="5bfb0-140">Machine Learning deploys the scoring image on Azure Kubernetes Service (AKS) as a web service.</span></span>
4. <span data-ttu-id="5bfb0-141">Az ügyfél a kódolt kép adatokkal HTTP POST-kérelmet küld.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-141">The client sends an HTTP POST request with the encoded image data.</span></span>
5. <span data-ttu-id="5bfb0-142">A webszolgáltatás a gépi tanulás által létrehozott preprocesses a rendszerkép-adatok, és elküldi a modell pontozása.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-142">The web service created by Machine Learning preprocesses the image data and sends it to the model for scoring.</span></span> 
6. <span data-ttu-id="5bfb0-143">Az előre jelzett kategóriák eredményeiket is küld vissza az ügyfélnek.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-143">The predicted categories with their scores are returned to the client.</span></span>

## <a name="architecture"></a><span data-ttu-id="5bfb0-144">Architektúra</span><span class="sxs-lookup"><span data-stu-id="5bfb0-144">Architecture</span></span>

<span data-ttu-id="5bfb0-145">Az architektúra az alábbi összetevőkből áll.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-145">This architecture consists of the following components.</span></span>

<span data-ttu-id="5bfb0-146">**[Az Azure Machine Learning szolgáltatás] [ aml]**  egy felhőalapú szolgáltatás, amellyel betanításához, üzembe helyezése, automatizálhatja és gépi tanulási modelleket, minden a felhőbeli biztosít széles körű skála kezelése.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-146">**[Azure Machine Learning service][aml]** is a cloud service that is used to train, deploy, automate and manage machine learning models, all at the broad scale that the cloud provides.</span></span> <span data-ttu-id="5bfb0-147">Szolgál ebben az architektúrában a modelleket, valamint a hitelesítést, az Útválasztás, a központi telepítés kezelése és a terheléselosztás, a webszolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-147">It is used in this architecture to manage the deployment of models as well as authentication, routing, and load balancing of the web service.</span></span>

<span data-ttu-id="5bfb0-148">**[Virtuális gép] [ vm]**  (VM).</span><span class="sxs-lookup"><span data-stu-id="5bfb0-148">**[Virtual machine][vm]** (VM).</span></span> <span data-ttu-id="5bfb0-149">A virtuális gép jelenik meg, mint például az eszköz &mdash; helyi vagy felhőbeli &mdash; , amely a HTTP-kérést küldhet.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-149">The VM is shown as an example of a device &mdash; local or in the cloud &mdash; that can send an HTTP request.</span></span>

<span data-ttu-id="5bfb0-150">**[Az Azure Kubernetes Service] [ aks]**  (AKS) segítségével helyezze üzembe az alkalmazást a Kubernetes-fürtön.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-150">**[Azure Kubernetes Service][aks]** (AKS) is used to deploy the application on a Kubernetes cluster.</span></span> <span data-ttu-id="5bfb0-151">Az AKS egyszerűsíti az üzembe helyezés és a kubernetes az operations.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-151">AKS simplifies the deployment and operations of Kubernetes.</span></span> <span data-ttu-id="5bfb0-152">A fürt a Python-modell rendszeres vagy GPU-kompatibilis virtuális gépek deep learning-modellek csak CPU virtuális gépek használatával konfigurálható.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-152">The cluster can be configured using CPU-only VMs for regular Python models or GPU-enabled VMs for deep learning models.</span></span>

<span data-ttu-id="5bfb0-153">**[Az Azure Container Registry] [ acr]**  lehetővé teszi, hogy a storage-lemezképeket, beleértve a DC/OS, Docker Swarm és Kubernetes Docker-tárolók üzembe helyezésének összes típusa esetében.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-153">**[Azure Container Registry][acr]** enables storage of images for all types of Docker container deployments including DC/OS, Docker Swarm and Kubernetes.</span></span> <span data-ttu-id="5bfb0-154">A pontozó rendszerképek üzembe helyezve az Azure Kubernetes Service-tárolók és a pontozó szkript futtatásához használt.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-154">The scoring images are deployed as containers on Azure Kubernetes Service and used to run the scoring script.</span></span> <span data-ttu-id="5bfb0-155">Az itt használt lemezképet a betanított modell és a pontozó szkript gépi tanulás által létrehozott, és ezután a rendszer továbbítja az Azure Container Registrybe.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-155">The image used here is created by Machine Learning from the trained model and scoring script, and then is pushed to the Azure Container Registry.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="5bfb0-156">A teljesítménnyel kapcsolatos megfontolások</span><span class="sxs-lookup"><span data-stu-id="5bfb0-156">Performance considerations</span></span>

<span data-ttu-id="5bfb0-157">Valós idejű pontozási architektúrák az átviteli teljesítmény válik domináns veszi figyelembe.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-157">For real-time scoring architectures, throughput performance becomes a dominant consideration.</span></span> <span data-ttu-id="5bfb0-158">Python-modellek rendszeres általánosan elfogadott, hogy a processzorok elegendőek a számítási feladatok kezelésére.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-158">For regular Python models, it's generally accepted that CPUs are sufficient to handle the workload.</span></span>

<span data-ttu-id="5bfb0-159">Azonban deep learning számítási feladatokhoz, amikor sebessége szűk keresztmetszetet gpu-k általánosan biztosítja jobban [teljesítmény] [ gpus-vs-cpus] processzorok képest.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-159">However for deep learning workloads, when speed is a bottleneck, GPUs generally provide better [performance][gpus-vs-cpus] compared to CPUs.</span></span> <span data-ttu-id="5bfb0-160">Megfelelő processzorokat használata GPU-teljesítményét, nagy mennyiségű processzor-fürt általában van szükség.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-160">To match GPU performance using CPUs, a cluster with large number of CPUs is usually needed.</span></span>

<span data-ttu-id="5bfb0-161">Mindkét forgatókönyvre érvényes ez az architektúra a processzorok is használhat, de deep learning-modellek, gpu-kat nyújt a jelentősen nagyobb átviteli sebesség értékek hasonló díjmentes CPU fürt képest.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-161">You can use CPUs for this architecture in either scenario, but for deep learning models, GPUs provide significantly higher throughput values compared to a CPU cluster of similar cost.</span></span> <span data-ttu-id="5bfb0-162">Az AKS támogatja a GPU-k, ez az egyik előnye az AKS használatával Ez az architektúra.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-162">AKS supports the use of GPUs, which is one advantage of using AKS for this architecture.</span></span> <span data-ttu-id="5bfb0-163">Ezenkívül deep learning-telepítések általában modellek használata nagy számú paraméterrel.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-163">Also, deep learning deployments typically use models with a high number of parameters.</span></span> <span data-ttu-id="5bfb0-164">Gpu-k használata megakadályozza, hogy a versengés az erőforrásokat a modell és a webes szolgáltatást, amely a hiba csak CPU-telepítések között.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-164">Using GPUs prevents contention for resources between the model and the web service, which is an issue in CPU-only deployments.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="5bfb0-165">Méretezési szempontok</span><span class="sxs-lookup"><span data-stu-id="5bfb0-165">Scalability considerations</span></span>

<span data-ttu-id="5bfb0-166">Gondoskodunk a rendszeres Python modellek, ahol ki van építve az AKS-fürtöt a CPU-csak virtuális gépek, amikor [horizontális felskálázás a podok számát][manually-scale-pods].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-166">For regular Python models, where the AKS cluster is provisioned with CPU-only VMs, take care when [scaling out the number of pods][manually-scale-pods].</span></span> <span data-ttu-id="5bfb0-167">A cél, hogy használja ki teljesen a fürtöt.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-167">The goal is to fully utilize the cluster.</span></span> <span data-ttu-id="5bfb0-168">Skálázás processzorigényét és a podok a meghatározott függ.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-168">Scaling depends on the CPU requests and limits defined for the pods.</span></span> <span data-ttu-id="5bfb0-169">Emellett támogatja a Machine Learning segítségével Kubernetes [podok automatikus skálázás] [ autoscale-pods] CPU-kihasználtság és más metrikák alapján.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-169">Machine Learning through Kubernetes also supports [pod autoscaling][autoscale-pods] based on CPU utilization or other metrics.</span></span> <span data-ttu-id="5bfb0-170">A [méretező fürt] [ autoscaler] (az előzetes verzió) skálázhatja ügynökcsomópontok a függőben lévő podok alapján.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-170">The [cluster autoscaler][autoscaler] (in preview) can scale agent nodes based on the pending pods.</span></span>

<span data-ttu-id="5bfb0-171">Deep learning-forgatókönyvek, GPU-kompatibilis virtuális gépek használatával erőforráskorlátok a podok is úgy, hogy egy GPU hozzá van rendelve egy pod.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-171">For deep learning scenarios, using GPU-enabled VMs, resource limits on pods are such that one GPU is assigned to one pod.</span></span> <span data-ttu-id="5bfb0-172">Virtuális gép használt típusától függően kell [a fürt csomópontjainak méretezése] [ scale-cluster] a szolgáltatás iránti igény kielégítése érdekében.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-172">Depending on the type of VM used, you must [scale the nodes of the cluster][scale-cluster] to meet the demand for the service.</span></span> <span data-ttu-id="5bfb0-173">Ezt az Azure CLI-vel és a kubectl használatával könnyedén megteheti.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-173">You can do this easily using the Azure CLI and kubectl.</span></span>

## <a name="monitoring-and-logging-considerations"></a><span data-ttu-id="5bfb0-174">Figyelés és naplózás kapcsolatos szempontok</span><span class="sxs-lookup"><span data-stu-id="5bfb0-174">Monitoring and logging considerations</span></span>

### <a name="aks-monitoring"></a><span data-ttu-id="5bfb0-175">AKS-figyelés</span><span class="sxs-lookup"><span data-stu-id="5bfb0-175">AKS monitoring</span></span>

<span data-ttu-id="5bfb0-176">Betekintést nyerhet az AKS-teljesítmény, használja a [-tárolókhoz az Azure Monitor] [ monitor-containers] funkció.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-176">For visibility into AKS performance, use the [Azure Monitor for containers][monitor-containers] feature.</span></span> <span data-ttu-id="5bfb0-177">Tartományvezérlők, a csomópontok és a Kubernetes, a metrikák API-n keresztül a rendelkezésre álló tárolók memória- és metrikákat gyűjt.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-177">It collects memory and processor metrics from controllers, nodes, and containers that are available in Kubernetes through the Metrics API.</span></span>

<span data-ttu-id="5bfb0-178">Az alkalmazás üzembe helyezése közben figyelheti az AKS-fürtöt, győződjön meg arról, hogy a várt módon működik, a csomópontokon működnek, és minden podok is futnak.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-178">While deploying your application, monitor the AKS cluster to make sure it's working as expected, all the nodes are operational, and all pods are running.</span></span> <span data-ttu-id="5bfb0-179">Bár használhatja a [kubectl] [ kubectl] is beolvasni a pod állapotát, a Kubernetes parancssori eszköz tartalmaz egy webes irányítópultot, a fürt állapota és a felügyeleti alapszintű figyeléséhez.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-179">Although you can use the [kubectl][kubectl] command-line tool to retrieve pod status, Kubernetes also includes a web dashboard for basic monitoring of the cluster status and management.</span></span>

![A Kubernetes-irányítópult képernyőképe](./_images/python-kubernetes-dashboard.png)

<span data-ttu-id="5bfb0-181">A fürt és a csomópontok általános állapotának megtekintéséhez nyissa meg a **csomópontok** a Kubernetes-irányítópult szakaszában.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-181">To see the overall state of the cluster and nodes, go to the **Nodes** section of the Kubernetes dashboard.</span></span> <span data-ttu-id="5bfb0-182">Ha egy csomópont inaktív vagy nem sikerült, megjelenítheti a hibanaplókat, onnan hivatkozó oldalakon találhat.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-182">If a node is inactive or has failed, you can display the error logs from that page.</span></span> <span data-ttu-id="5bfb0-183">Hasonlóképpen, nyissa meg a **Podok** és **központi telepítések** szakaszokban talál információt a podok számát és a központi telepítés állapotát.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-183">Similarly, go to the **Pods** and **Deployments** sections for information about the number of pods and status of your deployment.</span></span>

### <a name="aks-logs"></a><span data-ttu-id="5bfb0-184">AKS-naplók</span><span class="sxs-lookup"><span data-stu-id="5bfb0-184">AKS logs</span></span>

<span data-ttu-id="5bfb0-185">Az AKS automatikusan naplóz minden stdout/stderr a podok a fürt naplóit.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-185">AKS automatically logs all stdout/stderr to the logs of the pods in the cluster.</span></span> <span data-ttu-id="5bfb0-186">Tekintse át ezeket a kubectl használatával és a is csomópont-szintű eseményeit, és a naplókat.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-186">Use kubectl to see these and also node-level events and logs.</span></span> <span data-ttu-id="5bfb0-187">További információkért lásd: a telepítés lépéseit.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-187">For details, see the deployment steps.</span></span>

<span data-ttu-id="5bfb0-188">Használat [-tárolókhoz az Azure Monitor] [ monitor-containers] metrikák és a linuxhoz, ami a Log Analytics-munkaterületet a Log Analytics-ügynököket tárolóalapú verziója keresztül naplóinak összegyűjtésére.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-188">Use [Azure Monitor for containers][monitor-containers] to collect metrics and logs through a containerized version of the Log Analytics agent for Linux, which is stored in your Log Analytics workspace.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="5bfb0-189">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="5bfb0-189">Security considerations</span></span>

<span data-ttu-id="5bfb0-190">Használja az [Azure Security Centert][security-center] az Azure-erőforrások biztonsági állapotának egy központi felületen való nyomon követéséhez.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-190">Use [Azure Security Center][security-center] to get a central view of the security state of your Azure resources.</span></span> <span data-ttu-id="5bfb0-191">Security Center monitorozza a potenciális biztonsági problémákat, és az üzembe helyezés, a biztonsági állapotának átfogó képet nyújt, bár az ügynök AKS-csomópontok nem figyel.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-191">Security Center monitors potential security issues and provides a comprehensive picture of the security health of your deployment, although it doesn't monitor AKS agent nodes.</span></span> <span data-ttu-id="5bfb0-192">A Security Center Azure-előfizetésenként külön konfigurálandó.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-192">Security Center is configured per Azure subscription.</span></span> <span data-ttu-id="5bfb0-193">Biztonsági adatok gyűjtésének engedélyezése a leírtak szerint [az Azure-előfizetés a Security Center Standard verziójába történő felvételét][get-started].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-193">Enable security data collection as described in [Onboard your Azure subscription to Security Center Standard][get-started].</span></span> <span data-ttu-id="5bfb0-194">Az adatgyűjtés engedélyezése esetén a Security Center automatikusan figyeli az előfizetés alatt létrehozott összes virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-194">When data collection is enabled, Security Center automatically scans any VMs created under that subscription.</span></span>

<span data-ttu-id="5bfb0-195">**Műveletek**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-195">**Operations**.</span></span> <span data-ttu-id="5bfb0-196">Jelentkezzen be egy AKS-fürtöt az Azure Active Directory (Azure AD) hitelesítési jogkivonat használatával, konfigurálja az Azure AD használata az AKS [felhasználói hitelesítés][aad-auth].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-196">To sign in to an AKS cluster using your Azure Active Directory (Azure AD) authentication token, configure AKS to use Azure AD for [user authentication][aad-auth].</span></span> <span data-ttu-id="5bfb0-197">Fürt rendszergazdák is konfigurálhatják Kubernetes szerepköralapú hozzáférés-vezérlés (RBAC) a felhasználó identitását, vagy a könyvtár a csoport tagsága alapján.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-197">Cluster administrators can also configure Kubernetes role-based access control (RBAC) based on a user's identity or directory group membership.</span></span>

<span data-ttu-id="5bfb0-198">Használat [RBAC] [ rbac] üzembe helyezett Azure-erőforrásokhoz való hozzáférés szabályozása.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-198">Use [RBAC][rbac] to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="5bfb0-199">Az RBAC lehetővé teszi, hogy engedélyezési szerepköröket rendeljen a fejlesztő és üzemeltető csapata tagjaihoz.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-199">RBAC lets you assign authorization roles to members of your DevOps team.</span></span> <span data-ttu-id="5bfb0-200">Egy felhasználó több szerepkört kell hozzárendelni, és létrehozhat egyéni szerepköröket a még részletesebb [engedélyek].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-200">A user can be assigned to multiple roles, and you can create custom roles for even more fine-grained [permissions].</span></span>

<span data-ttu-id="5bfb0-201">**HTTPS**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-201">**HTTPS**.</span></span> <span data-ttu-id="5bfb0-202">Biztonsági szempontból ajánlott az alkalmazás kell HTTPS kényszerítése és HTTP-kérést.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-202">As a security best practice, the application should enforce HTTPS and redirect HTTP requests.</span></span> <span data-ttu-id="5bfb0-203">Használja az [bejövőforgalom-vezérlőjéhez] [ ingress-controller] üzembe helyezéséhez a fordított proxy, amely lezárja az SSL, és átirányítja a HTTP-kérelmekre.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-203">Use an [ingress controller][ingress-controller] to deploy a reverse proxy that terminates SSL and redirects HTTP requests.</span></span> <span data-ttu-id="5bfb0-204">További információkért lásd: [hozzon létre egy HTTPS bejövőforgalom-vezérlőt az Azure Kubernetes Service (AKS)][https-ingress].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-204">For more information, see [Create an HTTPS ingress controller on Azure Kubernetes Service (AKS)][https-ingress].</span></span>

<span data-ttu-id="5bfb0-205">**Hitelesítés**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-205">**Authentication**.</span></span> <span data-ttu-id="5bfb0-206">Ez a megoldás nem korlátozza a végpontok való hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-206">This solution doesn't restrict access to the endpoints.</span></span> <span data-ttu-id="5bfb0-207">A vállalati környezetben való felépítésüktől az architektúra üzembe helyezéséhez a végpontok védelme keresztül API-kulcsokat, és valamilyen felhasználói hitelesítés hozzáadása az ügyfélalkalmazásnak.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-207">To deploy the architecture in an enterprise setting, secure the endpoints through API keys and add some form of user authentication to the client application.</span></span>

<span data-ttu-id="5bfb0-208">**Tárolóregisztrációs adatbázis**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-208">**Container registry**.</span></span> <span data-ttu-id="5bfb0-209">A megoldás az Azure Container Registry tárolja a Docker-rendszerképet használja.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-209">This solution uses Azure Container Registry to store the Docker image.</span></span> <span data-ttu-id="5bfb0-210">A kódot, amely az alkalmazás függ, és a modell tartalmazza a rendszerképben.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-210">The code that the application depends on, and the model, are contained within this image.</span></span> <span data-ttu-id="5bfb0-211">Vállalati alkalmazások és kell használnia, privát regisztrációs adatbázis hardvermeghibásodásokkal szemben, rosszindulatú kódot futtató annak érdekében, hogy a tárolóban az adatokat illetéktelen kezekbe kerüljenek.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-211">Enterprise applications should use a private registry to help guard against running malicious code and to help keep the information inside the container from being compromised.</span></span>

<span data-ttu-id="5bfb0-212">**A DDoS protection**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-212">**DDoS protection**.</span></span> <span data-ttu-id="5bfb0-213">Érdemes lehet engedélyezni az [DDoS Protection Standard][ddos].</span><span class="sxs-lookup"><span data-stu-id="5bfb0-213">Consider enabling [DDoS Protection Standard][ddos].</span></span> <span data-ttu-id="5bfb0-214">Alapszintű DDoS protection az Azure platform részeként engedélyezve van, noha a DDoS Protection Standard kockázatcsökkentési képességeket biztosít, amelyek kifejezetten az Azure virtuális hálózati erőforrások, amelyek ideálisak.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-214">Although basic DDoS protection is enabled as part of the Azure platform, DDoS Protection Standard provides mitigation capabilities that are tuned specifically to Azure virtual network resources.</span></span>

<span data-ttu-id="5bfb0-215">**Naplózás**.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-215">**Logging**.</span></span> <span data-ttu-id="5bfb0-216">Ajánlott eljárások használata naplóadatokat, például a felhasználói jelszavakat és egyéb információkat, amelyek segítségével biztonsági csalások tisztítási tárolása előtt.</span><span class="sxs-lookup"><span data-stu-id="5bfb0-216">Use best practices before storing log data, such as scrubbing user passwords and other information that could be used to commit security fraud.</span></span>

## <a name="deployment"></a><span data-ttu-id="5bfb0-217">Környezet</span><span class="sxs-lookup"><span data-stu-id="5bfb0-217">Deployment</span></span>

<span data-ttu-id="5bfb0-218">Ez a referenciaarchitektúra üzembe helyezéséhez kövesse a GitHub-adattárak leírt lépéseket követve:</span><span class="sxs-lookup"><span data-stu-id="5bfb0-218">To deploy this reference architecture, follow the steps described in the GitHub repos:</span></span>

- <span data-ttu-id="5bfb0-219">[Rendszeres Python-modell][github-python]</span><span class="sxs-lookup"><span data-stu-id="5bfb0-219">[Regular Python models][github-python]</span></span>
- <span data-ttu-id="5bfb0-220">[Deep learning-modellek][github-dl]</span><span class="sxs-lookup"><span data-stu-id="5bfb0-220">[Deep learning models][github-dl]</span></span>

<!-- links -->

[aad-auth]: /azure/aks/aad-integration
[acr]: /azure/container-registry/
[something]: https://kubernetes.io/docs/reference/access-authn-authz/authentication/
[aks]: /azure/aks/intro-kubernetes
[autoscaler]: /azure/aks/autoscaler
[autoscale-pods]: /azure/aks/tutorial-kubernetes-scale#autoscale-pods
[azcopy]: /azure/storage/common/storage-use-azcopy-linux
[ddos]: /azure/virtual-network/ddos-protection-overview
[get-started]: /azure/security-center/security-center-get-started
[github-python]: https://github.com/Microsoft/MLAKSDeployAML
[github-dl]: https://github.com/Microsoft/AKSDeploymentTutorial_AML
[gpus-vs-cpus]: https://azure.microsoft.com/en-us/blog/gpus-vs-cpus-for-deployment-of-deep-learning-models/
[https-ingress]: /azure/aks/ingress-tls
[ingress-controller]: https://kubernetes.io/docs/concepts/services-networking/ingress/
[kubectl]: https://kubernetes.io/docs/tasks/tools/install-kubectl/
[aml]: /azure/machine-learning/service/overview-what-is-azure-ml
[manually-scale-pods]: /azure/aks/tutorial-kubernetes-scale#manually-scale-pods
[monitor-containers]: /azure/monitoring/monitoring-container-insights-overview
[engedélyek]: /azure/aks/concepts-identity
[permissions]: /azure/aks/concepts-identity
[rbac]: /azure/active-directory/role-based-access-control-what-is
[scale-cluster]: /azure/aks/scale-cluster
[scikit]: https://pypi.org/project/scikit-learn/
[security-center]: /azure/security-center/security-center-intro
[vm]: /azure/virtual-machines/
