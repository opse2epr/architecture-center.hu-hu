---
title: A mélytanulási modellek kötegelt kiértékelése
titleSuffix: Azure Reference Architectures
description: Ez a referenciaarchitektúra bemutatja, hogyan Neurális stílus átviteli alkalmazandó egy videót, az Azure Machine Learning segítségével.
author: jiata
ms.date: 02/06/2019
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat-ai
ms.openlocfilehash: a1c0701185c85f8e7bcbc183b32c4834529fc524
ms.sourcegitcommit: 1a3cc91530d56731029ea091db1f15d41ac056af
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/03/2019
ms.locfileid: "58887862"
---
# <a name="batch-scoring-of-deep-learning-models-on-azure"></a><span data-ttu-id="0afe3-103">Batch-pontozás deep learning-modellek az Azure-ban</span><span class="sxs-lookup"><span data-stu-id="0afe3-103">Batch scoring of deep learning models on Azure</span></span>

<span data-ttu-id="0afe3-104">Ez a referenciaarchitektúra bemutatja, hogyan Neurális stílus átviteli alkalmazandó egy videót, az Azure Machine Learning segítségével.</span><span class="sxs-lookup"><span data-stu-id="0afe3-104">This reference architecture shows how to apply neural style transfer to a video, using Azure Machine Learning.</span></span> <span data-ttu-id="0afe3-105">*Átviteli stílus* deep learning-módszer, amely egy másik képet stílusát egy meglévő kép composes.</span><span class="sxs-lookup"><span data-stu-id="0afe3-105">*Style transfer* is a deep learning technique that composes an existing image in the style of another image.</span></span> <span data-ttu-id="0afe3-106">Ez az architektúra bármilyen forgatókönyvhöz kötegelt pontozási használatával deep learninget használó is általánosítva.</span><span class="sxs-lookup"><span data-stu-id="0afe3-106">This architecture can be generalized for any scenario that uses batch scoring with deep learning.</span></span> <span data-ttu-id="0afe3-107">[**A megoldás üzembe helyezése.**](#deploy-the-solution)</span><span class="sxs-lookup"><span data-stu-id="0afe3-107">[**Deploy this solution**](#deploy-the-solution).</span></span>

![Az Azure Machine Learning használatával deep learning-modellek architektúra ábrája](./_images/aml-scoring-deep-learning.png)

<span data-ttu-id="0afe3-109">**A forgatókönyv**: Egy media szervezete egy videót, amelynek stílusát, így jelenik meg szeretne, például egy adott festmény.</span><span class="sxs-lookup"><span data-stu-id="0afe3-109">**Scenario**: A media organization has a video whose style they want to change to look like a specific painting.</span></span> <span data-ttu-id="0afe3-110">A szervezet szeretne tudni a stílus alkalmazása időben, és automatizált módon zajlik a videó minden keretet.</span><span class="sxs-lookup"><span data-stu-id="0afe3-110">The organization wants to be able to apply this style to all frames of the video in a timely manner and in an automated fashion.</span></span> <span data-ttu-id="0afe3-111">További ismereteket a Neurális stílus átviteli algoritmusok, lásd: [kép stílus átvitel használata Konvolúciós Neurális hálózatokkal] [ image-style-transfer] (PDF).</span><span class="sxs-lookup"><span data-stu-id="0afe3-111">For more background about neural style transfer algorithms, see [Image Style Transfer Using Convolutional Neural Networks][image-style-transfer] (PDF).</span></span>

<!-- markdownlint-disable MD033 -->

| <span data-ttu-id="0afe3-112">Style-lemezképet:</span><span class="sxs-lookup"><span data-stu-id="0afe3-112">Style image:</span></span> | <span data-ttu-id="0afe3-113">A videó bemeneti/tartalom:</span><span class="sxs-lookup"><span data-stu-id="0afe3-113">Input/content video:</span></span> | <span data-ttu-id="0afe3-114">Kimeneti videót:</span><span class="sxs-lookup"><span data-stu-id="0afe3-114">Output video:</span></span> |
|--------|--------|---------|
| <img src="https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/style_image.jpg" width="300"> | <span data-ttu-id="0afe3-115">[<img src="https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/input_video_image_0.jpg" width="300" height="300">](https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/input_video.mp4 "A videó bemeneti") *kattintson ide a megtekintéshez videó*</span><span class="sxs-lookup"><span data-stu-id="0afe3-115">[<img src="https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/input_video_image_0.jpg" width="300" height="300">](https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/input_video.mp4 "Input Video") *click to view video*</span></span> | <span data-ttu-id="0afe3-116">[<img src="https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/output_video_image_0.jpg" width="300" height="300">](https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/output_video.mp4 "A videó kimeneti") *kattintson ide a megtekintéshez videó*</span><span class="sxs-lookup"><span data-stu-id="0afe3-116">[<img src="https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/output_video_image_0.jpg" width="300" height="300">](https://happypathspublic.blob.core.windows.net/assets/batch_scoring_for_dl/output_video.mp4 "Output Video") *click to view video*</span></span> |

<!-- markdownlint-enable MD033 -->

<span data-ttu-id="0afe3-117">Ez a referenciaarchitektúra a számítási feladatokat az Azure storage-ban új adathordozó jelenléte által aktivált lett tervezve.</span><span class="sxs-lookup"><span data-stu-id="0afe3-117">This reference architecture is designed for workloads that are triggered by the presence of new media in Azure storage.</span></span>

<span data-ttu-id="0afe3-118">Feldolgozás az alábbi lépésekből áll:</span><span class="sxs-lookup"><span data-stu-id="0afe3-118">Processing involves the following steps:</span></span>

1. <span data-ttu-id="0afe3-119">Videofájl feltöltése a tárolóba.</span><span class="sxs-lookup"><span data-stu-id="0afe3-119">Upload a video file to storage.</span></span>
1. <span data-ttu-id="0afe3-120">A videó a fájlalapú eseményindítók egy logikai alkalmazás egy kérést küldhet az Azure Machine Learning közzétett végpont folyamat.</span><span class="sxs-lookup"><span data-stu-id="0afe3-120">The video file triggers a Logic App to send a request to the Azure Machine Learning pipeline published endpoint.</span></span>
1. <span data-ttu-id="0afe3-121">A folyamat dolgozza fel a videót, MPI-stílus átviteli vonatkozik, és a videó postprocesses.</span><span class="sxs-lookup"><span data-stu-id="0afe3-121">The pipeline processes the video, applies style transfer with MPI, and postprocesses the video.</span></span>
1. <span data-ttu-id="0afe3-122">A kimenet vissza a blob storage-ban a folyamat befejezése után a rendszer menti.</span><span class="sxs-lookup"><span data-stu-id="0afe3-122">The output is saved back to blob storage once the pipeline is completed.</span></span>

## <a name="architecture"></a><span data-ttu-id="0afe3-123">Architektúra</span><span class="sxs-lookup"><span data-stu-id="0afe3-123">Architecture</span></span>

<span data-ttu-id="0afe3-124">Ez az architektúra a következő összetevőkből áll.</span><span class="sxs-lookup"><span data-stu-id="0afe3-124">This architecture consists of the following components.</span></span>

### <a name="compute"></a><span data-ttu-id="0afe3-125">Compute</span><span class="sxs-lookup"><span data-stu-id="0afe3-125">Compute</span></span>

<span data-ttu-id="0afe3-126">**[Az Azure Machine Learning szolgáltatás] [ amls]**  Azure Machine Learning-folyamatokat hozhat létre reprodukálható és könnyen kezelhető feladatütemezések számítási használ.</span><span class="sxs-lookup"><span data-stu-id="0afe3-126">**[Azure Machine Learning Service][amls]** uses Azure Machine Learning Pipelines to create reproducible and easy-to-manage sequences of computation.</span></span> <span data-ttu-id="0afe3-127">Emellett egy felügyelt számítási célnak (amelyen folyamat számítást futtatható) nevű [Azure Machine Learning Compute] [ aml-compute] képzés, üzembe helyezése és pontozás a machine learning-modellek.</span><span class="sxs-lookup"><span data-stu-id="0afe3-127">It also offers a managed compute target (on which a pipeline computation can run) called [Azure Machine Learning Compute][aml-compute] for training, deploying, and scoring machine learning models.</span></span>

### <a name="storage"></a><span data-ttu-id="0afe3-128">Storage</span><span class="sxs-lookup"><span data-stu-id="0afe3-128">Storage</span></span>

<span data-ttu-id="0afe3-129">**[A BLOB storage-] [ blob-storage]**  (a bemeneti képekhez, a stílus lemezképek és a kimeneti képek) az összes rendszerkép tárolására szolgál.</span><span class="sxs-lookup"><span data-stu-id="0afe3-129">**[Blob storage][blob-storage]** is used to store all images (input images, style images, and output images).</span></span> <span data-ttu-id="0afe3-130">Az Azure Machine Learning szolgáltatás integrálható a Blob storage, hogy a felhasználók nem rendelkeznek a kézi számítási platform és a Blob storage között az adatok áthelyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="0afe3-130">Azure Machine Learning Service integrates with Blob storage so that users do not have to manually move data across compute platforms and Blob storage.</span></span> <span data-ttu-id="0afe3-131">A BLOB storage akkor is, amely a számítási feladat igényli a teljesítmény rendkívül költséghatékony.</span><span class="sxs-lookup"><span data-stu-id="0afe3-131">Blob storage is also very cost-effective for the performance that this workload requires.</span></span>

### <a name="trigger--scheduling"></a><span data-ttu-id="0afe3-132">Trigger / ütemezése</span><span class="sxs-lookup"><span data-stu-id="0afe3-132">Trigger / scheduling</span></span>

<span data-ttu-id="0afe3-133">**[Az Azure Logic Apps] [ logic-apps]**  a munkafolyamat elindítására szolgál.</span><span class="sxs-lookup"><span data-stu-id="0afe3-133">**[Azure Logic Apps][logic-apps]** is used to trigger the workflow.</span></span> <span data-ttu-id="0afe3-134">Amikor a logikai alkalmazás észleli, hogy hozzáadta-e egy blobot a tárolóhoz, az Azure Machine Learning folyamat elindítja.</span><span class="sxs-lookup"><span data-stu-id="0afe3-134">When the Logic App detects that a blob has been added to the container, it triggers the Azure Machine Learning Pipeline.</span></span> <span data-ttu-id="0afe3-135">A Logic Apps egy jó észleli a módosításokat a blob storage-ban könnyedén, mert ez a referenciaarchitektúra alkalmas, és egy egyszerű folyamatot biztosít az eseményindító módosítása.</span><span class="sxs-lookup"><span data-stu-id="0afe3-135">Logic Apps is a good fit for this reference architecture because it's an easy way to detect changes to blob storage and provides an easy process for changing the trigger.</span></span>

### <a name="preprocessing-and-postprocessing-our-data"></a><span data-ttu-id="0afe3-136">Előfeldolgozási és az adatok postprocessing</span><span class="sxs-lookup"><span data-stu-id="0afe3-136">Preprocessing and postprocessing our data</span></span>

<span data-ttu-id="0afe3-137">Ez a referenciaarchitektúra egy fa a Képanyag-orangutan használja.</span><span class="sxs-lookup"><span data-stu-id="0afe3-137">This reference architecture uses video footage of an orangutan in a tree.</span></span> <span data-ttu-id="0afe3-138">Letöltheti a Képanyag a [Itt][source-video].</span><span class="sxs-lookup"><span data-stu-id="0afe3-138">You can download the footage from [here][source-video].</span></span>

1. <span data-ttu-id="0afe3-139">Használat [FFmpeg] [ ffmpeg] a hangfájl kibontani a videoanyagokat, úgy, hogy a hangfájl is lehet stitched a kimeneti videót be újra később.</span><span class="sxs-lookup"><span data-stu-id="0afe3-139">Use [FFmpeg][ffmpeg] to extract the audio file from the video footage, so that the audio file can be stitched back into the output video later.</span></span>
1. <span data-ttu-id="0afe3-140">A videó felosztása egyes keretek a FFmpeg segítségével.</span><span class="sxs-lookup"><span data-stu-id="0afe3-140">Use FFmpeg to break the video into individual frames.</span></span> <span data-ttu-id="0afe3-141">A keretek egymástól függetlenül, párhuzamosan kerül feldolgozásra.</span><span class="sxs-lookup"><span data-stu-id="0afe3-141">The frames will be processed independently, in parallel.</span></span>
1. <span data-ttu-id="0afe3-142">Ezen a ponton azt is alkalmazhat Neurális stílus átviteli minden egyes keret párhuzamosan.</span><span class="sxs-lookup"><span data-stu-id="0afe3-142">At this point, we can apply neural style transfer to each individual frame in parallel.</span></span>
1. <span data-ttu-id="0afe3-143">Egy egyes keret feldolgozása megtörtént, igazolnia kell a keretek vissza együtt restitch FFmpeg segítségével.</span><span class="sxs-lookup"><span data-stu-id="0afe3-143">One each frame has been processed, we need to use FFmpeg to restitch the frames back together.</span></span>
1. <span data-ttu-id="0afe3-144">Végül azt csatlakoztassa újból a hangfájl a restitched képanyag.</span><span class="sxs-lookup"><span data-stu-id="0afe3-144">Finally we reattach the audio file to the restitched footage.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="0afe3-145">A teljesítménnyel kapcsolatos megfontolások</span><span class="sxs-lookup"><span data-stu-id="0afe3-145">Performance considerations</span></span>

### <a name="gpu-versus-cpu"></a><span data-ttu-id="0afe3-146">Processzor és GPU</span><span class="sxs-lookup"><span data-stu-id="0afe3-146">GPU versus CPU</span></span>

<span data-ttu-id="0afe3-147">A deep learning számítási feladatokhoz gpu-k általánosan élekről végez, és processzorokat sávszélességétől, az processzorok marketingre fürt általában szükség hasonló teljesítmény eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="0afe3-147">For deep learning workloads, GPUs will generally out-perform CPUs by a considerable amount, to the extent that a sizeable cluster of CPUs is usually needed to get comparable performance.</span></span> <span data-ttu-id="0afe3-148">Bár a lehetőség csak processzorokat használata ebben az architektúrában, gpu-k egy sokkal jobb költség/teljesítmény profilt biztosít.</span><span class="sxs-lookup"><span data-stu-id="0afe3-148">While it's an option to use only CPUs in this architecture, GPUs will provide a much better cost/performance profile.</span></span> <span data-ttu-id="0afe3-149">Azt javasoljuk, hogy a legújabb [NCv3 sorozat] virtuálisgép-méretek – gpu használatával GPU-optimalizált virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="0afe3-149">We recommend using the latest [NCv3 series]vm-sizes-gpu of GPU optimized VMs.</span></span>

<span data-ttu-id="0afe3-150">Az összes régióban alapértelmezés szerint nem engedélyezettek a GPU-kkal.</span><span class="sxs-lookup"><span data-stu-id="0afe3-150">GPUs are not enabled by default in all regions.</span></span> <span data-ttu-id="0afe3-151">Ellenőrizze, hogy válasszon ki egy régiót a GPU-k engedélyezve van.</span><span class="sxs-lookup"><span data-stu-id="0afe3-151">Make sure to select a region with GPUs enabled.</span></span> <span data-ttu-id="0afe3-152">Emellett az előfizetések nulla magok alapértelmezett kvóta tartozik GPU-optimalizált virtuális gépek számára.</span><span class="sxs-lookup"><span data-stu-id="0afe3-152">In addition, subscriptions have a default quota of zero cores for GPU-optimized VMs.</span></span> <span data-ttu-id="0afe3-153">Nyissa meg a támogatási kérelmet a kvóta is növelheti.</span><span class="sxs-lookup"><span data-stu-id="0afe3-153">You can raise this quota by opening a support request.</span></span> <span data-ttu-id="0afe3-154">Győződjön meg arról, hogy előfizetése rendelkezik-e elegendő kvótával a számítási feladatok futtatásához.</span><span class="sxs-lookup"><span data-stu-id="0afe3-154">Make sure that your subscription has enough quota to run your workload.</span></span>

### <a name="parallelizing-across-vms-versus-cores"></a><span data-ttu-id="0afe3-155">Magok és a virtuális gépen párhuzamosan futtatni</span><span class="sxs-lookup"><span data-stu-id="0afe3-155">Parallelizing across VMs versus cores</span></span>

<span data-ttu-id="0afe3-156">Batch-feladat egy stílust átviteli folyamat fut, amikor a feladatok elsősorban a GPU-n futó virtuális gépek között méretezésnek megfelelően kell.</span><span class="sxs-lookup"><span data-stu-id="0afe3-156">When running a style transfer process as a batch job, the jobs that run primarily on GPUs will have to be parallelized across VMs.</span></span> <span data-ttu-id="0afe3-157">Két módszer is lehetséges: Egyetlen GPU rendelkező virtuális gépeken nagyobb méretű fürtöt létrehozni, vagy hozzon létre egy kisebb fürtöt használó virtuális gépek sok gpu-kkal.</span><span class="sxs-lookup"><span data-stu-id="0afe3-157">Two approaches are possible: You can create a larger cluster using VMs that have a single GPU, or create a smaller cluster using VMs with many GPUs.</span></span>

<span data-ttu-id="0afe3-158">Ilyen számítási feladatok esetében két lesz hasonló teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="0afe3-158">For this workload, these two options will have comparable performance.</span></span> <span data-ttu-id="0afe3-159">Virtuális gépenként több gpu-kkal kevesebb virtuális gépek használatával segíthet csökkenteni az adatok áthelyezését.</span><span class="sxs-lookup"><span data-stu-id="0afe3-159">Using fewer VMs with more GPUs per VM can help to reduce data movement.</span></span> <span data-ttu-id="0afe3-160">A számítási feladatonként adatmennyiség viszont nem nagyon nagy, ezért nem vizsgálja meg, mennyi szabályozás blob Storage.</span><span class="sxs-lookup"><span data-stu-id="0afe3-160">However, the data volume per job for this workload is not very big, so you won't observe much throttling by blob storage.</span></span>

### <a name="mpi-step"></a><span data-ttu-id="0afe3-161">MPI lépés</span><span class="sxs-lookup"><span data-stu-id="0afe3-161">MPI step</span></span>

<span data-ttu-id="0afe3-162">Amikor létrehoz egy folyamatot az Azure Machine Learning, a párhuzamos számítások végrehajtásához használt lépéseket egyik az MPI-lépés.</span><span class="sxs-lookup"><span data-stu-id="0afe3-162">When creating the pipeline in Azure Machine Learning, one of the steps used to perform parallel computation is the MPI step.</span></span> <span data-ttu-id="0afe3-163">Az MPI-lépés segít az adatok egyenletes felosztása elérhető csomópontok között.</span><span class="sxs-lookup"><span data-stu-id="0afe3-163">The MPI step will help split the data evenly across the available nodes.</span></span> <span data-ttu-id="0afe3-164">Az MPI-lépés a rendszer nem hajtotta végre, amíg készen áll a kért csomópontok.</span><span class="sxs-lookup"><span data-stu-id="0afe3-164">The MPI step will not executed until all the requested nodes are ready.</span></span> <span data-ttu-id="0afe3-165">Kell egy csomópont sikertelen, vagy a felfüggesztett beolvasása (ha az alacsony prioritású virtuális gép), az MPI lépést kell újra futtatni.</span><span class="sxs-lookup"><span data-stu-id="0afe3-165">Should one node fail or get pre-empted (if it is a low-priority virtual machine), the MPI step will have to be re-run.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="0afe3-166">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="0afe3-166">Security considerations</span></span>

### <a name="restricting-access-to-azure-blob-storage"></a><span data-ttu-id="0afe3-167">Az Azure blob storage-ba való hozzáférés korlátozása</span><span class="sxs-lookup"><span data-stu-id="0afe3-167">Restricting access to Azure blob storage</span></span>

<span data-ttu-id="0afe3-168">Ez a referenciaarchitektúra az Azure blob storage a fő tárolási összetevő, amely a védendő.</span><span class="sxs-lookup"><span data-stu-id="0afe3-168">In this reference architecture, Azure blob storage is the main storage component that needs to be protected.</span></span> <span data-ttu-id="0afe3-169">A GitHub-adattárat látható az alapkonfigurációk azon központi telepítését tárfiókkulcsok segítségével a blobtároló eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="0afe3-169">The baseline deployment shown in the GitHub repo uses storage account keys to access the blob storage.</span></span> <span data-ttu-id="0afe3-170">További ellenőrzésére és védelmére fontolja meg egy közös hozzáférésű jogosultságkód (SAS) helyett.</span><span class="sxs-lookup"><span data-stu-id="0afe3-170">For further control and protection, consider using a shared access signature (SAS) instead.</span></span> <span data-ttu-id="0afe3-171">Ez a tároló objektumok korlátozott hozzáférést biztosít a anélkül, hogy keményen a fiókkulcsok code, vagy egyszerű szövegként menti.</span><span class="sxs-lookup"><span data-stu-id="0afe3-171">This grants limited access to objects in storage, without needing to hard code the account keys or save them in plaintext.</span></span> <span data-ttu-id="0afe3-172">Ez a módszer különösen hasznos, mert fiókkulcsok láthatók a sima szöveges Logic App Tervező felületen belül.</span><span class="sxs-lookup"><span data-stu-id="0afe3-172">This approach is especially useful because account keys are visible in plaintext inside of Logic App's designer interface.</span></span> <span data-ttu-id="0afe3-173">SAS használatával is biztosítható, hogy a tárfiók rendelkezik a megfelelő irányítás, és, hogy célja, hogy hozzáférhessenek a mobileszközeiken csak a személyeknek.</span><span class="sxs-lookup"><span data-stu-id="0afe3-173">Using an SAS also helps to ensure that the storage account has proper governance, and that access is granted only to the people intended to have it.</span></span>

<span data-ttu-id="0afe3-174">Forgatókönyvek a több bizalmas adatok győződjön meg arról, hogy a kulcsok összes védettek, mivel ezek a kulcsok teljes hozzáférési jogot az összes bemeneti és kimeneti adatok a munkaterhelési.</span><span class="sxs-lookup"><span data-stu-id="0afe3-174">For scenarios with more sensitive data, make sure that all of your storage keys are protected, because these keys grant full access to all input and output data from the workload.</span></span>

### <a name="data-encryption-and-data-movement"></a><span data-ttu-id="0afe3-175">Adattitkosítás és -adatok áthelyezése</span><span class="sxs-lookup"><span data-stu-id="0afe3-175">Data encryption and data movement</span></span>

<span data-ttu-id="0afe3-176">Ez a referenciaarchitektúra stílus átvitelt használ példaként szolgál a kötegelt pontozási a folyamatot.</span><span class="sxs-lookup"><span data-stu-id="0afe3-176">This reference architecture uses style transfer as an example of a batch scoring process.</span></span> <span data-ttu-id="0afe3-177">További adatok bizalmas forgatókönyvek esetén az adatok a storage-ban kell lennie titkosítása.</span><span class="sxs-lookup"><span data-stu-id="0afe3-177">For more data-sensitive scenarios, the data in storage should be encrypted at rest.</span></span> <span data-ttu-id="0afe3-178">Minden alkalommal adat áthelyezik az egyik helyről a következő, az SSL használatával biztonságossá tétele az adatátvitel.</span><span class="sxs-lookup"><span data-stu-id="0afe3-178">Each time data is moved from one location to the next, use SSL to secure the data transfer.</span></span> <span data-ttu-id="0afe3-179">További információkért lásd: [Azure Storage biztonsági útmutatóját][storage-security].</span><span class="sxs-lookup"><span data-stu-id="0afe3-179">For more information, see [Azure Storage security guide][storage-security].</span></span>

### <a name="securing-your-computation-in-a-virtual-network"></a><span data-ttu-id="0afe3-180">A számítási virtuális hálózat biztonságossá tétele</span><span class="sxs-lookup"><span data-stu-id="0afe3-180">Securing your computation in a virtual network</span></span>

<span data-ttu-id="0afe3-181">A Machine Learning számítási fürt üzembe helyezésekor, konfigurálhatja a fürt egy alhálózatán belül üzembe helyezhető egy [virtuális hálózat][virtual-network].</span><span class="sxs-lookup"><span data-stu-id="0afe3-181">When deploying your Machine Learning compute cluster, you can configure your cluster to be provisioned inside a subnet of a [virtual network][virtual-network].</span></span> <span data-ttu-id="0afe3-182">Ez lehetővé teszi a számítási csomópontok, a fürt más virtuális gépek biztonságos kommunikációhoz.</span><span class="sxs-lookup"><span data-stu-id="0afe3-182">This allows the compute nodes in the cluster to communicate securely with other virtual machines.</span></span>

### <a name="protecting-against-malicious-activity"></a><span data-ttu-id="0afe3-183">Rosszindulatú tevékenység elleni védelme</span><span class="sxs-lookup"><span data-stu-id="0afe3-183">Protecting against malicious activity</span></span>

<span data-ttu-id="0afe3-184">A forgatókönyvek, ahol több felhasználó van, győződjön meg arról, hogy kártékony tevékenységek ellen védett-e a bizalmas adatokat.</span><span class="sxs-lookup"><span data-stu-id="0afe3-184">In scenarios where there are multiple users, make sure that sensitive data is protected against malicious activity.</span></span> <span data-ttu-id="0afe3-185">Ha más felhasználók kapjanak hozzáférést ehhez a központi telepítéshez a bemeneti adatok testreszabása, jegyezze fel a következő óvintézkedéseket és szempontok:</span><span class="sxs-lookup"><span data-stu-id="0afe3-185">If other users are given access to this deployment to customize the input data, take note of the following precautions and considerations:</span></span>

- <span data-ttu-id="0afe3-186">Az RBAC használatával csak a számukra szükséges erőforrásokhoz való felhasználói hozzáférés korlátozására.</span><span class="sxs-lookup"><span data-stu-id="0afe3-186">Use RBAC to limit users' access to only the resources they need.</span></span>
- <span data-ttu-id="0afe3-187">Két különböző storage-fiókok kiépítéséhez.</span><span class="sxs-lookup"><span data-stu-id="0afe3-187">Provision two separate storage accounts.</span></span> <span data-ttu-id="0afe3-188">Az első fiók Store a bemeneti és kimeneti adatokat.</span><span class="sxs-lookup"><span data-stu-id="0afe3-188">Store input and output data in the first account.</span></span> <span data-ttu-id="0afe3-189">A külső felhasználók is hozzáférést kell biztosítani ehhez a fiókhoz.</span><span class="sxs-lookup"><span data-stu-id="0afe3-189">External users can be given access to this account.</span></span> <span data-ttu-id="0afe3-190">Store végrehajtható parancsfájlokat, és a kimeneti naplófájlokat a fiókban.</span><span class="sxs-lookup"><span data-stu-id="0afe3-190">Store executable scripts and output log files in the other account.</span></span> <span data-ttu-id="0afe3-191">A külső felhasználók nem kell a hozzáférést a fiókjához.</span><span class="sxs-lookup"><span data-stu-id="0afe3-191">External users should not have access to this account.</span></span> <span data-ttu-id="0afe3-192">Ez biztosítja, hogy a külső felhasználók nem módosítható a végrehajtható fájl (a kártevő kód beszúrása), és nem fér hozzá a logfiles, amelyek bizalmas információkat tartalmazhat.</span><span class="sxs-lookup"><span data-stu-id="0afe3-192">This will ensure that external users cannot modify any executable files (to inject malicious code), and don't have access to logfiles, which could hold sensitive information.</span></span>
- <span data-ttu-id="0afe3-193">Rosszindulatú felhasználók DDOS a feladat-várólistában vagy beszúrása a feladat-várólistában lévő helytelen formátumú ártalmas üzenetek okoz a rendszer zárolja, vagy üzenetmozgatót hibákat okoz.</span><span class="sxs-lookup"><span data-stu-id="0afe3-193">Malicious users can DDOS the job queue or inject malformed poison messages in the job queue, causing the system to lock up or causing dequeuing errors.</span></span>

## <a name="monitoring-and-logging"></a><span data-ttu-id="0afe3-194">Monitorozás és naplózás</span><span class="sxs-lookup"><span data-stu-id="0afe3-194">Monitoring and logging</span></span>

### <a name="monitoring-batch-jobs"></a><span data-ttu-id="0afe3-195">Batch-feladatok figyelése</span><span class="sxs-lookup"><span data-stu-id="0afe3-195">Monitoring Batch jobs</span></span>

<span data-ttu-id="0afe3-196">A feladat futtatásakor fontos nyomon követheti, és győződjön meg arról, hogy a dolgok várt módon működik.</span><span class="sxs-lookup"><span data-stu-id="0afe3-196">While running your job, it's important to monitor the progress and make sure that things are working as expected.</span></span> <span data-ttu-id="0afe3-197">Azonban ez több aktív csomópontból álló fürtben figyelése kihívást jelenthet.</span><span class="sxs-lookup"><span data-stu-id="0afe3-197">However, it can be a challenge to monitor across a cluster of active nodes.</span></span>

<span data-ttu-id="0afe3-198">A fürt általános állapotáról kaphat, nyissa meg a Machine Learning panel az Azure Portal, a csomópontok a fürt állapotának vizsgálata.</span><span class="sxs-lookup"><span data-stu-id="0afe3-198">To get a sense of the overall state of the cluster, go to the Machine Learning blade of the Azure Portal to inspect the state of the nodes in the cluster.</span></span> <span data-ttu-id="0afe3-199">Ha egy csomópont nem aktív, vagy egy feladat sikertelen volt, a hibanaplókat blob storage-bA lesznek mentve, és az Azure Portalon is elérhetők.</span><span class="sxs-lookup"><span data-stu-id="0afe3-199">If a node is inactive or a job has failed, the error logs are saved to blob storage, and are also accessible in the Azure Portal.</span></span>

<span data-ttu-id="0afe3-200">Figyelés is lehet további bővített naplók csatlakozik az Application Insights vagy a fürt és a feladatok állapotát a lekérdezéséhez külön folyamatokba futtatja.</span><span class="sxs-lookup"><span data-stu-id="0afe3-200">Monitoring can be further enriched by connecting logs to Application Insights or by running separate processes to poll for the state of the cluster and its jobs.</span></span>

### <a name="logging-with-azure-machine-learning"></a><span data-ttu-id="0afe3-201">Az Azure Machine Learning-naplózás</span><span class="sxs-lookup"><span data-stu-id="0afe3-201">Logging with Azure Machine Learning</span></span>

<span data-ttu-id="0afe3-202">Az Azure Machine számlázásról automatikusan projekttárolóba összes stdout/stderr társítása a blob storage-fiókhoz.</span><span class="sxs-lookup"><span data-stu-id="0afe3-202">Azure Machine Learing will automatically log all stdout/stderr to the associate blob storage account.</span></span> <span data-ttu-id="0afe3-203">Ellenkező értelmű rendelkezés az Azure Machine Learning-munkaterület automatikusan kiépíteni a tárfiókot, és a naplók dump bele.</span><span class="sxs-lookup"><span data-stu-id="0afe3-203">Unless otherwise specified, your Azure Machine Learning Workspace will automatically provision a storage account and dump your logs into it.</span></span> <span data-ttu-id="0afe3-204">A tárolók navigációs eszköz, például a Storage Explorer, amely egy sokkal egyszerűbb megoldást biztosít a naplófájlok navigáláshoz használhatja.</span><span class="sxs-lookup"><span data-stu-id="0afe3-204">You can also use a storage navigation tool such as Storage Explorer which will provide a much easier experience for navigating log files.</span></span>

## <a name="cost-considerations"></a><span data-ttu-id="0afe3-205">Költségekkel kapcsolatos szempontok</span><span class="sxs-lookup"><span data-stu-id="0afe3-205">Cost considerations</span></span>

<span data-ttu-id="0afe3-206">A storage és az ütemezési összetevők képest, ez a referenciaarchitektúra a messze használt számítási erőforrások uralja költségei tekintetében.</span><span class="sxs-lookup"><span data-stu-id="0afe3-206">Compared to the storage and scheduling components, the compute resources used in this reference architecture by far dominate in terms of costs.</span></span> <span data-ttu-id="0afe3-207">Az egyik fő kihívása van hatékonyan párhuzamosan futtatni a munkahelyi GPU-kompatibilis gép egy fürtön.</span><span class="sxs-lookup"><span data-stu-id="0afe3-207">One of the main challenges is effectively parallelizing the work across a cluster of GPU-enabled machines.</span></span>

<span data-ttu-id="0afe3-208">A Machine Learning COMPUTE számítási fürt mérete automatikusan méretezhetők felfelé és lefelé a várólistában a feladatok függően.</span><span class="sxs-lookup"><span data-stu-id="0afe3-208">The Machine Learning Compute cluster size can automatically scale up and down depending on the jobs in the queue.</span></span> <span data-ttu-id="0afe3-209">Automatikus vertikális felskálázás programozott módon engedélyezheti a minimális és maximális csomópontok beállításával.</span><span class="sxs-lookup"><span data-stu-id="0afe3-209">You can enable auto-scale programmatically by setting the minimum and maximum nodes.</span></span>

<span data-ttu-id="0afe3-210">És nem igényel azonnali feldolgozási munka automatikus méretezés beállítása nulla csomópontból álló fürtben tehát az alapértelmezett állapot (legalább).</span><span class="sxs-lookup"><span data-stu-id="0afe3-210">For work that doesn't require immediate processing, configure auto-scale so the default state (minimum) is a cluster of zero nodes.</span></span> <span data-ttu-id="0afe3-211">Ezzel a konfigurációval a fürt nullára a csomópontok kezdődik, és ha a várólistán lévő feladatok csak felskálázással.</span><span class="sxs-lookup"><span data-stu-id="0afe3-211">With this configuration, the cluster starts with zero nodes and only scales up when it detects jobs in the queue.</span></span> <span data-ttu-id="0afe3-212">Ha a kötegelt pontozási folyamat csak néhány alkalommal naponta történik vagy annál kisebb, ez a beállítás lehetővé teszi, hogy jelentős költségmegtakarítást.</span><span class="sxs-lookup"><span data-stu-id="0afe3-212">If the batch scoring process only happens a few times a day or less, this setting enables significant cost savings.</span></span>

<span data-ttu-id="0afe3-213">Automatikus méretezés nem lehet megfelelő kötegelt feladatok számához egymáshoz közel túl fordulhat elő.</span><span class="sxs-lookup"><span data-stu-id="0afe3-213">Auto-scaling may not be appropriate for batch jobs that happen too close to each other.</span></span> <span data-ttu-id="0afe3-214">A fürt számára le üzemeltethet a idejét is költségkezelési, így ha egy batch számítási feladatot csak néhány percet az előző feladat befejezése után kezdődik, költséghatékonyabb tartani a fürtön futó feladatok között lehet.</span><span class="sxs-lookup"><span data-stu-id="0afe3-214">The time that it takes for a cluster to spin up and spin down also incur a cost, so if a batch workload begins only a few minutes after the previous job ends, it might be more cost effective to keep the cluster running between jobs.</span></span>

<span data-ttu-id="0afe3-215">Machine Learning Compute is támogatja az alacsony prioritású virtuális gépekre.</span><span class="sxs-lookup"><span data-stu-id="0afe3-215">Machine Learning Compute also supports low-priority virtual machines.</span></span> <span data-ttu-id="0afe3-216">Ez lehetővé teszi, hogy a számítási futtatni, akkor előfordulhat, hogy lehet pre-empted bármikor csoportosítani kedvezményes virtuális gépeken.</span><span class="sxs-lookup"><span data-stu-id="0afe3-216">This allows you to run your computation on discounted virtual machines, with the caveat that they may be pre-empted at any time.</span></span> <span data-ttu-id="0afe3-217">Alacsony prioritású virtuális gépek ideálisak a nem kritikus fontosságú kötegelt pontozási a számítási feladatokat.</span><span class="sxs-lookup"><span data-stu-id="0afe3-217">Low-priority virtual machines are ideal for non-critical batch scoring workloads.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="0afe3-218">A megoldás üzembe helyezése</span><span class="sxs-lookup"><span data-stu-id="0afe3-218">Deploy the solution</span></span>

<span data-ttu-id="0afe3-219">Ez a referenciaarchitektúra üzembe helyezéséhez kövesse az ismertetett lépéseket a [GitHub-adattárat][deployment].</span><span class="sxs-lookup"><span data-stu-id="0afe3-219">To deploy this reference architecture, follow the steps described in the [GitHub repo][deployment].</span></span>

> [!NOTE]
> <span data-ttu-id="0afe3-220">A kötegelt pontozási architektúra deep learning-modellek az Azure Kubernetes Service használatával is telepítheti.</span><span class="sxs-lookup"><span data-stu-id="0afe3-220">You can also deploy a batch scoring architecture for deep learning models using the Azure Kubernetes Service.</span></span> <span data-ttu-id="0afe3-221">A jelen ismertetett lépéseket követve [Github-adattárat][deployment2].</span><span class="sxs-lookup"><span data-stu-id="0afe3-221">Follow the steps described in this [Github repo][deployment2].</span></span>

<!-- links -->

[aml-compute]: /azure/machine-learning/service/how-to-set-up-training-targets#amlcompute
[amls]: /azure/machine-learning/service/overview-what-is-azure-ml
[azcopy]: /azure/storage/common/storage-use-azcopy-linux
[blob-storage]: /azure/storage/blobs/storage-blobs-introduction
[container-instances]: /azure/container-instances/
[container-registry]: /azure/container-registry/
[deployment]: https://github.com/Azure/Batch-Scoring-Deep-Learning-Models-With-AML
[deployment2]: https://github.com/Azure/Batch-Scoring-Deep-Learning-Models-With-AKS
[ffmpeg]: https://www.ffmpeg.org/
[image-style-transfer]: https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf
[logic-apps]: /azure/logic-apps/
[source-video]: https://happypathspublic.blob.core.windows.net/videos/orangutan.mp4
[storage-security]: /azure/storage/common/storage-security-guide
[vm-sizes-gpu]: /azure/virtual-machines/windows/sizes-gpu
[virtual-network]: /azure/machine-learning/service/how-to-enable-virtual-network
