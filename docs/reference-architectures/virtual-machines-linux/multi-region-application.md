---
title: "Linux virtuális gépek futtatása a több Azure-régiók a magas rendelkezésre állás"
description: "Ügyfélszoftverek központi telepítése a virtuális gépek magas rendelkezésre állást és a rugalmasság Azure több régióba."
author: MikeWasson
ms.date: 11/22/2016
pnp.series.title: Linux VM workloads
pnp.series.prev: n-tier
ms.openlocfilehash: 3b68f6fc79ba4b29e41ba2b04537b834bb8859b0
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 11/14/2017
---
# <a name="run-linux-vms-in-multiple-regions-for-high-availability"></a><span data-ttu-id="2fab0-103">Linux virtuális gépek futtatása a magas rendelkezésre állású több régióba</span><span class="sxs-lookup"><span data-stu-id="2fab0-103">Run Linux VMs in multiple regions for high availability</span></span>

<span data-ttu-id="2fab0-104">A referencia-architektúrában futó N szintű alkalmazás több Azure-régiók, rendelkezésre állást és a hatékony vész-helyreállítási infrastruktúra elérése érdekében bevált gyakorlatok csoportja jeleníti meg.</span><span class="sxs-lookup"><span data-stu-id="2fab0-104">This reference architecture shows a set of proven practices for running an N-tier application in multiple Azure regions, in order to achieve availability and a robust disaster recovery infrastructure.</span></span> 

<span data-ttu-id="2fab0-105">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="2fab0-105">![[0]][0]</span></span>

<span data-ttu-id="2fab0-106">*Töltse le a [Visio fájl] [ visio-download] ezen architektúra.*</span><span class="sxs-lookup"><span data-stu-id="2fab0-106">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="2fab0-107">Architektúra</span><span class="sxs-lookup"><span data-stu-id="2fab0-107">Architecture</span></span> 

<span data-ttu-id="2fab0-108">Ez az architektúra látható egy épít [futtatása a Linux virtuális gépek N szintű alkalmazások](n-tier.md).</span><span class="sxs-lookup"><span data-stu-id="2fab0-108">This architecture builds on the one shown in [Run Linux VMs for an N-tier application](n-tier.md).</span></span> 

* <span data-ttu-id="2fab0-109">**Elsődleges és másodlagos régiók**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-109">**Primary and secondary regions**.</span></span> <span data-ttu-id="2fab0-110">Két régió segítségével magasabb rendelkezésre állásának eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="2fab0-110">Use two regions to achieve higher availability.</span></span> <span data-ttu-id="2fab0-111">Az elsődleges régióban egyik. A más régióban van, a feladatátvételre.</span><span class="sxs-lookup"><span data-stu-id="2fab0-111">One is the primary region.The other region is for failover.</span></span>
* <span data-ttu-id="2fab0-112">**Az Azure Traffic Manager**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-112">**Azure Traffic Manager**.</span></span> <span data-ttu-id="2fab0-113">[A TRAFFIC Manager] [ traffic-manager] irányítja a bejövő kéréseket a régiók egyikéhez sem.</span><span class="sxs-lookup"><span data-stu-id="2fab0-113">[Traffic Manager][traffic-manager] routes incoming requests to one of the regions.</span></span> <span data-ttu-id="2fab0-114">A normál működés során az elsődleges régióban irányítja a kérelmeket.</span><span class="sxs-lookup"><span data-stu-id="2fab0-114">During normal operations, it routes requests to the primary region.</span></span> <span data-ttu-id="2fab0-115">Ha az adott régióban, a Traffic Manager feladatátadás a másodlagos régióba.</span><span class="sxs-lookup"><span data-stu-id="2fab0-115">If that region becomes unavailable, Traffic Manager fails over to the secondary region.</span></span> <span data-ttu-id="2fab0-116">További információkért tekintse meg a szakasz [Traffic Manager konfigurációs](#traffic-manager-configuration).</span><span class="sxs-lookup"><span data-stu-id="2fab0-116">For more information, see the section [Traffic Manager configuration](#traffic-manager-configuration).</span></span>
* <span data-ttu-id="2fab0-117">**Erőforráscsoportok**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-117">**Resource groups**.</span></span> <span data-ttu-id="2fab0-118">Hozzon létre külön [erőforráscsoportok] [ resource groups] az elsődleges régióban, a másodlagos régióba, és a Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="2fab0-118">Create separate [resource groups][resource groups] for the primary region, the secondary region, and for Traffic Manager.</span></span> <span data-ttu-id="2fab0-119">Ez lehetővé teszi a rugalmasság, minden egyes régió szerinti egyetlen gyűjtemény-erőforrások kezelésére.</span><span class="sxs-lookup"><span data-stu-id="2fab0-119">This gives you the flexibility to manage each region as a single collection of resources.</span></span> <span data-ttu-id="2fab0-120">Például egy régió tartozik, sikerült újratelepítése nélkül a másik egy le.</span><span class="sxs-lookup"><span data-stu-id="2fab0-120">For example, you could redeploy one region, without taking down the other one.</span></span> <span data-ttu-id="2fab0-121">[Az erőforráscsoportok hivatkozás][resource-group-links], így az alkalmazás az erőforrások listájának lekérdezés futtatása.</span><span class="sxs-lookup"><span data-stu-id="2fab0-121">[Link the resource groups][resource-group-links], so that you can run a query to list all the resources for the application.</span></span>
* <span data-ttu-id="2fab0-122">**Vnetek**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-122">**VNets**.</span></span> <span data-ttu-id="2fab0-123">Hozzon létre egy külön hálózatok mindegyik régióhoz.</span><span class="sxs-lookup"><span data-stu-id="2fab0-123">Create a separate VNet for each region.</span></span> <span data-ttu-id="2fab0-124">Ellenőrizze, hogy a címterek nem lehetnek átfedésben.</span><span class="sxs-lookup"><span data-stu-id="2fab0-124">Make sure the address spaces do not overlap.</span></span>
* <span data-ttu-id="2fab0-125">**Apache Cassandra**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-125">**Apache Cassandra**.</span></span> <span data-ttu-id="2fab0-126">Adatközpontokban Cassandra telepíteni a magas rendelkezésre állású Azure-régiók között.</span><span class="sxs-lookup"><span data-stu-id="2fab0-126">Deploy Cassandra in data centers across Azure regions for high availability.</span></span> <span data-ttu-id="2fab0-127">Minden régióban a csomópontok a hibája állvány-kompatibilis módban van konfigurálva, és frissítési tartományt, a rugalmasságot belül a régió.</span><span class="sxs-lookup"><span data-stu-id="2fab0-127">Within each region, nodes are configured in rack-aware mode with fault and upgrade domains, for resiliency inside the region.</span></span>

## <a name="recommendations"></a><span data-ttu-id="2fab0-128">Javaslatok</span><span class="sxs-lookup"><span data-stu-id="2fab0-128">Recommendations</span></span>

<span data-ttu-id="2fab0-129">Egy több területi architektúra biztosít magas rendelkezésre állás érdekében, mint egyetlen régióban üzembe helyezni.</span><span class="sxs-lookup"><span data-stu-id="2fab0-129">A multi-region architecture can provide higher availability than deploying to a single region.</span></span> <span data-ttu-id="2fab0-130">Ha egy regionális kimaradás érinti az elsődleges régióban, [Traffic Manager] [ traffic-manager] hogy áthelyezze a feladatokat a másodlagos régióba.</span><span class="sxs-lookup"><span data-stu-id="2fab0-130">If a regional outage affects the primary region, you can use [Traffic Manager][traffic-manager] to fail over to the secondary region.</span></span> <span data-ttu-id="2fab0-131">Ez az architektúra segíthet is, ha az alkalmazás egy egyedi alrendszer nem tud.</span><span class="sxs-lookup"><span data-stu-id="2fab0-131">This architecture can also help if an individual subsystem of the application fails.</span></span>

<span data-ttu-id="2fab0-132">Magas rendelkezésre állás elérése érdekében a különböző régiókban néhány általános módszer van:</span><span class="sxs-lookup"><span data-stu-id="2fab0-132">There are several general approaches to achieving high availability across regions:</span></span>   

* <span data-ttu-id="2fab0-133">A melegtartalék aktív/passzív.</span><span class="sxs-lookup"><span data-stu-id="2fab0-133">Active/passive with hot standby.</span></span> <span data-ttu-id="2fab0-134">Forgalom kerül egy régió tartozik, a más vár melegtartalék közben.</span><span class="sxs-lookup"><span data-stu-id="2fab0-134">Traffic goes to one region, while the other waits on hot standby.</span></span> <span data-ttu-id="2fab0-135">Meleg készenléti azt jelenti, hogy a virtuális gépeket, a másodlagos régióban lefoglalt és fut mindig.</span><span class="sxs-lookup"><span data-stu-id="2fab0-135">Hot standby means the VMs in the secondary region are allocated and running at all times.</span></span>
* <span data-ttu-id="2fab0-136">A meleg készenléti állapotban lévő aktív/passzív.</span><span class="sxs-lookup"><span data-stu-id="2fab0-136">Active/passive with cold standby.</span></span> <span data-ttu-id="2fab0-137">Forgalom kerül egy régió tartozik, a más vár meleg készenléti közben.</span><span class="sxs-lookup"><span data-stu-id="2fab0-137">Traffic goes to one region, while the other waits on cold standby.</span></span> <span data-ttu-id="2fab0-138">Meleg készenléti állapot azt jelenti, hogy a virtuális gépeket, a másodlagos régióban nem foglal le addig, amíg a feladatátvételi szükséges.</span><span class="sxs-lookup"><span data-stu-id="2fab0-138">Cold standby means the VMs in the secondary region are not allocated until needed for failover.</span></span> <span data-ttu-id="2fab0-139">Ez a megközelítés költségek kisebb futtatásához, de általában adott meghibásodás során online állapotba hosszabb ideig tart.</span><span class="sxs-lookup"><span data-stu-id="2fab0-139">This approach costs less to run, but will generally take longer to come online during a failure.</span></span>
* <span data-ttu-id="2fab0-140">Aktív.</span><span class="sxs-lookup"><span data-stu-id="2fab0-140">Active/active.</span></span> <span data-ttu-id="2fab0-141">Mindkét régió aktív, és kérés kerül közöttük.</span><span class="sxs-lookup"><span data-stu-id="2fab0-141">Both regions are active, and requests are load balanced between them.</span></span> <span data-ttu-id="2fab0-142">Ha nem érhető el egy régió tartozik, az kívül Elforgatás lesz végrehajtva.</span><span class="sxs-lookup"><span data-stu-id="2fab0-142">If one region becomes unavailable, it is taken out of rotation.</span></span> 

<span data-ttu-id="2fab0-143">Ez az architektúra melegtartalék feladatátvételi Traffic Manager használata az aktív/passzív összpontosít.</span><span class="sxs-lookup"><span data-stu-id="2fab0-143">This architecture focuses on active/passive with hot standby, using Traffic Manager for failover.</span></span> <span data-ttu-id="2fab0-144">Vegye figyelembe, hogy sikerült központi telepítése egy kis számú virtuális gépek melegtartalék és majd horizontális felskálázás igény szerint.</span><span class="sxs-lookup"><span data-stu-id="2fab0-144">Note that you could deploy a small number of VMs for hot standby and then scale out as needed.</span></span>


### <a name="regional-pairing"></a><span data-ttu-id="2fab0-145">Regionális párosítás</span><span class="sxs-lookup"><span data-stu-id="2fab0-145">Regional pairing</span></span>

<span data-ttu-id="2fab0-146">Minden Azure-régió, egy másik ugyanazon a földrajzi régióját párosított.</span><span class="sxs-lookup"><span data-stu-id="2fab0-146">Each Azure region is paired with another region within the same geography.</span></span> <span data-ttu-id="2fab0-147">Régiók általában választhat a azonos regionális pár (például USA keleti régiója 2 és Velünk központi).</span><span class="sxs-lookup"><span data-stu-id="2fab0-147">In general, choose regions from the same regional pair (for example, East US 2 and US Central).</span></span> <span data-ttu-id="2fab0-148">Ennek során a következő előnyöket nyújtja:</span><span class="sxs-lookup"><span data-stu-id="2fab0-148">Benefits of doing so include:</span></span>

* <span data-ttu-id="2fab0-149">A széles körű kimaradás esetén legalább egy régió kívül minden pár helyreállítási prioritása van.</span><span class="sxs-lookup"><span data-stu-id="2fab0-149">If there is a broad outage, recovery of at least one region out of every pair is prioritized.</span></span>
* <span data-ttu-id="2fab0-150">Tervezett Azure rendszerfrissítések előkészítése már megkezdődött párosított régiók egymás után, az lehetséges állásidő minimalizálása érdekében.</span><span class="sxs-lookup"><span data-stu-id="2fab0-150">Planned Azure system updates are rolled out to paired regions sequentially, to minimize possible downtime.</span></span>
* <span data-ttu-id="2fab0-151">Párok találhatók belül az azonos földrajzi adatok rezidens követelményeinek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="2fab0-151">Pairs reside within the same geography, to meet data residency requirements.</span></span>

<span data-ttu-id="2fab0-152">Győződjön meg arról, hogy mindkét régió támogatja az összes Azure-szolgáltatás szükséges az alkalmazás (lásd: [régiói][services-by-region]).</span><span class="sxs-lookup"><span data-stu-id="2fab0-152">However, make sure that both regions support all of the Azure services needed for your application (see [Services by region][services-by-region]).</span></span> <span data-ttu-id="2fab0-153">Regionális párok kapcsolatos további információkért lásd: [üzleti folytonossági és vészhelyreállítási helyreállítási (BCDR): Azure-régiókat párosítva][regional-pairs].</span><span class="sxs-lookup"><span data-stu-id="2fab0-153">For more information about regional pairs, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions][regional-pairs].</span></span>

### <a name="traffic-manager-configuration"></a><span data-ttu-id="2fab0-154">A TRAFFIC Manager-konfiguráció</span><span class="sxs-lookup"><span data-stu-id="2fab0-154">Traffic Manager configuration</span></span>

<span data-ttu-id="2fab0-155">A Traffic Manager konfigurálásakor, vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="2fab0-155">Consider the following points when configuring Traffic Manager:</span></span>

* <span data-ttu-id="2fab0-156">**Útválasztás**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-156">**Routing**.</span></span> <span data-ttu-id="2fab0-157">A TRAFFIC Manager támogatja több [útválasztási algoritmusok][tm-routing].</span><span class="sxs-lookup"><span data-stu-id="2fab0-157">Traffic Manager supports several [routing algorithms][tm-routing].</span></span> <span data-ttu-id="2fab0-158">A jelen cikkben ismertetett esetben használjon *prioritás* útválasztási (korábbi nevén *feladatátvételi* útválasztási).</span><span class="sxs-lookup"><span data-stu-id="2fab0-158">For the scenario described in this article, use *priority* routing (formerly called *failover* routing).</span></span> <span data-ttu-id="2fab0-159">Ezzel a beállítással a Traffic Manager minden kérést küld az elsődleges régióban, hacsak az elsődleges régióban el nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="2fab0-159">With this setting, Traffic Manager sends all requests to the primary region, unless the primary region becomes unreachable.</span></span> <span data-ttu-id="2fab0-160">Ezen a ponton akkor automatikusan átkerül a másodlagos régióba.</span><span class="sxs-lookup"><span data-stu-id="2fab0-160">At that point, it automatically fails over to the secondary region.</span></span> <span data-ttu-id="2fab0-161">Lásd: [konfigurálhatja feladatátvételi útválasztási módszer][tm-configure-failover].</span><span class="sxs-lookup"><span data-stu-id="2fab0-161">See [Configure Failover routing method][tm-configure-failover].</span></span>
* <span data-ttu-id="2fab0-162">**Állapotmintáihoz**.</span><span class="sxs-lookup"><span data-stu-id="2fab0-162">**Health probe**.</span></span> <span data-ttu-id="2fab0-163">HTTP (vagy HTTPS) használ a TRAFFIC Manager [mintavételi] [ tm-monitoring] minden egyes régió rendelkezésre állásának figyelésére.</span><span class="sxs-lookup"><span data-stu-id="2fab0-163">Traffic Manager uses an HTTP (or HTTPS) [probe][tm-monitoring] to monitor the availability of each region.</span></span> <span data-ttu-id="2fab0-164">A mintavétel egy 200-as HTTP-választ a megadott URL-cím elérési keresi.</span><span class="sxs-lookup"><span data-stu-id="2fab0-164">The probe checks for an HTTP 200 response for a specified URL path.</span></span> <span data-ttu-id="2fab0-165">Ajánlott eljárásként hozzon létre egy végpontot, amely jelent a alkalmazás általános állapotát, és használja ezt a végpontot a állapotmintáihoz.</span><span class="sxs-lookup"><span data-stu-id="2fab0-165">As a best practice, create an endpoint that reports the overall health of the application, and use this endpoint for the health probe.</span></span> <span data-ttu-id="2fab0-166">Ellenkező esetben a mintavétel előfordulhat, hogy jelentés a kifogástalan állapotú végpontok, ha az alkalmazás kritikus részei ténylegesen nem működnek.</span><span class="sxs-lookup"><span data-stu-id="2fab0-166">Otherwise, the probe might report a healthy endpoint when critical parts of the application are actually failing.</span></span> <span data-ttu-id="2fab0-167">További információkért lásd: [állapotfigyelő végpont figyelési mintát][health-endpoint-monitoring-pattern].</span><span class="sxs-lookup"><span data-stu-id="2fab0-167">For more information, see [Health Endpoint Monitoring Pattern][health-endpoint-monitoring-pattern].</span></span>

<span data-ttu-id="2fab0-168">Amikor a Traffic Manager átadja a feladatokat a rendszer egy adott időn belül, ha ügyfelek nem tudják elérni az alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="2fab0-168">When Traffic Manager fails over there is a period of time when clients cannot reach the application.</span></span> <span data-ttu-id="2fab0-169">A duration hatással van a következő tényezőket:</span><span class="sxs-lookup"><span data-stu-id="2fab0-169">The duration is affected by the following factors:</span></span>

* <span data-ttu-id="2fab0-170">A állapotmintáihoz észlelni kell, hogy az elsődleges régióban vált nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="2fab0-170">The health probe must detect that the primary region has become unreachable.</span></span>
* <span data-ttu-id="2fab0-171">DNS-kiszolgálók frissítenie kell a gyorsítótárban lévő DNS-rekordok az IP-címhez, amely a DNS--élettartama (TTL) függ.</span><span class="sxs-lookup"><span data-stu-id="2fab0-171">DNS servers must update the cached DNS records for the IP address, which depends on the DNS time-to-live (TTL).</span></span> <span data-ttu-id="2fab0-172">Az alapértelmezett élettartam 300 másodpercen (5 percen), de ezt az értéket a Traffic Manager-profil létrehozásakor konfigurálhatja.</span><span class="sxs-lookup"><span data-stu-id="2fab0-172">The default TTL is 300 seconds (5 minutes), but you can configure this value when you create the Traffic Manager profile.</span></span>

<span data-ttu-id="2fab0-173">További információkért lásd: [kapcsolatos Traffic Manager figyelési][tm-monitoring].</span><span class="sxs-lookup"><span data-stu-id="2fab0-173">For details, see [About Traffic Manager Monitoring][tm-monitoring].</span></span>

<span data-ttu-id="2fab0-174">Ha a Traffic Manager átadja, ajánlott végrehajtása manuális feladat-visszavétel, nem pedig egy automatikus feladat-visszavétel végrehajtására.</span><span class="sxs-lookup"><span data-stu-id="2fab0-174">If Traffic Manager fails over, we recommend performing a manual failback rather than implementing an automatic failback.</span></span> <span data-ttu-id="2fab0-175">Ellenkező esetben hozhat létre olyan helyzet, amelyben az alkalmazás oda-vissza régiók közötti tükrözi.</span><span class="sxs-lookup"><span data-stu-id="2fab0-175">Otherwise, you can create a situation where the application flips back and forth between regions.</span></span> <span data-ttu-id="2fab0-176">Ellenőrizze, hogy minden alkalmazás alrendszer visszavétele előtt kifogástalan.</span><span class="sxs-lookup"><span data-stu-id="2fab0-176">Verify that all application subsystems are healthy before failing back.</span></span>

<span data-ttu-id="2fab0-177">Vegye figyelembe, hogy a Traffic Manager vissza alapértelmezés szerint automatikusan nem.</span><span class="sxs-lookup"><span data-stu-id="2fab0-177">Note that Traffic Manager automatically fails back by default.</span></span> <span data-ttu-id="2fab0-178">Ennek megelőzése érdekében manuálisan a Prioritás csökkentése az elsődleges régió egy feladatátvételi esemény után.</span><span class="sxs-lookup"><span data-stu-id="2fab0-178">To prevent this, manually lower the priority of the primary region after a failover event.</span></span> <span data-ttu-id="2fab0-179">Tegyük fel például, hogy az elsődleges régióban 1 prioritású virtuális gép, és a másodlagos prioritású 2.</span><span class="sxs-lookup"><span data-stu-id="2fab0-179">For example, suppose the primary region is priority 1 and the secondary is priority 2.</span></span> <span data-ttu-id="2fab0-180">A feladatátvétel után állítsa be az elsődleges régióban prioritás 3, hogy megakadályozza az automatikus feladatátvételi.</span><span class="sxs-lookup"><span data-stu-id="2fab0-180">After a failover, set the primary region to priority 3, to prevent automatic failback.</span></span> <span data-ttu-id="2fab0-181">Ha készen áll vissza, frissítse a prioritás 1.</span><span class="sxs-lookup"><span data-stu-id="2fab0-181">When you are ready to switch back, update the priority to 1.</span></span>

<span data-ttu-id="2fab0-182">A következő [Azure CLI] [ install-azure-cli] parancs frissíti a prioritás:</span><span class="sxs-lookup"><span data-stu-id="2fab0-182">The following [Azure CLI][install-azure-cli] command updates the priority:</span></span>

```bat
azure network traffic-manager  endpoint set --resource-group <resource-group> --profile-name <profile>
    --name <traffic-manager-name> --type AzureEndpoints --priority 3
```    

<span data-ttu-id="2fab0-183">Egy másik megoldás, hogy ideiglenesen letilthatja a végpont, amíg készen feladat-visszavételt:</span><span class="sxs-lookup"><span data-stu-id="2fab0-183">Another approach is to temporarily disable the endpoint until you are ready to fail back:</span></span>

```bat
azure network traffic-manager  endpoint set --resource-group <resource-group> --profile-name <profile>
    --name <traffic-manager-name> --type AzureEndpoints --status Disabled
```    

<span data-ttu-id="2fab0-184">A feladatátvételi függően szükség lehet újratelepíteni az erőforrások régión belül.</span><span class="sxs-lookup"><span data-stu-id="2fab0-184">Depending on the cause of a failover, you might need to redeploy the resources within a region.</span></span> <span data-ttu-id="2fab0-185">Mielőtt ismét sikertelen, egy működőképesség tesztjének elvégzéséhez.</span><span class="sxs-lookup"><span data-stu-id="2fab0-185">Before failing back, perform an operational readiness test.</span></span> <span data-ttu-id="2fab0-186">A vizsgálat ellenőrizni kell, többek között:</span><span class="sxs-lookup"><span data-stu-id="2fab0-186">The test should verify things like:</span></span>

* <span data-ttu-id="2fab0-187">Virtuális gépek helyesen vannak konfigurálva.</span><span class="sxs-lookup"><span data-stu-id="2fab0-187">VMs are configured correctly.</span></span> <span data-ttu-id="2fab0-188">(Az összes szükséges szoftverek telepítve van, az IIS fut, és így tovább.)</span><span class="sxs-lookup"><span data-stu-id="2fab0-188">(All required software is installed, IIS is running, and so on.)</span></span>
* <span data-ttu-id="2fab0-189">Alkalmazás alrendszereket is megfelelő.</span><span class="sxs-lookup"><span data-stu-id="2fab0-189">Application subsystems are healthy.</span></span>
* <span data-ttu-id="2fab0-190">Funkcionális tesztelése.</span><span class="sxs-lookup"><span data-stu-id="2fab0-190">Functional testing.</span></span> <span data-ttu-id="2fab0-191">(Például az adatbázis-rétegből érhető el a webes réteg alapján.)</span><span class="sxs-lookup"><span data-stu-id="2fab0-191">(For example, the database tier is reachable from the web tier.)</span></span>

### <a name="cassandra-deployment-across-multiple-regions"></a><span data-ttu-id="2fab0-192">Különféle régiókban Cassandra telepítése</span><span class="sxs-lookup"><span data-stu-id="2fab0-192">Cassandra deployment across multiple regions</span></span>

<span data-ttu-id="2fab0-193">Cassandra adatközpontok a replikáció és a munkaterhelések elkülönítése a fürtön belül együtt konfigurált kapcsolódó adatok csomópontok csoportja.</span><span class="sxs-lookup"><span data-stu-id="2fab0-193">Cassandra data centers are a group of related data nodes that are configured together within a cluster for replication and workload segregation.</span></span>

<span data-ttu-id="2fab0-194">Ajánlott [alapszintű DataStax vállalati] [ datastax] éles használja.</span><span class="sxs-lookup"><span data-stu-id="2fab0-194">We recommend [DataStax Enterprise][datastax] for production use.</span></span> <span data-ttu-id="2fab0-195">Az Azure-beli alapszintű DataStax további információkért lásd: [alapszintű DataStax vállalati üzembe helyezési útmutató az Azure][cassandra-in-azure].</span><span class="sxs-lookup"><span data-stu-id="2fab0-195">For more information on running DataStax in Azure, see [DataStax Enterprise Deployment Guide for Azure][cassandra-in-azure].</span></span> <span data-ttu-id="2fab0-196">Az alábbi általános javaslatokat bármely Cassandra edition vonatkoznak:</span><span class="sxs-lookup"><span data-stu-id="2fab0-196">The following general recommendations apply to any Cassandra edition:</span></span> 

* <span data-ttu-id="2fab0-197">A nyilvános IP-cím hozzárendelése minden csomóponton.</span><span class="sxs-lookup"><span data-stu-id="2fab0-197">Assign a public IP address to each node.</span></span> <span data-ttu-id="2fab0-198">Ez lehetővé teszi a fürtök Azure gerincét infrastruktúrája, alacsony költséggel nagyobb teljesítményt nyújtó régiók kommunikálhassanak.</span><span class="sxs-lookup"><span data-stu-id="2fab0-198">This enables the clusters to communicate across regions using the Azure backbone infrastructure, providing high throughput at low cost.</span></span>
* <span data-ttu-id="2fab0-199">Biztonságos-csomópontokat használja a megfelelő tűzfal és a hálózati biztonsági csoport (NSG) beállítások, így forgalmat csak ismert gazdagépek, köztük az ügyfelek és a többi fürtcsomóponton.</span><span class="sxs-lookup"><span data-stu-id="2fab0-199">Secure nodes using the appropriate firewall and network security group (NSG) configurations, allowing traffic only to and from known hosts, including clients and other cluster nodes.</span></span> <span data-ttu-id="2fab0-200">Vegye figyelembe, hogy a Cassandra más portokat használ a kommunikációs, OpsCenter, Spark-, és így tovább.</span><span class="sxs-lookup"><span data-stu-id="2fab0-200">Note that Cassandra uses different ports for communication, OpsCenter, Spark, and so forth.</span></span> <span data-ttu-id="2fab0-201">Cassandra portokkal, lásd: [tűzfalhozzáférés port konfigurálása][cassandra-ports].</span><span class="sxs-lookup"><span data-stu-id="2fab0-201">For port usage in Cassandra, see [Configuring firewall port access][cassandra-ports].</span></span>
* <span data-ttu-id="2fab0-202">SSL-titkosítást használni az összes [ügyfél-csomópont] [ ssl-client-node] és [csomópontok] [ ssl-node-node] kommunikáció.</span><span class="sxs-lookup"><span data-stu-id="2fab0-202">Use SSL encryption for all [client-to-node][ssl-client-node] and [node-to-node][ssl-node-node] communications.</span></span>
* <span data-ttu-id="2fab0-203">A régión belül útmutatását [Cassandra javaslatok](n-tier.md#cassandra).</span><span class="sxs-lookup"><span data-stu-id="2fab0-203">Within a region, follow the guidelines in [Cassandra recommendations](n-tier.md#cassandra).</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="2fab0-204">Rendelkezésre állási szempontok</span><span class="sxs-lookup"><span data-stu-id="2fab0-204">Availability considerations</span></span>

<span data-ttu-id="2fab0-205">Egy összetett N szintű alkalmazást, nem kell replikálni a másodlagos régióban a teljes alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="2fab0-205">With a complex N-tier app, you may not need to replicate the entire application in the secondary region.</span></span> <span data-ttu-id="2fab0-206">Ehelyett csak lehet, hogy replikálja a kritikus alrendszer, az üzletmenet folytonossága támogatásához szükséges.</span><span class="sxs-lookup"><span data-stu-id="2fab0-206">Instead, you might just replicate a critical subsystem that is needed to support business continuity.</span></span>

<span data-ttu-id="2fab0-207">A TRAFFIC Manager ponttá lehetséges hiba a rendszerben.</span><span class="sxs-lookup"><span data-stu-id="2fab0-207">Traffic Manager is a possible failure point in the system.</span></span> <span data-ttu-id="2fab0-208">A Traffic Manager szolgáltatás nem sikerül, ha az ügyfelek nem tudnak hozzáférni az alkalmazás a leállások során.</span><span class="sxs-lookup"><span data-stu-id="2fab0-208">If the Traffic Manager service fails, clients cannot access your application during the downtime.</span></span> <span data-ttu-id="2fab0-209">Tekintse át a [Traffic Manager SLA][tm-sla], és döntse el, hogy kizárólag a Traffic Manager segítségével megfelel-e az üzleti követelményeinek, a magas rendelkezésre állás érdekében.</span><span class="sxs-lookup"><span data-stu-id="2fab0-209">Review the [Traffic Manager SLA][tm-sla], and determine whether using Traffic Manager alone meets your business requirements for high availability.</span></span> <span data-ttu-id="2fab0-210">Ha nem, akkor vegyen fel egy másik forgalom felügyeleti megoldás, a feladat-visszavételre.</span><span class="sxs-lookup"><span data-stu-id="2fab0-210">If not, consider adding another traffic management solution as a failback.</span></span> <span data-ttu-id="2fab0-211">Ha az Azure Traffic Manager szolgáltatás nem sikerül, módosítsa a CNAME rekordot a DNS-ben, hogy a többi felügyeleti szolgálat mutasson.</span><span class="sxs-lookup"><span data-stu-id="2fab0-211">If the Azure Traffic Manager service fails, change your CNAME records in DNS to point to the other traffic management service.</span></span> <span data-ttu-id="2fab0-212">(Ebben a lépésben kézzel kell elvégezni, és az alkalmazás nem lehet a DNS-módosítások továbbítódnak.)</span><span class="sxs-lookup"><span data-stu-id="2fab0-212">(This step must be performed manually, and your application will be unavailable until the DNS changes are propagated.)</span></span>

<span data-ttu-id="2fab0-213">Figyelembe kell venni a feladatátvételi forgatókönyvek Cassandra fürt használják az alkalmazást, valamint a használt replikák száma konzisztenciaszintek függ.</span><span class="sxs-lookup"><span data-stu-id="2fab0-213">For the Cassandra cluster, the failover scenarios to consider depend on the consistency levels used by the application, as well as the number of replicas used.</span></span> <span data-ttu-id="2fab0-214">Konzisztenciaszintek és Cassandra használata: [konfigurálása az adatok konzisztenciájának] [ cassandra-consistency] és [Cassandra: hány csomópontok vannak volt szó, a kvórummal?][cassandra-consistency-usage]</span><span class="sxs-lookup"><span data-stu-id="2fab0-214">For consistency levels and usage in Cassandra, see [Configuring data consistency][cassandra-consistency] and [Cassandra: How many nodes are talked to with Quorum?][cassandra-consistency-usage]</span></span> <span data-ttu-id="2fab0-215">Az alkalmazás és a replikációs eljárás által használt konzisztenciaszint Cassandra az adatok rendelkezésre állását határozza meg.</span><span class="sxs-lookup"><span data-stu-id="2fab0-215">Data availability in Cassandra is determined by the consistency level used by the application and the replication mechanism.</span></span> <span data-ttu-id="2fab0-216">Az Cassandra replikáció, lásd: [a NoSQL-adatbázisok alapján adatreplikáció][cassandra-replication].</span><span class="sxs-lookup"><span data-stu-id="2fab0-216">For replication in Cassandra, see [Data Replication in NoSQL Databases Explained][cassandra-replication].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="2fab0-217">Felügyeleti szempontok</span><span class="sxs-lookup"><span data-stu-id="2fab0-217">Manageability considerations</span></span>

<span data-ttu-id="2fab0-218">Ha a telepítés frissítéséhez frissíteni egy régió tartozik csökkenti annak esélyét, a globális hibák egy helytelen konfiguráció vagy az alkalmazás hiba egyszerre.</span><span class="sxs-lookup"><span data-stu-id="2fab0-218">When you update your deployment, update one region at a time to reduce the chance of a global failure from an incorrect configuration or an error in the application.</span></span>

<span data-ttu-id="2fab0-219">Tesztelje a rugalmasság, a rendszer a hibák.</span><span class="sxs-lookup"><span data-stu-id="2fab0-219">Test the resiliency of the system to failures.</span></span> <span data-ttu-id="2fab0-220">Az alábbiakban néhány gyakori hiba helyzetek ellenőrzéséhez:</span><span class="sxs-lookup"><span data-stu-id="2fab0-220">Here are some common failure scenarios to test:</span></span>

* <span data-ttu-id="2fab0-221">Állítsa le a Virtuálisgép-példányok.</span><span class="sxs-lookup"><span data-stu-id="2fab0-221">Shut down VM instances.</span></span>
* <span data-ttu-id="2fab0-222">Nyomás erőforrások, például CPU és memória.</span><span class="sxs-lookup"><span data-stu-id="2fab0-222">Pressure resources such as CPU and memory.</span></span>
* <span data-ttu-id="2fab0-223">Hálózati kapcsolat bontása/késleltetés.</span><span class="sxs-lookup"><span data-stu-id="2fab0-223">Disconnect/delay network.</span></span>
* <span data-ttu-id="2fab0-224">Összeomlás-folyamatokat.</span><span class="sxs-lookup"><span data-stu-id="2fab0-224">Crash processes.</span></span>
* <span data-ttu-id="2fab0-225">Tanúsítványok lejárnak.</span><span class="sxs-lookup"><span data-stu-id="2fab0-225">Expire certificates.</span></span>
* <span data-ttu-id="2fab0-226">Hardver hibák szimulálásához.</span><span class="sxs-lookup"><span data-stu-id="2fab0-226">Simulate hardware faults.</span></span>
* <span data-ttu-id="2fab0-227">Állítsa le a DNS-szolgáltatás a tartományvezérlőkön.</span><span class="sxs-lookup"><span data-stu-id="2fab0-227">Shut down the DNS service on the domain controllers.</span></span>

<span data-ttu-id="2fab0-228">A helyreállítási idő mérését, és győződjön meg arról, hogy megfelelnek-e az üzleti igényeknek.</span><span class="sxs-lookup"><span data-stu-id="2fab0-228">Measure the recovery times and verify they meet your business requirements.</span></span> <span data-ttu-id="2fab0-229">Teszt sikertelen üzemmódot, valamint kombinációi.</span><span class="sxs-lookup"><span data-stu-id="2fab0-229">Test combinations of failure modes, as well.</span></span>


<!-- Links -->
[hybrid-vpn]: ../hybrid-networking/vpn.md

[cassandra-in-azure]: https://academy.datastax.com/resources/deployment-guide-azure
[cassandra-consistency]: http://docs.datastax.com/en/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html
[cassandra-replication]: http://www.planetcassandra.org/data-replication-in-nosql-databases-explained/
[cassandra-consistency-usage]: https://medium.com/@foundev/cassandra-how-many-nodes-are-talked-to-with-quorum-also-should-i-use-it-98074e75d7d5#.b4pb4alb2
[cassandra-ports]: https://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/sec/configFirewallPorts.html
[datastax]: https://www.datastax.com/products/datastax-enterprise
[health-endpoint-monitoring-pattern]: https://msdn.microsoft.com/library/dn589789.aspx
[install-azure-cli]: /azure/xplat-cli-install
[regional-pairs]: /azure/best-practices-availability-paired-regions
[resource groups]: /azure/azure-resource-manager/resource-group-overview
[resource-group-links]: /azure/resource-group-link-resources
[services-by-region]: https://azure.microsoft.com/regions/#services
[ssl-client-node]: http://docs.datastax.com/en/cassandra/2.0/cassandra/security/secureSSLClientToNode_t.html
[ssl-node-node]: http://docs.datastax.com/en/cassandra/2.0/cassandra/security/secureSSLNodeToNode_t.html
[tablediff]: https://msdn.microsoft.com/library/ms162843.aspx
[tm-configure-failover]: /azure/traffic-manager/traffic-manager-configure-failover-routing-method
[tm-monitoring]: /azure/traffic-manager/traffic-manager-monitoring
[tm-routing]: /azure/traffic-manager/traffic-manager-routing-methods
[tm-sla]: https://azure.microsoft.com/support/legal/sla/traffic-manager/v1_0/
[traffic-manager]: https://azure.microsoft.com/services/traffic-manager/
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[wsfc]: https://msdn.microsoft.com/library/hh270278.aspx
[0]: ./images/multi-region-application-diagram.png "Magas rendelkezésre állású hálózati architektúra Azure N szintű alkalmazásokhoz"
