---
title: "Linux rendszerű virtuális gépek futtatása N szintű alkalmazásokhoz az Azure-on"
description: "Annak az ismertetése, hogyan kell Linux rendszerű virtuális gépeket futtatni N szintű architektúrához a Microsoft Azure-ban."
author: MikeWasson
ms.date: 11/22/2017
pnp.series.title: Linux VM workloads
pnp.series.next: multi-region-application
pnp.series.prev: multi-vm
ms.openlocfilehash: da5d901ef01bfa170cf7d8646bced1e1403e5a09
ms.sourcegitcommit: ea7108f71dab09175ff69322874d1bcba800a37a
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 03/17/2018
---
# <a name="run-linux-vms-for-an-n-tier-application"></a><span data-ttu-id="2c5e8-103">Linux rendszerű virtuális gépek futtatása N szintű alkalmazáshoz</span><span class="sxs-lookup"><span data-stu-id="2c5e8-103">Run Linux VMs for an N-tier application</span></span>

<span data-ttu-id="2c5e8-104">Ez a referenciaarchitektúra bevált eljárásokat mutat be arra az esetre, ha egy N szintű alkalmazáshoz szeretne Linux rendszerű virtuális gépeket (VM-eket) futtatni.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-104">This reference architecture shows a set of proven practices for running Linux virtual machines (VMs) for an N-tier application.</span></span> [<span data-ttu-id="2c5e8-105">**A megoldás üzembe helyezése**.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-105">**Deploy this solution**.</span></span>](#deploy-the-solution)  

<span data-ttu-id="2c5e8-106">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="2c5e8-106">![[0]][0]</span></span>

<span data-ttu-id="2c5e8-107">*Töltse le az architektúra [Visio-fájlját][visio-download].*</span><span class="sxs-lookup"><span data-stu-id="2c5e8-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="2c5e8-108">Architektúra</span><span class="sxs-lookup"><span data-stu-id="2c5e8-108">Architecture</span></span>

<span data-ttu-id="2c5e8-109">Egy N szintű architektúra számos módon implementálható.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-109">There are many ways to implement an N-tier architecture.</span></span> <span data-ttu-id="2c5e8-110">Az ábrán egy tipikusnak mondható 3 szintű webalkalmazás látható.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-110">The diagram shows a typical 3-tier web application.</span></span> <span data-ttu-id="2c5e8-111">Ez az architektúra a következőre épül: [Elosztott terhelésű virtuális gépek futtatása a méretezhetőség és a rendelkezésre állás érdekében][multi-vm].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-111">This architecture builds on [Run load-balanced VMs for scalability and availability][multi-vm].</span></span> <span data-ttu-id="2c5e8-112">A webes és üzleti szintek elosztott terhelésű virtuális gépeket használnak.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-112">The web and business tiers use load-balanced VMs.</span></span>

* <span data-ttu-id="2c5e8-113">**Rendelkezésre állási csoportok.**</span><span class="sxs-lookup"><span data-stu-id="2c5e8-113">**Availability sets.**</span></span> <span data-ttu-id="2c5e8-114">Hozzon létre egy [rendelkezésre állási csoportot][azure-availability-sets] minden szinthez, majd minden szinten építsen ki legalább két virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-114">Create an [availability set][azure-availability-sets] for each tier, and provision at least two VMs in each tier.</span></span>  <span data-ttu-id="2c5e8-115">Így a virtuális gépek magasabb szintű [szolgáltatói szerződésre (SLA-ra)][vm-sla] jogosultak.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-115">This makes the VMs eligible for a higher [service level agreement (SLA)][vm-sla] for VMs.</span></span> <span data-ttu-id="2c5e8-116">Azt is megteheti, hogy egyetlen virtuális gépet helyez üzembe a rendelkezésre állási csoportban, de egy virtuális gép nem jogosult SLA-garanciára, kivéve, ha Azure Premium Storage-t használ minden operációsrendszer- és adatlemezhez.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-116">You can deploy a single VM in an availability set, but the single VM will not qualify for an SLA guarantee unless the single VM is using Azure Premium Storage for all OS and data disks.</span></span>  
* <span data-ttu-id="2c5e8-117">**Alhálózatok.**</span><span class="sxs-lookup"><span data-stu-id="2c5e8-117">**Subnets.**</span></span> <span data-ttu-id="2c5e8-118">Hozzon létre egy külön alhálózatot minden egyes szinthez.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-118">Create a separate subnet for each tier.</span></span> <span data-ttu-id="2c5e8-119">A címtartományt és az alhálózati maszkot a [CIDR] jelöléssel határozza meg.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-119">Specify the address range and subnet mask using [CIDR] notation.</span></span> 
* <span data-ttu-id="2c5e8-120">**Terheléselosztók**.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-120">**Load balancers.**</span></span> <span data-ttu-id="2c5e8-121">Használjon egy [internetkapcsolattal rendelkező terheléselosztót][load-balancer-external] a bejövő internetes forgalom webes szinten történő elosztására, és egy [belső terheléselosztót][load-balancer-internal] a webes szintről az üzleti szintre irányuló hálózati forgalom elosztására.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-121">Use an [Internet-facing load balancer][load-balancer-external] to distribute incoming Internet traffic to the web tier, and an [internal load balancer][load-balancer-internal] to distribute network traffic from the web tier to the business tier.</span></span>
* <span data-ttu-id="2c5e8-122">**Azure DNS**.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-122">**Azure DNS**.</span></span> <span data-ttu-id="2c5e8-123">Az [Azure DNS][azure-dns] egy üzemeltetési szolgáltatás, amely a Microsoft Azure infrastruktúráját használja a DNS-tartományok névfeloldásához.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-123">[Azure DNS][azure-dns] is a hosting service for DNS domains, providing name resolution using Microsoft Azure infrastructure.</span></span> <span data-ttu-id="2c5e8-124">Ha tartományait az Azure-ban üzemelteti, DNS-rekordjait a többi Azure-szolgáltatáshoz is használt hitelesítő adatokkal, API-kkal, eszközökkel és számlázási információkkal kezelheti.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-124">By hosting your domains in Azure, you can manage your DNS records using the same credentials, APIs, tools, and billing as your other Azure services.</span></span>
* <span data-ttu-id="2c5e8-125">**Jumpbox.**</span><span class="sxs-lookup"><span data-stu-id="2c5e8-125">**Jumpbox.**</span></span> <span data-ttu-id="2c5e8-126">Más néven [bástyagazdagép].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-126">Also called a [bastion host].</span></span> <span data-ttu-id="2c5e8-127">A hálózaton található biztonságos virtuális gép, amelyet a rendszergazdák a többi virtuális géphez való kapcsolódásra használnak.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-127">A secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="2c5e8-128">A jumpbox olyan NSG-vel rendelkezik, amely csak a biztonságos elemek listáján szereplő nyilvános IP-címekről érkező távoli forgalmat engedélyezi.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-128">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="2c5e8-129">Az NSG-nek lehetővé kell tennie a Secure Shell- (SSH-) forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-129">The NSG should permit secure shell (SSH) traffic.</span></span>
* <span data-ttu-id="2c5e8-130">**Monitorozás.**</span><span class="sxs-lookup"><span data-stu-id="2c5e8-130">**Monitoring.**</span></span> <span data-ttu-id="2c5e8-131">A figyelőszoftverek, mint a [Nagios], a [Zabbix] vagy az [Icinga], információval szolgálhatnak a válaszidőről, a virtuális gép hasznos üzemidejéről és a rendszer általános állapotáról.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-131">Monitoring software such as [Nagios], [Zabbix], or [Icinga] can give you insight into response time, VM uptime, and the overall health of your system.</span></span> <span data-ttu-id="2c5e8-132">Olyan virtuális gépre telepítse a figyelőszoftvert, amely egy különálló felügyeleti alhálózaton található.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-132">Install the monitoring software on a VM that's placed in a separate management subnet.</span></span>
* <span data-ttu-id="2c5e8-133">**NSG-k**.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-133">**NSGs.**</span></span> <span data-ttu-id="2c5e8-134">Használjon [hálózati biztonsági csoportokat][nsg] (NSG-ket) a hálózati forgalom korlátozására a virtuális hálózaton belül.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-134">Use [network security groups][nsg] (NSGs) to restrict network traffic within the VNet.</span></span> <span data-ttu-id="2c5e8-135">Az itt látható 3 szintű architektúrában például az adatbázisszint csak az üzleti szintről és a felügyeleti alhálózatról érkező forgalmat fogadja, a webes kezelőfelület felől érkező forgalmat nem.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-135">For example, in the 3-tier architecture shown here, the database tier does not accept traffic from the web front end, only from the business tier and the management subnet.</span></span>
* <span data-ttu-id="2c5e8-136">**Apache Cassandra-adatbázis**.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-136">**Apache Cassandra database**.</span></span> <span data-ttu-id="2c5e8-137">Magas rendelkezésre állást biztosít az adatszinten a replikáció és a feladatátvétel engedélyezésével.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-137">Provides high availability at the data tier, by enabling replication and failover.</span></span>

## <a name="recommendations"></a><span data-ttu-id="2c5e8-138">Javaslatok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-138">Recommendations</span></span>

<span data-ttu-id="2c5e8-139">Az Ön követelményei eltérhetnek az itt leírt architektúrától.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-139">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="2c5e8-140">Ezeket a javaslatokat tekintse kiindulópontnak.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-140">Use these recommendations as a starting point.</span></span> 

### <a name="vnet--subnets"></a><span data-ttu-id="2c5e8-141">Virtuális hálózat/alhálózatok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-141">VNet / Subnets</span></span>

<span data-ttu-id="2c5e8-142">A virtuális hálózat létrehozásakor határozza meg az egyes alhálózatok erőforrásai által igényelt IP-címek számát.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-142">When you create the VNet, determine how many IP addresses your resources in each subnet require.</span></span> <span data-ttu-id="2c5e8-143">[CIDR] jelöléssel adjon meg egy alhálózati maszkot és egy virtuális hálózati címtartományt, amely elég nagy a szükséges IP-címekhez.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-143">Specify a subnet mask and a VNet address range large enough for the required IP addresses using [CIDR] notation.</span></span> <span data-ttu-id="2c5e8-144">Használjon a szabványos [magánhálózati IP-címblokkokba][private-ip-space] eső címterületet. Ezek az IP-címblokkok a következők: 10.0.0.0/8, 172.16.0.0/12 és 192.168.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-144">Use an address space that falls within the standard [private IP address blocks][private-ip-space], which are 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16.</span></span>

<span data-ttu-id="2c5e8-145">Válasszon olyan címtartományt, amely nincs átfedésben a helyszíni hálózattal, hogy később átjárót lehessen beállítani a virtuális és a helyszíni hálózat között.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-145">Choose an address range that does not overlap with your on-premises network, in case you need to set up a gateway between the VNet and your on-premises network later.</span></span> <span data-ttu-id="2c5e8-146">A virtuális hálózat létrehozása után a címtartomány nem módosítható.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-146">Once you create the VNet, you can't change the address range.</span></span>

<span data-ttu-id="2c5e8-147">Az alhálózatokat a funkciók és a biztonsági követelmények szem előtt tartásával tervezze meg.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-147">Design subnets with functionality and security requirements in mind.</span></span> <span data-ttu-id="2c5e8-148">Minden ugyanazon szinthez vagy szerepkörhöz tartozó virtuális gépnek egyazon alhálózaton kell lennie. Ez az alhálózat biztonsági korlátot is képezhet.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-148">All VMs within the same tier or role should go into the same subnet, which can be a security boundary.</span></span> <span data-ttu-id="2c5e8-149">A virtuális hálózatok és alhálózatok megtervezésével kapcsolatos további információkért lásd az [Azure-beli virtuális hálózatok tervezésével és kialakításával][plan-network] foglalkozó témakört.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-149">For more information about designing VNets and subnets, see [Plan and design Azure Virtual Networks][plan-network].</span></span>

<span data-ttu-id="2c5e8-150">Az egyes alhálózatokon adja meg az alhálózat címterületét CIDR-jelölés formájában.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-150">For each subnet, specify the address space for the subnet in CIDR notation.</span></span> <span data-ttu-id="2c5e8-151">A „10.0.0.0/24” például egy 256 IP-címből álló tartományt hoz létre.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-151">For example, '10.0.0.0/24' creates a range of 256 IP addresses.</span></span> <span data-ttu-id="2c5e8-152">A virtuális gépek ezek közül 251-et használhatnak; öt foglalt.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-152">VMs can use 251 of these; five are reserved.</span></span> <span data-ttu-id="2c5e8-153">Győződjön meg arról, hogy a címtartományok nem fedik át egymást a különböző alhálózatokon.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-153">Make sure the address ranges don't overlap across subnets.</span></span> <span data-ttu-id="2c5e8-154">Lásd a [virtuális hálózatra vonatkozó gyakori kérdéseket][vnet faq].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-154">See the [Virtual Network FAQ][vnet faq].</span></span>

### <a name="network-security-groups"></a><span data-ttu-id="2c5e8-155">Network security groups (Hálózati biztonsági csoportok)</span><span class="sxs-lookup"><span data-stu-id="2c5e8-155">Network security groups</span></span>

<span data-ttu-id="2c5e8-156">A szintek közötti forgalmat NSG-szabályokkal korlátozhatja.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-156">Use NSG rules to restrict traffic between tiers.</span></span> <span data-ttu-id="2c5e8-157">A fenti 3 szintes architektúra esetén például a webes szint nem kommunikál közvetlenül az adatbázisszinttel.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-157">For example, in the 3-tier architecture shown above, the web tier does not communicate directly with the database tier.</span></span> <span data-ttu-id="2c5e8-158">Ennek kényszerítése érdekében az adatbázisszintnek blokkolnia kell a webes szint alhálózatáról érkező bejövő forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-158">To enforce this, the database tier should block incoming traffic from the web tier subnet.</span></span>  

1. <span data-ttu-id="2c5e8-159">Hozzon létre egy NSG-t, és társítsa az adatbázisszint alhálózatához.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-159">Create an NSG and associate it to the database tier subnet.</span></span>
2. <span data-ttu-id="2c5e8-160">Adjon meg egy szabályt, amely minden, a virtuális hálózatról bejövő forgalmat blokkol.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-160">Add a rule that denies all inbound traffic from the VNet.</span></span> <span data-ttu-id="2c5e8-161">(A szabályban használja a `VIRTUAL_NETWORK` címkét.)</span><span class="sxs-lookup"><span data-stu-id="2c5e8-161">(Use the `VIRTUAL_NETWORK` tag in the rule.)</span></span> 
3. <span data-ttu-id="2c5e8-162">Adjon meg egy magasabb prioritású szabályt, amely engedélyezi az üzleti szint alhálózatáról bejövő forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-162">Add a rule with a higher priority that allows inbound traffic from the business tier subnet.</span></span> <span data-ttu-id="2c5e8-163">Ez a szabály felülírja az előzőt, és lehetővé teszi az üzleti szint számára az adatbázisszinttel folytatott kommunikációt.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-163">This rule overrides the previous rule, and allows the business tier to talk to the database tier.</span></span>
4. <span data-ttu-id="2c5e8-164">Adjon meg egy szabályt, amely engedélyezi az adatbázisszint alhálózatán belülről érkező forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-164">Add a rule that allows inbound traffic from within the database tier subnet itself.</span></span> <span data-ttu-id="2c5e8-165">Ez lehetővé teszi a virtuális gépek közötti kommunikációt az adatbázisszinten, amelyre az adatbázis replikációja és feladatátvétele miatt van szükség.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-165">This rule allows communication between VMs in the database tier, which is needed for database replication and failover.</span></span>
5. <span data-ttu-id="2c5e8-166">Adjon meg egy szabályt, amely engedélyezi a jumpbox alhálózatáról származó SSH-forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-166">Add a rule that allows SSH traffic from the jumpbox subnet.</span></span> <span data-ttu-id="2c5e8-167">Ez lehetővé teszi, hogy a rendszergazdák csatlakozni tudjanak az adatbázisszinthez a jumpboxból.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-167">This rule lets administrators connect to the database tier from the jumpbox.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="2c5e8-168">A hálózati biztonsági csoportok olyan [alapértelmezett szabályokkal][nsg-rules] rendelkeznek, amelyek engedélyezik a virtuális hálózaton belülről érkező bejövő forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-168">An NSG has [default rules][nsg-rules] that allow any inbound traffic from within the VNet.</span></span> <span data-ttu-id="2c5e8-169">Ezek a szabályok nem törölhetők, de magasabb prioritású szabályok létrehozásával felülbírálhatók.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-169">These rules can't be deleted, but you can override them by creating higher-priority rules.</span></span>
   > 
   > 

### <a name="load-balancers"></a><span data-ttu-id="2c5e8-170">Terheléselosztók</span><span class="sxs-lookup"><span data-stu-id="2c5e8-170">Load balancers</span></span>

<span data-ttu-id="2c5e8-171">A külső terheléselosztó osztja el az internetes forgalmat a webes szintre.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-171">The external load balancer distributes Internet traffic to the web tier.</span></span> <span data-ttu-id="2c5e8-172">Hozzon létre egy nyilvános IP-címet ehhez a terheléselosztóhoz.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-172">Create a public IP address for this load balancer.</span></span> <span data-ttu-id="2c5e8-173">Lásd: [Internetkapcsolattal rendelkező terheléselosztó létrehozása][lb-external-create].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-173">See [Creating an Internet-facing load balancer][lb-external-create].</span></span>

<span data-ttu-id="2c5e8-174">A belső terheléselosztó osztja el a webes szintről az üzleti szint felé irányuló hálózati forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-174">The internal load balancer distributes network traffic from the web tier to the business tier.</span></span> <span data-ttu-id="2c5e8-175">Ahhoz, hogy ez a terheléselosztó magánhálózati IP-címre tehessen szert, hozzon létre egy előtérbeli IP-konfigurációt, és rendelje hozzá az üzleti szint alhálózatához.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-175">To give this load balancer a private IP address, create a frontend IP configuration and associate it with the subnet for the business tier.</span></span> <span data-ttu-id="2c5e8-176">Lásd: [Belső terheléselosztó létrehozása][lb-internal-create].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-176">See [Get started creating an Internal load balancer][lb-internal-create].</span></span>

### <a name="cassandra"></a><span data-ttu-id="2c5e8-177">Cassandra</span><span class="sxs-lookup"><span data-stu-id="2c5e8-177">Cassandra</span></span>

<span data-ttu-id="2c5e8-178">Éles környezetben ajánlott a [DataStax Enterprise][datastax] használata, de ezek a javaslatok bármely Cassandra-kiadásra is vonatkoznak.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-178">We recommend [DataStax Enterprise][datastax] for production use, but these recommendations apply to any Cassandra edition.</span></span> <span data-ttu-id="2c5e8-179">További információk a DataStax futtatásáról az Azure-ban: [A DataStax Enterprise üzembehelyezési útmutatója az Azure-hoz][cassandra-in-azure].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-179">For more information on running DataStax in Azure, see [DataStax Enterprise Deployment Guide for Azure][cassandra-in-azure].</span></span> 

<span data-ttu-id="2c5e8-180">Helyezze a virtuális gépeket egy rendelkezésre állási csoport Cassandra-fürtjére annak érdekében, hogy a Cassandra-replikák több tartalék és frissítési tartományon legyenek elosztva.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-180">Put the VMs for a Cassandra cluster in an availability set to ensure that the Cassandra replicas are distributed across multiple fault domains and upgrade domains.</span></span> <span data-ttu-id="2c5e8-181">A tartalék és a frissítési tartományokról további információkért lásd a [virtuális gépek rendelkezésre állásának kezelésével][azure-availability-sets] foglalkozó témakört.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-181">For more information about fault domains and upgrade domains, see [Manage the availability of virtual machines][azure-availability-sets].</span></span> 

<span data-ttu-id="2c5e8-182">Rendelkezésre állási csoportonként konfiguráljon három tartalék tartományt (ez a maximum) és 18 frissítési tartományt.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-182">Configure three fault domains (the maximum) per availability set and 18 upgrade domains per availability set.</span></span> <span data-ttu-id="2c5e8-183">Így a legmagasabb számú olyan frissítési tartománya lehet, amelyet a tartalék tartományokon még egyenletesen lehet elosztani.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-183">This provides the maximum number of upgrade domains that can still be distributed evenly across the fault domains.</span></span>   

<span data-ttu-id="2c5e8-184">Konfigurálja a csomópontokat állvány-kompatibilis üzemmódban.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-184">Configure nodes in rack-aware mode.</span></span> <span data-ttu-id="2c5e8-185">Képezze le a tartalék tartományokat állványokra a `cassandra-rackdc.properties` fájlban.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-185">Map fault domains to racks in the `cassandra-rackdc.properties` file.</span></span>

<span data-ttu-id="2c5e8-186">A fürt előtt nincs szükség terheléselosztóra.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-186">You don't need a load balancer in front of the cluster.</span></span> <span data-ttu-id="2c5e8-187">Az ügyfél közvetlenül csatlakozik a fürt egyik csomópontjához.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-187">The client connects directly to a node in the cluster.</span></span>

### <a name="jumpbox"></a><span data-ttu-id="2c5e8-188">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="2c5e8-188">Jumpbox</span></span>

<span data-ttu-id="2c5e8-189">A jumpboxnak minimális teljesítménykövetelményei vannak, ezért kis virtuálisgép-méretet jelöljön ki a számára, például egy standard A1-et.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-189">The jumpbox will have minimal performance requirements, so select a small VM size for the jumpbox such as Standard A1.</span></span> 

<span data-ttu-id="2c5e8-190">Hozzon létre egy [nyilvános IP-címet] a jumpbox számára.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-190">Create a [public IP address] for the jumpbox.</span></span> <span data-ttu-id="2c5e8-191">Helyezze a jumpboxot a többi virtuális géppel megegyező virtuális hálózatba, de egy külön felügyeleti alhálózaton legyen.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-191">Place the jumpbox in the same VNet as the other VMs, but in a separate management subnet.</span></span>

<span data-ttu-id="2c5e8-192">Az alkalmazás számítási feladatait futtató virtuális gépek nyilvános internetről való SSH-hozzáférését ne engedélyezze.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-192">Do not allow SSH access from the public Internet to the VMs that run the application workload.</span></span> <span data-ttu-id="2c5e8-193">Az ilyen virtuális gépek SSH-hozzáférésének ehelyett a jumpboxon keresztül kell történnie.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-193">Instead, all SSH access to these VMs must come through the jumpbox.</span></span> <span data-ttu-id="2c5e8-194">A rendszergazda először bejelentkezik a jumpboxba, majd azon keresztül bejelentkezik a többi virtuális gépbe.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-194">An administrator logs into the jumpbox, and then logs into the other VM from the jumpbox.</span></span> <span data-ttu-id="2c5e8-195">A jumpbox engedélyezi az internetről érkező SSH-forgalmat, de csak az ismert, biztonságos IP-címekről.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-195">The jumpbox allows SSH traffic from the Internet, but only from known, safe IP addresses.</span></span>

<span data-ttu-id="2c5e8-196">A jumpbox védelmére hozzon létre egy NSG-t, és alkalmazza azt a jumpbox alhálózatára.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-196">To secure the jumpbox, create an NSG and apply it to the jumpbox subnet.</span></span> <span data-ttu-id="2c5e8-197">Adjon meg egy NSG-szabályt, amely csak a biztonságos nyilvános IP-címkészletekről engedélyezi az SSH-kapcsolatokat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-197">Add an NSG rule that allows SSH connections only from a safe set of public IP addresses.</span></span> <span data-ttu-id="2c5e8-198">Az NSG az alhálózathoz vagy a jumpbox hálózati adapteréhez is csatolható.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-198">The NSG can be attached either to the subnet or to the jumpbox NIC.</span></span> <span data-ttu-id="2c5e8-199">Ebben az esetben ajánlott a hálózati adapterhez való csatlakoztatás, így az SSH-forgalom akkor is csak a jumpbox irányába van engedélyezve, ha más virtuális gépeket ad hozzá ugyanahhoz az alhálózathoz.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-199">In this case, we recommend attaching it to the NIC, so SSH traffic is permitted only to the jumpbox, even if you add other VMs to the same subnet.</span></span>

<span data-ttu-id="2c5e8-200">Állítsa be az NSG-t a többi alhálózathoz is úgy, hogy engedélyezze a felügyeleti alhálózatból érkező SSH-forgalmat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-200">Configure the NSGs for the other subnets to allow SSH traffic from the management subnet.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="2c5e8-201">Rendelkezésre állási szempontok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-201">Availability considerations</span></span>

<span data-ttu-id="2c5e8-202">Helyezzen minden szintet vagy virtuálisgép-szerepkört külön rendelkezésre állási csoportba.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-202">Put each tier or VM role into a separate availability set.</span></span> 

<span data-ttu-id="2c5e8-203">Hiába van több virtuális gépe, ez az adatbázisszinten nem jelent automatikusan magasabb rendelkezésre állást.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-203">At the database tier, having multiple VMs does not automatically translate into a highly available database.</span></span> <span data-ttu-id="2c5e8-204">Relációs adatbázis esetén rendszerint replikációval és feladatátvétellel biztosítható a magas rendelkezésre állás.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-204">For a relational database, you will typically need to use replication and failover to achieve high availability.</span></span>  

<span data-ttu-id="2c5e8-205">Ha magasabb rendelkezésre állás szükséges, mint amelyet a [virtuális gépekhez készült Azure SLA nyújt][vm-sla], replikálja az alkalmazást két régióban, a feladatátvételre pedig használja az Azure Traffic Managert.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-205">If you need higher availability than the [Azure SLA for VMs][vm-sla] provides, replicate the application across two regions and use Azure Traffic Manager for failover.</span></span> <span data-ttu-id="2c5e8-206">További információkért lásd: [Linux virtuális gépek futtatása több régióban a magas rendelkezésre állás érdekében][multi-dc].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-206">For more information, see [Run Linux VMs in multiple regions for high availability][multi-dc].</span></span>  

## <a name="security-considerations"></a><span data-ttu-id="2c5e8-207">Biztonsági szempontok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-207">Security considerations</span></span>

<span data-ttu-id="2c5e8-208">Érdemes lehet megadni egy hálózati virtuális berendezést (network virtual appliance, NVA), hogy DMZ-t lehessen létrehozni a nyilvános internet és az Azure-beli virtuális hálózat között.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-208">Consider adding a network virtual appliance (NVA) to create a DMZ between the public Internet and the Azure virtual network.</span></span> <span data-ttu-id="2c5e8-209">Az NVA egy általános kifejezés egy olyan virtuális berendezésre, amely hálózatokhoz kapcsolódó feladatokat lát el, például gondoskodik a tűzfalról, a csomagvizsgálatról, a naplózásról és az egyéni útválasztásról.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-209">NVA is a generic term for a virtual appliance that can perform network-related tasks such as firewall, packet inspection, auditing, and custom routing.</span></span> <span data-ttu-id="2c5e8-210">További információkért lásd a [DMZ az Azure és az internet közötti implementálásával][dmz] foglalkozó témakört.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-210">For more information, see [Implementing a DMZ between Azure and the Internet][dmz].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="2c5e8-211">Méretezési szempontok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-211">Scalability considerations</span></span>

<span data-ttu-id="2c5e8-212">A terheléselosztók elosztják a hálózati forgalmat a webes és az üzleti szinteken.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-212">The load balancers distribute network traffic to the web and business tiers.</span></span> <span data-ttu-id="2c5e8-213">Új virtuálisgép-példányok hozzáadásával horizontálisan skálázhatja a rendszert.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-213">Scale horizontally by adding new VM instances.</span></span> <span data-ttu-id="2c5e8-214">Vegye figyelembe, hogy egymástól függetlenül is méretezheti a webes és az üzleti szinteket, a terheléstől függően.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-214">Note that you can scale the web and business tiers independently, based on load.</span></span> <span data-ttu-id="2c5e8-215">Az ügyfélaffinitás fenntartásának szükségessége okozta lehetséges komplikációk csökkentése érdekében a webes szint virtuális gépeinek állapotmentesnek kell lennie,</span><span class="sxs-lookup"><span data-stu-id="2c5e8-215">To reduce possible complications caused by the need to maintain client affinity, the VMs in the web tier should be stateless.</span></span> <span data-ttu-id="2c5e8-216">ahogy az üzleti logikát üzemeltető virtuális gépeknek is.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-216">The VMs hosting the business logic should also be stateless.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="2c5e8-217">Felügyeleti szempontok</span><span class="sxs-lookup"><span data-stu-id="2c5e8-217">Manageability considerations</span></span>

<span data-ttu-id="2c5e8-218">A teljes rendszer kezelését egyszerűbbé teheti különböző központosított felügyeleti eszközök használatával, amilyen például az [Azure Automation][azure-administration], a [Microsoft Operations Management Suite][operations-management-suite], a [Chef][chef] vagy a [Puppet][puppet].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-218">Simplify management of the entire system by using centralized administration tools such as [Azure Automation][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef], or [Puppet][puppet].</span></span> <span data-ttu-id="2c5e8-219">Ezek az eszközök konszolidálják több virtuális gép rögzített diagnosztikai és az állapotinformációit, így átfogó képet nyújtanak a rendszerről.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-219">These tools can consolidate diagnostic and health information captured from multiple VMs to provide an overall view of the system.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="2c5e8-220">A megoldás üzembe helyezése</span><span class="sxs-lookup"><span data-stu-id="2c5e8-220">Deploy the solution</span></span>

<span data-ttu-id="2c5e8-221">Ennek a referenciaarchitektúrának egy üzemelő példánya elérhető a [GitHubon][github-folder].</span><span class="sxs-lookup"><span data-stu-id="2c5e8-221">A deployment for this reference architecture is available on [GitHub][github-folder].</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="2c5e8-222">Előfeltételek</span><span class="sxs-lookup"><span data-stu-id="2c5e8-222">Prerequisites</span></span>

<span data-ttu-id="2c5e8-223">Mielőtt üzembe helyezhetné saját előfizetésében a referenciaarchitektúrát, az alábbi lépéseket kell elvégeznie.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-223">Before you can deploy the reference architecture to your own subscription, you must perform the following steps.</span></span>

1. <span data-ttu-id="2c5e8-224">Klónozza, ágaztassa vagy a zip-fájl letöltése a [architektúrák hivatkozhat] [ ref-arch-repo] GitHub-tárházban.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-224">Clone, fork, or download the zip file for the [reference architectures][ref-arch-repo] GitHub repository.</span></span>

2. <span data-ttu-id="2c5e8-225">Győződjön meg arról, hogy az Azure CLI 2.0 telepítve van a számítógépén.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-225">Make sure you have the Azure CLI 2.0 installed on your computer.</span></span> <span data-ttu-id="2c5e8-226">A CLI telepítéséhez kövesse az [Azure CLI 2.0 telepítése][azure-cli-2] című szakaszban leírt utasításokat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-226">To install the CLI, follow the instructions in [Install Azure CLI 2.0][azure-cli-2].</span></span>

3. <span data-ttu-id="2c5e8-227">Telepítse [az Azure építőelemei][azbb] npm-csomagot.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-227">Install the [Azure building blocks][azbb] npm package.</span></span>

  ```bash
  npm install -g @mspnp/azure-building-blocks
  ```

4. <span data-ttu-id="2c5e8-228">Jelentkezzen be Azure-fiókjába egy parancssorból, Bash-parancssorból vagy PowerShell-parancssorból az alábbi parancsok egyikével, és kövesse az utasításokat.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-228">From a command prompt, bash prompt, or PowerShell prompt, login to your Azure account by using one of the commands below, and follow the prompts.</span></span>

  ```bash
  az login
  ```

### <a name="deploy-the-solution-using-azbb"></a><span data-ttu-id="2c5e8-229">A megoldás üzembe helyezése az azbb használatával</span><span class="sxs-lookup"><span data-stu-id="2c5e8-229">Deploy the solution using azbb</span></span>

<span data-ttu-id="2c5e8-230">Ha Linux rendszerű virtuális gépeket szeretne üzembe helyezni egy N szintű alkalmazás referenciaarchitektúrájához, kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="2c5e8-230">To deploy the Linux VMs for an N-tier application reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="2c5e8-231">Navigáljon a fenti előfeltételek 1. lépése során klónozott adattár `virtual-machines\n-tier-linux` mappájához.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-231">Navigate to the `virtual-machines\n-tier-linux` folder for the repository you cloned in step 1 of the pre-requisites above.</span></span>

2. <span data-ttu-id="2c5e8-232">A paraméterfájl egy alapértelmezett rendszergazdai felhasználónevet és jelszót határoz meg az üzemelő példány minden egyes virtuális gépéhez.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-232">The parameter file specifies a default adminstrator user name and password for each VM in the deployment.</span></span> <span data-ttu-id="2c5e8-233">Ezeket módosítania kell, mielőtt üzembe helyezné a referenciaarchitektúrát.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-233">You must change these before you deploy the reference architecture.</span></span> <span data-ttu-id="2c5e8-234">Nyissa meg az `n-tier-linux.json` fájlt, és cserélje le az egyes **adminUsername** és **adminPassword** mezők tartalmát az új beállításokra.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-234">Open the `n-tier-linux.json` file and replace each **adminUsername** and **adminPassword** field with your new settings.</span></span>   <span data-ttu-id="2c5e8-235">Mentse a fájlt.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-235">Save the file.</span></span>

3. <span data-ttu-id="2c5e8-236">Helyezze üzembe a referenciaarchitektúrát az **azbb** parancssori eszköz használatával az alább látható módon.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-236">Deploy the reference architecture using the **azbb** command line tool as shown below.</span></span>

  ```bash
  azbb -s <your subscription_id> -g <your resource_group_name> -l <azure region> -p n-tier-linux.json --deploy
  ```

<span data-ttu-id="2c5e8-237">A mintául szolgáló referenciaarchitektúra Azure-építőelemekkel történő üzembe helyezéséről további információkat a [GitHub-adattárban][git] talál.</span><span class="sxs-lookup"><span data-stu-id="2c5e8-237">For more information on deploying this sample reference architecture using Azure Building Blocks, visit the [GitHub repository][git].</span></span>

<!-- links -->
[multi-dc]: multi-region-application.md
[dmz]: ../dmz/secure-vnet-dmz.md
[multi-vm]: ./multi-vm.md
[naming conventions]: /azure/guidance/guidance-naming-conventions
[azbb]: https://github.com/mspnp/template-building-blocks/wiki/Install-Azure-Building-Blocks
[azure-administration]: /azure/automation/automation-intro
[azure-availability-sets]: /azure/virtual-machines/virtual-machines-linux-manage-availability
[azure-cli-2]: https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest
[azure-dns]: /azure/dns/dns-overview
[bástyagazdagép]: https://en.wikipedia.org/wiki/Bastion_host
[cassandra-in-azure]: https://docs.datastax.com/en/datastax_enterprise/4.5/datastax_enterprise/install/installAzure.html
[cidr]: https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing
[chef]: https://www.chef.io/solutions/azure/
[datastax]: http://www.datastax.com/products/datastax-enterprise
[git]: https://github.com/mspnp/template-building-blocks
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/n-tier-linux
[lb-external-create]: /azure/load-balancer/load-balancer-get-started-internet-portal
[lb-internal-create]: /azure/load-balancer/load-balancer-get-started-ilb-arm-portal
[load-balancer-external]: /azure/load-balancer/load-balancer-internet-overview
[load-balancer-internal]: /azure/load-balancer/load-balancer-internal-overview
[nsg]: /azure/virtual-network/virtual-networks-nsg
[nsg-rules]: /azure/azure-resource-manager/best-practices-resource-manager-security#network-security-groups
[operations-management-suite]: https://www.microsoft.com/server-cloud/operations-management-suite/overview.aspx
[plan-network]: /azure/virtual-network/virtual-network-vnet-plan-design-arm
[private-ip-space]: https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
[nyilvános IP-címet]: /azure/virtual-network/virtual-network-ip-addresses-overview-arm
[puppet]: https://puppetlabs.com/blog/managing-azure-virtual-machines-puppet
[ref-arch-repo]: https://github.com/mspnp/reference-architectures
[vm-sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines
[vnet faq]: /azure/virtual-network/virtual-networks-faq
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[Nagios]: https://www.nagios.org/
[Zabbix]: http://www.zabbix.com/
[Icinga]: http://www.icinga.org/
[0]: ./images/n-tier-diagram.png "N szintű architektúra a Microsoft Azure használatával"

