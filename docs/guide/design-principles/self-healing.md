---
title: "Automatikus javítás kialakítása"
description: "Rugalmas alkalmazások tud helyreállni hibák után beavatkozás nélkül."
author: MikeWasson
layout: LandingPage
ms.openlocfilehash: 0782b65b77615f7c006724264ab0ca2d2c7c04e2
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 11/14/2017
---
# <a name="design-for-self-healing"></a><span data-ttu-id="6a300-103">Automatikus javítás kialakítása</span><span class="sxs-lookup"><span data-stu-id="6a300-103">Design for self healing</span></span>

## <a name="design-your-application-to-be-self-healing-when-failures-occur"></a><span data-ttu-id="6a300-104">A hibák bekövetkezésekor öngyógyító kell alkalmazás megtervezése</span><span class="sxs-lookup"><span data-stu-id="6a300-104">Design your application to be self healing when failures occur</span></span>

<span data-ttu-id="6a300-105">Elosztott rendszer esetén fordulhat elő hibák.</span><span class="sxs-lookup"><span data-stu-id="6a300-105">In a distributed system, failures happen.</span></span> <span data-ttu-id="6a300-106">Hardver sikertelen lehet.</span><span class="sxs-lookup"><span data-stu-id="6a300-106">Hardware can fail.</span></span> <span data-ttu-id="6a300-107">A hálózati is átmeneti hibák fordultak elő.</span><span class="sxs-lookup"><span data-stu-id="6a300-107">The network can have transient failures.</span></span> <span data-ttu-id="6a300-108">Ritkán az egész szolgáltatás vagy a régió problémákat tapasztalhat a szüneteltetése, de még az kell lennie a tervezett.</span><span class="sxs-lookup"><span data-stu-id="6a300-108">Rarely, an entire service or region may experience a disruption, but even those must be planned for.</span></span>

<span data-ttu-id="6a300-109">Ezért tervezzen egy alkalmazás hibák bekövetkezésekor öngyógyító.</span><span class="sxs-lookup"><span data-stu-id="6a300-109">Therefore, design an application to be self healing when failures occur.</span></span> <span data-ttu-id="6a300-110">Ehhez szükséges a három pronged megközelítés:</span><span class="sxs-lookup"><span data-stu-id="6a300-110">This requires a three-pronged approach:</span></span>

- <span data-ttu-id="6a300-111">Észleli a hibáit.</span><span class="sxs-lookup"><span data-stu-id="6a300-111">Detect failures.</span></span>
- <span data-ttu-id="6a300-112">Hibák szabályosan válaszolni.</span><span class="sxs-lookup"><span data-stu-id="6a300-112">Respond to failures gracefully.</span></span>
- <span data-ttu-id="6a300-113">Naplózhatja és megfigyelheti sikertelen, működési feltárhatja.</span><span class="sxs-lookup"><span data-stu-id="6a300-113">Log and monitor failures, to give operational insight.</span></span>

<span data-ttu-id="6a300-114">Hiba egy bizonyos típusú adott válasz függ, hogy az alkalmazás rendelkezésre állási követelményeinek.</span><span class="sxs-lookup"><span data-stu-id="6a300-114">How you respond to a particular type of failure may depend on your application's availability requirements.</span></span> <span data-ttu-id="6a300-115">Például ha magas rendelkezésre állást igényel, akkor előfordulhat, hogy automatikusan áthelyezze a feladatokat egy másodlagos régióban regionális kimaradás során.</span><span class="sxs-lookup"><span data-stu-id="6a300-115">For example, if you require very high availability, you might automatically fail over to a secondary region during a regional outage.</span></span> <span data-ttu-id="6a300-116">Azonban, hogy egy költségesebb, mint egyetlen területi központi telepítések gyakorisága.</span><span class="sxs-lookup"><span data-stu-id="6a300-116">However, that will incur a higher cost than a single-region deployment.</span></span> 

<span data-ttu-id="6a300-117">Nem csupán figyelembe venni nagy eseményekkel – például regionális kimaradások esetén, amelyek általában ritkán fordul elő.</span><span class="sxs-lookup"><span data-stu-id="6a300-117">Also, don't just consider big events like regional outages, which are generally rare.</span></span> <span data-ttu-id="6a300-118">Irányul, lehető legtöbb, ha nem több, a helyi, rövid élettartamú hibák, például a hálózati csatlakozási hibák kezelése, vagy nem sikerült a Helyadatbázis-kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="6a300-118">You should focus as much, if not more, on handling local, short-lived failures, such as network connectivity failures or failed database connections.</span></span>

## <a name="recommendations"></a><span data-ttu-id="6a300-119">Javaslatok</span><span class="sxs-lookup"><span data-stu-id="6a300-119">Recommendations</span></span>

<span data-ttu-id="6a300-120">**Próbálja meg újra a sikertelen műveleteket**.</span><span class="sxs-lookup"><span data-stu-id="6a300-120">**Retry failed operations**.</span></span> <span data-ttu-id="6a300-121">Amikor egy szolgáltatás foglalt átmeneti hibák pillanatnyi megszűnését hálózati kapcsolatot, az eldobott adatbázis-kapcsolat vagy időtúllépés miatt fordulhat elő.</span><span class="sxs-lookup"><span data-stu-id="6a300-121">Transient failures may occur due to momentary loss of network connectivity, a dropped database connection, or a timeout when a service is busy.</span></span> <span data-ttu-id="6a300-122">Build újrapróbálkozási logika átmeneti hibák kezeléséhez az alkalmazásba.</span><span class="sxs-lookup"><span data-stu-id="6a300-122">Build retry logic into your application to handle transient failures.</span></span> <span data-ttu-id="6a300-123">Az Azure-szolgáltatások számos az ügyfél SDK automatikus újrapróbálkozások valósítja meg.</span><span class="sxs-lookup"><span data-stu-id="6a300-123">For many Azure services, the client SDK implements automatic retries.</span></span> <span data-ttu-id="6a300-124">További információkért lásd: [átmeneti hiba kezelési] [ transient-fault-handling] és [újra mintát][retry].</span><span class="sxs-lookup"><span data-stu-id="6a300-124">For more information, see [Transient fault handling][transient-fault-handling] and [Retry Pattern][retry].</span></span>

<span data-ttu-id="6a300-125">**Hibás távoli szolgáltatások (áramköri megszakító) védelme**.</span><span class="sxs-lookup"><span data-stu-id="6a300-125">**Protect failing remote services (Circuit Breaker)**.</span></span> <span data-ttu-id="6a300-126">Hasznos lehet, hogy átmeneti hiba után próbálkozzon újra, de ha a hiba továbbra is fennáll, akkor is végül beütés hibás szolgáltatás túl sok hívókat.</span><span class="sxs-lookup"><span data-stu-id="6a300-126">It's good to retry after a transient failure, but if the failure persists, you can end up with too many callers hammering a failing service.</span></span> <span data-ttu-id="6a300-127">Ez vezethet kaszkádolt sikertelen kérelmek, készítsen biztonsági másolatot.</span><span class="sxs-lookup"><span data-stu-id="6a300-127">This can lead to cascading failures, as requests back up.</span></span> <span data-ttu-id="6a300-128">Használja a [áramköri megszakító mintát] [ circuit-breaker] gyors (nélkül a távoli hívás) meghiúsul egy művelet esetén valószínűleg hiba fog előfordulni.</span><span class="sxs-lookup"><span data-stu-id="6a300-128">Use the [Circuit Breaker Pattern][circuit-breaker] to fail fast (without making the remote call) when an operation is likely to fail.</span></span>  

<span data-ttu-id="6a300-129">**Különítse el a fontos erőforrásokhoz (válaszfal)**.</span><span class="sxs-lookup"><span data-stu-id="6a300-129">**Isolate critical resources (Bulkhead)**.</span></span> <span data-ttu-id="6a300-130">Egy alrendszer hibáinak néha kaszkádolt is.</span><span class="sxs-lookup"><span data-stu-id="6a300-130">Failures in one subsystem can sometimes cascade.</span></span> <span data-ttu-id="6a300-131">Ez akkor fordulhat elő, ha a hiba miatt egyes erőforrásokat, például a szálak vagy sockets, nem az időben, ami Erőforrásfogyás felszabadított beolvasása.</span><span class="sxs-lookup"><span data-stu-id="6a300-131">This can happen if a failure causes some resources, such as threads or sockets, not to get freed in a timely manner, leading to resource exhaustion.</span></span> <span data-ttu-id="6a300-132">Ennek elkerülése érdekében partíció egy rendszer elkülönített csoportokba, így egy partíció meghibásodása esetén nem áll le a teljes rendszer.</span><span class="sxs-lookup"><span data-stu-id="6a300-132">To avoid this, partition a system into isolated groups, so that a failure in one partition does not bring down the entire system.</span></span>  

<span data-ttu-id="6a300-133">**Hajtsa végre a terhelés simítás**.</span><span class="sxs-lookup"><span data-stu-id="6a300-133">**Perform load leveling**.</span></span> <span data-ttu-id="6a300-134">Alkalmazások a forgalmat, amely képes ne terhelje tovább a háttérkiszolgálón szolgáltatások hirtelen teljesítményt tapasztalhat.</span><span class="sxs-lookup"><span data-stu-id="6a300-134">Applications may experience sudden spikes in traffic that can overwhelm services on the backend.</span></span> <span data-ttu-id="6a300-135">Ennek elkerülése érdekében használja a [várólista alapú terhelés simítás mintát] [ load-level] a várólistába helyezni a munkaelemet az aszinkron módon futnak.</span><span class="sxs-lookup"><span data-stu-id="6a300-135">To avoid this, use the [Queue-Based Load Leveling Pattern][load-level] to queue work items to run asynchronously.</span></span> <span data-ttu-id="6a300-136">A várólista kisimítja a terhelés csúcsait kimenő puffer funkcionál.</span><span class="sxs-lookup"><span data-stu-id="6a300-136">The queue acts as a buffer that smooths out peaks in the load.</span></span> 

<span data-ttu-id="6a300-137">**Feladatok átadása a**.</span><span class="sxs-lookup"><span data-stu-id="6a300-137">**Fail over**.</span></span> <span data-ttu-id="6a300-138">Példánya nem érhető el, ha átadja egy másik példánya.</span><span class="sxs-lookup"><span data-stu-id="6a300-138">If an instance can't be reached, fail over to another instance.</span></span> <span data-ttu-id="6a300-139">Az állapot nélküli alkalmazások, például a webkiszolgáló fog helyezze el a traffic manager vagy terheléselosztó mögött több példányt.</span><span class="sxs-lookup"><span data-stu-id="6a300-139">For things that are stateless, like a web server, put several instances behind a load balancer or traffic manager.</span></span> <span data-ttu-id="6a300-140">Dolgot tároló állapota, például egy adatbázis-replikákat használ, valamint a feladatátvétel.</span><span class="sxs-lookup"><span data-stu-id="6a300-140">For things that store state, like a database, use replicas and fail over.</span></span> <span data-ttu-id="6a300-141">Attól függően, hogy a tárolót, és hogyan replikált elképzelhető, hogy szükség az alkalmazás a végleges konzisztencia kezelésére.</span><span class="sxs-lookup"><span data-stu-id="6a300-141">Depending on the data store and how it replicates, this may require the application to deal with eventual consistency.</span></span> 

<span data-ttu-id="6a300-142">**Nem sikerült tranzakciók kártalanítja**.</span><span class="sxs-lookup"><span data-stu-id="6a300-142">**Compensate failed transactions**.</span></span> <span data-ttu-id="6a300-143">Az elosztott tranzakciók általában elkerülése, szolgáltatások és erőforrások koordinációs van szükségük.</span><span class="sxs-lookup"><span data-stu-id="6a300-143">In general, avoid distributed transactions, as they require coordination across services and resources.</span></span> <span data-ttu-id="6a300-144">Ehelyett állítható össze a kisebb az egyes tranzakciók művelet.</span><span class="sxs-lookup"><span data-stu-id="6a300-144">Instead, compose an operation from smaller individual transactions.</span></span> <span data-ttu-id="6a300-145">Ha a művelet sikertelen félúton keresztül, [Compensating tranzakciók] [ compensating-transactions] visszavonása bármely lépése, amely már befejeződött.</span><span class="sxs-lookup"><span data-stu-id="6a300-145">If the operation fails midway through, use [Compensating Transactions][compensating-transactions] to undo any step that already completed.</span></span> 

<span data-ttu-id="6a300-146">**Ellenőrzőpont hosszú ideje tartó tranzakciók**.</span><span class="sxs-lookup"><span data-stu-id="6a300-146">**Checkpoint long-running transactions**.</span></span> <span data-ttu-id="6a300-147">Az ellenőrzőpontok is biztosít rugalmasságot, ha egy hosszú ideig futó művelet sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="6a300-147">Checkpoints can provide resiliency if a long-running operation fails.</span></span> <span data-ttu-id="6a300-148">Ha a művelet újraindítja (például, hogy van észlelnie másik virtuális gép), a legutóbbi ellenőrzőponttól folytatni.</span><span class="sxs-lookup"><span data-stu-id="6a300-148">When the operation restarts (for example, it is picked up by another VM), it can be resumed from the last checkpoint.</span></span>

<span data-ttu-id="6a300-149">**Csökkentheti a szabályosan**.</span><span class="sxs-lookup"><span data-stu-id="6a300-149">**Degrade gracefully**.</span></span> <span data-ttu-id="6a300-150">Néha nem dolgozunk a probléma, de megadhat csökkentett továbbra is hasznos.</span><span class="sxs-lookup"><span data-stu-id="6a300-150">Sometimes you can't work around a problem, but you can provide reduced functionality that is still useful.</span></span> <span data-ttu-id="6a300-151">Érdemes lehet olyan alkalmazás, amely a katalógus könyvek mutatja.</span><span class="sxs-lookup"><span data-stu-id="6a300-151">Consider an application that shows a catalog of books.</span></span> <span data-ttu-id="6a300-152">Ha az alkalmazás nem olvasható be a lefedi a miniatűr képére, azt egy helyőrző kép lehet, hogy megjelenítése.</span><span class="sxs-lookup"><span data-stu-id="6a300-152">If the application can't retrieve the thumbnail image for the cover, it might show a placeholder image.</span></span> <span data-ttu-id="6a300-153">Előfordulhat, hogy az alkalmazás nem kritikus teljes alrendszereket.</span><span class="sxs-lookup"><span data-stu-id="6a300-153">Entire subsystems might be noncritical for the application.</span></span> <span data-ttu-id="6a300-154">Például az elektronikus kereskedelmi webhely termék javaslatok megjelenítése fontos valószínűleg kevesebb mint feldolgozási rendeléseket.</span><span class="sxs-lookup"><span data-stu-id="6a300-154">For example, in an e-commerce site, showing product recommendations is probably less critical than processing orders.</span></span>

<span data-ttu-id="6a300-155">**Ügyfelek szabályozás**.</span><span class="sxs-lookup"><span data-stu-id="6a300-155">**Throttle clients**.</span></span> <span data-ttu-id="6a300-156">A felhasználók kevés néha nagy a terhelés, ami csökkentheti az alkalmazás rendelkezésre állásának más felhasználók létrehozása.</span><span class="sxs-lookup"><span data-stu-id="6a300-156">Sometimes a small number of users create excessive load, which can reduce your application's availability for other users.</span></span> <span data-ttu-id="6a300-157">Ebben a helyzetben szabályozás az ügyfél egy bizonyos ideig.</span><span class="sxs-lookup"><span data-stu-id="6a300-157">In this situation, throttle the client for a certain period of time.</span></span> <span data-ttu-id="6a300-158">Lásd: [mintát szabályozás][throttle].</span><span class="sxs-lookup"><span data-stu-id="6a300-158">See [Throttling Pattern][throttle].</span></span>

<span data-ttu-id="6a300-159">**Ezeken blokkolása**.</span><span class="sxs-lookup"><span data-stu-id="6a300-159">**Block bad actors**.</span></span> <span data-ttu-id="6a300-160">Csak adatátviteli ügyfél, mert ez nem jelenti azt ügyfél ártó működött.</span><span class="sxs-lookup"><span data-stu-id="6a300-160">Just because you throttle a client, it doesn't mean client was acting maliciously.</span></span> <span data-ttu-id="6a300-161">Csak akkor az ügyfél túllépése miatt a szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="6a300-161">It just means the client exceeded their service quota.</span></span> <span data-ttu-id="6a300-162">De ha egy ügyfél következetesen meghaladja a kvótát, vagy ellenkező esetben úgy viselkedik, helytelen, akkor blokkolhatják őket.</span><span class="sxs-lookup"><span data-stu-id="6a300-162">But if a client consistently exceeds their quota or otherwise behaves badly, you might block them.</span></span> <span data-ttu-id="6a300-163">Adja meg egy sávon kívüli folyamat felhasználó kérelem első feloldva.</span><span class="sxs-lookup"><span data-stu-id="6a300-163">Define an out-of-band process for user to request getting unblocked.</span></span>

<span data-ttu-id="6a300-164">**Vezető választás használata**.</span><span class="sxs-lookup"><span data-stu-id="6a300-164">**Use leader election**.</span></span> <span data-ttu-id="6a300-165">Ha egy feladat koordinálására van szüksége, használja [vezető választás] [ leader-election] egy koordinátor kiválasztásához.</span><span class="sxs-lookup"><span data-stu-id="6a300-165">When you need to coordinate a task, use [Leader Election][leader-election] to select a coordinator.</span></span> <span data-ttu-id="6a300-166">Ily módon a koordinátor nem a hibaérzékeny pontok kialakulását.</span><span class="sxs-lookup"><span data-stu-id="6a300-166">That way, the coordinator is not a single point of failure.</span></span> <span data-ttu-id="6a300-167">A koordinátor nem sikerül, ha egy új van kiválasztva.</span><span class="sxs-lookup"><span data-stu-id="6a300-167">If the coordinator fails, a new one is selected.</span></span> <span data-ttu-id="6a300-168">Helyett egy vezető választás algoritmus teljesen új megvalósításához, fontolja meg egy vásárolt megoldás például Zookeeper.</span><span class="sxs-lookup"><span data-stu-id="6a300-168">Rather than implement a leader election algorithm from scratch, consider an off-the-shelf solution such as Zookeeper.</span></span>  

<span data-ttu-id="6a300-169">**Van a vizsgálat**.</span><span class="sxs-lookup"><span data-stu-id="6a300-169">**Test with fault injection**.</span></span> <span data-ttu-id="6a300-170">A sikeres elérési út minden túl gyakran, jól lett tesztelve azonban nem sikertelen elérési.</span><span class="sxs-lookup"><span data-stu-id="6a300-170">All too often, the success path is well tested but not the failure path.</span></span> <span data-ttu-id="6a300-171">A rendszer hosszú ideje előtt hiba elérési gyakorolni az éles környezetben futtathat.</span><span class="sxs-lookup"><span data-stu-id="6a300-171">A system could run in production for a long time before a failure path is exercised.</span></span> <span data-ttu-id="6a300-172">Van segítségével ellenőrizze a sikertelen, a rendszer a rugalmasság, tényleges sikertelen futtatásától vagy szimulál őket.</span><span class="sxs-lookup"><span data-stu-id="6a300-172">Use fault injection to test the resiliency of the system to failures, either by triggering actual failures or by simulating them.</span></span> 

<span data-ttu-id="6a300-173">**Chaos mérnöki kihasználásának**.</span><span class="sxs-lookup"><span data-stu-id="6a300-173">**Embrace chaos engineering**.</span></span> <span data-ttu-id="6a300-174">Chaos mérnöki tartalék injektálási fogalmát hibákat vagy olyan rendellenes feltételek véletlenszerűen beszúrva az éles példányok terjeszti ki.</span><span class="sxs-lookup"><span data-stu-id="6a300-174">Chaos engineering extends the notion of fault injection, by randomly injecting failures or abnormal conditions into production instances.</span></span> 

<span data-ttu-id="6a300-175">A strukturált módjáról, hogy az alkalmazások öngyógyító, lásd: [rugalmas alkalmazások az Azure-][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="6a300-175">For a structured approach to making your applications self healing, see [Design resilient applications for Azure][resiliency-overview].</span></span>  

[circuit-breaker]: ../../patterns/circuit-breaker.md
[compensating-transactions]: ../../patterns/compensating-transaction.md
[leader-election]: ../../patterns/leader-election.md
[load-level]: ../../patterns/queue-based-load-leveling.md
[resiliency-overview]: ../../resiliency/index.md
[retry]: ../../patterns/retry.md
[throttle]: ../../patterns/throttling.md
[transient-fault-handling]: ../../best-practices/transient-faults.md

